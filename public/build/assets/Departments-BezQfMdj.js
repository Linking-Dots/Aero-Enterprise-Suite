import{u as De,r as h,j as e,G as We,c as T,a as Y,H as Ge,g as He,h as Ve}from"./app-CmFfjWsP.js";import{u as Ce,T as C,B as ee,G as Ue,F as qe}from"./logo-Bb-VUmpc.js";import{P as Ke}from"./PageHeader-VPvENNef.js";import{S as Je}from"./StatsCards-DlhJAGRq.js";import{z as L,D as Qe,E as Xe,H as Ze,J as Q,b as Pe,c as I,K as se,g as Se,u as ae,I as Fe,L as ke,k as _,l as fe,N as es,O as ss,B as k,e as as,A as ts,G as rs,h as ls,P as ns}from"./App-DKNf4kbj.js";import{d as ne}from"./dayjs.min-Yb-mO8Jg.js";import{N as os}from"./NoDataMessage-DTSaGzbI.js";import{F as je}from"./EyeIcon-DH514du3.js";import{F as te}from"./PencilIcon-G8jhViOO.js";import{F as ge}from"./TrashIcon-BNDxSKX0.js";import{F as is}from"./EllipsisVerticalIcon-DYnqK8rG.js";import{F as re}from"./CheckCircleIcon-DcAHPOOH.js";import{F as le}from"./XCircleIcon-DRvI_4Zc.js";import{F as Ie}from"./MapPinIcon-D9dB3maE.js";import{F as ds}from"./UserIcon-C42ICOt3.js";import{t as cs,a as ms,b as hs,c as xs,d as us,e as ps}from"./chunk-F3UDT23P-DZAw_N80.js";import{p as Te}from"./chunk-EAPQ7RWQ-DgLMMHg6.js";import{t as X}from"./chunk-BOOVDPB6-DSWITBr2.js";import{u as be}from"./chunk-S574QCAN-WXP3Hn5v.js";import{G as fs}from"./GlassDialog-C5_CkNH7.js";import{D as Ee}from"./DialogTitle-JICgBhou.js";import{D as H}from"./Divider-BqW5YimP.js";import{D as Ae,a as Re}from"./DialogContent-RSy4PdMH.js";import{T as O,I as ve,F as Z}from"./TextField-CZkJRVYj.js";import{S as we,M as G}from"./Select-D2ehSAHQ.js";import{B as V}from"./Button-CPbP042r.js";import{D as js}from"./Dialog-ydNep9GA.js";import{F as gs}from"./ExclamationTriangleIcon-DVI7Fufz.js";import{A as Ne}from"./Alert-Dm1ESiov.js";import{C as Me}from"./CircularProgress-BjwqTAiA.js";import{F as bs}from"./PlusIcon-CjH05r6-.js";import{F as vs}from"./DocumentArrowDownIcon-Cat9IkTU.js";import{b as ws}from"./chunk-57V4RE7B-BMIbxhB8.js";import{F as Ns}from"./TableCellsIcon-DekrskrV.js";import{F as ys}from"./AdjustmentsHorizontalIcon-CvXOK6En.js";import{i as _s}from"./chunk-SSA7SXE4-DCTIi96t.js";import{s as ye,l as B}from"./chunk-Y2AYO5NJ-DTFyT4m_.js";import"./create-visual-element-CNNoQd8i.js";import"./chunk-D5XJWRAV-D-wO4tV2.js";import"./EnvelopeIcon-B03bj0NI.js";import"./ShieldCheckIcon-B_1qhU2x.js";import"./useHasTabbableChild-mvVqOm0Y.js";import"./index-8-ppjCsZ.js";import"./index-CokAva9Y.js";import"./Popover-BA5NTheW.js";import"./useSlot-DSwTWDBd.js";const Ds=({departments:p,onEdit:m,onDelete:P,onView:t,loading:f,isMobile:i,isTablet:g,pagination:u,onPageChange:l,onRowsPerPageChange:S,canEditDepartment:r=!1,canDeleteDepartment:N=!1})=>{var F,E;const{auth:y}=De().props,d=r||((F=y.permissions)==null?void 0:F.includes("departments.update"))||!1,x=N||((E=y.permissions)==null?void 0:E.includes("departments.delete"))||!1,b=h.useMemo(()=>[{name:"DEPARTMENT",uid:"name"},{name:"CODE",uid:"code",hide:i},{name:"MANAGER",uid:"manager"},{name:"EMPLOYEES",uid:"employees"},{name:"LOCATION",uid:"location",hide:i},{name:"STATUS",uid:"status"},{name:"ESTABLISHED",uid:"established",hide:i||g},{name:"ACTIONS",uid:"actions"}].filter(w=>!w.hide),[i,g]),n=(a,w)=>{var o,v;switch(w){case"name":return e.jsx(be,{avatarProps:{radius:"lg",fallback:e.jsx(Se,{className:"w-8 h-4"}),size:i?"sm":"md"},name:a.name,description:a.parent?a.parent.name:"Top-level department",classNames:{name:"font-semibold text-foreground text-left",description:"text-default-500 text-left text-xs",wrapper:"justify-start"}});case"code":return e.jsx("div",{children:a.code?e.jsx(I,{size:"sm",variant:"flat",color:"primary",className:"text-xs",children:a.code}):e.jsx("span",{className:"text-default-400 text-xs",children:"-"})});case"manager":return e.jsx("div",{className:"flex items-start ",children:a.manager?e.jsxs(e.Fragment,{children:[e.jsx(be,{avatarProps:{radius:"lg",src:((o=a.manager)==null?void 0:o.profile_image_url)||((v=a.manager)==null?void 0:v.profile_image),size:"md",fallback:e.jsx(ds,{className:"w-5 h-5"})},classNames:{name:"font-semibold text-foreground text-sm",description:"text-default-500 text-xs"}}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:a.manager.name}),!i&&a.manager.email&&e.jsx("span",{className:"text-xs text-default-400",children:a.manager.email})]})]}):e.jsx("span",{className:"text-default-400 text-xs",children:"Not assigned"})});case"employees":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:a.employee_count||0})]});case"location":return e.jsx("div",{className:"flex items-center gap-2",children:a.location?e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:a.location})]}):e.jsx("span",{className:"text-default-400 text-xs",children:"-"})});case"status":return e.jsx(I,{size:"sm",variant:a.is_active?"solid":"bordered",color:a.is_active?"success":"danger",startContent:a.is_active?e.jsx(re,{className:"w-3 h-3"}):e.jsx(le,{className:"w-3 h-3"}),children:a.is_active?"Active":"Inactive"});case"established":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{className:"text-sm",children:a.established_date?ne(a.established_date).format("MMM D, YYYY"):e.jsx("span",{className:"text-default-400 text-xs",children:"-"})})]});case"actions":return e.jsx("div",{className:"flex justify-end items-center",children:i?e.jsxs(Qe,{children:[e.jsx(Xe,{children:e.jsx(T,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(is,{className:"w-4 h-4"})})}),e.jsxs(Ze,{"aria-label":"Department actions",children:[e.jsx(Q,{startContent:e.jsx(je,{className:"w-4 h-4"}),onPress:()=>t(a),children:"View Details"},"view"),d&&e.jsx(Q,{startContent:e.jsx(te,{className:"w-4 h-4"}),onPress:()=>m(a),children:"Edit Department"},"edit"),x&&e.jsx(Q,{className:"text-danger",color:"danger",startContent:e.jsx(ge,{className:"w-4 h-4"}),isDisabled:a.employee_count>0,onPress:()=>P(a),children:"Delete Department"},"delete")]})]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{content:"View Department",children:e.jsx(T,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>t(a),children:e.jsx(je,{className:"w-4 h-4"})})}),d&&e.jsx(X,{content:"Edit Department",children:e.jsx(T,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-blue-500",onPress:()=>m(a),children:e.jsx(te,{className:"w-4 h-4"})})}),x&&e.jsx(X,{content:a.employee_count>0?"Cannot delete department with employees":"Delete Department",children:e.jsx(T,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-danger",isDisabled:a.employee_count>0,onPress:()=>P(a),children:e.jsx(ge,{className:"w-4 h-4"})})})]})});default:return e.jsx("span",{children:a[w]})}},R=()=>!p||!p.data||f?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(u.currentPage-1)*u.perPage+1," to ",Math.min(u.currentPage*u.perPage,p.total)," of ",p.total," departments"]}),e.jsx(Te,{total:Math.ceil(p.total/u.perPage),initialPage:u.currentPage,page:u.currentPage,onChange:l,size:i?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]});return!f&&(!p||!p.data||p.data.length===0)?e.jsx("div",{className:"w-full",children:e.jsx(os,{message:"No departments found",icon:e.jsx(L,{className:"w-12 h-12 text-default-300"}),description:"Try adjusting your search or filters"})}):e.jsx("div",{className:"w-full",children:e.jsxs(cs,{"aria-label":"Departments table",removeWrapper:!0,classNames:{base:"bg-transparent",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs",td:"border-b border-white/5 py-3"},bottomContent:R(),children:[e.jsx(ms,{columns:b,children:a=>e.jsx(hs,{children:a.name},a.uid)}),e.jsx(xs,{items:p.data||[],emptyContent:!f&&"No departments found",loadingContent:e.jsx(We,{}),isLoading:f,children:a=>e.jsx(us,{children:w=>e.jsx(ps,{children:n(a,w)})},a.id)})]})})},_e=({open:p,onClose:m,onSuccess:P,department:t=null,managers:f=[],parentDepartments:i=[]})=>{var R,F,E,a,w;const g=Ce(),u=ae(g.breakpoints.down("md")),[l,S]=h.useState(!1),[r,N]=h.useState({}),y={name:"",code:"",description:"",parent_id:null,manager_id:null,location:"",is_active:!0,established_date:""},[d,x]=h.useState(y);h.useEffect(()=>{x(t?{name:t.name||"",code:t.code||"",description:t.description||"",parent_id:t.parent_id||null,manager_id:t.manager_id||null,location:t.location||"",is_active:t.is_active??!0,established_date:t.established_date?ne(t.established_date).format("YYYY-MM-DD"):""}:y),N({})},[t,p]);const b=o=>{const{name:v,value:c,type:D,checked:W}=o.target;x(A=>({...A,[v]:D==="checkbox"?W:c})),r[v]&&N(A=>({...A,[v]:null}))},n=async()=>{var o,v;S(!0),N({});try{const c={...d,established_date:d.established_date||null};let D;t!=null&&t.id?(D=await Y.put(`/departments/${t.id}`,c),k.success("Department updated successfully")):(D=await Y.post("/departments",c),k.success("Department created successfully")),P(D.data.department),m()}catch(c){if(console.error("Error saving department:",c),(v=(o=c.response)==null?void 0:o.data)!=null&&v.errors){N(c.response.data.errors);const D=Object.values(c.response.data.errors)[0];D&&k.error(D[0])}else k.error("An error occurred while saving the department")}finally{S(!1)}};return e.jsxs(fs,{open:p,onClose:l?void 0:m,maxWidth:"md",fullWidth:!0,fullScreen:u,"aria-labelledby":"department-form-dialog",children:[e.jsxs(Ee,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(C,{variant:"h6",component:"div",children:t?"Edit Department":"Create New Department"}),e.jsx(Fe,{edge:"end",color:"inherit",onClick:m,disabled:l,"aria-label":"close",children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsx(H,{}),e.jsx(Ae,{sx:{pt:2},children:e.jsxs(_,{container:!0,spacing:3,children:[e.jsx(_,{item:!0,xs:12,children:e.jsx(C,{variant:"subtitle1",color:"primary",gutterBottom:!0,children:"Basic Information"})}),e.jsx(_,{item:!0,xs:12,md:6,children:e.jsx(O,{name:"name",label:"Department Name",fullWidth:!0,required:!0,value:d.name,onChange:b,error:!!r.name,helperText:((R=r.name)==null?void 0:R[0])||"",disabled:l})}),e.jsx(_,{item:!0,xs:12,md:6,children:e.jsx(O,{name:"code",label:"Department Code",fullWidth:!0,value:d.code||"",onChange:b,error:!!r.code,helperText:((F=r.code)==null?void 0:F[0])||"Unique identifier (e.g., HR001, FIN002)",disabled:l})}),e.jsx(_,{item:!0,xs:12,children:e.jsx(O,{name:"description",label:"Description",fullWidth:!0,multiline:!0,rows:3,value:d.description||"",onChange:b,error:!!r.description,helperText:((E=r.description)==null?void 0:E[0])||"",disabled:l})}),e.jsx(_,{item:!0,xs:12,sx:{mt:2},children:e.jsx(C,{variant:"subtitle1",color:"primary",gutterBottom:!0,children:"Organizational Information"})}),e.jsx(_,{item:!0,xs:12,md:6,children:e.jsxs(fe,{fullWidth:!0,error:!!r.parent_id,children:[e.jsx(ve,{id:"parent-department-label",children:"Parent Department"}),e.jsxs(we,{labelId:"parent-department-label",name:"parent_id",value:d.parent_id||"",onChange:b,label:"Parent Department",disabled:l,children:[e.jsx(G,{value:"",children:e.jsx("em",{children:"None (Top-Level Department)"})}),i.map(o=>(t==null?void 0:t.id)!==o.id&&e.jsx(G,{value:o.id,children:o.name},o.id))]}),r.parent_id&&e.jsx(Z,{children:r.parent_id[0]})]})}),e.jsx(_,{item:!0,xs:12,md:6,children:e.jsxs(fe,{fullWidth:!0,error:!!r.manager_id,children:[e.jsx(ve,{id:"manager-label",children:"Department Manager"}),e.jsxs(we,{labelId:"manager-label",name:"manager_id",value:d.manager_id||"",onChange:b,label:"Department Manager",disabled:l,children:[e.jsx(G,{value:"",children:e.jsx("em",{children:"Not Assigned"})}),f.map(o=>e.jsx(G,{value:o.id,children:o.name},o.id))]}),r.manager_id&&e.jsx(Z,{children:r.manager_id[0]})]})}),e.jsx(_,{item:!0,xs:12,md:6,children:e.jsx(O,{name:"location",label:"Location",fullWidth:!0,value:d.location||"",onChange:b,error:!!r.location,helperText:((a=r.location)==null?void 0:a[0])||"Physical location of the department",disabled:l})}),e.jsx(_,{item:!0,xs:12,md:6,children:e.jsx(O,{name:"established_date",label:"Established Date",type:"date",fullWidth:!0,value:d.established_date||"",onChange:b,error:!!r.established_date,helperText:((w=r.established_date)==null?void 0:w[0])||"",disabled:l,InputLabelProps:{shrink:!0}})}),e.jsxs(_,{item:!0,xs:12,children:[e.jsx(es,{control:e.jsx(ss,{checked:d.is_active,onChange:b,name:"is_active",color:"success",disabled:l}),label:"Department is active"}),r.is_active&&e.jsx(Z,{error:!0,children:r.is_active[0]})]})]})}),e.jsx(H,{}),e.jsxs(Re,{sx:{px:3,py:2},children:[e.jsx(V,{onClick:m,disabled:l,color:"inherit",children:"Cancel"}),e.jsx(V,{onClick:n,variant:"contained",color:"primary",disabled:l,children:l?"Saving...":t?"Update Department":"Create Department"})]})]})},Cs=({open:p,onClose:m,onSuccess:P,department:t})=>{const[f,i]=h.useState(!1),[g,u]=h.useState(null),l=async()=>{var S,r,N,y;if(t){i(!0),u(null);try{await Y.delete(`/departments/${t.id}`),k.success("Department deleted successfully"),P(),m()}catch(d){if(console.error("Error deleting department:",d),(r=(S=d.response)==null?void 0:S.data)!=null&&r.message)u(d.response.data.message),k.error(d.response.data.message);else if((y=(N=d.response)==null?void 0:N.data)!=null&&y.errors){const x=Object.values(d.response.data.errors)[0];u(x),k.error(x)}else u("An error occurred while deleting the department"),k.error("An error occurred while deleting the department")}finally{i(!1)}}};return t?e.jsxs(js,{open:p,onClose:f?void 0:m,maxWidth:"sm",fullWidth:!0,"aria-labelledby":"delete-department-dialog",children:[e.jsxs(Ee,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(C,{variant:"h6",children:"Delete Department"}),e.jsx(Fe,{edge:"end",color:"inherit",onClick:m,disabled:f,"aria-label":"close",children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsx(H,{}),e.jsx(Ae,{children:e.jsxs(ee,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(ee,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(gs,{className:"w-8 h-8 text-yellow-500"}),e.jsxs(C,{variant:"body1",children:["Are you sure you want to delete the department ",e.jsx("strong",{children:t.name}),"?"]})]}),t.employee_count>0&&e.jsxs(Ne,{severity:"warning",sx:{mt:2},children:["This department has ",t.employee_count," employees assigned to it. You cannot delete a department with active employees. Please reassign these employees to other departments first."]}),g&&e.jsx(Ne,{severity:"error",sx:{mt:2},children:g}),e.jsx(C,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"This action cannot be undone. All associated data will be permanently removed."})]})}),e.jsx(H,{}),e.jsxs(Re,{sx:{px:3,py:2},children:[e.jsx(V,{onClick:m,disabled:f,color:"inherit",children:"Cancel"}),e.jsx(V,{onClick:l,variant:"contained",color:"error",disabled:f||t.employee_count>0,startIcon:f&&e.jsx(Me,{size:20,color:"inherit"}),children:f?"Deleting...":"Delete Department"})]})]}):null},ba=({title:p,departments:m,managers:P,parentDepartments:t,stats:f,filters:i})=>{var de,ce,me,he,xe,ue;const{auth:g}=De().props,u=Ce(),l=ae(u.breakpoints.down("sm")),S=ae(u.breakpoints.down("md")),[r,N]=h.useState(m||{data:[]}),[y,d]=h.useState(!1),[x,b]=h.useState({type:null,department:null}),[n,R]=h.useState({search:(i==null?void 0:i.search)||"",status:(i==null?void 0:i.status)||"all",parentDepartment:(i==null?void 0:i.parentDepartment)||"all"}),[F,E]=h.useState(!1),[a,w]=h.useState("table"),[o,v]=h.useState({currentPage:(m==null?void 0:m.current_page)||1,perPage:(m==null?void 0:m.per_page)||10}),[c,D]=h.useState(f||{total:0,active:0,inactive:0,parent_departments:0}),W=((de=g.permissions)==null?void 0:de.includes("departments.create"))||!1,A=((ce=g.permissions)==null?void 0:ce.includes("departments.update"))||!1,U=((me=g.permissions)==null?void 0:me.includes("departments.delete"))||!1,ze=A||((he=g.permissions)==null?void 0:he.includes("departments.update"))||!1;U||(xe=g.permissions)!=null&&xe.includes("departments.delete");const q=h.useCallback(async()=>{d(!0);try{const s=await Y.get(route("api.departments"),{params:{page:o.currentPage,per_page:o.perPage,search:n.search,status:n.status,parent_department:n.parentDepartment}});N(s.data.departments)}catch(s){console.error("Error fetching departments:",s),k.error("Failed to load departments data")}finally{d(!1)}},[o.currentPage,o.perPage,n.search,n.status,n.parentDepartment]),K=h.useCallback(async()=>{try{const s=await Y.get(route("departments.stats"));if(s.status===200){const{stats:j}=s.data;D(j)}}catch(s){console.error("Error fetching department stats:",s)}},[]);h.useEffect(()=>{q(),K()},[q,K]);const M=(s,j)=>{R($=>({...$,[s]:j})),v($=>({...$,currentPage:1}))},oe=s=>{v(j=>({...j,currentPage:s})),window.scrollTo({top:0,behavior:"smooth"})},$e=s=>{v({currentPage:1,perPage:s})},z=(s,j=null)=>{b({type:s,department:j})},J=()=>{b({type:null,department:null})},ie=()=>{q(),K()},Be=({department:s,index:j})=>{const $=s.manager,pe=s.parent;return e.jsx(He,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 transition-all duration-200 cursor-pointer h-full",onPress:()=>z("view_department",s),children:e.jsxs(Ve,{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3 pb-3 border-b border-white/10",children:[e.jsx("div",{className:"flex justify-center items-center h-10 w-10 rounded-lg bg-primary/20 text-primary shrink-0",children:e.jsx(Se,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground text-sm line-clamp-1",children:s.name}),e.jsx("p",{className:"text-default-500 text-xs",children:s.code||"No Code"})]}),ze&&e.jsx(T,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground ml-2",onPress:Ye=>{Ye.stopPropagation(),z("edit_department",s)},children:e.jsx(te,{className:"w-4 h-4"})})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[s.location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ie,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs line-clamp-1",children:s.location})]}),s.established_date&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Pe,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs",children:ne(s.established_date).format("MMM D, YYYY")})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(se,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsxs("span",{className:"text-default-600 text-xs",children:[s.employee_count||0," ",s.employee_count===1?"Employee":"Employees"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10 flex flex-wrap gap-2",children:[e.jsx(I,{size:"sm",variant:s.is_active?"solid":"bordered",color:s.is_active?"success":"danger",className:"text-xs",startContent:s.is_active?e.jsx(re,{className:"w-3 h-3"}):e.jsx(le,{className:"w-3 h-3"}),children:s.is_active?"Active":"Inactive"}),pe&&e.jsx(I,{size:"sm",variant:"flat",color:"primary",className:"text-xs",startContent:e.jsx(L,{className:"w-3 h-3"}),children:pe.name}),$&&e.jsx(I,{size:"sm",variant:"flat",color:"secondary",className:"text-xs",startContent:e.jsx(se,{className:"w-3 h-3"}),children:$.name})]})]})})},Oe=h.useMemo(()=>[{title:"Total Departments",value:(c==null?void 0:c.total)||0,icon:e.jsx(L,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All departments"},{title:"Active",value:(c==null?void 0:c.active)||0,icon:e.jsx(re,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Active departments"},{title:"Inactive",value:(c==null?void 0:c.inactive)||0,icon:e.jsx(le,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Inactive departments"},{title:"Parent Departments",value:(c==null?void 0:c.parent_departments)||0,icon:e.jsx(as,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Top-level departments"}],[c]),Le=h.useMemo(()=>{const s=[];return W&&s.push({label:l?"Add":"Add Department",icon:e.jsx(bs,{className:"w-4 h-4"}),onPress:()=>z("add_department"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),s.push({label:l?"":"Export",isIconOnly:l,icon:e.jsx(vs,{className:"w-4 h-4"}),variant:"bordered",className:"border-[rgba(var(--theme-primary-rgb),0.3)] bg-[rgba(var(--theme-primary-rgb),0.05)] hover:bg-[rgba(var(--theme-primary-rgb),0.1)]"}),s},[W,l]);return e.jsxs(ts,{children:[e.jsx(Ge,{title:p}),e.jsx(ee,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(rs,{in:!0,timeout:800,children:e.jsx(Ue,{children:e.jsx(Ke,{title:"Department Management",subtitle:"Manage company departments, hierarchies, and organizational structure",icon:e.jsx(L,{className:"w-8 h-8"}),variant:"default",actionButtons:Le,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(Je,{stats:Oe,className:"mb-6"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(_s,{label:"Search Departments",variant:"bordered",placeholder:"Search by name, code, or location...",value:n.search,onValueChange:s=>M("search",s),startContent:e.jsx(ls,{className:"w-4 h-4"}),classNames:{input:"bg-transparent",inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},size:l?"sm":"md"})}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs(ws,{variant:"bordered",className:"bg-white/5",children:[e.jsxs(T,{isIconOnly:l,color:a==="table"?"primary":"default",onPress:()=>w("table"),className:a==="table"?"bg-blue-500/20":"",children:[e.jsx(Ns,{className:"w-4 h-4"}),!l&&e.jsx("span",{className:"ml-1",children:"Table"})]}),e.jsxs(T,{isIconOnly:l,color:a==="grid"?"primary":"default",onPress:()=>w("grid"),className:a==="grid"?"bg-blue-500/20":"",children:[e.jsx(ns,{className:"w-4 h-4"}),!l&&e.jsx("span",{className:"ml-1",children:"Grid"})]})]}),e.jsxs(T,{isIconOnly:l,variant:"bordered",onPress:()=>E(!F),className:F?"bg-purple-500/20":"bg-white/5",children:[e.jsx(ys,{className:"w-4 h-4"}),!l&&e.jsx("span",{className:"ml-1",children:"Filters"})]})]})]}),F&&e.jsx(qe,{in:!0,timeout:300,children:e.jsxs("div",{className:"mb-6 p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(ye,{label:"Status",variant:"bordered",selectedKeys:n.status!=="all"?[n.status]:[],onSelectionChange:s=>{const j=Array.from(s)[0]||"all";M("status",j)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e.jsx(B,{value:"all",children:"All Statuses"},"all"),e.jsx(B,{value:"active",children:"Active Only"},"active"),e.jsx(B,{value:"inactive",children:"Inactive Only"},"inactive")]}),e.jsxs(ye,{label:"Parent Department",variant:"bordered",selectedKeys:n.parentDepartment!=="all"?[n.parentDepartment]:[],onSelectionChange:s=>{const j=Array.from(s)[0]||"all";M("parentDepartment",j)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e.jsx(B,{value:"all",children:"All Parent Departments"},"all"),e.jsx(B,{value:"none",children:"Top-Level Departments"},"none"),t==null?void 0:t.map(s=>e.jsx(B,{value:s.id.toString(),children:s.name},s.id.toString()))]})]}),(n.search||n.status!=="all"||n.parentDepartment!=="all")&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-white/10",children:[n.search&&e.jsxs(I,{variant:"flat",color:"primary",size:"sm",onClose:()=>M("search",""),children:["Search: ",n.search]}),n.status!=="all"&&e.jsxs(I,{variant:"flat",color:"secondary",size:"sm",onClose:()=>M("status","all"),children:["Status: ",n.status==="active"?"Active":"Inactive"]}),n.parentDepartment!=="all"&&e.jsxs(I,{variant:"flat",color:"warning",size:"sm",onClose:()=>M("parentDepartment","all"),children:["Parent: ",n.parentDepartment==="none"?"None (Top-Level)":(ue=t==null?void 0:t.find(s=>s.id===parseInt(n.parentDepartment)))==null?void 0:ue.name]})]})]})}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsxs(C,{variant:"h6",className:"font-semibold text-foreground",children:[a==="table"?"Department Table":"Department Grid",e.jsxs("span",{className:"text-sm text-default-500 ml-2",children:["(",r.total||0," ",r.total===1?"department":"departments",")"]})]})}),y?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Me,{size:40}),e.jsx(C,{className:"mt-4",color:"textSecondary",children:"Loading departments data..."})]}):a==="table"?e.jsx(Ds,{departments:r,loading:y,onEdit:A?s=>z("edit_department",s):void 0,onDelete:U?s=>z("delete_department",s):void 0,onView:s=>z("view_department",s),isMobile:l,isTablet:S,pagination:o,onPageChange:oe,onRowsPerPageChange:$e,canEditDepartment:A,canDeleteDepartment:U}):e.jsxs("div",{className:"p-4",children:[r.data&&r.data.length>0?e.jsx("div",{className:`grid gap-4 ${l?"grid-cols-1":S?"grid-cols-2":"grid-cols-3 xl:grid-cols-4"}`,children:r.data.map((s,j)=>e.jsx(Be,{department:s,index:j},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(L,{className:"w-12 h-12 mx-auto text-default-300 mb-2"}),e.jsx(C,{variant:"body1",color:"textSecondary",children:"No departments found"}),e.jsx(C,{variant:"caption",color:"textSecondary",children:"Try adjusting your search or filters"})]}),r.data&&r.data.length>0&&e.jsx("div",{className:"flex justify-center mt-6 border-t border-white/10 pt-4",children:e.jsx(Te,{total:Math.ceil(r.total/o.perPage),initialPage:o.currentPage,page:o.currentPage,onChange:oe,size:l?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})})]})]})]})})})})}),(x.type==="add_department"||x.type==="edit_department")&&e.jsx(_e,{open:!0,onClose:J,onSuccess:ie,department:x.type==="edit_department"?x.department:null,managers:P,parentDepartments:t}),x.type==="delete_department"&&e.jsx(Cs,{open:!0,onClose:J,onSuccess:ie,department:x.department}),x.type==="view_department"&&e.jsx(_e,{open:!0,onClose:J,onSuccess:()=>{},department:x.department,managers:P,parentDepartments:t,readOnly:!0})]})};export{ba as default};
