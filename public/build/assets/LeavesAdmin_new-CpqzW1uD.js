import{J as de,r as t,j as e,a as ce,Q as B,c as _,b as k,d as j,s as me}from"./app-1wQt--nt.js";import{d as P,a as pe,F as ve,b as R,c as T,s as W,l as d,A as ue}from"./App-CJ72I6-H.js";import{S as xe}from"./StatsCards-AqeastQj.js";import{L as Y,D as fe,B as he,a as be,b as ye}from"./BulkDeleteModal-Bb2QKXKz.js";import{d as je}from"./dayjs.min-TwBzSM1t.js";import"./react-toastify.esm-7Z6exQ6O.js";import{F as ge}from"./CheckCircleIcon-Bp6SHwqJ.js";import{F as Fe}from"./XCircleIcon-BRfJHDwL.js";import{F as we}from"./ExclamationTriangleIcon-CmB-OXVM.js";import{m as q}from"./proxy-FaoYfrPs.js";import{F as Ne}from"./PresentationChartLineIcon-D1BzzvGS.js";import{F as Le}from"./PlusIcon-gmSZeGZx.js";import{F as Se}from"./DocumentArrowDownIcon-CaZXJQsD.js";import{F as _e}from"./MagnifyingGlassIcon-Cgcxt5ho.js";import{F as ke}from"./AdjustmentsHorizontalIcon-BYWurDdf.js";import{i as O}from"./chunk-SSA7SXE4-DjN6Ae7g.js";import{b as Re}from"./chunk-57V4RE7B-B82MjbrF.js";import"./EnvelopeIcon-xR3UncmP.js";import"./UserIcon-22PyUsQI.js";import"./ShieldCheckIcon-ChGc8m05.js";import"./KeyIcon-h2pu3Ali.js";import"./logo-DnR0JPZq.js";import"./features-animation-BpwofX4V.js";import"./create-visual-element-fTKIUGtP.js";import"./chunk-TLYTI3QM-8nwDK7H4.js";import"./TrashIcon-BB17ClPJ.js";import"./PencilIcon-CBZ_3X6K.js";import"./EllipsisVerticalIcon-Lf_3n3Uu.js";import"./XCircleIcon-C2UfmLZG.js";import"./CheckCircleIcon-2tMkQwTL.js";import"./ClockIcon-BuD8w1J6.js";import"./ExclamationTriangleIcon-D5XsrxUy.js";import"./createLucideIcon-DJqPSuMo.js";import"./HeartIcon-Z6dWMM9L.js";import"./SunIcon-DvzRGQj3.js";import"./chunk-F3UDT23P-B9VGgRxL.js";import"./chunk-XJ2YRSUP-CgfBCzzl.js";import"./useToggleState-AF4Ubgig.js";import"./chunk-S574QCAN-DT8GJkWP.js";import"./chunk-JOT4BT4P-DC4V1P_k.js";import"./chunk-EAPQ7RWQ-EFkfDWsO.js";import"./chunk-YRZGWF2W-B74zE2_z.js";import"./clock-Doj3asja.js";import"./chunk-QESP63UR-B24HJkRS.js";import"./chunk-O5MCAK4F-Uny7Odd0.js";import"./InformationCircleIcon-D13Vz50w.js";import"./chunk-TQNYOUFX-CKzw0eZT.js";const Me=({title:x,allUsers:f})=>{var D,E,I,$,z;const{auth:m}=de().props,[r,Q]=t.useState(!1),[Ce,J]=t.useState(!1);t.useEffect(()=>{const a=()=>{Q(window.innerWidth<640),J(window.innerWidth<768)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);const[K,Ae]=t.useState(!1),[g,p]=t.useState([]),[De,F]=t.useState(),[Ee,v]=t.useState(0),[Ie,w]=t.useState(0),[h,M]=t.useState(),[G,C]=t.useState([]),[$e,ze]=t.useState(""),[N,Be]=t.useState([]),[Pe,H]=t.useState({perPage:30,currentPage:1}),[Te,We]=t.useState(!1),[L,X]=t.useState(!1),[i,Z]=t.useState({employee:"",selectedMonth:je().format("YYYY-MM"),status:[],leaveType:[],department:[]}),b=t.useCallback((a,s)=>{if(a==="year"){const o=Number(s);if(o<1900||o>new Date().getFullYear()){console.warn("Invalid year selected. Must be between 1900 and current year.");return}}Z(o=>({...o,[a]:s})),H(o=>({...o,currentPage:1}))},[]),[c,V]=t.useState({pending:0,approved:0,rejected:0,total:0,thisMonth:0,thisWeek:0,totalDaysUsed:0,totalDaysRemaining:0}),U=t.useMemo(()=>[{title:"Total Leaves",value:c.total,icon:e.jsx(P,{}),color:"text-primary",iconBg:"bg-primary/20",description:"All leave requests"},{title:"Pending",value:c.pending,icon:e.jsx(pe,{}),color:"text-warning",iconBg:"bg-warning/20",description:"Awaiting approval"},{title:"Approved",value:c.approved,icon:e.jsx(ge,{}),color:"text-success",iconBg:"bg-success/20",description:"Approved requests"},{title:"Rejected",value:c.rejected,icon:e.jsx(Fe,{}),color:"text-danger",iconBg:"bg-danger/20",description:"Rejected requests"},{title:"This Month",value:c.thisMonth,icon:e.jsx(ve,{}),color:"text-secondary",iconBg:"bg-secondary/20",description:"Current month"},{title:"This Week",value:c.thisWeek,icon:e.jsx(R,{}),color:"text-primary",iconBg:"bg-primary/20",description:"Current week"}],[c]),ee=((D=m.permissions)==null?void 0:D.includes("leaves.view"))||!1,ae=((E=m.permissions)==null?void 0:E.includes("leaves.approve"))||!1,A=((I=m.permissions)==null?void 0:I.includes("leaves.create"))||!1,te=(($=m.permissions)==null?void 0:$.includes("leaves.update"))||!1,se=((z=m.permissions)==null?void 0:z.includes("leaves.delete"))||!1,[n,S]=t.useState({add_leave:!1,edit_leave:!1,delete_leave:!1,bulk_leave:!1,bulk_delete:!1}),re=t.useRef(null),y=t.useCallback(a=>{S(s=>({...s,[a]:!0}))},[]),u=t.useCallback(a=>{S(s=>({...s,[a]:!1})),a==="bulk_delete"&&C([])},[]),le=t.useCallback(a=>{C(a),S(s=>({...s,bulk_delete:!0}))},[]),l=t.useCallback(async()=>{try{const a=await ce.get(route("leaves.stats"));a.data.success&&V(a.data.data)}catch(a){console.error("Failed to fetch leave stats:",a)}},[]),oe=t.useCallback(a=>{p(s=>[a,...s]),v(s=>s+1),l()},[l]),ne=t.useCallback(a=>{p(s=>s.map(o=>o.id===a.id?a:o)),l()},[l]),ie=t.useCallback(a=>{p(s=>s.filter(o=>o.id!==a)),v(s=>s-1),l()},[l]);return t.useEffect(()=>{l()},[l]),ee?e.jsxs(e.Fragment,{children:[e.jsx(B,{title:x}),n.add_leave&&e.jsx(Y,{open:n.add_leave,closeModal:()=>u("add_leave"),leavesData:g,setLeavesData:p,currentLeave:null,allUsers:f,departments:N,setTotalRows:v,setLastPage:w,setLeaves:F,employee:i.employee,selectedMonth:i.selectedMonth,addLeaveOptimized:oe,fetchLeavesStats:l}),n.edit_leave&&e.jsx(Y,{open:n.edit_leave,closeModal:()=>u("edit_leave"),leavesData:g,setLeavesData:p,currentLeave:h,allUsers:f,departments:N,setTotalRows:v,setLastPage:w,setLeaves:F,employee:i.employee,selectedMonth:i.selectedMonth,updateLeaveOptimized:ne,fetchLeavesStats:l}),n.delete_leave&&e.jsx(fe,{open:n.delete_leave,closeModal:()=>u("delete_leave"),leaveId:h==null?void 0:h.id,setLeaves:F,setTotalRows:v,setLastPage:w,deleteLeaveOptimized:ie,fetchLeavesStats:l}),n.bulk_leave&&e.jsx(he,{open:n.bulk_leave,onClose:()=>u("bulk_leave"),onSuccess:a=>{l()},allUsers:f,departments:N,leavesData:g,isAdmin:!0}),n.bulk_delete&&e.jsx(be,{open:n.bulk_delete,onClose:()=>u("bulk_delete"),onSuccess:a=>{l()},selectedLeaves:G,allUsers:f}),e.jsx("div",{className:"flex flex-col w-full h-full p-4",role:"main","aria-label":"Leave Management",children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"w-full",children:e.jsx(q.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:e.jsxs(_,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                        var(--theme-content1, #FAFAFA) 20%, 
                                        var(--theme-content2, #F4F4F5) 10%, 
                                        var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(T,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                            color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                            color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${r?"p-4":"p-6"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                            ${r?"p-2":"p-3"} 
                                                            rounded-xl flex items-center justify-center
                                                        `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(Ne,{className:`
                                                                ${r?"w-6 h-6":"w-8 h-8"}
                                                            `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                                ${r?"text-xl":"text-2xl"}
                                                                font-bold text-foreground
                                                                ${r?"truncate":""}
                                                            `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Leave Management"}),e.jsx("p",{className:`
                                                                ${r?"text-xs":"text-sm"} 
                                                                text-default-500
                                                                ${r?"truncate":""}
                                                            `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Manage employee leave requests and approvals"})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[A&&e.jsx(j,{color:"primary",variant:"shadow",startContent:e.jsx(Le,{className:"w-4 h-4"}),onPress:()=>y("add_leave"),size:r?"sm":"md",className:"font-semibold",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Add Leave"}),A&&e.jsx(j,{color:"secondary",variant:"flat",startContent:e.jsx(R,{className:"w-4 h-4"}),onPress:()=>y("bulk_leave"),size:r?"sm":"md",className:"font-semibold",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Bulk Add"}),e.jsx(j,{color:"default",variant:"bordered",startContent:e.jsx(Se,{className:"w-4 h-4"}),size:r?"sm":"md",className:"font-semibold",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Export"})]})]})})})}),e.jsxs(k,{className:"p-6",children:[e.jsx(xe,{stats:U,className:"mb-6"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(O,{label:"Search Employee",placeholder:"Search by name or ID...",value:i.employee,onChange:a=>b("employee",a.target.value),startContent:e.jsx(_e,{className:"w-4 h-4 text-default-400"}),variant:"bordered",size:r?"sm":"md",className:"w-full",style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"flex gap-2 items-end",children:e.jsx(Re,{variant:"bordered",children:e.jsxs(j,{isIconOnly:r,color:L?"primary":"default",onPress:()=>X(!L),style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(ke,{className:"w-4 h-4"}),!r&&e.jsx("span",{className:"ml-1",children:"Filters"})]})})})]}),L&&e.jsx(q.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx("div",{className:"mb-6 p-4 rounded-lg border border-divider",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(W,{label:"Leave Status",placeholder:"Select status...",selectionMode:"multiple",selectedKeys:new Set(i.status),onSelectionChange:a=>b("status",Array.from(a)),variant:"bordered",size:r?"sm":"md",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(d,{value:"pending",children:"Pending"},"pending"),e.jsx(d,{value:"approved",children:"Approved"},"approved"),e.jsx(d,{value:"rejected",children:"Rejected"},"rejected"),e.jsx(d,{value:"new",children:"New"},"new")]}),e.jsxs(W,{label:"Leave Type",placeholder:"Select type...",selectionMode:"multiple",selectedKeys:new Set(i.leaveType),onSelectionChange:a=>b("leaveType",Array.from(a)),variant:"bordered",size:r?"sm":"md",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(d,{value:"sick",children:"Sick Leave"},"sick"),e.jsx(d,{value:"annual",children:"Annual Leave"},"annual"),e.jsx(d,{value:"personal",children:"Personal Leave"},"personal"),e.jsx(d,{value:"maternity",children:"Maternity Leave"},"maternity")]}),e.jsx(O,{label:"Month/Year",type:"month",value:i.selectedMonth,onChange:a=>b("selectedMonth",a.target.value),startContent:e.jsx(R,{className:"w-4 h-4 text-default-400"}),variant:"bordered",size:r?"sm":"md",style:{fontFamily:'var(--fontFamily, "Inter")'}})]})})}),e.jsxs(_,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',background:`linear-gradient(135deg, 
                                                var(--theme-content1, #FAFAFA) 20%, 
                                                var(--theme-content2, #F4F4F5) 10%, 
                                                var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(T,{className:"border-b pb-2",style:{borderColor:"var(--theme-divider, #E4E4E7)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg flex items-center justify-center",style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)"},children:e.jsx(P,{className:"w-6 h-6",style:{color:"var(--theme-primary)"}})}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-semibold text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Leave Records"})]})}),e.jsx(k,{children:K?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx(me,{size:"lg"})}):e.jsx("div",{className:"max-h-[84vh] overflow-y-auto",children:e.jsx(ye,{ref:re,filterData:i,onEditLeave:a=>{M(a),y("edit_leave")},onDeleteLeave:a=>{M(a),y("delete_leave")},onBulkDelete:le,isAdmin:!0,canEdit:te,canDelete:se,canApprove:ae})})})]})]})]})})})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{title:x}),e.jsx("div",{className:"flex flex-col w-full h-full p-4",children:e.jsx(_,{className:"max-w-md mx-auto mt-8",children:e.jsxs(k,{className:"p-8 text-center",children:[e.jsx(we,{className:"w-16 h-16 text-warning mx-auto mb-4"}),e.jsx("h6",{className:"text-lg font-semibold mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-sm text-default-500",children:"You don't have permission to view leave management."})]})})})]})};Me.layout=x=>e.jsx(ue,{children:x});export{Me as default};
