import{J as xe,r as u,j as e,s as ee,d as S,a as L,u as Re,Q as Ee,c as ze,b as Ae}from"./app-CiBPbyAr.js";import{G as Te}from"./GlassCard-guOD2JxI.js";import{P as Me}from"./PageHeader-DEi3tHha.js";import{S as Oe}from"./StatsCards-Be_bKHRI.js";import{B,d as $e,a as Be,b as Le,m as K,v as Q,k as fe,c as ge,e as ve,f as be,g as ye,A as Ye,C as Ve}from"./Dashboard-CPNd3DMY.js";import{d as je}from"./dayjs.min-DXAzwD7E.js";import{N as We,B as ce}from"./NoDataMessage-OIuuBOsq.js";import{F as me}from"./EyeIcon-cTlH-bF4.js";import{F as J}from"./PencilIcon-DiVlBs-U.js";import{F as Y}from"./TrashIcon-R2b5_OJU.js";import{F as Ge}from"./EllipsisVerticalIcon-eYuR9c4V.js";import{F as Ne,a as we}from"./MapPinIcon-8_FEX-4D.js";import{F as X}from"./CheckCircleIcon-7H3XLCQK.js";import{F as Z}from"./XCircleIcon-D14Unmh5.js";import{F as qe}from"./UserIcon-CPOz_d1e.js";import{t as He,a as Ke,b as Ue,c as Qe}from"./chunk-F3UDT23P-wsXFewUK.js";import{t as Je,a as Xe}from"./chunk-YRZGWF2W-rHnz-zkW.js";import{p as _e}from"./chunk-EAPQ7RWQ-jnfi5EPG.js";import{t as U}from"./XMarkIcon-CpdZc9DB.js";import{c as R}from"./chunk-IHOGUXIG-CnmF9_7T.js";import{u as ue}from"./chunk-S574QCAN-DkmCb_hJ.js";import{B as V}from"./react-toastify.esm-D0tNEqm0.js";import{B as Ze}from"./briefcase-DLKOJwyN.js";import{i as $}from"./chunk-SSA7SXE4-BT3sPGwv.js";import{s as W,l as E}from"./chunk-Y2AYO5NJ-CGrWMAj_.js";import{s as ea}from"./chunk-TQNYOUFX-BFR1qItM.js";import{m as Fe}from"./chunk-O5MCAK4F-C4eHveDL.js";import{F as aa}from"./ExclamationTriangleIcon-DC16n5Ju.js";import{F as sa}from"./UserGroupIcon-CT6cdJCC.js";import{F as ta}from"./PlusIcon-iAP9U8Pg.js";import{F as ra}from"./DocumentArrowDownIcon-BERf6rRI.js";import{m as pe}from"./proxy-Cfx62t_1.js";import{F as la}from"./MagnifyingGlassIcon-DlJargRS.js";import{b as na}from"./chunk-57V4RE7B-DaLoPBwd.js";import{F as ia}from"./TableCellsIcon-D_6JKYxH.js";import{F as oa}from"./AdjustmentsHorizontalIcon-D3m_MWhB.js";import"./chunk-D5XJWRAV-CqTUrz2Y.js";import"./chunk-TLYTI3QM-DuiOO4dl.js";import"./EnvelopeIcon-BN6QkLRV.js";import"./ClockIcon-T-_i7KZO.js";import"./ShieldCheckIcon-BkonDmr6.js";import"./KeyIcon-NAPP_wzx.js";import"./index-Do1zAF9P.js";import"./logo-Pwvcz7fP.js";import"./features-animation-BC7Bj3NZ.js";import"./create-visual-element-Cvv_yb_V.js";import"./createLucideIcon-BbKA8-SS.js";import"./chunk-XJ2YRSUP-DgKtO4b4.js";import"./useToggleState-OM9TYNBE.js";const da=({departments:g,onEdit:p,onDelete:D,onView:t,loading:h,isMobile:o,isTablet:v,pagination:N,onPageChange:l,onRowsPerPageChange:b,canEditDepartment:i=!1,canDeleteDepartment:w=!1})=>{var k,z;const{auth:d}=xe().props,_=i||((k=d.permissions)==null?void 0:k.includes("departments.update"))||!1,c=w||((z=d.permissions)==null?void 0:z.includes("departments.delete"))||!1,I=u.useMemo(()=>[{name:"DEPARTMENT",uid:"name"},{name:"CODE",uid:"code",hide:o},{name:"MANAGER",uid:"manager"},{name:"EMPLOYEES",uid:"employees"},{name:"LOCATION",uid:"location",hide:o},{name:"STATUS",uid:"status"},{name:"ESTABLISHED",uid:"established",hide:o||v},{name:"ACTIONS",uid:"actions"}].filter(F=>!F.hide),[o,v]),n=(s,F)=>{var y,r;switch(F){case"name":return e.jsx(ue,{avatarProps:{radius:"lg",fallback:e.jsx(fe,{className:"w-8 h-4"}),size:o?"sm":"md"},name:s.name,description:s.parent?s.parent.name:"Top-level department",classNames:{name:"font-semibold text-foreground text-left",description:"text-default-500 text-left text-xs",wrapper:"justify-start"}});case"code":return e.jsx("div",{children:s.code?e.jsx(R,{size:"sm",variant:"flat",color:"primary",className:"text-xs",children:s.code}):e.jsx("span",{className:"text-default-400 text-xs",children:"-"})});case"manager":return e.jsx("div",{className:"flex items-start ",children:s.manager?e.jsxs(e.Fragment,{children:[e.jsx(ue,{avatarProps:{radius:"lg",src:((y=s.manager)==null?void 0:y.profile_image_url)||((r=s.manager)==null?void 0:r.profile_image),size:"md",fallback:e.jsx(qe,{className:"w-5 h-5"})},classNames:{name:"font-semibold text-foreground text-sm",description:"text-default-500 text-xs"}}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:s.manager.name}),!o&&s.manager.email&&e.jsx("span",{className:"text-xs text-default-400",children:s.manager.email})]})]}):e.jsx("span",{className:"text-default-400 text-xs",children:"Not assigned"})});case"employees":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:s.employee_count||0})]});case"location":return e.jsx("div",{className:"flex items-center gap-2",children:s.location?e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:s.location})]}):e.jsx("span",{className:"text-default-400 text-xs",children:"-"})});case"status":return e.jsx(R,{size:"sm",variant:s.is_active?"solid":"bordered",color:s.is_active?"success":"danger",startContent:s.is_active?e.jsx(X,{className:"w-3 h-3"}):e.jsx(Z,{className:"w-3 h-3"}),children:s.is_active?"Active":"Inactive"});case"established":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{className:"text-sm",children:s.established_date?je(s.established_date).format("MMM D, YYYY"):e.jsx("span",{className:"text-default-400 text-xs",children:"-"})})]});case"actions":return e.jsx("div",{className:"flex justify-end items-center",children:o?e.jsxs($e,{children:[e.jsx(Be,{children:e.jsx(S,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(Ge,{className:"w-4 h-4"})})}),e.jsxs(Le,{"aria-label":"Department actions",children:[e.jsx(K,{startContent:e.jsx(me,{className:"w-4 h-4"}),onPress:()=>t(s),children:"View Details"},"view"),_&&e.jsx(K,{startContent:e.jsx(J,{className:"w-4 h-4"}),onPress:()=>p(s),children:"Edit Department"},"edit"),c&&e.jsx(K,{className:"text-danger",color:"danger",startContent:e.jsx(Y,{className:"w-4 h-4"}),isDisabled:s.employee_count>0,onPress:()=>D(s),children:"Delete Department"},"delete")]})]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{content:"View Department",children:e.jsx(S,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>t(s),children:e.jsx(me,{className:"w-4 h-4"})})}),_&&e.jsx(U,{content:"Edit Department",children:e.jsx(S,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-blue-500",onPress:()=>p(s),children:e.jsx(J,{className:"w-4 h-4"})})}),c&&e.jsx(U,{content:s.employee_count>0?"Cannot delete department with employees":"Delete Department",children:e.jsx(S,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-danger",isDisabled:s.employee_count>0,onPress:()=>D(s),children:e.jsx(Y,{className:"w-4 h-4"})})})]})});default:return e.jsx("span",{children:s[F]})}},A=()=>!g||!g.data||h?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(N.currentPage-1)*N.perPage+1," to ",Math.min(N.currentPage*N.perPage,g.total)," of ",g.total," departments"]}),e.jsx(_e,{total:Math.ceil(g.total/N.perPage),initialPage:N.currentPage,page:N.currentPage,onChange:l,size:o?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]});return!h&&(!g||!g.data||g.data.length===0)?e.jsx("div",{className:"w-full",children:e.jsx(We,{message:"No departments found",icon:e.jsx(B,{className:"w-12 h-12 text-default-300"}),description:"Try adjusting your search or filters"})}):e.jsx("div",{className:"w-full",children:e.jsxs(He,{"aria-label":"Departments table",removeWrapper:!0,classNames:{base:"bg-transparent",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs",td:"border-b border-white/5 py-3"},bottomContent:A(),children:[e.jsx(Je,{columns:I,children:s=>e.jsx(Xe,{children:s.name},s.uid)}),e.jsx(Ke,{items:g.data||[],emptyContent:!h&&"No departments found",loadingContent:e.jsx(ee,{}),isLoading:h,children:s=>e.jsx(Ue,{children:F=>e.jsx(Qe,{children:n(s,F)})},s.id)})]})})},he=({open:g,onClose:p,onSuccess:D,department:t=null,managers:h=[],parentDepartments:o=[]})=>{var n,A,k,z,s,F,y;const[v,N]=u.useState(!1),[l,b]=u.useState({}),i=()=>{var P;if(typeof window>"u")return"lg";const m=((P=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:P.trim())||"12px",x=parseInt(m);return x===0?"none":x<=4?"sm":x<=8?"md":x<=16?"lg":"full"},w={name:"",code:"",description:"",parent_id:"",manager_id:"",location:"",is_active:!0,established_date:""},[d,_]=u.useState(w);u.useEffect(()=>{_(t?{name:t.name||"",code:t.code||"",description:t.description||"",parent_id:t.parent_id||"",manager_id:t.manager_id||"",location:t.location||"",is_active:t.is_active??!0,established_date:t.established_date||""}:w),b({})},[t,g]);const c=(r,m)=>{_(x=>({...x,[r]:m})),l[r]&&b(x=>({...x,[r]:null}))},I=async r=>{r.preventDefault(),N(!0),b({});const m=new Promise(async(x,P)=>{try{const f={...d,parent_id:d.parent_id||null,manager_id:d.manager_id||null,established_date:d.established_date||null};let C;t!=null&&t.id?(C=await L.put(`/departments/${t.id}`,f),x([C.data.message||"Department updated successfully"])):(C=await L.post("/departments",f),x([C.data.message||"Department created successfully"])),D(C.data.department),p()}catch(f){if(console.error("Full error object:",f),f.response)if(f.response.status===422){b(f.response.data.errors||{});const C=Object.values(f.response.data.errors||{}).flat();P(C.length>0?C.join(", "):"Validation failed")}else P(`HTTP Error ${f.response.status}: ${f.response.data.message||"An unexpected error occurred"}`);else f.request?P("No response received from the server. Please check your internet connection."):P("An error occurred while setting up the request.")}finally{N(!1)}});V.promise(m,{pending:{render(){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(ee,{size:"sm"}),e.jsx("span",{children:"Saving department..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},success:{render({data:x}){return e.jsx(e.Fragment,{children:x.map((P,f)=>e.jsx("div",{children:P},f))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},error:{render({data:x}){return e.jsx(e.Fragment,{children:x})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}}})};return e.jsx(ge,{isOpen:g,onOpenChange:v?void 0:p,size:"2xl",radius:i(),scrollBehavior:"inside",classNames:{base:"bg-content1",backdrop:"bg-black/50 backdrop-blur-sm"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(ve,{children:[e.jsxs(be,{className:"flex gap-3 items-center",style:{fontFamily:'var(--fontFamily, "Inter")',borderBottom:"1px solid var(--theme-divider)"},children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-primary) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(ce,{size:20,style:{color:"var(--theme-primary)"}})}),e.jsx("span",{className:"text-lg font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:t?"Edit Department":"Create New Department"})]}),e.jsxs("form",{onSubmit:I,children:[e.jsx(ye,{className:"py-4 px-4 sm:py-6 sm:px-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx($,{label:"Department Name",placeholder:"Enter department name",value:d.name,onChange:r=>c("name",r.target.value),isInvalid:!!l.name,errorMessage:(n=l.name)==null?void 0:n[0],isRequired:!0,variant:"bordered",size:"sm",radius:i(),startContent:e.jsx(ce,{size:16,className:"text-default-400"}),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx($,{label:"Department Code",placeholder:"e.g., HR001, FIN002",value:d.code,onChange:r=>c("code",r.target.value),isInvalid:!!l.code,errorMessage:(A=l.code)==null?void 0:A[0],variant:"bordered",size:"sm",radius:i(),description:"Unique identifier",classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"col-span-2",children:e.jsx($,{label:"Description",placeholder:"Enter department description",value:d.description,onChange:r=>c("description",r.target.value),isInvalid:!!l.description,errorMessage:(k=l.description)==null?void 0:k[0],variant:"bordered",size:"sm",radius:i(),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx(W,{label:"Parent Department (Optional)",placeholder:"Select parent department",selectedKeys:d.parent_id?new Set([String(d.parent_id)]):new Set,onSelectionChange:r=>{const m=Array.from(r)[0];c("parent_id",m||"")},isInvalid:!!l.parent_id,errorMessage:(z=l.parent_id)==null?void 0:z[0],variant:"bordered",size:"sm",radius:i(),description:"None = Top-Level Department",classNames:{trigger:"min-h-unit-10",value:"text-small"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:o==null?void 0:o.filter(r=>(t==null?void 0:t.id)!==r.id).map(r=>e.jsx(E,{value:r.id,children:r.name},String(r.id)))})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx(W,{label:"Department Manager (Optional)",placeholder:"Select manager",selectedKeys:d.manager_id?new Set([String(d.manager_id)]):new Set,onSelectionChange:r=>{const m=Array.from(r)[0];c("manager_id",m||"")},isInvalid:!!l.manager_id,errorMessage:(s=l.manager_id)==null?void 0:s[0],variant:"bordered",size:"sm",radius:i(),startContent:e.jsx(Ze,{size:16,className:"text-default-400"}),classNames:{trigger:"min-h-unit-10",value:"text-small"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:h==null?void 0:h.map(r=>e.jsx(E,{value:r.id,children:r.name},String(r.id)))})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx($,{label:"Location",placeholder:"Physical location",value:d.location,onChange:r=>c("location",r.target.value),isInvalid:!!l.location,errorMessage:(F=l.location)==null?void 0:F[0],variant:"bordered",size:"sm",radius:i(),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx($,{type:"date",label:"Established Date",value:d.established_date,onChange:r=>c("established_date",r.target.value),isInvalid:!!l.established_date,errorMessage:(y=l.established_date)==null?void 0:y[0],variant:"bordered",size:"sm",radius:i(),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:"color-mix(in srgb, var(--theme-content2) 30%, transparent)"},children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Active Status"}),e.jsx("p",{className:"text-xs text-default-500 mt-1",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Active departments can be assigned to employees"})]}),e.jsx(ea,{isSelected:d.is_active,onValueChange:r=>c("is_active",r),size:"sm",classNames:{wrapper:"group-data-[selected=true]:bg-success"},style:{fontFamily:'var(--fontFamily, "Inter")'}})]}),l.is_active&&e.jsx("p",{className:"text-xs text-danger mt-1",children:l.is_active[0]})]})]})}),e.jsxs(Fe,{style:{borderTop:"1px solid var(--theme-divider)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(S,{onPress:p,isDisabled:v,variant:"light",radius:i(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(S,{type:"submit",color:"primary",isLoading:v,radius:i(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:t?"Update Department":"Create Department"})]})]})]})})},ca=({open:g,onClose:p,onSuccess:D,department:t})=>{const[h,o]=u.useState(!1),v=()=>{var w;if(typeof window>"u")return"lg";const b=((w=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:w.trim())||"12px",i=parseInt(b);return i===0?"none":i<=4?"sm":i<=8?"md":i<=16?"lg":"full"},N=async()=>{if(!t){V.error("Invalid department provided");return}o(!0);const l=new Promise(async(b,i)=>{var w,d,_,c,I;try{const n=await L.delete(`/departments/${t.id}`);n.status===200&&(D&&D(t,"delete"),b(n.data.message||"Department deleted successfully"))}catch(n){console.error("Error deleting department:",n),((w=n.response)==null?void 0:w.status)===422?i(((_=(d=n.response)==null?void 0:d.data)==null?void 0:_.message)||"Cannot delete department with active employees"):((c=n.response)==null?void 0:c.status)===404?i("Department not found or already deleted"):((I=n.response)==null?void 0:I.status)===403?i("You do not have permission to delete this department"):i("An error occurred while deleting the department")}finally{o(!1)}});V.promise(l,{pending:{render(){return"Deleting department..."},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},success:{render({data:b}){return p(),b},icon:"âœ…",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},error:{render({data:b}){return b},icon:"âŒ",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}}})};return t?e.jsx(ge,{isOpen:g,onOpenChange:h?void 0:p,size:"lg",radius:v(),classNames:{base:"bg-content1",backdrop:"bg-black/50 backdrop-blur-sm"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(ve,{children:[e.jsxs(be,{className:"flex gap-3 items-center",style:{fontFamily:'var(--fontFamily, "Inter")',borderBottom:"1px solid var(--theme-divider)"},children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-danger) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(Y,{className:"w-5 h-5",style:{color:"var(--theme-danger)"}})}),e.jsx("span",{className:"text-lg font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Delete Department"})]}),e.jsx(ye,{className:"py-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-warning) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-warning) 30%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:[e.jsx(aa,{className:"w-6 h-6 flex-shrink-0",style:{color:"var(--theme-warning)"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Are you sure you want to delete this department?"}),e.jsx("p",{className:"text-sm font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")',color:"var(--theme-primary)"},children:t.name})]})]}),t.employee_count>0&&e.jsx("div",{className:"p-4 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-danger) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-danger) 30%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsxs("p",{className:"text-sm",style:{fontFamily:'var(--fontFamily, "Inter")',color:"var(--theme-danger)"},children:["This department has ",e.jsx("strong",{children:t.employee_count})," employees assigned to it. You cannot delete a department with active employees. Please reassign these employees to other departments first."]})}),e.jsx("p",{className:"text-sm text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"This action cannot be undone. All associated data will be permanently removed."})]})}),e.jsxs(Fe,{style:{borderTop:"1px solid var(--theme-divider)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(S,{onPress:p,isDisabled:h,variant:"light",radius:v(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(S,{onPress:N,color:"danger",isDisabled:h||t.employee_count>0,isLoading:h,radius:v(),startContent:!h&&e.jsx(Y,{className:"w-4 h-4"}),style:{fontFamily:'var(--fontFamily, "Inter")'},children:h?"Deleting...":"Delete Department"})]})]})}):null},ns=({title:g,departments:p,managers:D,parentDepartments:t,stats:h,filters:o})=>{var te,re,le,ne,ie,oe;const{auth:v}=xe().props,{theme:N}=Re(),[l]=u.useState(window.innerWidth<640),[b]=u.useState(window.innerWidth<768),[i,w]=u.useState(p||{data:[]}),[d,_]=u.useState(!1),[c,I]=u.useState({type:null,department:null}),[n,A]=u.useState({search:(o==null?void 0:o.search)||"",status:(o==null?void 0:o.status)||"all",parentDepartment:(o==null?void 0:o.parentDepartment)||"all"}),[k,z]=u.useState(!1),[s,F]=u.useState("table"),[y,r]=u.useState({currentPage:(p==null?void 0:p.current_page)||1,perPage:(p==null?void 0:p.per_page)||10}),[m,x]=u.useState(h||{total:0,active:0,inactive:0,parent_departments:0}),P=((te=v.permissions)==null?void 0:te.includes("departments.create"))||!1,f=((re=v.permissions)==null?void 0:re.includes("departments.update"))||!1,C=((le=v.permissions)==null?void 0:le.includes("departments.delete"))||!1,Pe=f||((ne=v.permissions)==null?void 0:ne.includes("departments.update"))||!1;C||(ie=v.permissions)!=null&&ie.includes("departments.delete");const G=u.useCallback(async()=>{_(!0);try{const a=await L.get(route("api.departments"),{params:{page:y.currentPage,per_page:y.perPage,search:n.search,status:n.status,parent_department:n.parentDepartment}});w(a.data.departments)}catch(a){console.error("Error fetching departments:",a),V.error("Failed to load departments data")}finally{_(!1)}},[y.currentPage,y.perPage,n.search,n.status,n.parentDepartment]),q=u.useCallback(async()=>{try{const a=await L.get(route("departments.stats"));if(a.status===200){const{stats:j}=a.data;x(j)}}catch(a){console.error("Error fetching department stats:",a)}},[]);u.useEffect(()=>{G(),q()},[G,q]);const T=(a,j)=>{A(O=>({...O,[a]:j})),r(O=>({...O,currentPage:1}))},ae=a=>{r(j=>({...j,currentPage:a})),window.scrollTo({top:0,behavior:"smooth"})},Ce=a=>{r({currentPage:1,perPage:a})},M=(a,j=null)=>{I({type:a,department:j})},H=()=>{I({type:null,department:null})},se=()=>{G(),q()},Se=({department:a,index:j})=>{const O=a.manager,de=a.parent;return e.jsx(ze,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 transition-all duration-200 cursor-pointer h-full",onPress:()=>M("view_department",a),children:e.jsxs(Ae,{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3 pb-3 border-b border-white/10",children:[e.jsx("div",{className:"flex justify-center items-center h-10 w-10 rounded-lg bg-primary/20 text-primary shrink-0",children:e.jsx(fe,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground text-sm line-clamp-1",children:a.name}),e.jsx("p",{className:"text-default-500 text-xs",children:a.code||"No Code"})]}),Pe&&e.jsx(S,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground ml-2",onPress:ke=>{ke.stopPropagation(),M("edit_department",a)},children:e.jsx(J,{className:"w-4 h-4"})})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[a.location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(we,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs line-clamp-1",children:a.location})]}),a.established_date&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ne,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs",children:je(a.established_date).format("MMM D, YYYY")})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Q,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsxs("span",{className:"text-default-600 text-xs",children:[a.employee_count||0," ",a.employee_count===1?"Employee":"Employees"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10 flex flex-wrap gap-2",children:[e.jsx(R,{size:"sm",variant:a.is_active?"solid":"bordered",color:a.is_active?"success":"danger",className:"text-xs",startContent:a.is_active?e.jsx(X,{className:"w-3 h-3"}):e.jsx(Z,{className:"w-3 h-3"}),children:a.is_active?"Active":"Inactive"}),de&&e.jsx(R,{size:"sm",variant:"flat",color:"primary",className:"text-xs",startContent:e.jsx(B,{className:"w-3 h-3"}),children:de.name}),O&&e.jsx(R,{size:"sm",variant:"flat",color:"secondary",className:"text-xs",startContent:e.jsx(Q,{className:"w-3 h-3"}),children:O.name})]})]})})},De=u.useMemo(()=>[{title:"Total Departments",value:(m==null?void 0:m.total)||0,icon:e.jsx(B,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All departments"},{title:"Active",value:(m==null?void 0:m.active)||0,icon:e.jsx(X,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Active departments"},{title:"Inactive",value:(m==null?void 0:m.inactive)||0,icon:e.jsx(Z,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Inactive departments"},{title:"Parent Departments",value:(m==null?void 0:m.parent_departments)||0,icon:e.jsx(sa,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Top-level departments"}],[m]),Ie=u.useMemo(()=>{const a=[];return P&&a.push({label:l?"Add":"Add Department",icon:e.jsx(ta,{className:"w-4 h-4"}),onPress:()=>M("add_department"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),a.push({label:l?"":"Export",isIconOnly:l,icon:e.jsx(ra,{className:"w-4 h-4"}),variant:"bordered",className:"border-[rgba(var(--theme-primary-rgb),0.3)] bg-[rgba(var(--theme-primary-rgb),0.05)] hover:bg-[rgba(var(--theme-primary-rgb),0.1)]"}),a},[P,l]);return e.jsxs(Ye,{children:[e.jsx(Ee,{title:g}),e.jsx("div",{className:"flex justify-center p-2",children:e.jsx(pe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:e.jsx(Te,{children:e.jsx(Me,{title:"Department Management",subtitle:"Manage company departments, hierarchies, and organizational structure",icon:e.jsx(B,{className:"w-8 h-8"}),variant:"default",actionButtons:Ie,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(Oe,{stats:De,className:"mb-6"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx($,{label:"Search Departments",placeholder:"Search by name, code, or location...",value:n.search,onChange:a=>T("search",a.target.value),startContent:e.jsx(la,{className:"w-4 h-4 text-default-400"})})}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs(na,{variant:"bordered",className:"bg-white/5",children:[e.jsxs(S,{isIconOnly:l,color:s==="table"?"primary":"default",onPress:()=>F("table"),className:s==="table"?"bg-blue-500/20":"",children:[e.jsx(ia,{className:"w-4 h-4"}),!l&&e.jsx("span",{className:"ml-1",children:"Table"})]}),e.jsxs(S,{isIconOnly:l,color:s==="grid"?"primary":"default",onPress:()=>F("grid"),className:s==="grid"?"bg-blue-500/20":"",children:[e.jsx(Ve,{className:"w-4 h-4"}),!l&&e.jsx("span",{className:"ml-1",children:"Grid"})]})]}),e.jsxs(S,{isIconOnly:l,variant:"bordered",onPress:()=>z(!k),className:k?"bg-purple-500/20":"bg-white/5",children:[e.jsx(oa,{className:"w-4 h-4"}),!l&&e.jsx("span",{className:"ml-1",children:"Filters"})]})]})]}),k&&e.jsxs(pe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"mb-6 p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(W,{label:"Status",variant:"bordered",selectedKeys:n.status!=="all"?[n.status]:[],onSelectionChange:a=>{const j=Array.from(a)[0]||"all";T("status",j)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e.jsx(E,{value:"all",children:"All Statuses"},"all"),e.jsx(E,{value:"active",children:"Active Only"},"active"),e.jsx(E,{value:"inactive",children:"Inactive Only"},"inactive")]}),e.jsxs(W,{label:"Parent Department",variant:"bordered",selectedKeys:n.parentDepartment!=="all"?[n.parentDepartment]:[],onSelectionChange:a=>{const j=Array.from(a)[0]||"all";T("parentDepartment",j)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e.jsx(E,{value:"all",children:"All Parent Departments"},"all"),e.jsx(E,{value:"none",children:"Top-Level Departments"},"none"),t==null?void 0:t.map(a=>e.jsx(E,{value:a.id.toString(),children:a.name},a.id.toString()))]})]}),(n.search||n.status!=="all"||n.parentDepartment!=="all")&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-white/10",children:[n.search&&e.jsxs(R,{variant:"flat",color:"primary",size:"sm",onClose:()=>T("search",""),children:["Search: ",n.search]}),n.status!=="all"&&e.jsxs(R,{variant:"flat",color:"secondary",size:"sm",onClose:()=>T("status","all"),children:["Status: ",n.status==="active"?"Active":"Inactive"]}),n.parentDepartment!=="all"&&e.jsxs(R,{variant:"flat",color:"warning",size:"sm",onClose:()=>T("parentDepartment","all"),children:["Parent: ",n.parentDepartment==="none"?"None (Top-Level)":(oe=t==null?void 0:t.find(a=>a.id===parseInt(n.parentDepartment)))==null?void 0:oe.name]})]})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:[s==="table"?"Department Table":"Department Grid",e.jsxs("span",{className:"text-sm text-default-500 ml-2",children:["(",i.total||0," ",i.total===1?"department":"departments",")"]})]})}),d?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{size:"lg"}),e.jsx("p",{className:"mt-4 text-default-500",children:"Loading departments data..."})]}):s==="table"?e.jsx(da,{departments:i,loading:d,onEdit:f?a=>M("edit_department",a):void 0,onDelete:C?a=>M("delete_department",a):void 0,onView:a=>M("view_department",a),isMobile:l,isTablet:b,pagination:y,onPageChange:ae,onRowsPerPageChange:Ce,canEditDepartment:f,canDeleteDepartment:C}):e.jsxs("div",{className:"p-4",children:[i.data&&i.data.length>0?e.jsx("div",{className:`grid gap-4 ${l?"grid-cols-1":b?"grid-cols-2":"grid-cols-3 xl:grid-cols-4"}`,children:i.data.map((a,j)=>e.jsx(Se,{department:a,index:j},a.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(B,{className:"w-12 h-12 mx-auto text-default-300 mb-2"}),e.jsx("p",{className:"text-default-500 mb-1",children:"No departments found"}),e.jsx("p",{className:"text-xs text-default-400",children:"Try adjusting your search or filters"})]}),i.data&&i.data.length>0&&e.jsx("div",{className:"flex justify-center mt-6 border-t border-white/10 pt-4",children:e.jsx(_e,{total:Math.ceil(i.total/y.perPage),initialPage:y.currentPage,page:y.currentPage,onChange:ae,size:l?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})})]})]})]})})})})}),(c.type==="add_department"||c.type==="edit_department")&&e.jsx(he,{open:!0,onClose:H,onSuccess:se,department:c.type==="edit_department"?c.department:null,managers:D,parentDepartments:t}),c.type==="delete_department"&&e.jsx(ca,{open:!0,onClose:H,onSuccess:se,department:c.department}),c.type==="view_department"&&e.jsx(he,{open:!0,onClose:H,onSuccess:()=>{},department:c.department,managers:D,parentDepartments:t,readOnly:!0})]})};export{ns as default};
