import{r as i,j as e,s as pe,d as U,t as gt,F as te,a as le,Q as Dt,c as W,b as M,S as bt}from"./app-DVUFbdfp.js";import{y as ye,e as ne,c as Lt,C as je,D as Ne,E as we,H as D,G as At,x as zt,s as ae,w as ue,f as Wt,l as ie,I as Mt,A as Bt}from"./Dashboard-BngDYBN9.js";import{S as Ot}from"./StatsCards-CNQ0jS7F.js";import{c as B,t as Fe,F as wt,B as y,b as Ft}from"./react-toastify.esm-BGNsfwtG.js";import{F as Gt}from"./HashtagIcon-D9MvqwT6.js";import{F as fe}from"./UserIcon-B7QEUQkX.js";import{F as _e}from"./EnvelopeIcon-DrccQfO7.js";import{F as oe,a as _t}from"./DeviceTabletIcon-4xW690BB.js";import{F as Ct}from"./CheckCircleIcon-Bj79FXld.js";import{F as de}from"./ShieldCheckIcon-x97l6B3f.js";import{F as Ce}from"./EllipsisVerticalIcon-0rZudGtj.js";import{F as It}from"./PencilIcon-Cij0zfs3.js";import{F as ve}from"./LockClosedIcon-BmvDOtul.js";import{t as Vt,a as Ht,b as qt,c as Kt}from"./chunk-F3UDT23P-CcAwGHkZ.js";import{t as Zt,a as Jt}from"./chunk-YRZGWF2W-CblOCDPo.js";import{p as Rt}from"./chunk-EAPQ7RWQ-BtA6Z7p2.js";import{u as kt}from"./chunk-S574QCAN-CrDoWXbj.js";import{F as Qt}from"./XCircleIcon-Bsndss8i.js";import{F as Xt}from"./TrophyIcon-DEPMLjkG.js";import{F as be}from"./UserPlusIcon-Dih6bhUJ.js";import{F as yt}from"./ChartBarIcon-KUdYoSFg.js";import{m as Yt}from"./proxy-2H637bms.js";import{F as ea}from"./DocumentArrowDownIcon-C6RBGBCt.js";import{F as ta}from"./ChartPieIcon-sIEzhcm8.js";import{F as aa}from"./TableCellsIcon-uMD5dkTn.js";import{c as sa}from"./chunk-D5XJWRAV-Bt5mjX15.js";import{s as k}from"./chunk-TLYTI3QM-CKheJf8I.js";import{i as ra}from"./chunk-SSA7SXE4-C3usqADV.js";import{b as la}from"./chunk-57V4RE7B-CFCcp5VC.js";import{s as ia}from"./chunk-TQNYOUFX-CnOioCq6.js";import"./KeyIcon-BcAqv8Tc.js";import"./logo-Pwvcz7fP.js";import"./ExclamationTriangleIcon-Dyxee4xP.js";import"./features-animation-DC0z2bL1.js";import"./create-visual-element-BM9TDDmP.js";import"./chunk-XJ2YRSUP-BK_h7l5x.js";import"./useToggleState-DCj_HjaE.js";function na({title:r,titleId:F,...m},_){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:_,"aria-labelledby":F},m),r?i.createElement("title",{id:F},r):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 10.5V6.75a4.5 4.5 0 1 1 9 0v3.75M3.75 21.75h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H3.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"}))}const ge=i.forwardRef(na);function oa({title:r,titleId:F,...m},_){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:_,"aria-labelledby":F},m),r?i.createElement("title",{id:F},r):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.348 14.652a3.75 3.75 0 0 1 0-5.304m5.304 0a3.75 3.75 0 0 1 0 5.304m-7.425 2.121a6.75 6.75 0 0 1 0-9.546m9.546 0a6.75 6.75 0 0 1 0 9.546M5.106 18.894c-3.808-3.807-3.808-9.98 0-13.788m13.788 0c3.808 3.807 3.808 9.98 0 13.788M12 12h.008v.008H12V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const jt=i.forwardRef(oa),J=()=>"var(--borderRadius, 12px)",da=({allUsers:r,roles:F,isMobile:m,isTablet:_,setUsers:L,pagination:v,onPageChange:I,onRowsPerPageChange:P,totalUsers:C=0,onEdit:Q,loading:x=!1,updateUserOptimized:R,deleteUserOptimized:d,toggleUserStatusOptimized:O,updateUserRolesOptimized:q,toggleSingleDeviceLogin:T,resetUserDevice:G,deviceActions:A={}})=>{const[X,V]=i.useState({}),S=(t,n="w-5 h-5")=>{const c=(t==null?void 0:t.toLowerCase())||"";return c.includes("mobile")||c.includes("android")||c.includes("iphone")?e.jsx(oe,{className:`${n} text-primary`}):c.includes("tablet")||c.includes("ipad")?e.jsx(_t,{className:`${n} text-secondary`}):e.jsx(Ft,{className:`${n} text-default-500`})},Y=t=>{const n=(t==null?void 0:t.toLowerCase())||"";return n.includes("mobile")||n.includes("android")||n.includes("iphone")?"Mobile Device":n.includes("tablet")||n.includes("ipad")?"Tablet":"Desktop"},h=(t,n,c)=>{V(s=>({...s,[`${t}-${n}`]:c}))},j=(t,n)=>X[`${t}-${n}`]||!1;async function se(t,n){h(t,"role",!0);const c=new Promise(async(s,E)=>{var p;try{const f=await axios.post(route("user.updateRole",{id:t}),{roles:n});f.status===200&&(q&&q(t,n),s([f.data.message||"Role updated successfully"]))}catch(f){((p=f.response)==null?void 0:p.status)===422?E(f.response.data.errors||["Failed to update user role."]):E(["An unexpected error occurred. Please try again later."])}finally{h(t,"role",!1)}});return y.promise(c,{pending:"Updating employee role...",success:{render({data:s}){return s.join(", ")}},error:{render({data:s}){return Array.isArray(s)?s.join(", "):s}}}),c}const ce=i.useMemo(()=>{const t=[{name:"#",uid:"sl"},{name:"USER",uid:"user"},{name:"EMAIL",uid:"email"},{name:"DEPARTMENT",uid:"department"},{name:"DEVICE STATUS",uid:"device_status"},{name:"STATUS",uid:"status"},{name:"ROLES",uid:"roles"},{name:"ACTIONS",uid:"actions"}];if(!m&&!_)t.splice(3,0,{name:"PHONE",uid:"phone"});else if(m)t.splice(t.findIndex(n=>n.uid==="department"),1),t.splice(t.findIndex(n=>n.uid==="device_status"),1);else if(_){const n=t.findIndex(c=>c.uid==="device_status");if(n>-1){const c=t.splice(n,1)[0];t.splice(2,0,c)}}return t},[m,_]),K=async(t,n)=>{if(!j(t,"status")){h(t,"status",!0);try{O?(O(t,!n),y.success(`User status ${n?"deactivated":"activated"} successfully`)):L&&(L(c=>c.map(s=>s.id===t?{...s,active:!n}:s)),y.success(`User status ${n?"deactivated":"activated"} successfully`))}catch(c){console.error("Error toggling user status:",c),y.error("Failed to update user status")}finally{h(t,"status",!1)}}},g=(t,n,c)=>{var E;const s=t[n];switch(n){case"sl":const Z=(v!=null&&v.currentPage&&(v!=null&&v.perPage)?Number((v.currentPage-1)*v.perPage):0)+(typeof c=="number"?c:0)+1;return e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"flex items-center justify-center w-8 h-8 border shadow-sm",style:{background:"var(--theme-content2, #F4F4F5)",borderColor:"var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 8px)",color:"var(--theme-foreground, #000000)"},children:e.jsx("span",{className:"text-sm font-bold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:Z})})});case"user":return e.jsx(kt,{className:"w-fit max-w-full",avatarProps:{radius:J(),size:"sm",src:(t==null?void 0:t.profile_image_url)||(t==null?void 0:t.profile_image),showFallback:!0,name:(t==null?void 0:t.name)||"Unnamed User",isBordered:!0,style:{borderColor:"var(--theme-primary, #3B82F6)",borderWidth:"2px"}},name:e.jsx("span",{className:"text-sm font-semibold whitespace-nowrap text-default-900",style:{fontFamily:'var(--fontFamily, "Inter")'},children:(t==null?void 0:t.name)||"Unnamed User"}),description:e.jsxs("span",{className:"text-xs text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:["ID: ",t==null?void 0:t.id]})});case"email":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-md",style:{background:"var(--theme-content2, #F4F4F5)",color:"var(--theme-default-500, #6B7280)"},children:e.jsx(_e,{className:"w-3.5 h-3.5"})}),e.jsx("span",{className:"text-sm font-medium text-default-900",style:{fontFamily:'var(--fontFamily, "Inter")'},children:t.email})]});case"phone":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-md",style:{background:"var(--theme-content2, #F4F4F5)",color:"var(--theme-default-500, #6B7280)"},children:e.jsx(ye,{className:"w-3.5 h-3.5"})}),e.jsx("span",{className:"text-sm font-medium text-default-900",style:{fontFamily:'var(--fontFamily, "Inter")'},children:t.phone||"N/A"})]});case"department":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-md",style:{background:"var(--theme-content2, #F4F4F5)",color:"var(--theme-default-500, #6B7280)"},children:e.jsx(ne,{className:"w-3.5 h-3.5"})}),e.jsx("span",{className:"text-sm font-medium text-default-900",style:{fontFamily:'var(--fontFamily, "Inter")'},children:(t==null?void 0:t.department)||"N/A"})]});case"device_status":const z=j(t.id,"deviceToggle");return e.jsx("div",{className:"flex items-center space-x-2",children:t.single_device_login?e.jsxs(e.Fragment,{children:[e.jsx(B,{size:"sm",variant:"flat",color:t.active_device?"warning":"success",startContent:z?e.jsx("div",{className:"animate-spin",children:e.jsx(te,{className:"w-3 h-3"})}):t.active_device?e.jsx(ve,{className:"w-3 h-3"}):e.jsx(ge,{className:"w-3 h-3"}),children:z?"Loading...":t.active_device?"Locked":"Free"}),t.active_device&&!z&&e.jsx(Fe,{content:e.jsxs("div",{className:"backdrop-blur-md border rounded-lg p-4 shadow-2xl max-w-sm",style:{background:"color-mix(in srgb, var(--theme-content1) 20%, transparent)",borderColor:"var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[S(t.active_device.user_agent,"w-5 h-5"),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-foreground text-sm",style:{fontFamily:'var(--fontFamily, "Inter")'},children:t.active_device.device_name||"Unknown Device"}),e.jsx("div",{className:"text-xs text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:Y(t.active_device.user_agent)})]})]}),e.jsx("div",{className:"space-y-2 text-xs",children:e.jsx("div",{className:"pt-2 mt-2 border-t",style:{borderColor:"color-mix(in srgb, var(--theme-divider) 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(wt,{className:"w-3 h-3 text-success"}),e.jsx("span",{className:"text-success text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:t.active_device.is_active?"Currently Active":"Inactive"})]})})})]}),placement:"top",classNames:{content:"p-0 bg-transparent shadow-none border-none"},children:e.jsx("div",{className:"flex items-center p-1 rounded-sm hover:bg-content1/10 transition-colors cursor-default",children:S(t.active_device.user_agent,"w-4 h-4")})})]}):e.jsx(B,{size:"sm",variant:"flat",color:"default",startContent:z?e.jsx("div",{className:"animate-spin",children:e.jsx(te,{className:"w-3 h-3"})}):e.jsx(de,{className:"w-3 h-3"}),children:z?"Loading...":"Disabled"})});case"status":return e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:t.active,onChange:()=>K(t.id,t.active),disabled:j(t.id,"status")}),e.jsx("div",{className:"w-11 h-6 peer-focus:outline-hidden peer-focus:ring-4 peer-focus:ring-opacity-30 rounded-full peer transition-all duration-300 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all",style:{backgroundColor:t.active?"var(--theme-success, #10B981)":"var(--theme-danger, #EF4444)"}}),j(t.id,"status")&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(pe,{size:"sm",color:"default"})})]}),e.jsx("span",{className:"text-xs font-medium",style:{color:t.active?"var(--theme-success, #10B981)":"var(--theme-danger, #EF4444)",fontFamily:'var(--fontFamily, "Inter")'},children:t.active?"Active":"Inactive"})]});case"roles":const me=((E=t.roles)==null?void 0:E.map(b=>typeof b=="object"&&b!==null?b.name:b))||[],xe=new Set(me),H=Array.from(xe).join(", ")||"No Roles";return e.jsx("div",{className:"flex items-center",children:e.jsxs(je,{isDisabled:j(t.id,"role"),className:"max-w-[220px]",children:[e.jsx(Ne,{children:e.jsx(U,{className:"capitalize",variant:"solid",size:"sm",radius:J(),startContent:j(t.id,"role")?e.jsx(pe,{size:"sm"}):null,style:{background:"var(--theme-primary, #3B82F6)",color:"white",fontFamily:'var(--fontFamily, "Inter")',borderRadius:J()},children:H})}),e.jsx(we,{disallowEmptySelection:!1,"aria-label":"Role selection",closeOnSelect:!1,selectedKeys:xe,selectionMode:"multiple",variant:"flat",onSelectionChange:b=>{const re=Array.from(b);se(t.id,re)},children:(F||[]).map(b=>e.jsx(D,{children:typeof b=="object"&&b!==null?b.name:b},typeof b=="object"&&b!==null?b.name:b))})]})});case"actions":return e.jsx("div",{className:"flex justify-center items-center",children:e.jsxs(je,{children:[e.jsx(Ne,{children:e.jsx(U,{isIconOnly:!0,size:"sm",variant:"solid",radius:J(),style:{background:"var(--theme-content2, #F4F4F5)",color:"var(--theme-default-500, #6B7280)",fontFamily:'var(--fontFamily, "Inter")',borderRadius:J()},className:"hover:opacity-80 transition-opacity",children:e.jsx(Ce,{className:"w-4 h-4"})})}),e.jsxs(we,{style:{background:"var(--theme-content1, #FFFFFF)",border:"1px solid var(--theme-divider, #E5E7EB)",borderRadius:J()},children:[e.jsx(D,{textValue:"View Profile",href:route("profile",{user:t.id}),as:gt,className:"text-blue-500",startContent:e.jsx(fe,{className:"w-4 h-4"}),children:"View Profile"}),e.jsx(D,{textValue:"Edit User",onPress:()=>{Q&&Q(t)},className:"text-amber-500",startContent:e.jsx(It,{className:"w-4 h-4"}),children:"Edit"}),e.jsx(D,{textValue:"Device Toggle",onPress:()=>{T&&!j(t.id,"deviceToggle")&&(h(t.id,"deviceToggle",!0),T(t.id,!t.single_device_login).finally(()=>{h(t.id,"deviceToggle",!1)}))},isDisabled:A[t.id]||j(t.id,"deviceToggle"),startContent:j(t.id,"deviceToggle")?e.jsx("div",{className:"animate-spin",children:e.jsx(te,{className:"w-4 h-4"})}):t.single_device_login?e.jsx(ge,{className:"w-4 h-4"}):e.jsx(ve,{className:"w-4 h-4"}),className:t.single_device_login?"text-orange-500":"text-green-500",children:j(t.id,"deviceToggle")?"Processing...":t.single_device_login?"Disable Device Lock":"Enable Device Lock"}),t.single_device_login&&t.active_device&&e.jsx(D,{textValue:"Reset Device",onPress:()=>{G&&!j(t.id,"deviceReset")&&(h(t.id,"deviceReset",!0),G(t.id).finally(()=>{h(t.id,"deviceReset",!1)}))},isDisabled:A[t.id]||j(t.id,"deviceReset"),startContent:j(t.id,"deviceReset")?e.jsx("div",{className:"animate-spin",children:e.jsx(te,{className:"w-4 h-4"})}):e.jsx(te,{className:"w-4 h-4"}),className:"text-red-500",children:j(t.id,"deviceReset")?"Resetting...":"Reset Device"}),e.jsx(D,{textValue:"View Devices",href:route("admin.users.devices",{userId:t.id}),as:gt,startContent:e.jsx(oe,{className:"w-4 h-4"}),className:"text-blue-500",children:"View Device History"})]})]})});default:return s}},N=()=>!r||!C||x?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-6 py-4 border-t",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:"var(--theme-content2, #F4F4F5)",borderRadius:"0 0 var(--borderRadius, 12px) var(--borderRadius, 12px)"},children:[e.jsxs("span",{className:"text-sm text-default-600 mb-3 sm:mb-0 font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Showing"," ",e.jsx("span",{className:"font-semibold text-default-900",children:(v.currentPage-1)*v.perPage+1})," ","to"," ",e.jsx("span",{className:"font-semibold text-default-900",children:Math.min(v.currentPage*v.perPage,C)})," ","of"," ",e.jsx("span",{className:"font-semibold text-default-900",children:C})," ","users"]}),e.jsx(Rt,{total:Math.ceil(C/v.perPage),initialPage:v.currentPage,page:v.currentPage,onChange:I,size:m?"sm":"md",variant:"flat",showControls:!0,radius:J(),style:{fontFamily:'var(--fontFamily, "Inter")'},classNames:{wrapper:"gap-1",item:"bg-default-100 hover:bg-default-200 text-default-700 font-medium border border-default-200",cursor:"bg-primary text-primary-foreground font-semibold shadow-md",prev:"bg-default-100 hover:bg-default-200 text-default-700 border border-default-200",next:"bg-default-100 hover:bg-default-200 text-default-700 border border-default-200"}})]});return e.jsxs("div",{className:"w-full flex flex-col border rounded-lg shadow-lg",style:{maxHeight:"calc(100vh - 240px)",borderColor:"var(--theme-divider, #E4E4E7)",background:"var(--theme-content1, #FFFFFF)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx("div",{className:"flex-1 overflow-auto",style:{scrollbarWidth:"thin",scrollbarColor:"var(--theme-divider, #E4E4E7) transparent"},children:e.jsxs(Vt,{removeWrapper:!0,selectionMode:"none",isCompact:m,classNames:{base:"min-w-[900px]",wrapper:"p-0 shadow-none",th:"text-default-600 border-b font-semibold text-xs sticky top-0 z-30",td:"border-b py-4 px-3",table:"border-collapse w-full",thead:"sticky top-0 z-30",tbody:"",tr:"hover:bg-default-50 transition-colors duration-150",emptyWrapper:"text-center h-32",loadingWrapper:"h-32"},style:{"--table-border-color":"var(--theme-divider, #E4E4E7)","--table-header-bg":"var(--theme-content2, #F4F4F5)","--table-row-hover":"var(--theme-default-50, #F9FAFB)"},children:[e.jsx(Zt,{columns:ce,children:t=>e.jsx(Jt,{align:t.uid==="actions"||t.uid==="sl"?"center":"start",width:t.uid==="user"?280:t.uid==="email"?240:t.uid==="phone"?140:t.uid==="department"||t.uid==="device_status"?160:t.uid==="status"?120:t.uid==="roles"?180:t.uid==="actions"?120:void 0,style:{background:"var(--table-header-bg)",borderColor:"var(--table-border-color)",fontFamily:'var(--fontFamily, "Inter")',fontSize:"0.75rem",fontWeight:"600"},children:e.jsxs("div",{className:"flex items-center gap-2 py-1",children:[t.uid==="sl"&&e.jsx(Gt,{className:"w-3 h-3 text-default-400"}),t.uid==="user"&&e.jsx(fe,{className:"w-3 h-3 text-default-400"}),t.uid==="email"&&e.jsx(_e,{className:"w-3 h-3 text-default-400"}),t.uid==="phone"&&e.jsx(ye,{className:"w-3 h-3 text-default-400"}),t.uid==="department"&&e.jsx(ne,{className:"w-3 h-3 text-default-400"}),t.uid==="device_status"&&e.jsx(oe,{className:"w-3 h-3 text-default-400"}),t.uid==="status"&&e.jsx(Ct,{className:"w-3 h-3 text-default-400"}),t.uid==="roles"&&e.jsx(de,{className:"w-3 h-3 text-default-400"}),t.uid==="actions"&&e.jsx(Ce,{className:"w-3 h-3 text-default-400"}),e.jsx("span",{children:t.name})]})},t.uid)}),e.jsx(Ht,{items:r||[],emptyContent:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(Lt,{className:"w-12 h-12 text-default-300 mb-3"}),e.jsx("p",{className:"text-default-500 font-medium",children:"No users found"}),e.jsx("p",{className:"text-default-400 text-sm",children:"Try adjusting your search or filters"})]}),loadingContent:e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx(pe,{size:"lg",color:"primary"})}),isLoading:x,children:(t,n)=>{const c=r?r.findIndex(s=>s.id===t.id):n;return e.jsx(qt,{className:"group",style:{background:"var(--theme-content1, #FFFFFF)"},children:s=>e.jsx(Kt,{style:{borderColor:"var(--table-border-color)",fontFamily:'var(--fontFamily, "Inter")',background:"inherit"},children:g(t,s,c)})},t.id)}})]})}),N()]})},Nt=({user:r,allUsers:F,departments:m,designations:_,setUsers:L,open:v,closeModal:I,editMode:P=!1})=>{const[C,Q]=i.useState(!1),[x,R]=i.useState({id:(r==null?void 0:r.id)||"",name:(r==null?void 0:r.name)||"",user_name:(r==null?void 0:r.user_name)||"",gender:(r==null?void 0:r.gender)||"",birthday:(r==null?void 0:r.birthday)||"",date_of_joining:(r==null?void 0:r.date_of_joining)||"",address:(r==null?void 0:r.address)||"",employee_id:(r==null?void 0:r.employee_id)||"",phone:(r==null?void 0:r.phone)||"",email:(r==null?void 0:r.email)||"",department_id:(r==null?void 0:r.department_id)||"",designation_id:(r==null?void 0:r.designation_id)||"",report_to:(r==null?void 0:r.report_to)||"",password:"",confirmPassword:"",roles:(r==null?void 0:r.roles)||[]}),[d,O]=i.useState({}),[q,T]=i.useState(!1),[G,A]=i.useState(!1),[X,V]=i.useState((r==null?void 0:r.profile_image_url)||(r==null?void 0:r.profile_image)||null),[S,Y]=i.useState(null),[h,j]=i.useState(F);i.useEffect(()=>{(r!=null&&r.profile_image_url||r!=null&&r.profile_image)&&V(r.profile_image_url||r.profile_image)},[r]);const se=async t=>{var c;t.preventDefault(),T(!0);const n=new FormData;if(Object.keys(x).forEach(s=>{s==="roles"&&Array.isArray(x[s])?x[s].forEach((E,p)=>{n.append(`roles[${p}]`,E)}):x[s]!==null&&x[s]!==void 0&&n.append(s,x[s])}),S){const s=S.type;if(["image/jpeg","image/jpg","image/png"].includes(s))n.append("profile_image",S);else{y.error("Invalid file type. Only JPEG and PNG are allowed.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}),T(!1);return}}try{const s=P?route("updateUser",{id:r.id}):route("addUser"),E=P?"put":"post",p=await axios[E](s,n);p.status===200&&(L&&L(P?f=>f.map(Z=>Z.id===p.data.user.id?p.data.user:Z):f=>[...f,p.data.user]),y.success(((c=p.data.messages)==null?void 0:c.length)>0?p.data.messages.join(" "):`User ${P?"updated":"added"} successfully`,{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}),I())}catch(s){T(!1),ce(s)}finally{T(!1)}},ce=t=>{t.response?t.response.status===422?(O(t.response.data.errors||{}),y.error(t.response.data.error||`Failed to ${P?"update":"add"} user.`,{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}})):y.error("An unexpected error occurred. Please try again later.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}):t.request?y.error("No response received from the server. Please check your internet connection.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}):y.error("An error occurred while setting up the request.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}})},K=t=>{const n=t.target.files[0];if(n){const c=URL.createObjectURL(n);V(c),Y(n)}},g=(t,n)=>{R(c=>({...c,[t]:n})),d[t]&&O(c=>{const s={...c};return delete s[t],s})},N=()=>{Q(!C)};return e.jsxs(At,{open:v,onClose:I,fullWidth:!0,maxWidth:"md",sx:{"& .MuiPaper-root":{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:theme.glassCard.background,border:theme.glassCard.border,borderRadius:"16px",color:theme.palette.text.primary,boxShadow:theme.glassCard.boxShadow}},children:[e.jsx(DialogTitle,{sx:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",pb:2},children:e.jsxs(Box,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(Typography,{variant:"h6",component:"div",sx:{fontWeight:600},children:P?"Edit User":"Add New User"}),e.jsx(IconButton,{"aria-label":"close",onClick:I,sx:{color:theme.palette.grey[500],"&:hover":{color:theme.palette.primary.main}},children:e.jsx(ClearIcon,{})})]})}),e.jsx(DialogContent,{sx:{pt:3},children:e.jsx("form",{onSubmit:se,children:e.jsxs(Grid,{container:!0,spacing:3,children:[e.jsx(Grid,{item:!0,xs:12,sx:{display:"flex",justifyContent:"center",mb:2},children:e.jsxs(Box,{onMouseEnter:()=>A(!0),onMouseLeave:()=>A(!1),sx:{position:"relative"},children:[e.jsx(zt,{src:X,alt:"Profile",sx:{width:120,height:120,border:"4px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",filter:G?"brightness(70%)":"brightness(100%)",transition:"all 0.3s ease"}}),e.jsxs(Box,{component:"label",htmlFor:"icon-button-file",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",opacity:G?1:0,transition:"opacity 0.3s ease",cursor:"pointer"},children:[e.jsx("input",{accept:"image/*",id:"icon-button-file",type:"file",style:{display:"none"},onChange:K}),e.jsx(PhotoCamera,{sx:{color:"white",fontSize:32}})]})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Full Name",value:x.name,onChange:t=>g("name",t.target.value),error:!!d.name,helperText:d.name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}},required:!0})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Username",value:x.user_name,onChange:t=>g("user_name",t.target.value),error:!!d.user_name,helperText:d.user_name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}},required:!0})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Email",type:"email",value:x.email,onChange:t=>g("email",t.target.value),error:!!d.email,helperText:d.email,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}},required:!0})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Phone",value:x.phone,onChange:t=>g("phone",t.target.value),error:!!d.phone,helperText:d.phone,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"department-label",sx:{color:theme.palette.text.secondary},children:"Department"}),e.jsxs(ae,{labelId:"department-label",value:x.department_id,onChange:t=>g("department_id",t.target.value),label:"Department",error:!!d.department_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"None"})}),m==null?void 0:m.map(t=>e.jsx(MenuItem,{value:t.id,children:t.name},t.id))]}),d.department_id&&e.jsx(FormHelperText,{error:!0,children:d.department_id})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"designation-label",sx:{color:theme.palette.text.secondary},children:"Designation"}),e.jsxs(ae,{labelId:"designation-label",value:x.designation_id,onChange:t=>g("designation_id",t.target.value),label:"Designation",error:!!d.designation_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"None"})}),_==null?void 0:_.map(t=>e.jsx(MenuItem,{value:t.id,children:t.name},t.id))]}),d.designation_id&&e.jsx(FormHelperText,{error:!0,children:d.designation_id})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"gender-label",sx:{color:theme.palette.text.secondary},children:"Gender"}),e.jsxs(ae,{labelId:"gender-label",value:x.gender,onChange:t=>g("gender",t.target.value),label:"Gender",error:!!d.gender,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"Select Gender"})}),e.jsx(MenuItem,{value:"male",children:"Male"}),e.jsx(MenuItem,{value:"female",children:"Female"}),e.jsx(MenuItem,{value:"other",children:"Other"})]}),d.gender&&e.jsx(FormHelperText,{error:!0,children:d.gender})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Employee ID",value:x.employee_id,onChange:t=>g("employee_id",t.target.value),error:!!d.employee_id,helperText:d.employee_id,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Date of Birth",type:"date",value:x.birthday,onChange:t=>g("birthday",t.target.value),error:!!d.birthday,helperText:d.birthday,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Date of Joining",type:"date",value:x.date_of_joining,onChange:t=>g("date_of_joining",t.target.value),error:!!d.date_of_joining,helperText:d.date_of_joining,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"report-to-label",sx:{color:theme.palette.text.secondary},children:"Reports To"}),e.jsxs(ae,{labelId:"report-to-label",value:x.report_to,onChange:t=>g("report_to",t.target.value),label:"Reports To",error:!!d.report_to,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"None"})}),h==null?void 0:h.filter(t=>t.id!==x.id).map(t=>e.jsx(MenuItem,{value:t.id,children:t.name},t.id))]}),d.report_to&&e.jsx(FormHelperText,{error:!0,children:d.report_to})]})}),e.jsx(Grid,{item:!0,xs:12,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Address",multiline:!0,rows:3,value:x.address,onChange:t=>g("address",t.target.value),error:!!d.address,helperText:d.address,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),!P&&e.jsxs(e.Fragment,{children:[e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Password",type:C?"text":"password",value:x.password,onChange:t=>g("password",t.target.value),error:!!d.password,helperText:d.password,required:!P,InputProps:{endAdornment:e.jsx(IconButton,{"aria-label":"toggle password visibility",onClick:N,edge:"end",children:C?e.jsx(VisibilityOff,{}):e.jsx(Visibility,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Confirm Password",type:C?"text":"password",value:x.confirmPassword,onChange:t=>g("confirmPassword",t.target.value),error:!!d.confirmPassword,helperText:d.confirmPassword||(x.password!==x.confirmPassword&&x.confirmPassword?"Passwords do not match":""),required:!P,InputProps:{endAdornment:e.jsx(IconButton,{"aria-label":"toggle password visibility",onClick:N,edge:"end",children:C?e.jsx(VisibilityOff,{}):e.jsx(Visibility,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})})]})]})})}),e.jsxs(DialogActions,{sx:{justifyContent:"space-between",p:3,borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(U,{onClick:I,variant:"bordered",color:"default",size:"lg",className:"bg-white/5 hover:bg-white/10 border border-white/10",children:"Cancel"}),e.jsx(LoadingButton,{onClick:se,loading:q,loadingPosition:"start",startIcon:e.jsx(PasswordIcon,{}),variant:"contained",sx:{background:"linear-gradient(45deg, #3a7bd5 0%, #2456bd 100%)",boxShadow:"0 4px 20px 0 rgba(58, 123, 213, 0.4)","&:hover":{background:"linear-gradient(45deg, #2456bd 0%, #1a3c8a 100%)"}},children:P?"Update User":"Add User"})]})]})},$=()=>{var _;if(typeof window>"u")return"lg";const F=((_=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:_.trim())||"12px",m=parseInt(F);return m===0?"none":m<=4?"sm":m<=8?"md":m<=12?"lg":"xl"},ca=({title:r,roles:F})=>{var Se,Ee,$e,Te,Ue,De,Le,Ae,ze,We,Me,Be,Oe,Ge,Ve,He,qe,Ke,Ze,Je,Qe,Xe,Ye,et,tt,at,st,rt,lt,it,nt,ot,dt,ct;const[m,_]=i.useState(!1),[L,v]=i.useState(!1),[I,P]=i.useState(!1),[C,Q]=i.useState(!1);i.useEffect(()=>{const a=()=>{_(window.innerWidth<640),v(window.innerWidth<768),P(window.innerWidth>=1025),Q(window.innerWidth>=641&&window.innerWidth<=1024)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);const[x,R]=i.useState([]),[d,O]=i.useState(!0),[q,T]=i.useState(null),[G,A]=i.useState(0),[X,V]=i.useState(1),[S,Y]=i.useState(null),[h,j]=i.useState({search:"",role:"all",status:"all",department:"all"}),[se,ce]=i.useState(!1),[K,g]=i.useState("table"),[N,t]=i.useState({currentPage:1,perPage:10,total:x.length}),[n,c]=i.useState({}),[s,E]=i.useState({overview:{total_users:0,active_users:0,inactive_users:0,deleted_users:0,total_roles:0,total_departments:0},distribution:{by_role:[],by_department:[],by_status:[]},activity:{recent_registrations:{new_users_30_days:0,new_users_90_days:0,new_users_year:0,recently_active:0},user_growth_rate:0,current_month_registrations:0},security:{access_metrics:{users_with_roles:0,users_without_roles:0,admin_users:0,regular_users:0},role_distribution:[]},health:{status_ratio:{active_percentage:0,inactive_percentage:0,deleted_percentage:0},system_metrics:{user_activation_rate:0,role_coverage:0,department_coverage:0}},quick_metrics:{total_users:0,active_ratio:0,role_diversity:0,department_diversity:0,recent_activity:0,system_health_score:0}}),p=i.useMemo(()=>({data:x,total:G,current_page:N.currentPage,per_page:N.perPage,last_page:X}),[x,G,N.currentPage,N.perPage,X]),f=i.useCallback(async()=>{try{const{data:a}=await le.get(route("users.stats"));a.stats&&E(a.stats)}catch(a){console.error("Error fetching user stats:",a)}},[]),Z=i.useCallback(async()=>{O(!0);try{const a=await le.get(route("users.paginate"),{params:{page:N.currentPage,perPage:N.perPage,search:h.search||void 0,role:h.role!=="all"?h.role:void 0,status:h.status!=="all"?h.status:void 0,department:h.department!=="all"?h.department:void 0}});if(a.status===200){const{users:l}=a.data;l.data&&Array.isArray(l.data)?(R(l.data),A(l.total||l.data.length),V(l.last_page||1)):Array.isArray(l)?(R(l),A(l.length),V(1)):(console.error("Unexpected users data format:",l),R([]),A(0),V(1))}}catch(a){console.error("Error fetching users:",a),y.error("Failed to load users data"),R([])}finally{O(!1)}},[h,N.currentPage,N.perPage]);i.useEffect(()=>{Z()},[Z]),i.useEffect(()=>{f();const a=setInterval(f,6e4);return()=>clearInterval(a)},[f]);const z=(a,l)=>{j(o=>({...o,[a]:l})),t(o=>({...o,currentPage:1}))},me=a=>{t(l=>({...l,currentPage:a})),window.scrollTo({top:0,behavior:"smooth"})},xe=a=>{t(l=>({...l,currentPage:1,perPage:a}))},H=i.useCallback((a,l=null)=>{Y(a),T(l)},[]),b=i.useCallback(()=>{Y(null),T(null)},[]),re=i.useCallback(a=>{R(a)},[]),Pt=i.useCallback(a=>{R(l=>l.map(o=>o.id===a.id?{...o,...a}:o))},[]),St=i.useCallback(a=>{R(l=>l.filter(o=>o.id!==a)),f()},[f]),Ie=i.useCallback((a,l)=>{R(o=>o.map(u=>u.id===a?{...u,active:l}:u)),f()},[f]),Et=i.useCallback((a,l)=>{R(o=>o.map(u=>u.id===a?{...u,roles:l}:u)),f()},[f]),Re=i.useCallback(async(a,l)=>{var o,u;c(w=>({...w,[a]:!0}));try{const w=await le.post(route("admin.users.devices.toggle",{userId:a}));w.data.success&&(R(he=>he.map(ee=>ee.id===a?{...ee,single_device_login_enabled:w.data.single_device_login_enabled}:ee)),y.success(w.data.message))}catch(w){console.error("Error toggling single device login:",w),y.error(((u=(o=w.response)==null?void 0:o.data)==null?void 0:u.message)||"Failed to toggle single device login")}finally{c(w=>({...w,[a]:!1}))}},[]),ke=i.useCallback(async a=>{c(l=>({...l,[a]:!0}));try{const l=await le.post(route("admin.users.devices.reset",{userId:a}),{reason:"Admin reset via user management"});l.data.success&&(R(o=>o.map(u=>u.id===a?{...u,active_device:null}:u)),y.success(l.data.message||"User devices have been reset"))}catch(l){console.error("Error resetting user devices:",l),y.error("Failed to reset user devices")}finally{c(l=>({...l,[a]:!1}))}},[]);i.useCallback(async a=>{try{const l=await le.get(route("admin.users.devices",{userId:a}));if(l.data.success){const o=l.data.devices;if(o.length===0)y.info("User has no registered devices");else{const u=o.filter(w=>w.is_active).length;y.info(`User has ${o.length} device(s): ${u} active, ${o.length-u} inactive`)}}}catch(l){console.error("Error fetching user devices:",l),y.error("Failed to fetch device information")}},[]);const Pe=(a,l="w-4 h-4")=>{const o=(a==null?void 0:a.toLowerCase())||"";return o.includes("mobile")||o.includes("android")||o.includes("iphone")?e.jsx(oe,{className:`${l} text-primary`}):o.includes("tablet")||o.includes("ipad")?e.jsx(_t,{className:`${l} text-secondary`}):e.jsx(Ft,{className:`${l} text-default-500`})},$t=a=>{const l=(a==null?void 0:a.toLowerCase())||"";return l.includes("mobile")||l.includes("android")||l.includes("iphone")?"Mobile":l.includes("tablet")||l.includes("ipad")?"Tablet":"Desktop"},Tt=({user:a,index:l})=>e.jsx(W,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 transition-all duration-200 h-full min-h-[320px]",style:{background:`linear-gradient(135deg, 
          color-mix(in srgb, var(--theme-content1) 90%, transparent) 20%, 
          color-mix(in srgb, var(--theme-content2) 80%, transparent) 80%)`,borderColor:"color-mix(in srgb, var(--theme-primary) 20%, transparent)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsxs(M,{className:"p-3 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-3 pb-2 border-b border-white/10",children:[e.jsx(kt,{avatarProps:{radius:"md",src:(a==null?void 0:a.profile_image_url)||(a==null?void 0:a.profile_image),size:"sm",fallback:e.jsx(fe,{className:"w-4 h-4"}),style:{borderColor:"var(--theme-primary)",borderWidth:"2px"}},name:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-foreground text-sm line-clamp-1",children:a.name}),e.jsxs("span",{className:"text-default-500 text-xs line-clamp-1",children:["ID: ",a.id]})]}),classNames:{wrapper:"flex-1 min-w-0",name:"text-sm font-semibold",description:"text-xs text-default-500"}}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Fe,{content:"Edit User",size:"sm",children:e.jsx(U,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-primary min-w-6 w-6 h-6",onPress:()=>H("edit",a),children:e.jsx(It,{className:"w-3 h-3"})})}),e.jsxs(je,{placement:"bottom-end",children:[e.jsx(Ne,{children:e.jsx(U,{isIconOnly:!0,size:"sm",variant:"ghost",radius:$(),isDisabled:n[a.id],className:"min-w-6 w-6 h-6",style:{background:"color-mix(in srgb, var(--theme-content2) 30%, transparent)"},children:e.jsx(Ce,{className:"w-3 h-3"})})}),e.jsxs(we,{"aria-label":"Device management actions",variant:"bordered",className:"min-w-[180px]",style:{background:"color-mix(in srgb, var(--theme-content1) 95%, transparent)",backdropFilter:"blur(16px)",borderColor:"color-mix(in srgb, var(--theme-primary) 20%, transparent)",borderRadius:"var(--borderRadius, 12px)"},children:[e.jsx(D,{startContent:a.single_device_login?e.jsx(ge,{className:"w-3 h-3"}):e.jsx(ve,{className:"w-3 h-3"}),onPress:()=>Re(a.id,!a.single_device_login),isDisabled:n[a.id],className:"text-xs",children:a.single_device_login?"Disable Lock":"Enable Lock"},"toggle-device-lock"),a.single_device_login&&a.active_device&&e.jsx(D,{startContent:e.jsx(te,{className:"w-3 h-3"}),onPress:()=>ke(a.id),isDisabled:n[a.id],className:"text-xs",children:"Reset Device"},"reset-device"),e.jsx(D,{startContent:e.jsx(oe,{className:"w-3 h-3"}),onPress:()=>bt.visit(route("admin.users.devices",{userId:a.id})),className:"text-xs",children:"Device History"},"view-devices"),e.jsx(D,{startContent:e.jsx(fe,{className:"w-3 h-3"}),onPress:()=>bt.visit(route("profile",{user:a.id})),className:"text-xs",children:"View Profile"},"view-profile")]})]})]})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(_e,{className:"w-3 h-3 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 line-clamp-1 flex-1",children:a.email})]}),a.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(ye,{className:"w-3 h-3 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 line-clamp-1",children:a.phone})]}),(a.department||a.department_id)&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(ne,{className:"w-3 h-3 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 line-clamp-1",children:typeof a.department=="string"?a.department:"N/A"})]})]}),e.jsxs("div",{className:"mb-3 p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-content2) 40%, transparent)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-default-700",children:"Device Status"}),a.single_device_login&&a.active_device&&e.jsx(Fe,{content:e.jsxs("div",{className:"p-2 max-w-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[Pe(a.active_device.user_agent,"w-4 h-4"),e.jsx("span",{className:"font-medium text-xs",children:a.active_device.device_name||"Unknown Device"})]}),e.jsxs("div",{className:"text-xs text-default-500",children:[$t(a.active_device.user_agent)," â€¢",a.active_device.is_active?" Active":" Inactive"]})]}),size:"sm",children:e.jsx("div",{className:"cursor-help",children:Pe(a.active_device.user_agent,"w-4 h-4")})})]}),e.jsx(B,{size:"sm",variant:"flat",color:a.single_device_login?a.active_device?"warning":"success":"default",startContent:a.single_device_login?a.active_device?e.jsx(ve,{className:"w-3 h-3"}):e.jsx(ge,{className:"w-3 h-3"}):e.jsx(de,{className:"w-3 h-3"}),className:"text-xs",children:a.single_device_login?a.active_device?"Locked":"Free":"Disabled"})]}),e.jsxs("div",{className:"mt-auto space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-medium text-default-700",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ia,{size:"sm",isSelected:a.active,onValueChange:o=>Ie(a.id,o),color:a.active?"success":"danger",classNames:{wrapper:"group-data-[selected=true]:bg-success",thumb:"group-data-[selected=true]:ml-4"}}),e.jsx("span",{className:`text-xs font-medium ${a.active?"text-success":"text-danger"}`,children:a.active?"Active":"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-default-700 mb-1 block",children:"Roles"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.roles&&a.roles.length>0?a.roles.slice(0,3).map((o,u)=>{const w=typeof o=="object"&&o!==null?o.name:o;return e.jsx(B,{size:"sm",variant:"flat",color:"secondary",className:"text-xs h-5",children:w},u)}):e.jsx(B,{size:"sm",variant:"bordered",color:"default",className:"text-xs h-5",children:"No Roles"}),a.roles&&a.roles.length>3&&e.jsxs(B,{size:"sm",variant:"bordered",color:"primary",className:"text-xs h-5",children:["+",a.roles.length-3]})]})]})]})]})}),Ut=i.useMemo(()=>{var a,l,o,u,w,he,ee,mt,xt,ht,ut,pt,ft,vt;return[{title:"Total Users",value:((a=s==null?void 0:s.overview)==null?void 0:a.total_users)||0,icon:e.jsx(ue,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All users"},{title:"Active Users",value:((l=s==null?void 0:s.overview)==null?void 0:l.active_users)||0,icon:e.jsx(Ct,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:`${((u=(o=s==null?void 0:s.health)==null?void 0:o.status_ratio)==null?void 0:u.active_percentage)||0}% Active`},{title:"Inactive Users",value:((w=s==null?void 0:s.overview)==null?void 0:w.inactive_users)||0,icon:e.jsx(Qt,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:`${((ee=(he=s==null?void 0:s.health)==null?void 0:he.status_ratio)==null?void 0:ee.inactive_percentage)||0}% Inactive`},{title:"Total Roles",value:((mt=s==null?void 0:s.overview)==null?void 0:mt.total_roles)||0,icon:e.jsx(de,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Role diversity"},{title:"Role Coverage",value:`${((ht=(xt=s==null?void 0:s.health)==null?void 0:xt.system_metrics)==null?void 0:ht.role_coverage)||0}%`,icon:e.jsx(Xt,{className:"w-5 h-5"}),color:"text-emerald-400",iconBg:"bg-emerald-500/20",description:"Users with roles"},{title:"Recent Activity",value:((pt=(ut=s==null?void 0:s.activity)==null?void 0:ut.recent_registrations)==null?void 0:pt.recently_active)||0,icon:e.jsx(wt,{className:"w-5 h-5"}),color:"text-cyan-400",iconBg:"bg-cyan-500/20",description:"Active last 7 days"},{title:"System Health",value:`${((ft=s==null?void 0:s.quick_metrics)==null?void 0:ft.system_health_score)||0}%`,icon:e.jsx(jt,{className:"w-5 h-5"}),color:"text-pink-400",iconBg:"bg-pink-500/20",description:"Overall health"},{title:"Departments",value:((vt=s==null?void 0:s.overview)==null?void 0:vt.total_departments)||0,icon:e.jsx(ne,{className:"w-5 h-5"}),color:"text-indigo-400",iconBg:"bg-indigo-500/20",description:"Department diversity"}]},[s]);return i.useMemo(()=>{const a=[];return a.push({label:m?"Add":"Add User",icon:e.jsx(be,{className:"w-4 h-4"}),onPress:()=>H("add"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),a.push({label:m?"":"Export",isIconOnly:m,icon:e.jsx(yt,{className:"w-4 h-4"}),variant:"bordered",className:"border-[rgba(var(--theme-primary-rgb),0.3)] bg-[rgba(var(--theme-primary-rgb),0.05)] hover:bg-[rgba(var(--theme-primary-rgb),0.1)]"}),a},[m,H]),e.jsxs(e.Fragment,{children:[e.jsx(Dt,{title:r||"Users Management"}),S==="add"&&e.jsx(Nt,{user:null,open:S==="add",setUsers:re,closeModal:b,editMode:!1}),S==="edit"&&q&&e.jsx(Nt,{user:q,open:S==="edit",setUsers:re,closeModal:b,editMode:!0}),e.jsx("div",{className:"flex flex-col w-full h-full p-4",role:"main","aria-label":"Users Management",children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"w-full",children:e.jsx(Yt.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:e.jsxs(W,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                    var(--theme-content1, #FAFAFA) 20%, 
                    var(--theme-content2, #F4F4F5) 10%, 
                    var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(sa,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                      color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                      color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${I?"p-6":C?"p-4":"p-3"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[d?e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx(k,{className:"w-12 h-12 rounded-xl"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(k,{className:"w-64 h-6 rounded mb-2"}),e.jsx(k,{className:"w-48 h-4 rounded"})]})]}):e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                ${I?"p-3":C?"p-2.5":"p-2"} 
                                rounded-xl flex items-center justify-center
                              `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(ue,{className:`
                                  ${I?"w-8 h-8":C?"w-6 h-6":"w-5 h-5"}
                                `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                  ${I?"text-2xl":C?"text-xl":"text-lg"}
                                  font-bold text-foreground
                                  ${I?"":"truncate"}
                                `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Users Management"}),e.jsx("p",{className:`
                                  ${I?"text-sm":"text-xs"} 
                                  text-default-500
                                  ${I?"":"truncate"}
                                `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Manage user accounts, roles and permissions"})]})]}),d?e.jsxs("div",{className:"flex flex-wrap gap-2 lg:gap-3",children:[e.jsx(k,{className:"w-24 h-8 rounded"}),e.jsx(k,{className:"w-20 h-8 rounded"})]}):e.jsxs("div",{className:"flex flex-wrap gap-2 lg:gap-3",children:[e.jsx(U,{size:m?"sm":"md",color:"primary",startContent:e.jsx(be,{className:"w-4 h-4"}),onPress:()=>H("add"),radius:$(),style:{fontFamily:'var(--fontFamily, "Inter")'},className:"min-w-0",children:m?"Add":"Add User"}),e.jsx(U,{size:m?"sm":"md",variant:"bordered",startContent:e.jsx(ea,{className:"w-4 h-4"}),radius:$(),style:{background:"color-mix(in srgb, var(--theme-primary) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-primary) 30%, transparent)",color:"var(--theme-primary)",fontFamily:'var(--fontFamily, "Inter")'},className:"min-w-0",children:m?"Export":"Export Users"})]})]})})})}),e.jsxs(M,{className:"p-6",children:[e.jsx(Ot,{stats:Ut,className:"mb-6",isLoading:d}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mb-6",children:d?e.jsx(e.Fragment,{children:Array.from({length:6}).map((a,l)=>e.jsx(W,{className:"transition-all duration-200",style:{background:"color-mix(in srgb, var(--theme-content1) 5%, transparent)",borderColor:"color-mix(in srgb, var(--theme-default) 10%, transparent)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(k,{className:"w-9 h-9 rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(k,{className:"w-24 h-4 rounded mb-1"}),e.jsx(k,{className:"w-32 h-3 rounded"})]})]}),e.jsx("div",{className:"space-y-3",children:Array.from({length:4}).map((o,u)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"w-20 h-3 rounded"}),e.jsx(k,{className:"w-12 h-3 rounded"})]},u))})]})},l))}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"transition-all duration-200",style:{background:"color-mix(in srgb, var(--theme-content1) 5%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 20%, transparent)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-primary) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(ta,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Role Distribution"}),e.jsx("p",{className:"text-small text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"User roles breakdown"})]})]}),e.jsx("div",{className:"space-y-3",children:((Ee=(Se=s==null?void 0:s.distribution)==null?void 0:Se.by_role)==null?void 0:Ee.length)>0?s.distribution.by_role.slice(0,4).map((a,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:`color-mix(in srgb, var(--theme-primary) ${80-l*15}%, var(--theme-secondary) ${20+l*15}%)`}}),e.jsx("span",{className:"text-sm text-foreground truncate",style:{fontFamily:'var(--fontFamily, "Inter")'},children:a.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:a.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",style:{fontFamily:'var(--fontFamily, "Inter")'},children:["(",a.percentage,"%)"]})]})]},l)):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-default-400",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No role data available"})})})]})}),e.jsx(W,{className:"transition-all duration-200",style:{background:"color-mix(in srgb, var(--theme-content1) 5%, transparent)",borderColor:"color-mix(in srgb, var(--theme-secondary) 20%, transparent)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-secondary) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(ue,{className:"w-5 h-5",style:{color:"var(--theme-secondary)"}})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"User Status"}),e.jsx("p",{className:"text-small text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Active vs inactive users"})]})]}),e.jsx("div",{className:"space-y-3",children:((Te=($e=s==null?void 0:s.distribution)==null?void 0:$e.by_status)==null?void 0:Te.length)>0?s.distribution.by_status.map((a,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:a.name==="Active"?"var(--theme-success)":a.name==="Inactive"?"var(--theme-danger)":"var(--theme-default)"}}),e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:a.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:a.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",style:{fontFamily:'var(--fontFamily, "Inter")'},children:["(",a.percentage,"%)"]})]})]},l)):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-default-400",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No status data available"})})})]})}),e.jsx(W,{className:"transition-all duration-200",style:{background:"color-mix(in srgb, var(--theme-content1) 5%, transparent)",borderColor:"color-mix(in srgb, var(--theme-warning) 20%, transparent)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-warning) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(ne,{className:"w-5 h-5",style:{color:"var(--theme-warning)"}})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Departments"}),e.jsx("p",{className:"text-small text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Users by department"})]})]}),e.jsx("div",{className:"space-y-3",children:((De=(Ue=s==null?void 0:s.distribution)==null?void 0:Ue.by_department)==null?void 0:De.length)>0?s.distribution.by_department.slice(0,4).map((a,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:`color-mix(in srgb, var(--theme-warning) ${80-l*15}%, var(--theme-primary) ${20+l*15}%)`}}),e.jsx("span",{className:"text-sm text-foreground truncate",style:{fontFamily:'var(--fontFamily, "Inter")'},children:a.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:a.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",style:{fontFamily:'var(--fontFamily, "Inter")'},children:["(",a.percentage,"%)"]})]})]},l)):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-default-400",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No department data available"})})})]})}),e.jsx(W,{className:"transition-all duration-200",style:{background:"color-mix(in srgb, var(--theme-content1) 5%, transparent)",borderColor:"color-mix(in srgb, var(--theme-success) 20%, transparent)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-success) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(yt,{className:"w-5 h-5",style:{color:"var(--theme-success)"}})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"User Growth"}),e.jsx("p",{className:"text-small text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Registration trends"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"New (30 days)"}),e.jsx("span",{className:"text-sm font-medium text-success",style:{fontFamily:'var(--fontFamily, "Inter")'},children:((Ae=(Le=s==null?void 0:s.activity)==null?void 0:Le.recent_registrations)==null?void 0:Ae.new_users_30_days)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"New (90 days)"}),e.jsx("span",{className:"text-sm font-medium text-primary",style:{fontFamily:'var(--fontFamily, "Inter")'},children:((We=(ze=s==null?void 0:s.activity)==null?void 0:ze.recent_registrations)==null?void 0:We.new_users_90_days)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Recently Active"}),e.jsx("span",{className:"text-sm font-medium text-secondary",style:{fontFamily:'var(--fontFamily, "Inter")'},children:((Be=(Me=s==null?void 0:s.activity)==null?void 0:Me.recent_registrations)==null?void 0:Be.recently_active)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Growth Rate"}),e.jsx(B,{size:"sm",color:(((Oe=s==null?void 0:s.activity)==null?void 0:Oe.user_growth_rate)||0)>0?"success":(((Ge=s==null?void 0:s.activity)==null?void 0:Ge.user_growth_rate)||0)<0?"danger":"default",variant:"flat",radius:$(),children:e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:[((Ve=s==null?void 0:s.activity)==null?void 0:Ve.user_growth_rate)||0,"%"]})})]})]})]})}),e.jsx(W,{className:"transition-all duration-200",style:{background:"color-mix(in srgb, var(--theme-content1) 5%, transparent)",borderColor:"color-mix(in srgb, var(--theme-danger) 20%, transparent)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-danger) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(de,{className:"w-5 h-5",style:{color:"var(--theme-danger)"}})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Access Control"}),e.jsx("p",{className:"text-small text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Role assignments"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"With Roles"}),e.jsx("span",{className:"text-sm font-medium text-success",style:{fontFamily:'var(--fontFamily, "Inter")'},children:((qe=(He=s==null?void 0:s.security)==null?void 0:He.access_metrics)==null?void 0:qe.users_with_roles)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Without Roles"}),e.jsx("span",{className:"text-sm font-medium text-danger",style:{fontFamily:'var(--fontFamily, "Inter")'},children:((Ze=(Ke=s==null?void 0:s.security)==null?void 0:Ke.access_metrics)==null?void 0:Ze.users_without_roles)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Admin Users"}),e.jsx("span",{className:"text-sm font-medium text-warning",style:{fontFamily:'var(--fontFamily, "Inter")'},children:((Qe=(Je=s==null?void 0:s.security)==null?void 0:Je.access_metrics)==null?void 0:Qe.admin_users)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Role Coverage"}),e.jsx(B,{size:"sm",color:(((Ye=(Xe=s==null?void 0:s.health)==null?void 0:Xe.system_metrics)==null?void 0:Ye.role_coverage)||0)>80?"success":(((tt=(et=s==null?void 0:s.health)==null?void 0:et.system_metrics)==null?void 0:tt.role_coverage)||0)>60?"warning":"danger",variant:"flat",radius:$(),children:e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:[((st=(at=s==null?void 0:s.health)==null?void 0:at.system_metrics)==null?void 0:st.role_coverage)||0,"%"]})})]})]})]})}),e.jsx(W,{className:"transition-all duration-200",style:{background:"color-mix(in srgb, var(--theme-content1) 5%, transparent)",borderColor:"color-mix(in srgb, var(--theme-default) 20%, transparent)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-default) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(jt,{className:"w-5 h-5",style:{color:"var(--theme-default)"}})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"System Health"}),e.jsx("p",{className:"text-small text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Overall metrics"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Health Score"}),e.jsx(B,{size:"sm",color:(((rt=s==null?void 0:s.quick_metrics)==null?void 0:rt.system_health_score)||0)>80?"success":(((lt=s==null?void 0:s.quick_metrics)==null?void 0:lt.system_health_score)||0)>60?"warning":"danger",variant:"flat",radius:$(),children:e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:[((it=s==null?void 0:s.quick_metrics)==null?void 0:it.system_health_score)||0,"%"]})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Activation Rate"}),e.jsxs("span",{className:"text-sm font-medium text-success",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[((ot=(nt=s==null?void 0:s.health)==null?void 0:nt.system_metrics)==null?void 0:ot.user_activation_rate)||0,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Total Roles"}),e.jsx("span",{className:"text-sm font-medium text-primary",style:{fontFamily:'var(--fontFamily, "Inter")'},children:((dt=s==null?void 0:s.overview)==null?void 0:dt.total_roles)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Total Departments"}),e.jsx("span",{className:"text-sm font-medium text-warning",style:{fontFamily:'var(--fontFamily, "Inter")'},children:((ct=s==null?void 0:s.overview)==null?void 0:ct.total_departments)||0})]})]})]})})]})}),e.jsx("div",{className:"mb-6",children:d?e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-end",children:[e.jsx("div",{className:"w-full sm:w-auto sm:min-w-[200px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"w-24 h-4 rounded"}),e.jsx(k,{className:"w-full h-10 rounded-lg"})]})}),e.jsx("div",{className:"w-full sm:w-auto sm:min-w-[200px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"w-20 h-4 rounded"}),e.jsx(k,{className:"w-full h-10 rounded-lg"})]})})]}):e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-end",children:[e.jsx("div",{className:"flex-1",children:e.jsx(ra,{label:"Search Users",placeholder:"Search by name, email or phone...",value:h.search,onValueChange:a=>z("search",a),variant:"bordered",size:m?"sm":"md",radius:$(),startContent:e.jsx(Wt,{className:"w-4 h-4 text-default-400"}),classNames:{inputWrapper:"border-default-200 hover:border-default-300"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsxs("div",{className:"flex flex-wrap gap-2 lg:gap-3",children:[e.jsxs(ae,{label:"Status",selectedKeys:h.status?[h.status]:[],onSelectionChange:a=>z("status",Array.from(a)[0]),variant:"bordered",size:m?"sm":"md",radius:$(),className:"w-32",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(ie,{children:"All Status"},"all"),e.jsx(ie,{children:"Active"},"active"),e.jsx(ie,{children:"Inactive"},"inactive")]}),e.jsxs(ae,{label:"Role",selectedKeys:h.role?[h.role]:[],onSelectionChange:a=>z("role",Array.from(a)[0]),variant:"bordered",size:m?"sm":"md",radius:$(),className:"w-32",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(ie,{children:"All Roles"},"all"),F==null?void 0:F.map((a,l)=>{const o=typeof a=="object"&&a!==null?a.name:a,u=typeof o=="string"?o.toLowerCase():String(o||`role-${l}`).toLowerCase();return e.jsx(ie,{children:o||"Unknown Role"},u)})]}),e.jsxs(la,{variant:"bordered",radius:$(),children:[e.jsx(U,{isIconOnly:!0,color:K==="table"?"primary":"default",onPress:()=>g("table"),size:m?"sm":"md",children:e.jsx(aa,{className:"w-4 h-4"})}),e.jsx(U,{isIconOnly:!0,color:K==="grid"?"primary":"default",onPress:()=>g("grid"),size:m?"sm":"md",children:e.jsx(Mt,{className:"w-4 h-4"})})]})]})]})}),e.jsx("div",{className:"overflow-hidden",children:d?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(pe,{size:"lg"})}):K==="table"?e.jsx(da,{allUsers:p.data,roles:F,setUsers:re,isMobile:m,isTablet:L,pagination:N,onPageChange:me,onRowsPerPageChange:xe,totalUsers:p.total,loading:d,onEdit:a=>H("edit",a),updateUserOptimized:Pt,deleteUserOptimized:St,toggleUserStatusOptimized:Ie,updateUserRolesOptimized:Et,toggleSingleDeviceLogin:Re,resetUserDevice:ke,deviceActions:n}):e.jsxs("div",{children:[p.data&&p.data.length>0?e.jsx("div",{className:`grid gap-4 ${m?"grid-cols-1":L?"grid-cols-2":"grid-cols-3 xl:grid-cols-4"}`,children:p.data.map((a,l)=>e.jsx(Tt,{user:a,index:l},a.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ue,{className:"w-16 h-16 mx-auto text-default-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No users found"}),e.jsx("p",{className:"text-default-500 mb-4",children:"Try adjusting your search criteria or filters"}),e.jsx(U,{color:"primary",startContent:e.jsx(be,{className:"w-4 h-4"}),onPress:()=>H("add"),children:"Add First User"})]}),p.data&&p.data.length>0&&e.jsx("div",{className:"flex justify-center mt-6 border-t pt-4",style:{borderColor:"var(--theme-divider, #E4E4E7)"},children:e.jsx(Rt,{total:Math.ceil(p.total/N.perPage),initialPage:N.currentPage,page:N.currentPage,onChange:me,size:m?"sm":"md",variant:"bordered",showControls:!0,radius:$(),style:{fontFamily:'var(--fontFamily, "Inter")'}})})]})})]})]})})})})})]})};ca.layout=r=>e.jsx(Bt,{children:r});export{ca as default};
