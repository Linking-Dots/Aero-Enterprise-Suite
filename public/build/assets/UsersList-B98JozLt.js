import{r as n,j as e,s as Ze,b as H,L as Ke,F as X,a as se,H as yt,d as W,e as V,c as oe}from"./app-DVP_m8h7.js";import{B as et,C as tt,D as st,E as Q,h as ot,k as le,z as dt,G as wt,x as Nt,s as Y,b as de,f as _t,H as Ct,l as ae,A as kt}from"./App-pkq0eXyk.js";import{G as Ft}from"./logo-D1JCVLgz.js";import{P as Pt}from"./PageHeader-BUuKVLC7.js";import{S as Rt}from"./StatsCards-BxBddKNK.js";import{c as z,t as It,B as y,a as Tt}from"./react-toastify.esm-11ySLd55.js";import{F as ct}from"./EllipsisVerticalIcon-BDDPBu9b.js";import{F as ce}from"./UserIcon-SndiMFUs.js";import{F as mt}from"./PencilIcon-CQejNNLk.js";import{a as me,b as St,F as at}from"./SignalIcon-ByDba1BK.js";import{F as xe}from"./LockClosedIcon-DW1QPL_h.js";import{F as he}from"./DevicePhoneMobileIcon-k7i5n1BE.js";import{F as ne}from"./ShieldCheckIcon-CAzrY1qb.js";import{F as Ut}from"./EnvelopeIcon-CCl31SqK.js";import{t as $t,a as Dt,b as At,c as Et}from"./chunk-F3UDT23P-bTe2Vr3o.js";import{t as Lt}from"./chunk-YRZGWF2W-OOeD0y1O.js";import{t as zt}from"./chunk-TSPNSPCL-apcFqiC2.js";import{p as xt}from"./chunk-EAPQ7RWQ-BA9qruv0.js";import{u as ht}from"./chunk-S574QCAN-dtvn5DCJ.js";import{F as rt}from"./CheckCircleIcon-BkiSCmd_.js";import{F as it}from"./XCircleIcon-Cpn7u5Q-.js";import{F as Mt}from"./TrophyIcon-BEv63N8j.js";import{F as Gt}from"./UserPlusIcon-eYl6hwUP.js";import{F as lt}from"./ChartBarIcon-CenWUbeF.js";import{F as Ot}from"./ChartPieIcon-By0IJ988.js";import{F as Bt}from"./ExclamationTriangleIcon-D2qoBr5-.js";import{F as Wt}from"./TableCellsIcon-XQeIpQ7f.js";import{F as Vt}from"./AdjustmentsHorizontalIcon-D0gupIBC.js";import{m as Ht}from"./proxy-BomxYwOG.js";import{i as qt}from"./chunk-SSA7SXE4-C5QhRsCJ.js";import{b as Jt}from"./chunk-57V4RE7B-CCauCU7j.js";import"./KeyIcon-ClouCyVq.js";import"./features-animation-DPmZMQ5S.js";import"./create-visual-element-DRYypj6G.js";import"./chunk-XJ2YRSUP-ot1Ib-Dn.js";import"./useToggleState-DUQRr0AO.js";import"./index-Jgrs7YXA.js";const Qt=({allUsers:r,roles:A,isMobile:h,isTablet:S,setUsers:U,pagination:b,onPageChange:I,onRowsPerPageChange:p,totalUsers:k=0,onEdit:M,loading:m=!1,updateUserOptimized:Z,deleteUserOptimized:o,toggleUserStatusOptimized:$,updateUserRolesOptimized:G,toggleSingleDeviceLogin:P,resetUserDevice:T,deviceActions:E={}})=>{const[q,O]=n.useState({}),x=(t,a="w-5 h-5")=>{const d=(t==null?void 0:t.toLowerCase())||"";return d.includes("mobile")||d.includes("android")||d.includes("iphone")?e.jsx(he,{className:`${a} text-primary`}):d.includes("tablet")||d.includes("ipad")?e.jsx(St,{className:`${a} text-secondary`}):e.jsx(Tt,{className:`${a} text-default-500`})},K=t=>{const a=(t==null?void 0:t.toLowerCase())||"";return a.includes("mobile")||a.includes("android")||a.includes("iphone")?"Mobile Device":a.includes("tablet")||a.includes("ipad")?"Tablet":"Desktop"},w=(t,a,d)=>{O(l=>({...l,[`${t}-${a}`]:d}))},j=(t,a)=>q[`${t}-${a}`]||!1;async function R(t,a){w(t,"role",!0);const d=new Promise(async(l,f)=>{var C;try{const _=await axios.post(route("user.updateRole",{id:t}),{roles:a});_.status===200&&(G&&G(t,a),l([_.data.message||"Role updated successfully"]))}catch(_){((C=_.response)==null?void 0:C.status)===422?f(_.response.data.errors||["Failed to update user role."]):f(["An unexpected error occurred. Please try again later."])}finally{w(t,"role",!1)}});return y.promise(d,{pending:"Updating employee role...",success:{render({data:l}){return l.join(", ")}},error:{render({data:l}){return Array.isArray(l)?l.join(", "):l}}}),d}const J=n.useMemo(()=>{const t=[{name:"#",uid:"sl"},{name:"USER",uid:"user"},{name:"EMAIL",uid:"email"},{name:"DEPARTMENT",uid:"department"},{name:"DEVICE STATUS",uid:"device_status"},{name:"STATUS",uid:"status"},{name:"ROLES",uid:"roles"},{name:"ACTIONS",uid:"actions"}];if(!h&&!S)t.splice(3,0,{name:"PHONE",uid:"phone"});else if(h)t.splice(t.findIndex(a=>a.uid==="department"),1),t.splice(t.findIndex(a=>a.uid==="device_status"),1);else if(S){const a=t.findIndex(d=>d.uid==="device_status");if(a>-1){const d=t.splice(a,1)[0];t.splice(2,0,d)}}return t},[h,S]),N=async(t,a)=>{if(!j(t,"status")){w(t,"status",!0);try{$?($(t,!a),y.success(`User status ${a?"deactivated":"activated"} successfully`)):U&&(U(d=>d.map(l=>l.id===t?{...l,active:!a}:l)),y.success(`User status ${a?"deactivated":"activated"} successfully`))}catch(d){console.error("Error toggling user status:",d),y.error("Failed to update user status")}finally{w(t,"status",!1)}}},u=(t,a,d)=>{var f;const l=t[a];switch(a){case"sl":const B=(b!=null&&b.currentPage&&(b!=null&&b.perPage)?Number((b.currentPage-1)*b.perPage):0)+(typeof d=="number"?d:0)+1;return e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-content1/20 backdrop-blur-md rounded-lg border border-divider",children:e.jsx("span",{className:"text-sm font-semibold text-foreground",children:B})})});case"user":return e.jsx(ht,{className:"w-fit max-w-full",avatarProps:{radius:"lg",size:"sm",src:(t==null?void 0:t.profile_image_url)||(t==null?void 0:t.profile_image),showFallback:!0,name:(t==null?void 0:t.name)||"Unnamed User",isBordered:!0},name:e.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:(t==null?void 0:t.name)||"Unnamed User"})});case"email":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ut,{className:"w-4 h-4 text-default-400 mr-2"}),e.jsx("span",{className:"text-sm",children:t.email})]});case"phone":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(dt,{className:"w-4 h-4 text-default-400 mr-2"}),e.jsx("span",{className:"text-sm",children:t.phone||"N/A"})]});case"department":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"w-4 h-4 text-default-400 mr-2"}),e.jsx("span",{className:"text-sm",children:(t==null?void 0:t.department)||"N/A"})]});case"device_status":const F=j(t.id,"deviceToggle");return e.jsx("div",{className:"flex items-center space-x-2",children:t.single_device_login?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:"sm",variant:"flat",color:t.active_device?"warning":"success",startContent:F?e.jsx("div",{className:"animate-spin",children:e.jsx(X,{className:"w-3 h-3"})}):t.active_device?e.jsx(xe,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"}),children:F?"Loading...":t.active_device?"Locked":"Free"}),t.active_device&&!F&&e.jsx(It,{content:e.jsxs("div",{className:"bg-content1/20 backdrop-blur-md border border-divider rounded-lg p-4 shadow-2xl max-w-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[x(t.active_device.user_agent,"w-5 h-5"),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-foreground text-sm",children:t.active_device.device_name||"Unknown Device"}),e.jsx("div",{className:"text-xs text-default-500",children:K(t.active_device.user_agent)})]})]}),e.jsx("div",{className:"space-y-2 text-xs",children:e.jsx("div",{className:"pt-2 mt-2 border-t border-white/20",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ot,{className:"w-3 h-3 text-success"}),e.jsx("span",{className:"text-success text-xs font-medium",children:t.active_device.is_active?"Currently Active":"Inactive"})]})})})]}),placement:"top",classNames:{content:"p-0 bg-transparent shadow-none border-none"},children:e.jsx("div",{className:"flex items-center p-1 rounded-sm hover:bg-content1/10 transition-colors cursor-default",children:x(t.active_device.user_agent,"w-4 h-4")})})]}):e.jsx(z,{size:"sm",variant:"flat",color:"default",startContent:F?e.jsx("div",{className:"animate-spin",children:e.jsx(X,{className:"w-3 h-3"})}):e.jsx(ne,{className:"w-3 h-3"}),children:F?"Loading...":"Disabled"})});case"status":return e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:t.active,onChange:()=>N(t.id,t.active),disabled:j(t.id,"status")}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-hidden peer-focus:ring-4 peer-focus:ring-opacity-30 rounded-full peer transition-all duration-300 ${t.active?"bg-green-500 peer-focus:ring-green-300":"bg-red-500 peer-focus:ring-red-300"} peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all`}),j(t.id,"status")&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),e.jsx("span",{className:"ml-2 text-xs",children:t.active?"Active":"Inactive"})]});case"roles":const re=((f=t.roles)==null?void 0:f.map(v=>typeof v=="object"&&v!==null?v.name:v))||[],ie=new Set(re),ee=Array.from(ie).join(", ")||"No Roles";return e.jsx("div",{className:"flex items-center",children:e.jsxs(et,{isDisabled:j(t.id,"role"),className:"max-w-[220px]",children:[e.jsx(tt,{children:e.jsx(H,{className:"capitalize",variant:"bordered",size:"sm",startContent:j(t.id,"role")?e.jsx(Ze,{size:"sm"}):null,children:ee})}),e.jsx(st,{disallowEmptySelection:!1,"aria-label":"Multiple selection example",closeOnSelect:!1,selectedKeys:ie,selectionMode:"multiple",variant:"flat",onSelectionChange:v=>{const te=Array.from(v);R(t.id,te)},children:(A||[]).map(v=>e.jsx(Q,{children:typeof v=="object"&&v!==null?v.name:v},typeof v=="object"&&v!==null?v.name:v))})]})});case"actions":return e.jsx("div",{className:"flex justify-center items-center",children:e.jsxs(et,{children:[e.jsx(tt,{children:e.jsx(H,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",children:e.jsx(ct,{className:"w-4 h-4"})})}),e.jsxs(st,{"aria-label":"User Actions",children:[e.jsx(Q,{textValue:"View Profile",href:route("profile",{user:t.id}),as:Ke,className:"text-blue-500",startContent:e.jsx(ce,{className:"w-4 h-4"}),children:"View Profile"}),e.jsx(Q,{textValue:"Edit User",onPress:()=>{M&&M(t)},className:"text-amber-500",startContent:e.jsx(mt,{className:"w-4 h-4"}),children:"Edit"}),e.jsx(Q,{textValue:"Device Toggle",onPress:()=>{P&&!j(t.id,"deviceToggle")&&(w(t.id,"deviceToggle",!0),P(t.id,!t.single_device_login).finally(()=>{w(t.id,"deviceToggle",!1)}))},isDisabled:E[t.id]||j(t.id,"deviceToggle"),startContent:j(t.id,"deviceToggle")?e.jsx("div",{className:"animate-spin",children:e.jsx(X,{className:"w-4 h-4"})}):t.single_device_login?e.jsx(me,{className:"w-4 h-4"}):e.jsx(xe,{className:"w-4 h-4"}),className:t.single_device_login?"text-orange-500":"text-green-500",children:j(t.id,"deviceToggle")?"Processing...":t.single_device_login?"Disable Device Lock":"Enable Device Lock"}),t.single_device_login&&t.active_device&&e.jsx(Q,{textValue:"Reset Device",onPress:()=>{T&&!j(t.id,"deviceReset")&&(w(t.id,"deviceReset",!0),T(t.id).finally(()=>{w(t.id,"deviceReset",!1)}))},isDisabled:E[t.id]||j(t.id,"deviceReset"),startContent:j(t.id,"deviceReset")?e.jsx("div",{className:"animate-spin",children:e.jsx(X,{className:"w-4 h-4"})}):e.jsx(X,{className:"w-4 h-4"}),className:"text-red-500",children:j(t.id,"deviceReset")?"Resetting...":"Reset Device"}),e.jsx(Q,{textValue:"View Devices",href:route("users.device.show",{user:t.id}),as:Ke,startContent:e.jsx(he,{className:"w-4 h-4"}),className:"text-blue-500",children:"View Device History"})]})]})});default:return l}},L=()=>!r||!k||m?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-divider bg-content1/50 backdrop-blur-md",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(b.currentPage-1)*b.perPage+1," to ",Math.min(b.currentPage*b.perPage,k)," of ",k," users"]}),e.jsx(xt,{total:Math.ceil(k/b.perPage),initialPage:b.currentPage,page:b.currentPage,onChange:I,size:h?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-content1/20 backdrop-blur-md border-divider hover:bg-content1/30",cursor:"bg-content1/40 backdrop-blur-md border-divider"}})]});return e.jsxs("div",{className:"w-full overflow-hidden flex flex-col border border-divider rounded-lg bg-content1/10 backdrop-blur-md",style:{maxHeight:"calc(100vh - 200px)"},children:[e.jsx("div",{className:"overflow-auto grow relative table-scroll-container frozen-column-container",children:e.jsxs($t,{"aria-label":"Users table",removeWrapper:!0,selectionMode:"none",isCompact:h,classNames:{base:"bg-transparent min-w-[800px]",wrapper:"p-0 bg-transparent shadow-none",th:"backdrop-blur-md text-default-500 border-b border-divider font-medium text-xs sticky top-0 z-30 shadow-xs bg-content1/20",td:"border-b border-divider/50 py-3 group-aria-[selected=false]:group-data-[hover=true]:before:bg-default-100",table:"border-collapse",thead:"sticky top-0 z-30",tbody:"divide-y divide-divider/50",tr:"group outline-none tap-highlight-transparent data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 data-[selected=true]:bg-default-100",emptyWrapper:"text-center h-32",loadingWrapper:"h-32"},children:[e.jsx(Lt,{columns:J,children:t=>e.jsx(zt,{align:t.uid==="actions"||t.uid==="sl"?"center":"start",width:t.uid==="sl"?60:t.uid==="user"?240:void 0,className:t.uid==="sl"?"sticky-header-sl backdrop-blur-md":t.uid==="user"?"sticky-header-user backdrop-blur-md":"backdrop-blur-md sticky top-0 z-30",children:t.name},t.uid)}),e.jsx(Dt,{items:r||[],emptyContent:"No users found",loadingContent:e.jsx(Ze,{}),isLoading:m,children:(t,a)=>{const d=r?r.findIndex(l=>l.id===t.id):a;return e.jsx(At,{className:"table-row-hover",children:l=>e.jsx(Et,{className:l==="sl"?"frozen-column sticky left-0 z-20 backdrop-blur-md border-r border-divider/30":l==="user"?"frozen-column-user sticky z-20 backdrop-blur-md border-r border-divider/30":"",style:l==="user"?{left:"60px"}:{},children:u(t,l,d)})},t.id)}})]})}),L()]})},nt=({user:r,allUsers:A,departments:h,designations:S,setUsers:U,open:b,closeModal:I,editMode:p=!1})=>{const[k,M]=n.useState(!1),[m,Z]=n.useState({id:(r==null?void 0:r.id)||"",name:(r==null?void 0:r.name)||"",user_name:(r==null?void 0:r.user_name)||"",gender:(r==null?void 0:r.gender)||"",birthday:(r==null?void 0:r.birthday)||"",date_of_joining:(r==null?void 0:r.date_of_joining)||"",address:(r==null?void 0:r.address)||"",employee_id:(r==null?void 0:r.employee_id)||"",phone:(r==null?void 0:r.phone)||"",email:(r==null?void 0:r.email)||"",department_id:(r==null?void 0:r.department_id)||"",designation_id:(r==null?void 0:r.designation_id)||"",report_to:(r==null?void 0:r.report_to)||"",password:"",confirmPassword:"",roles:(r==null?void 0:r.roles)||[]}),[o,$]=n.useState({}),[G,P]=n.useState(!1),[T,E]=n.useState(!1),[q,O]=n.useState((r==null?void 0:r.profile_image_url)||(r==null?void 0:r.profile_image)||null),[x,K]=n.useState(null),[w,j]=n.useState(A);n.useEffect(()=>{(r!=null&&r.profile_image_url||r!=null&&r.profile_image)&&O(r.profile_image_url||r.profile_image)},[r]);const R=async t=>{var d;t.preventDefault(),P(!0);const a=new FormData;if(Object.keys(m).forEach(l=>{l==="roles"&&Array.isArray(m[l])?m[l].forEach((f,C)=>{a.append(`roles[${C}]`,f)}):m[l]!==null&&m[l]!==void 0&&a.append(l,m[l])}),x){const l=x.type;if(["image/jpeg","image/jpg","image/png"].includes(l))a.append("profile_image",x);else{y.error("Invalid file type. Only JPEG and PNG are allowed.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}),P(!1);return}}try{const l=p?route("updateUser",{id:r.id}):route("addUser"),f=p?"put":"post",C=await axios[f](l,a);C.status===200&&(U&&U(p?_=>_.map(B=>B.id===C.data.user.id?C.data.user:B):_=>[..._,C.data.user]),y.success(((d=C.data.messages)==null?void 0:d.length)>0?C.data.messages.join(" "):`User ${p?"updated":"added"} successfully`,{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}),I())}catch(l){P(!1),J(l)}finally{P(!1)}},J=t=>{t.response?t.response.status===422?($(t.response.data.errors||{}),y.error(t.response.data.error||`Failed to ${p?"update":"add"} user.`,{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}})):y.error("An unexpected error occurred. Please try again later.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}):t.request?y.error("No response received from the server. Please check your internet connection.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}):y.error("An error occurred while setting up the request.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}})},N=t=>{const a=t.target.files[0];if(a){const d=URL.createObjectURL(a);O(d),K(a)}},u=(t,a)=>{Z(d=>({...d,[t]:a})),o[t]&&$(d=>{const l={...d};return delete l[t],l})},L=()=>{M(!k)};return e.jsxs(wt,{open:b,onClose:I,fullWidth:!0,maxWidth:"md",sx:{"& .MuiPaper-root":{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:theme.glassCard.background,border:theme.glassCard.border,borderRadius:"16px",color:theme.palette.text.primary,boxShadow:theme.glassCard.boxShadow}},children:[e.jsx(DialogTitle,{sx:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",pb:2},children:e.jsxs(Box,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(Typography,{variant:"h6",component:"div",sx:{fontWeight:600},children:p?"Edit User":"Add New User"}),e.jsx(IconButton,{"aria-label":"close",onClick:I,sx:{color:theme.palette.grey[500],"&:hover":{color:theme.palette.primary.main}},children:e.jsx(ClearIcon,{})})]})}),e.jsx(DialogContent,{sx:{pt:3},children:e.jsx("form",{onSubmit:R,children:e.jsxs(Grid,{container:!0,spacing:3,children:[e.jsx(Grid,{item:!0,xs:12,sx:{display:"flex",justifyContent:"center",mb:2},children:e.jsxs(Box,{onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),sx:{position:"relative"},children:[e.jsx(Nt,{src:q,alt:"Profile",sx:{width:120,height:120,border:"4px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",filter:T?"brightness(70%)":"brightness(100%)",transition:"all 0.3s ease"}}),e.jsxs(Box,{component:"label",htmlFor:"icon-button-file",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",opacity:T?1:0,transition:"opacity 0.3s ease",cursor:"pointer"},children:[e.jsx("input",{accept:"image/*",id:"icon-button-file",type:"file",style:{display:"none"},onChange:N}),e.jsx(PhotoCamera,{sx:{color:"white",fontSize:32}})]})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Full Name",value:m.name,onChange:t=>u("name",t.target.value),error:!!o.name,helperText:o.name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}},required:!0})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Username",value:m.user_name,onChange:t=>u("user_name",t.target.value),error:!!o.user_name,helperText:o.user_name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}},required:!0})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Email",type:"email",value:m.email,onChange:t=>u("email",t.target.value),error:!!o.email,helperText:o.email,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}},required:!0})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Phone",value:m.phone,onChange:t=>u("phone",t.target.value),error:!!o.phone,helperText:o.phone,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"department-label",sx:{color:theme.palette.text.secondary},children:"Department"}),e.jsxs(Y,{labelId:"department-label",value:m.department_id,onChange:t=>u("department_id",t.target.value),label:"Department",error:!!o.department_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"None"})}),h==null?void 0:h.map(t=>e.jsx(MenuItem,{value:t.id,children:t.name},t.id))]}),o.department_id&&e.jsx(FormHelperText,{error:!0,children:o.department_id})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"designation-label",sx:{color:theme.palette.text.secondary},children:"Designation"}),e.jsxs(Y,{labelId:"designation-label",value:m.designation_id,onChange:t=>u("designation_id",t.target.value),label:"Designation",error:!!o.designation_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"None"})}),S==null?void 0:S.map(t=>e.jsx(MenuItem,{value:t.id,children:t.name},t.id))]}),o.designation_id&&e.jsx(FormHelperText,{error:!0,children:o.designation_id})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"gender-label",sx:{color:theme.palette.text.secondary},children:"Gender"}),e.jsxs(Y,{labelId:"gender-label",value:m.gender,onChange:t=>u("gender",t.target.value),label:"Gender",error:!!o.gender,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"Select Gender"})}),e.jsx(MenuItem,{value:"male",children:"Male"}),e.jsx(MenuItem,{value:"female",children:"Female"}),e.jsx(MenuItem,{value:"other",children:"Other"})]}),o.gender&&e.jsx(FormHelperText,{error:!0,children:o.gender})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Employee ID",value:m.employee_id,onChange:t=>u("employee_id",t.target.value),error:!!o.employee_id,helperText:o.employee_id,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Date of Birth",type:"date",value:m.birthday,onChange:t=>u("birthday",t.target.value),error:!!o.birthday,helperText:o.birthday,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Date of Joining",type:"date",value:m.date_of_joining,onChange:t=>u("date_of_joining",t.target.value),error:!!o.date_of_joining,helperText:o.date_of_joining,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"report-to-label",sx:{color:theme.palette.text.secondary},children:"Reports To"}),e.jsxs(Y,{labelId:"report-to-label",value:m.report_to,onChange:t=>u("report_to",t.target.value),label:"Reports To",error:!!o.report_to,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"None"})}),w==null?void 0:w.filter(t=>t.id!==m.id).map(t=>e.jsx(MenuItem,{value:t.id,children:t.name},t.id))]}),o.report_to&&e.jsx(FormHelperText,{error:!0,children:o.report_to})]})}),e.jsx(Grid,{item:!0,xs:12,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Address",multiline:!0,rows:3,value:m.address,onChange:t=>u("address",t.target.value),error:!!o.address,helperText:o.address,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),!p&&e.jsxs(e.Fragment,{children:[e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Password",type:k?"text":"password",value:m.password,onChange:t=>u("password",t.target.value),error:!!o.password,helperText:o.password,required:!p,InputProps:{endAdornment:e.jsx(IconButton,{"aria-label":"toggle password visibility",onClick:L,edge:"end",children:k?e.jsx(VisibilityOff,{}):e.jsx(Visibility,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Confirm Password",type:k?"text":"password",value:m.confirmPassword,onChange:t=>u("confirmPassword",t.target.value),error:!!o.confirmPassword,helperText:o.confirmPassword||(m.password!==m.confirmPassword&&m.confirmPassword?"Passwords do not match":""),required:!p,InputProps:{endAdornment:e.jsx(IconButton,{"aria-label":"toggle password visibility",onClick:L,edge:"end",children:k?e.jsx(VisibilityOff,{}):e.jsx(Visibility,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})})]})]})})}),e.jsxs(DialogActions,{sx:{justifyContent:"space-between",p:3,borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(H,{onClick:I,variant:"bordered",color:"default",size:"lg",className:"bg-white/5 hover:bg-white/10 border border-white/10",children:"Cancel"}),e.jsx(LoadingButton,{onClick:R,loading:G,loadingPosition:"start",startIcon:e.jsx(PasswordIcon,{}),variant:"contained",sx:{background:"linear-gradient(45deg, #3a7bd5 0%, #2456bd 100%)",boxShadow:"0 4px 20px 0 rgba(58, 123, 213, 0.4)","&:hover":{background:"linear-gradient(45deg, #2456bd 0%, #1a3c8a 100%)"}},children:p?"Update User":"Add User"})]})]})},Xt=({title:r,roles:A})=>{var ge,be,fe,ve,je,ye,we,Ne,_e,Ce,ke,Fe,Pe,Re,Ie,Te,Se,Ue,$e,De,Ae,Ee,Le,ze,Me,Ge,Oe;const[h,S]=n.useState(!1),[U,b]=n.useState(!1);n.useEffect(()=>{const s=()=>{S(window.innerWidth<640),b(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const[I,p]=n.useState([]),[k,M]=n.useState(!0),[m,Z]=n.useState(null),[o,$]=n.useState(0),[G,P]=n.useState(1),[T,E]=n.useState(null),[q,O]=n.useState({}),[x,K]=n.useState({search:"",role:"all",status:"all",department:"all"}),[w,j]=n.useState(!1),[R,J]=n.useState("table"),[N,u]=n.useState({currentPage:1,perPage:10,total:I.length}),[L,t]=n.useState({}),[a,d]=n.useState({overview:{total_users:0,active_users:0,inactive_users:0,deleted_users:0,total_roles:0,total_departments:0},distribution:{by_role:[],by_department:[],by_status:[]},activity:{recent_registrations:{new_users_30_days:0,new_users_90_days:0,new_users_year:0,recently_active:0},user_growth_rate:0,current_month_registrations:0},security:{access_metrics:{users_with_roles:0,users_without_roles:0,admin_users:0,regular_users:0},role_distribution:[]},health:{status_ratio:{active_percentage:0,inactive_percentage:0,deleted_percentage:0},system_metrics:{user_activation_rate:0,role_coverage:0,department_coverage:0}},quick_metrics:{total_users:0,active_ratio:0,role_diversity:0,department_diversity:0,recent_activity:0,system_health_score:0}}),l=n.useMemo(()=>({data:I,total:o,current_page:N.currentPage,per_page:N.perPage,last_page:G}),[I,o,N.currentPage,N.perPage,G]),f=n.useCallback(async()=>{try{const{data:s}=await se.get(route("users.stats"));s.stats&&d(s.stats)}catch(s){console.error("Error fetching user stats:",s)}},[]),C=n.useCallback((s,i)=>{O(c=>({...c,[i]:s.currentTarget}))},[]),_=n.useCallback(s=>{O(i=>({...i,[s]:null}))},[]),B=n.useCallback(async()=>{M(!0);try{const s=await se.get(route("users.paginate"),{params:{page:N.currentPage,perPage:N.perPage,search:x.search||void 0,role:x.role!=="all"?x.role:void 0,status:x.status!=="all"?x.status:void 0,department:x.department!=="all"?x.department:void 0}});if(s.status===200){const{users:i}=s.data;i.data&&Array.isArray(i.data)?(p(i.data),$(i.total||i.data.length),P(i.last_page||1)):Array.isArray(i)?(p(i),$(i.length),P(1)):(console.error("Unexpected users data format:",i),p([]),$(0),P(1))}}catch(s){console.error("Error fetching users:",s),y.error("Failed to load users data"),p([])}finally{M(!1)}},[x,N.currentPage,N.perPage]);n.useEffect(()=>{B()},[B]),n.useEffect(()=>{f();const s=setInterval(f,6e4);return()=>clearInterval(s)},[f]);const F=(s,i)=>{K(c=>({...c,[s]:i})),u(c=>({...c,currentPage:1}))},re=s=>{u(i=>({...i,currentPage:s})),window.scrollTo({top:0,behavior:"smooth"})},ie=s=>{u(i=>({...i,currentPage:1,perPage:s}))},ee=n.useCallback((s,i=null)=>{E(s),Z(i)},[]),v=n.useCallback(()=>{E(null),Z(null)},[]),te=n.useCallback(s=>{p(s)},[]),pt=n.useCallback(s=>{p(i=>i.map(c=>c.id===s.id?{...c,...s}:c))},[]),ut=n.useCallback(s=>{p(i=>i.filter(c=>c.id!==s)),f()},[f]),gt=n.useCallback((s,i)=>{p(c=>c.map(g=>g.id===s?{...g,active:i}:g)),f()},[f]),bt=n.useCallback((s,i)=>{p(c=>c.map(g=>g.id===s?{...g,roles:i}:g)),f()},[f]),pe=n.useCallback(async(s,i)=>{t(c=>({...c,[s]:!0}));try{(await se.post(route("users.device.toggle"),{user_id:s,enabled:i})).status===200&&(p(g=>g.map(D=>D.id===s?{...D,single_device_login:i,active_device:i?D.active_device:null}:D)),y.success(i?"Single device login enabled for user":"Single device login disabled for user"))}catch(c){console.error("Error toggling single device login:",c),y.error("Failed to update device settings")}finally{t(c=>({...c,[s]:!1}))}},[]),ue=n.useCallback(async s=>{t(i=>({...i,[s]:!0}));try{(await se.post(route("users.device.reset"),{user_id:s})).status===200&&(p(c=>c.map(g=>g.id===s?{...g,active_device:null}:g)),y.success("User device has been reset"))}catch(i){console.error("Error resetting user device:",i),y.error("Failed to reset user device")}finally{t(i=>({...i,[s]:!1}))}},[]);n.useCallback(async s=>{try{const i=await se.get(route("users.device.list",{user:s}));if(i.status===200){const c=i.data.devices;y.info(`User has ${c.length} device record(s)`)}}catch(i){console.error("Error fetching user devices:",i),y.error("Failed to fetch device information")}},[]);const ft=({user:s,index:i})=>{var c;return e.jsx(W,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 transition-all duration-200 cursor-pointer h-full",onPress:()=>oe.visit(route("profile",{user:s.id})),children:e.jsxs(V,{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3 pb-3 border-b border-white/10",children:[e.jsx(ht,{avatarProps:{radius:"lg",src:(s==null?void 0:s.profile_image_url)||(s==null?void 0:s.profile_image),size:"md",fallback:e.jsx(ce,{className:"w-5 h-5"})},classNames:{name:"font-semibold text-foreground text-sm",description:"text-default-500 text-xs"}}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground text-sm line-clamp-1",children:s.name}),e.jsx("p",{className:"text-default-500 text-xs",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>{oe.visit(route("profile",{user:s.id}))},children:e.jsx(mt,{className:"w-4 h-4"})}),e.jsx(IconButton,{size:"small",onClick:g=>C(g,`device-menu-${s.id}`),sx:{color:"rgba(255, 255, 255, 0.6)","&:hover":{color:"rgba(255, 255, 255, 0.9)",backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:e.jsx(ct,{className:"w-4 h-4"})}),e.jsxs(Menu,{anchorEl:q[`device-menu-${s.id}`],open:!!q[`device-menu-${s.id}`],onClose:()=>_(`device-menu-${s.id}`),sx:{"& .MuiPaper-root":{backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(16px)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px",minWidth:"200px"},"& .MuiMenuItem-root":{color:"rgba(255, 255, 255, 0.9)",padding:"8px 16px","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.15)"},"&.Mui-disabled":{color:"rgba(255, 255, 255, 0.3)"}}},children:[e.jsxs(MenuItem,{onClick:()=>{_(`device-menu-${s.id}`),pe(s.id,!s.single_device_login)},disabled:L[s.id],sx:{gap:1},children:[s.single_device_login?e.jsx(me,{className:"w-4 h-4"}):e.jsx(xe,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{children:s.single_device_login?"Disable Device Lock":"Enable Device Lock"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)"},children:s.single_device_login?"Disable device restriction":"Enable device restriction"})]})]}),s.single_device_login&&s.active_device&&e.jsxs(MenuItem,{onClick:()=>{_(`device-menu-${s.id}`),ue(s.id)},disabled:L[s.id],sx:{gap:1},children:[e.jsx(X,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{children:"Reset Device"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)"},children:"Allow login from new device"})]})]}),e.jsxs(MenuItem,{onClick:()=>{_(`device-menu-${s.id}`),oe.visit(route("users.device.show",{user:s.id}))},sx:{gap:1},children:[e.jsx(he,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{children:"View Devices"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)"},children:"View device history"})]})]})]})]})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[s.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(dt,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs line-clamp-1",children:s.phone})]}),(s.department||s.department_id)&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(le,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs",children:typeof s.department=="string"?s.department:"N/A"})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10 flex flex-wrap gap-2",children:[e.jsx(z,{size:"sm",variant:s.active?"solid":"bordered",color:s.active?"success":"danger",className:"text-xs",startContent:s.active?e.jsx(rt,{className:"w-3 h-3"}):e.jsx(it,{className:"w-3 h-3"}),children:s.active?"Active":"Inactive"}),(c=s.roles)==null?void 0:c.map((g,D)=>e.jsx(z,{size:"sm",variant:"flat",color:"secondary",className:"text-xs",startContent:e.jsx(ce,{className:"w-3 h-3"}),children:g},D)),s.single_device_login&&e.jsx(z,{size:"sm",variant:"flat",color:s.active_device?"warning":"default",className:"text-xs",startContent:e.jsx(ne,{className:"w-3 h-3"}),children:s.active_device?"Device Locked":"Device Free"})]})]})})},vt=n.useMemo(()=>{var s,i,c,g,D,Be,We,Ve,He,qe,Je,Qe,Xe,Ye;return[{title:"Total Users",value:((s=a==null?void 0:a.overview)==null?void 0:s.total_users)||0,icon:e.jsx(de,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All users"},{title:"Active Users",value:((i=a==null?void 0:a.overview)==null?void 0:i.active_users)||0,icon:e.jsx(rt,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:`${((g=(c=a==null?void 0:a.health)==null?void 0:c.status_ratio)==null?void 0:g.active_percentage)||0}% Active`},{title:"Inactive Users",value:((D=a==null?void 0:a.overview)==null?void 0:D.inactive_users)||0,icon:e.jsx(it,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:`${((We=(Be=a==null?void 0:a.health)==null?void 0:Be.status_ratio)==null?void 0:We.inactive_percentage)||0}% Inactive`},{title:"Total Roles",value:((Ve=a==null?void 0:a.overview)==null?void 0:Ve.total_roles)||0,icon:e.jsx(ne,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Role diversity"},{title:"Role Coverage",value:`${((qe=(He=a==null?void 0:a.health)==null?void 0:He.system_metrics)==null?void 0:qe.role_coverage)||0}%`,icon:e.jsx(Mt,{className:"w-5 h-5"}),color:"text-emerald-400",iconBg:"bg-emerald-500/20",description:"Users with roles"},{title:"Recent Activity",value:((Qe=(Je=a==null?void 0:a.activity)==null?void 0:Je.recent_registrations)==null?void 0:Qe.recently_active)||0,icon:e.jsx(ot,{className:"w-5 h-5"}),color:"text-cyan-400",iconBg:"bg-cyan-500/20",description:"Active last 7 days"},{title:"System Health",value:`${((Xe=a==null?void 0:a.quick_metrics)==null?void 0:Xe.system_health_score)||0}%`,icon:e.jsx(at,{className:"w-5 h-5"}),color:"text-pink-400",iconBg:"bg-pink-500/20",description:"Overall health"},{title:"Departments",value:((Ye=a==null?void 0:a.overview)==null?void 0:Ye.total_departments)||0,icon:e.jsx(le,{className:"w-5 h-5"}),color:"text-indigo-400",iconBg:"bg-indigo-500/20",description:"Department diversity"}]},[a]),jt=n.useMemo(()=>{const s=[];return s.push({label:h?"Add":"Add User",icon:e.jsx(Gt,{className:"w-4 h-4"}),onPress:()=>ee("add"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),s.push({label:h?"":"Export",isIconOnly:h,icon:e.jsx(lt,{className:"w-4 h-4"}),variant:"bordered",className:"border-[rgba(var(--theme-primary-rgb),0.3)] bg-[rgba(var(--theme-primary-rgb),0.05)] hover:bg-[rgba(var(--theme-primary-rgb),0.1)]"}),s},[h,ee]);return e.jsxs(e.Fragment,{children:[e.jsx(yt,{title:r}),T==="add"&&e.jsx(nt,{user:null,open:T==="add",setUsers:te,closeModal:v,editMode:!1}),T==="edit"&&m&&e.jsx(nt,{user:m,open:T==="edit",setUsers:te,closeModal:v,editMode:!0}),e.jsx(Box,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(Grow,{in:!0,children:e.jsx(Ft,{children:e.jsx(Pt,{title:"Users Management",subtitle:"Manage users accounts and roles",icon:e.jsx(de,{className:"w-8 h-8"}),actionButtons:jt,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(Rt,{stats:vt,className:"mb-6"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mb-6",children:[e.jsx(W,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(V,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(Ot,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"Role Distribution"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"User roles breakdown"})]})]}),e.jsx("div",{className:"space-y-3",children:(be=(ge=a==null?void 0:a.distribution)==null?void 0:ge.by_role)==null?void 0:be.slice(0,5).map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-linear-to-r from-purple-400 to-pink-400"}),e.jsx("span",{className:"text-sm text-foreground truncate",children:s.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:s.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",children:["(",s.percentage,"%)"]})]})]},i))})]})}),e.jsx(W,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(V,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(le,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"Department Distribution"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"Users by department"})]})]}),e.jsx("div",{className:"space-y-3",children:(ve=(fe=a==null?void 0:a.distribution)==null?void 0:fe.by_department)==null?void 0:ve.slice(0,5).map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-linear-to-r from-blue-400 to-cyan-400"}),e.jsx("span",{className:"text-sm text-foreground truncate",children:s.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:s.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",children:["(",s.percentage,"%)"]})]})]},i))})]})}),e.jsx(W,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(V,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e.jsx(ne,{className:"w-5 h-5 text-red-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"Security Metrics"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"Access control overview"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Users with Roles"}),e.jsx("span",{className:"text-sm font-medium text-green-400",children:((ye=(je=a==null?void 0:a.security)==null?void 0:je.access_metrics)==null?void 0:ye.users_with_roles)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Users without Roles"}),e.jsx("span",{className:"text-sm font-medium text-red-400",children:((Ne=(we=a==null?void 0:a.security)==null?void 0:we.access_metrics)==null?void 0:Ne.users_without_roles)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Admin Users"}),e.jsx("span",{className:"text-sm font-medium text-orange-400",children:((Ce=(_e=a==null?void 0:a.security)==null?void 0:_e.access_metrics)==null?void 0:Ce.admin_users)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Role Coverage"}),e.jsxs("span",{className:"text-sm font-medium text-blue-400",children:[((Fe=(ke=a==null?void 0:a.health)==null?void 0:ke.system_metrics)==null?void 0:Fe.role_coverage)||0,"%"]})]})]})]})}),e.jsx(W,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(V,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(lt,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"Activity Trends"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"Recent user activity"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Recently Active"}),e.jsx("span",{className:"text-sm font-medium text-green-400",children:((Re=(Pe=a==null?void 0:a.activity)==null?void 0:Pe.recent_registrations)==null?void 0:Re.recently_active)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"New (30 days)"}),e.jsx("span",{className:"text-sm font-medium text-blue-400",children:((Te=(Ie=a==null?void 0:a.activity)==null?void 0:Ie.recent_registrations)==null?void 0:Te.new_users_30_days)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"New (90 days)"}),e.jsx("span",{className:"text-sm font-medium text-cyan-400",children:((Ue=(Se=a==null?void 0:a.activity)==null?void 0:Se.recent_registrations)==null?void 0:Ue.new_users_90_days)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Growth Rate"}),e.jsxs("span",{className:"text-sm font-medium text-purple-400",children:[(($e=a==null?void 0:a.activity)==null?void 0:$e.user_growth_rate)||0,"%"]})]})]})]})}),e.jsx(W,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(V,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-teal-500/20 rounded-lg",children:e.jsx(at,{className:"w-5 h-5 text-teal-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"System Health"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"Overall system metrics"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Health Score"}),e.jsxs("span",{className:"text-sm font-medium text-teal-400",children:[((De=a==null?void 0:a.quick_metrics)==null?void 0:De.system_health_score)||0,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Activation Rate"}),e.jsxs("span",{className:"text-sm font-medium text-green-400",children:[((Ee=(Ae=a==null?void 0:a.health)==null?void 0:Ae.system_metrics)==null?void 0:Ee.user_activation_rate)||0,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Dept. Coverage"}),e.jsxs("span",{className:"text-sm font-medium text-blue-400",children:[((ze=(Le=a==null?void 0:a.health)==null?void 0:Le.system_metrics)==null?void 0:ze.department_coverage)||0,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Total Departments"}),e.jsx("span",{className:"text-sm font-medium text-purple-400",children:((Me=a==null?void 0:a.overview)==null?void 0:Me.total_departments)||0})]})]})]})}),e.jsx(W,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(V,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(Bt,{className:"w-5 h-5 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"Status Breakdown"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"User status distribution"})]})]}),e.jsx("div",{className:"space-y-3",children:(Oe=(Ge=a==null?void 0:a.distribution)==null?void 0:Ge.by_status)==null?void 0:Oe.map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s.name==="Active"?"bg-green-400":s.name==="Inactive"?"bg-red-400":"bg-gray-400"}`}),e.jsx("span",{className:"text-sm text-foreground",children:s.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:s.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",children:["(",s.percentage,"%)"]})]})]},i))})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(qt,{placeholder:"Search by name, email or phone...",value:x.search,onChange:s=>F("search",s.target.value),startContent:e.jsx(_t,{className:"w-4 h-4",style:{color:"var(--theme-foreground-400, #71717A)"}}),variant:"bordered",size:h?"sm":"md",style:{borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs(Jt,{variant:"bordered",className:"bg-white/5",children:[e.jsxs(H,{isIconOnly:h,color:R==="table"?"primary":"default",onPress:()=>J("table"),className:R==="table"?"bg-blue-500/20":"",children:[e.jsx(Wt,{className:"w-4 h-4"}),!h&&e.jsx("span",{className:"ml-1",children:"Table"})]}),e.jsxs(H,{isIconOnly:h,color:R==="grid"?"primary":"default",onPress:()=>J("grid"),className:R==="grid"?"bg-blue-500/20":"",children:[e.jsx(Ct,{className:"w-4 h-4"}),!h&&e.jsx("span",{className:"ml-1",children:"Grid"})]})]}),e.jsxs(H,{isIconOnly:h,variant:"bordered",onPress:()=>j(!w),className:w?"bg-purple-500/20":"bg-white/5",children:[e.jsx(Vt,{className:"w-4 h-4"}),!h&&e.jsx("span",{className:"ml-1",children:"Filters"})]})]})]}),w&&e.jsx(Ht.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:e.jsxs("div",{className:"mb-6 p-4 backdrop-blur-md rounded-lg border",style:{background:"color-mix(in srgb, var(--theme-content1, #FFFFFF) 5%, transparent)",borderColor:"var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)"},children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(Y,{label:"Status",selectedKeys:x.status?[x.status]:[],onSelectionChange:s=>F("status",Array.from(s)[0]),variant:"bordered",size:"sm",style:{borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(ae,{value:"all",children:"All Statuses"},"all"),e.jsx(ae,{value:"active",children:"Active Only"},"active"),e.jsx(ae,{value:"inactive",children:"Inactive Only"},"inactive")]}),e.jsxs(Y,{label:"Role",selectedKeys:x.role?[x.role]:[],onSelectionChange:s=>F("role",Array.from(s)[0]),variant:"bordered",size:"sm",style:{borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(ae,{value:"all",children:"All Roles"},"all"),A==null?void 0:A.map(s=>e.jsx(ae,{value:s.toLowerCase(),children:s},s.toLowerCase()))]})]}),(x.search||x.status!=="all"||x.role!=="all")&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t",style:{borderColor:"var(--theme-divider, #E4E4E7)"},children:[x.search&&e.jsxs(z,{variant:"flat",color:"primary",size:"sm",onClose:()=>F("search",""),children:["Search: ",x.search]}),x.status!=="all"&&e.jsxs(z,{variant:"flat",color:"secondary",size:"sm",onClose:()=>F("status","all"),children:["Status: ",x.status==="active"?"Active":"Inactive"]}),x.role!=="all"&&e.jsxs(z,{variant:"flat",color:"warning",size:"sm",onClose:()=>F("role","all"),children:["Role: ",x.role]})]})]})}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsxs(Typography,{variant:"h6",className:"font-semibold text-foreground",children:[R==="table"?"User Table":"User Grid",e.jsxs("span",{className:"text-sm text-default-500 ml-2",children:["(",l.total||0," ",l.total===1?"user":"users",")"]})]})}),k?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(CircularProgress,{size:40}),e.jsx(Typography,{className:"mt-4",color:"textSecondary",children:"Loading users data..."})]}):R==="table"?e.jsx(Qt,{allUsers:l.data,roles:A,setUsers:te,isMobile:h,isTablet:U,pagination:N,onPageChange:re,onRowsPerPageChange:ie,totalUsers:l.total,loading:k,onEdit:s=>ee("edit",s),updateUserOptimized:pt,deleteUserOptimized:ut,toggleUserStatusOptimized:gt,updateUserRolesOptimized:bt,toggleSingleDeviceLogin:pe,resetUserDevice:ue,deviceActions:L}):e.jsxs("div",{className:"p-4",children:[l.data&&l.data.length>0?e.jsx("div",{className:`grid gap-4 ${h?"grid-cols-1":U?"grid-cols-2":"grid-cols-3 xl:grid-cols-4"}`,children:l.data.map((s,i)=>e.jsx(ft,{user:s,index:i},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(de,{className:"w-12 h-12 mx-auto text-default-300 mb-2"}),e.jsx(Typography,{variant:"body1",color:"textSecondary",children:"No users found"}),e.jsx(Typography,{variant:"caption",color:"textSecondary",children:"Try adjusting your search or filters"})]}),l.data&&l.data.length>0&&e.jsx("div",{className:"flex justify-center mt-6 border-t border-white/10 pt-4",children:e.jsx(xt,{total:Math.ceil(l.total/N.perPage),initialPage:N.currentPage,page:N.currentPage,onChange:re,size:h?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})})]})]})]})})})})})]})};Xt.layout=r=>e.jsx(kt,{children:r});export{Xt as default};
