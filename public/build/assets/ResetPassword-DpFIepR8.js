import{h as P,r as m,g as S,j as e,H as V,b as A}from"./app-DVP_m8h7.js";import{A as I}from"./AuthLayout-BBBDwOO-.js";import"./Button-CtZbokJE.js";import{m as t}from"./proxy-BomxYwOG.js";import{F as $}from"./KeyIcon-ClouCyVq.js";import{F as h}from"./EyeSlashIcon-DfSw3Dpa.js";import{F as f}from"./EyeIcon-D700gLzM.js";import{F as w}from"./LockClosedIcon-DW1QPL_h.js";import{F as E}from"./ShieldCheckIcon-CAzrY1qb.js";import{i as u}from"./chunk-SSA7SXE4-C5QhRsCJ.js";import"./logo-D1JCVLgz.js";import"./create-visual-element-DRYypj6G.js";function B({token:g,email:x}){const{data:o,setData:n,post:j,processing:l,errors:r,reset:v}=P({token:g,email:x,verification_code:"",password:"",password_confirmation:""}),[d,b]=m.useState(0),[c,N]=m.useState(!1),[p,C]=m.useState(!1),s=S(),k=a=>{let i=0;return a.length>=8&&(i+=1),/[a-z]/.test(a)&&(i+=1),/[A-Z]/.test(a)&&(i+=1),/[0-9]/.test(a)&&(i+=1),/[^A-Za-z0-9]/.test(a)&&(i+=1),i},F=a=>{const i=a.target.value;n("password",i),b(k(i))},_=()=>{switch(d){case 0:case 1:return"Very weak";case 2:return"Weak";case 3:return"Fair";case 4:return"Good";case 5:return"Strong";default:return""}},y=()=>{switch(d){case 0:case 1:return s.palette.error.main;case 2:return"#f59e0b";case 3:return"#eab308";case 4:return s.palette.primary.main;case 5:return s.palette.success.main;default:return s.palette.grey[300]}},R=a=>{a.preventDefault(),j(route("password.update"),{onFinish:()=>v("password","password_confirmation")})};return e.jsxs(I,{title:"Set new password",subtitle:"Enter the verification code and create a new secure password",children:[e.jsx(V,{title:"Reset Password"}),e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsx(t.div,{className:"p-4 rounded-xl border",style:{background:s.palette.mode==="dark"?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.8)",borderColor:s.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs("p",{className:"text-sm",style:{color:s.palette.text.secondary},children:["Resetting password for: ",e.jsx("span",{className:"font-medium",style:{color:s.palette.text.primary},children:x})]})}),e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(u,{type:"text",label:"Verification code",placeholder:"Enter 6-digit code from email",value:o.verification_code,onChange:a=>n("verification_code",a.target.value),isInvalid:!!r.verification_code,errorMessage:r.verification_code,autoComplete:"one-time-code",autoFocus:!0,maxLength:6,isRequired:!0,startContent:e.jsx($,{className:"w-4 h-4 text-default-400"})}),e.jsx(t.p,{className:"text-xs mt-2",style:{color:s.palette.text.secondary},initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:"Check your email for the 6-digit verification code"})]}),e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs("div",{children:[e.jsx(u,{type:c?"text":"password",label:"New password",placeholder:"Create a strong password",value:o.password,onChange:F,isInvalid:!!r.password,errorMessage:r.password,autoComplete:"new-password",isRequired:!0,startContent:e.jsx(w,{className:"w-4 h-4 text-default-400 pointer-events-none shrink-0"}),endContent:e.jsx("button",{className:"focus:outline-hidden",type:"button",onClick:()=>N(!c),children:c?e.jsx(h,{className:"w-4 h-4 text-default-400 pointer-events-none"}):e.jsx(f,{className:"w-4 h-4 text-default-400 pointer-events-none"})})}),o.password&&e.jsxs(t.div,{className:"mt-3 space-y-2",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.4},children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-1 h-2 rounded-full overflow-hidden",style:{backgroundColor:s.palette.grey[200]},children:e.jsx(t.div,{className:"h-full rounded-full transition-all duration-500",style:{backgroundColor:y()},initial:{width:0},animate:{width:`${d/5*100}%`}})}),e.jsx(t.span,{className:"text-xs font-medium w-20 text-right",style:{color:y()},initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:_()})]}),e.jsx(t.p,{className:"text-xs",style:{color:s.palette.text.secondary},initial:{opacity:0,y:-5},animate:{opacity:1,y:0},transition:{delay:.3},children:"Use 8+ characters with uppercase, lowercase, numbers, and symbols"})]})]})}),e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsx(u,{type:p?"text":"password",label:"Confirm new password",placeholder:"Confirm your new password",value:o.password_confirmation,onChange:a=>n("password_confirmation",a.target.value),isInvalid:!!r.password_confirmation,errorMessage:r.password_confirmation,autoComplete:"new-password",isRequired:!0,startContent:e.jsx(w,{className:"w-4 h-4 text-default-400 pointer-events-none shrink-0"}),endContent:e.jsx("button",{className:"focus:outline-hidden",type:"button",onClick:()=>C(!p),children:p?e.jsx(h,{className:"w-4 h-4 text-default-400 pointer-events-none"}):e.jsx(f,{className:"w-4 h-4 text-default-400 pointer-events-none"})})})}),e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsx(A,{type:"submit",color:"primary",size:"lg",className:"w-full",isLoading:l,disabled:l,children:l?"Updating password...":"Update password"})})]}),e.jsx(t.div,{className:"mt-8 p-4 rounded-xl border",style:{background:"rgba(34, 197, 94, 0.1)",borderColor:"rgba(34, 197, 94, 0.2)",backdropFilter:"blur(10px)"},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(t.div,{className:"shrink-0",initial:{scale:0},animate:{scale:1},transition:{delay:.7,type:"spring",stiffness:500},children:e.jsx(E,{className:"w-5 h-5 text-green-500"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx(t.h3,{className:"text-sm font-medium text-green-800",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.8},children:"Secure Password Reset"}),e.jsxs(t.div,{className:"text-sm text-green-700 mt-2 space-y-1",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.9},children:[e.jsx("p",{children:"• Your password reset is protected with two-factor verification"}),e.jsx("p",{children:"• All sessions will be invalidated after password change"}),e.jsx("p",{children:"• This activity is logged for security monitoring"})]})]})]})})]})}export{B as default};
