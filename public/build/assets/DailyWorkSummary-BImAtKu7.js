import{u as be,R as ye,j as e,d as O,F as K,c as z,b as T,f as se,r as F,M as ve,a as ae,Q as ge,A as je}from"./app-n1LIYQPq.js";import{T as te}from"./index-CtBsO7PD.js";import{u as U,p as V,b as q,F as re,h as J,e as le,i as ie,m as Ne,j as Fe,k as we,n as ke,o as Se,s as De,l as ne,A as Re}from"./Dashboard-DJ5BzCaS.js";import{F as G,a as oe,r as de,b as ce,c as Ce,D as _e,d as We,e as Ie,u as M,w as Ee}from"./xlsx-DhsXJJlV.js";import{F as X}from"./ClockIcon-ChFXL_Ff.js";import{F as me}from"./CheckCircleIcon-BlN3OktQ.js";import{F as Y}from"./ChartBarIcon-JNTBlviq.js";import{F as ee}from"./CheckCircleIcon-CTmMgZPD.js";import{c as Z,F as pe,B as A}from"./react-toastify.esm-BDdnkiAB.js";import{F as $e}from"./ExclamationTriangleIcon-DMLwC-5W.js";import{c as C,t as Pe,a as Me,b as Ye}from"./chunk-F3UDT23P-CfD27OBv.js";import{t as Ae,a as ze}from"./chunk-YRZGWF2W-BSYRfbDM.js";import{s as Q}from"./chunk-TLYTI3QM-BSxz-uix.js";import{S as Te}from"./StatsCards-CChDBcUs.js";import{c as Be}from"./chunk-XJ2YRSUP-lNaR9vZt.js";import{F as Le}from"./InformationCircleIcon-CDepHfVV.js";import{d as k}from"./dayjs.min-B9vFY_nY.js";import{i as Oe}from"./isBetween-Branh0xT.js";import{F as Ve}from"./DocumentArrowDownIcon-BTegPBhP.js";import{m as xe}from"./proxy-BHshDoAS.js";import{F as Ge}from"./FunnelIcon-2Kubj-Dn.js";import{F as Qe}from"./AdjustmentsHorizontalIcon-DoeVcrNC.js";import{c as Ue}from"./chunk-D5XJWRAV-CVXe_h6o.js";import{b as qe}from"./chunk-57V4RE7B-DYEOAoWt.js";import{i as ue}from"./chunk-SSA7SXE4-BTItze1Z.js";import"./EnvelopeIcon-Cyp16-sG.js";import"./UserIcon-CpBOTOOT.js";import"./ShieldCheckIcon-BYBWX_Ph.js";import"./KeyIcon-BR78fqqK.js";import"./logo-Pwvcz7fP.js";import"./features-animation-BfbXr3Ir.js";import"./create-visual-element-Dv6o1znz.js";import"./createLucideIcon-BIFw61hB.js";import"./useToggleState-CNXYdUeg.js";const He=({filteredData:j,onRefresh:_,loading:W=!1})=>{const{theme:B}=be(),h=U("(max-width: 1024px)"),m=()=>{var l;if(typeof window>"u")return"lg";const s=parseInt(((l=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:l.trim())||"12");return s===0?"none":s<=4?"sm":s<=8?"md":s<=16?"lg":"full"},v=()=>e.jsxs("div",{className:"max-h-[84vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx(Q,{className:"w-32 h-6 rounded"}),e.jsx(Q,{className:"w-20 h-8 rounded"})]}),e.jsx(J,{className:"max-h-[70vh]",children:e.jsxs("div",{className:"border border-divider rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-default-100/80 backdrop-blur-md border-b border-divider",children:e.jsx("div",{className:"flex",children:I.map((s,l)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(Q,{className:"w-20 h-4 rounded"})},l))})}),e.jsx("div",{className:"divide-y divide-divider",children:Array.from({length:8}).map((s,l)=>e.jsx("div",{className:"flex hover:bg-default-50/50 transition-colors",children:I.map((u,a)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(Q,{className:"w-full h-4 rounded"})},a))},l))})]})})]}),d=s=>new Date(s).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}),x=s=>s>=100?"success":s>=75?"warning":s>=50?"primary":"danger",b=s=>s>=100?e.jsx(me,{className:"w-3 h-3"}):s>=50?e.jsx(X,{className:"w-3 h-3"}):e.jsx($e,{className:"w-3 h-3"}),S=(s,l)=>{const u="w-3 h-3",a=l>0?"":"text-gray-400";switch(s==null?void 0:s.toLowerCase()){case"embankment":return e.jsx(le,{className:`${u} text-amber-500 ${a}`});case"structure":return e.jsx(G,{className:`${u} text-blue-500 ${a}`});case"pavement":return e.jsx(ie,{className:`${u} text-gray-500 ${a}`});default:return e.jsx(q,{className:`${u} text-primary ${a}`})}},R=({summary:s})=>{const l=s.totalDailyWorks>0?(s.completed/s.totalDailyWorks*100).toFixed(1):0,u=s.rfiSubmissions>0&&s.completed>0?(s.rfiSubmissions/s.completed*100).toFixed(1):0,a=s.totalDailyWorks-s.completed;return e.jsx(z,{className:"mb-2",shadow:"sm",radius:m(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(T,{className:"p-3",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-3 flex-1",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-primary",style:{fontFamily:'var(--fontFamily, "Inter")'},children:d(s.date)}),e.jsxs("span",{className:"text-xs text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.totalDailyWorks," total works"]})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Z,{size:"sm",variant:"flat",color:x(parseFloat(l)),startContent:b(parseFloat(l)),radius:m(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:[l,"%"]})})]}),e.jsx(se,{className:"my-3"}),e.jsxs("div",{className:"space-y-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Completion Progress"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.completed,"/",s.totalDailyWorks]})]}),e.jsx(V,{value:parseFloat(l),color:x(parseFloat(l)),size:"sm",radius:m(),className:"w-full","aria-label":`Completion progress: ${l}%`})]}),s.rfiSubmissions>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"RFI Submission"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.rfiSubmissions,"/",s.completed]})]}),e.jsx(V,{value:parseFloat(u),color:x(parseFloat(u)),size:"sm",radius:m(),className:"w-full","aria-label":`RFI submission progress: ${u}%`})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[S("embankment",s.embankment),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Embankment"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.embankment})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[S("structure",s.structure),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Structure"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.structure})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[S("pavement",s.pavement),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Pavement"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.pavement})]})]}),e.jsx(se,{className:"my-3"}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"w-3 h-3 text-warning"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Resubmissions: ",s.resubmissions]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3 text-danger"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Pending: ",a]})]})]})]})})},L=ye.useCallback((s,l)=>{const u=s.totalDailyWorks>0?(s.completed/s.totalDailyWorks*100).toFixed(1):0,a=s.rfiSubmissions>0&&s.completed>0?(s.rfiSubmissions/s.completed*100).toFixed(1):0,n=s.totalDailyWorks-s.completed;switch(l){case"date":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(re,{className:"w-3 h-3 text-default-500"}),e.jsx("span",{className:"text-sm font-medium",children:d(s.date)})]})});case"totalDailyWorks":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-3 h-3 text-primary"}),e.jsx("span",{className:"text-sm font-bold",children:s.totalDailyWorks})]})});case"resubmissions":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"w-3 h-3 text-warning"}),e.jsx("span",{className:"text-sm",children:s.resubmissions})]})});case"embankment":case"structure":case"pavement":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[S(l,s[l]),e.jsx("span",{className:"text-sm",children:s[l]})]})});case"completed":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(me,{className:"w-3 h-3 text-success"}),e.jsx("span",{className:"text-sm font-medium text-success",children:s.completed})]})});case"pending":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3 text-danger"}),e.jsx("span",{className:"text-sm font-medium text-danger",children:n})]})});case"completionPercentage":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{value:parseFloat(u),color:x(parseFloat(u)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`Daily work completion: ${u}%`}),e.jsxs(Z,{size:"sm",variant:"flat",color:x(parseFloat(u)),startContent:b(parseFloat(u)),children:[u,"%"]})]})});case"rfiSubmissions":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"w-3 h-3 text-info"}),e.jsx("span",{className:"text-sm",children:s.rfiSubmissions})]})});case"rfiSubmissionPercentage":return e.jsx(C,{children:e.jsx("div",{className:"flex items-center gap-2",children:s.rfiSubmissions>0?e.jsxs(e.Fragment,{children:[e.jsx(V,{value:parseFloat(a),color:x(parseFloat(a)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`RFI submission percentage: ${a}%`}),e.jsxs(Z,{size:"sm",variant:"flat",color:x(parseFloat(a)),startContent:b(parseFloat(a)),children:[a,"%"]})]}):e.jsx("span",{className:"text-sm text-default-400",children:"-"})})});default:return e.jsx(C,{children:s[l]})}},[]),I=[{name:"Date",uid:"date",icon:re},{name:"Total Daily Works",uid:"totalDailyWorks",icon:q},{name:"Resubmissions",uid:"resubmissions",icon:K},{name:"Embankment",uid:"embankment",icon:le},{name:"Structure",uid:"structure",icon:G},{name:"Pavement",uid:"pavement",icon:ie},{name:"Completed",uid:"completed",icon:ee},{name:"Pending",uid:"pending",icon:pe},{name:"Completion %",uid:"completionPercentage",icon:Y},{name:"RFI Submissions",uid:"rfiSubmissions",icon:G},{name:"RFI Submission %",uid:"rfiSubmissionPercentage",icon:Y}];return h?e.jsxs("div",{className:"space-y-4",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[_&&e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(O,{size:"sm",variant:"bordered",color:"primary",radius:m(),startContent:e.jsx(K,{className:"w-4 h-4"}),onPress:_,"aria-label":"Refresh daily work summary table",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Refresh Summary"})}),e.jsx(J,{className:"max-h-[70vh]",children:(j==null?void 0:j.length)>0?j.map((s,l)=>e.jsx(R,{summary:s},l)):e.jsx(z,{className:"text-center py-8",radius:m(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(T,{children:[e.jsx(Y,{className:"w-12 h-12 text-default-300 mb-4 mx-auto"}),e.jsx("h6",{className:"text-lg font-semibold text-default-600 mb-2",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No summary data found"}),e.jsx("p",{className:"text-sm text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No work summary available for the selected period"})]})})})]}):W?e.jsx(v,{}):e.jsx("div",{className:"max-h-[84vh] overflow-y-auto",children:e.jsx(J,{className:"max-h-[70vh]",children:e.jsxs(Pe,{selectionMode:"none",isCompact:!0,removeWrapper:!0,isStriped:!0,"aria-label":"Daily Work Summary Table",isHeaderSticky:!0,radius:m(),classNames:{base:"max-h-[520px] overflow-auto",table:"min-h-[200px] w-full",thead:"z-10",tbody:"overflow-y-auto",th:"bg-default-100 text-default-700 font-semibold",td:"text-default-600"},style:{borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Ae,{columns:I,children:s=>e.jsx(ze,{align:s.uid==="date"?"start":"center",className:`bg-default-100/80 backdrop-blur-md ${s.width||""}`,style:{minWidth:s.uid==="date"?"128px":s.uid==="incharge"?"192px":"auto"},children:e.jsxs("div",{className:`flex items-center gap-1 ${s.uid==="date"?"justify-start":"justify-center"}`,children:[s.icon&&e.jsx(s.icon,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-semibold",children:s.name})]})},s.uid)}),e.jsx(Me,{items:j||[],emptyContent:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Y,{className:"w-12 h-12 text-default-300 mb-4"}),e.jsx("h6",{className:"text-lg font-medium text-default-600",children:"No summary data found"}),e.jsx("span",{className:"text-sm text-default-500",children:"No work summary available for the selected period"})]}),children:s=>e.jsx(Ye,{children:l=>L(s,l)},s.date)})]})})})},Je=({open:j,closeModal:_,filteredData:W=[],inCharges:B=[]})=>{var l,u;const[h,m]=F.useState({format:"excel",columns:["date","totalDailyWorks","completed","pending","completionPercentage","rfiSubmissions","embankment","structure","pavement","resubmissions"],includeCharts:!1,groupBy:"date"}),[v,d]=F.useState(!1),x=[{key:"excel",label:"Excel (.xlsx)",description:"Comprehensive spreadsheet with summary data",icon:e.jsx(We,{size:20,className:"text-green-600"})},{key:"csv",label:"CSV (.csv)",description:"Simple comma-separated values",icon:e.jsx(Ie,{size:20,className:"text-blue-600"})}],b=[{key:"date",label:"Date",description:"Summary date"},{key:"totalDailyWorks",label:"Total Works",description:"Total number of daily works"},{key:"completed",label:"Completed",description:"Number of completed works"},{key:"pending",label:"Pending",description:"Number of pending works"},{key:"completionPercentage",label:"Completion %",description:"Completion percentage"},{key:"rfiSubmissions",label:"RFI Submissions",description:"Number of RFI submissions"},{key:"rfiSubmissionPercentage",label:"RFI Submission %",description:"RFI submission percentage"},{key:"embankment",label:"Embankment Works",description:"Number of embankment works"},{key:"structure",label:"Structure Works",description:"Number of structure works"},{key:"pavement",label:"Pavement Works",description:"Number of pavement works"},{key:"resubmissions",label:"Resubmissions",description:"Number of resubmissions"}],S=[{key:"date",label:"By Date",description:"Group summary by date"},{key:"type",label:"By Type",description:"Group summary by work type"},{key:"overall",label:"Overall Summary",description:"Single overall summary"}],R=async()=>{d(!0);try{let a=L();const n=`daily_work_summary_${new Date().toISOString().split("T")[0]}`;switch(h.format){case"excel":I(a,n);break;case"csv":s(a,n);break}A.success(`Successfully exported ${a.length} summary records`,{icon:e.jsx(ee,{className:"w-5 h-5"})}),_()}catch(a){A.error("Export failed: "+a.message)}finally{d(!1)}},L=()=>{let a=[...W];if(h.groupBy==="overall"){const n=a.reduce((g,w)=>g+w.totalDailyWorks,0),o=a.reduce((g,w)=>g+w.completed,0),y=a.reduce((g,w)=>g+w.rfiSubmissions,0),c=a.reduce((g,w)=>g+w.embankment,0),i=a.reduce((g,w)=>g+w.structure,0),D=a.reduce((g,w)=>g+w.pavement,0),$=a.reduce((g,w)=>g+w.resubmissions,0);a=[{date:"Overall Summary",totalDailyWorks:n,completed:o,pending:n-o,completionPercentage:n>0?(o/n*100).toFixed(1)+"%":"0%",rfiSubmissions:y,rfiSubmissionPercentage:n>0?(y/n*100).toFixed(1)+"%":"0%",embankment:c,structure:i,pavement:D,resubmissions:$}]}else if(h.groupBy==="type"){const n=a.reduce((o,y)=>(["embankment","structure","pavement"].forEach(c=>{y[c]>0&&(o[c]||(o[c]={type:c.charAt(0).toUpperCase()+c.slice(1),totalWorks:0,dates:[]}),o[c].totalWorks+=y[c],o[c].dates.push(y.date))}),o),{});a=Object.values(n).map(o=>({type:o.type,totalWorks:o.totalWorks,dateRange:`${Math.min(...o.dates)} to ${Math.max(...o.dates)}`,dateCount:o.dates.length}))}return a.map(n=>{const o={};return h.columns.forEach(y=>{var c;if(n.hasOwnProperty(y)){const i=((c=b.find(D=>D.key===y))==null?void 0:c.label)||y;o[i]=n[y]}}),o})},I=(a,n)=>{const o=M.json_to_sheet(a),y=M.book_new();M.book_append_sheet(y,o,"Summary");const c=Object.keys(a[0]||{}).map(()=>({wch:20}));o["!cols"]=c;const i=M.decode_range(o["!ref"]);for(let D=i.s.c;D<=i.e.c;D++){const $=M.encode_cell({r:0,c:D});o[$]&&(o[$].s={font:{bold:!0},fill:{fgColor:{rgb:"CCCCCC"}}})}Ee(y,`${n}.xlsx`)},s=(a,n)=>{const o=M.json_to_sheet(a),y=M.sheet_to_csv(o),c=new Blob([y],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),D=URL.createObjectURL(c);i.setAttribute("href",D),i.setAttribute("download",`${n}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)};return e.jsx(Ne,{isOpen:j,onClose:_,size:"3xl",scrollBehavior:"inside",classNames:{base:"backdrop-blur-md",backdrop:"bg-black/50 backdrop-blur-sm"},children:e.jsxs(Fe,{children:[e.jsxs(we,{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-6 h-6 text-primary"}),e.jsx("span",{children:"Export Daily Work Summary"})]}),e.jsx("p",{className:"text-sm text-default-500 font-normal",children:"Export summary data with customizable grouping and format options"})]}),e.jsx(ke,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(z,{className:"bg-default-50",children:e.jsxs(T,{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Export Format"}),e.jsx(de,{value:h.format,onValueChange:a=>m(n=>({...n,format:a})),orientation:"horizontal",children:x.map(a=>e.jsx(ce,{value:a.key,children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.icon,e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.label}),e.jsx("div",{className:"text-xs text-default-500",children:a.description})]})]})},a.key))})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Grouping & Summary"}),e.jsx(de,{value:h.groupBy,onValueChange:a=>m(n=>({...n,groupBy:a})),children:S.map(a=>e.jsx(ce,{value:a.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.label}),e.jsx("div",{className:"text-xs text-default-500",children:a.description})]})},a.key))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Columns to Export"}),e.jsx(Ce,{value:h.columns,onValueChange:a=>m(n=>({...n,columns:a})),children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:b.map(a=>e.jsx(Be,{value:a.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.label}),e.jsx("div",{className:"text-xs text-default-500",children:a.description})]})},a.key))})})]}),e.jsx(z,{className:"bg-primary-50 border-primary-200",children:e.jsx(T,{children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Le,{className:"w-5 h-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-primary-900",children:"Export Summary"}),e.jsxs("div",{className:"text-sm text-primary-700 space-y-1",children:[e.jsxs("p",{children:["• Format: ",(l=x.find(a=>a.key===h.format))==null?void 0:l.label]}),e.jsxs("p",{children:["• Grouping: ",(u=S.find(a=>a.key===h.groupBy))==null?void 0:u.label]}),e.jsxs("p",{children:["• Columns: ",h.columns.length," selected"]}),e.jsxs("p",{children:["• Records: ",W.length," summary entries"]})]})]})]})})})]})}),e.jsxs(Se,{children:[e.jsx(O,{variant:"light",onPress:_,isDisabled:v,children:"Cancel"}),e.jsx(O,{color:"primary",onPress:R,isLoading:v,startContent:!v&&e.jsx(_e,{size:16}),isDisabled:h.columns.length===0,children:v?"Exporting...":"Export Summary"})]})]})})};var H={exports:{}},Xe=H.exports,fe;function Ze(){return fe||(fe=1,function(j,_){(function(W,B){j.exports=B()})(Xe,function(){return function(W,B,h){var m=function(v,d){if(!d||!d.length||d.length===1&&!d[0]||d.length===1&&Array.isArray(d[0])&&!d[0].length)return null;var x;d.length===1&&d[0].length>0&&(d=d[0]),x=(d=d.filter(function(S){return S}))[0];for(var b=1;b<d.length;b+=1)d[b].isValid()&&!d[b][v](x)||(x=d[b]);return x};h.max=function(){var v=[].slice.call(arguments,0);return m("isAfter",v)},h.min=function(){var v=[].slice.call(arguments,0);return m("isBefore",v)}}})}(H)),H.exports}var Ke=Ze();const es=ve(Ke);k.extend(es);k.extend(Oe);const ss=({auth:j,title:_,summary:W,jurisdictions:B,inCharges:h})=>{const m=U("(min-width: 1025px)"),v=U("(min-width: 641px) and (max-width: 1024px)"),d=U("(max-width: 640px)"),x=()=>{var p;if(typeof window>"u")return"lg";const N=((p=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:p.trim())||"12px",r=parseInt(N);return r===0?"none":r<=4?"sm":r<=8?"md":r<=16?"lg":"full"},[b,S]=F.useState(W),[R,L]=F.useState(W),[I,s]=F.useState(!1),[l,u]=F.useState(null),[a,n]=F.useState(!1),o=F.useCallback(t=>{u(t)},[]),y=F.useCallback(()=>{u(null)},[]),c=F.useMemo(()=>!b||b.length===0?[]:b.map(t=>k(t.date)).filter(t=>t.isValid()),[b]),[i,D]=F.useState({startDate:c.length>0?k.min(...c).format("YYYY-MM-DD"):k().subtract(30,"days").format("YYYY-MM-DD"),endDate:c.length>0?k.max(...c).format("YYYY-MM-DD"):k().format("YYYY-MM-DD"),status:"all",incharge:"all"}),$=F.useCallback(async()=>{s(!0);try{const t=i.startDate||k().subtract(30,"days").format("YYYY-MM-DD"),N=i.endDate||k().format("YYYY-MM-DD"),r=await ae.post(te("daily-works-summary.refresh"),{startDate:t,endDate:N});if(r.data&&r.data.summary)S(r.data.summary),A.success("Summary data refreshed successfully");else if(r.data&&r.data.message){const p=await ae.get(te("daily-works-summary.data"),{params:{startDate:t,endDate:N}});p.data&&p.data.summary&&S(p.data.summary),A.success("Summary data refreshed successfully")}}catch(t){console.error("Failed to refresh summary:",t),t.response&&t.response.data&&t.response.data.message?A.error(t.response.data.message):A.error("Failed to refresh summary data")}finally{s(!1)}},[i]),g=F.useCallback((t,N)=>{D(r=>({...r,[t]:N}))},[]),w=F.useMemo(()=>{const t=R.reduce((E,P)=>E+P.totalDailyWorks,0),N=R.reduce((E,P)=>E+P.completed,0),r=R.reduce((E,P)=>E+P.pending,0),p=R.reduce((E,P)=>E+P.rfiSubmissions,0),f=t>0?(N/t*100).toFixed(1):0;return[{title:"Total Works",value:t,icon:e.jsx(Y,{className:"w-5 h-5"}),color:"text-blue-600",description:"All logged works"},{title:"Completed",value:N,icon:e.jsx(ee,{className:"w-5 h-5"}),color:"text-green-600",description:`${f}% completion rate`},{title:"Pending",value:r,icon:e.jsx(pe,{className:"w-5 h-5"}),color:"text-orange-600",description:"In progress"},{title:"RFI Submissions",value:p,icon:e.jsx(q,{className:"w-5 h-5"}),color:"text-purple-600",description:"Ready for inspection"}]},[R]),he=[{label:"Refresh",icon:e.jsx(K,{className:"w-4 h-4"}),variant:"flat",color:"primary",onPress:$,isLoading:I,className:"bg-linear-to-r from-blue-500/20 to-cyan-500/20 hover:from-blue-500/30 hover:to-cyan-500/30",ariaLabel:"Refresh daily work summary data"},...j.roles.includes("Administrator")||j.designation==="Supervision Engineer"?[{label:"Export",icon:e.jsx(Ve,{className:"w-4 h-4"}),variant:"flat",color:"success",onPress:()=>o("exportDailyWorkSummary"),className:"bg-linear-to-r from-green-500/20 to-emerald-500/20 hover:from-green-500/30 hover:to-emerald-500/30",ariaLabel:"Export daily work summary data"}]:[]];return F.useEffect(()=>{c.length>0&&(!i.startDate||!i.endDate)&&D(t=>({...t,startDate:k.min(...c).format("YYYY-MM-DD"),endDate:k.max(...c).format("YYYY-MM-DD")}))},[c]),F.useEffect(()=>{const N=b.filter(r=>{const p=k(r.date),f=k(i.startDate),E=k(i.endDate);return p.isBetween(f,E,null,"[]")&&(i.incharge==="all"||!i.incharge||r.incharge===i.incharge)}).reduce((r,p)=>{const f=k(p.date).format("YYYY-MM-DD");return r[f]?(r[f].totalDailyWorks+=p.totalDailyWorks,r[f].resubmissions+=p.resubmissions,r[f].embankment+=p.embankment,r[f].structure+=p.structure,r[f].pavement+=p.pavement,r[f].pending+=p.pending,r[f].completed+=p.completed,r[f].rfiSubmissions+=p.rfiSubmissions,r[f].completionPercentage=r[f].totalDailyWorks>0?r[f].completed/r[f].totalDailyWorks*100:0,r[f].rfiSubmissionPercentage=r[f].totalDailyWorks>0?r[f].rfiSubmissions/r[f].totalDailyWorks*100:0):r[f]={...p},r},{});L(Object.values(N))},[i,b]),e.jsxs(e.Fragment,{children:[e.jsx(ge,{title:_}),l==="exportDailyWorkSummary"&&e.jsx(Je,{open:l==="exportDailyWorkSummary",closeModal:y,filteredData:R,inCharges:h}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full max-w-[2000px]",children:e.jsxs(z,{className:"transition-all duration-200",radius:x(),style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                var(--theme-content1, #FAFAFA) 20%, 
                                var(--theme-content2, #F4F4F5) 10%, 
                                var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(Ue,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                    color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                    color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${m?"p-6":v?"p-4":"p-3"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                    ${m?"p-3":v?"p-2.5":"p-2"} 
                                                    rounded-xl flex items-center justify-center
                                                `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(Y,{className:`
                                                        ${m?"w-8 h-8":v?"w-6 h-6":"w-5 h-5"}
                                                    `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                        ${m?"text-2xl":v?"text-xl":"text-lg"}
                                                        font-bold text-foreground
                                                        ${m?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Daily Work Summary"}),e.jsx("p",{className:`
                                                        ${m?"text-sm":"text-xs"} 
                                                        text-default-500
                                                        ${m?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Overview of daily work statistics and progress"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex items-center gap-2",children:he.map((t,N)=>e.jsx(O,{size:m?"md":"sm",variant:t.variant||"flat",color:t.color||"primary",startContent:t.icon,onPress:t.onPress,isLoading:t.isLoading,className:`${t.className||""} font-medium`,radius:x(),"aria-label":t.ariaLabel||t.label,style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)"},children:t.label},N))})})]})})})}),e.jsxs(T,{className:"pt-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Te,{stats:w,isLoading:I}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5 text-default-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Quick Filters:"})]}),e.jsx("div",{className:"flex gap-2 items-end",children:e.jsx(qe,{variant:"bordered",radius:x(),className:"bg-white/5",children:e.jsxs(O,{isIconOnly:d,color:a?"primary":"default",onPress:()=>n(!a),className:a?"bg-primary/20":"bg-white/5","aria-label":a?"Hide advanced filters":"Show advanced filters",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Qe,{className:"w-4 h-4"}),!d&&e.jsx("span",{className:"ml-1",children:"Advanced Filters"})]})})})]}),e.jsx(je,{children:a&&e.jsx(xe.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx("div",{className:"p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx("div",{className:"sm:col-span-2 lg:col-span-2",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Date Range"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center",children:[e.jsx(ue,{type:"date",label:"Start date",value:i.startDate,onChange:t=>g("startDate",t.target.value),size:"sm",variant:"bordered",radius:x(),"aria-label":"Select start date for filtering daily work summary",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                                         focus-within:bg-content2/90 border-divider/50 
                                                                                         hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx("span",{className:"text-sm text-default-500 px-2",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"to"}),e.jsx(ue,{type:"date",label:"End date",value:i.endDate,onChange:t=>g("endDate",t.target.value),size:"sm",variant:"bordered",radius:x(),"aria-label":"Select end date for filtering daily work summary",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                                         focus-within:bg-content2/90 border-divider/50 
                                                                                         hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}})]})]})}),(j.roles.includes("Administrator")||j.designation==="Supervision Engineer")&&e.jsx("div",{children:e.jsxs(De,{label:"In Charge",placeholder:"Select in charge...",selectedKeys:i.incharge?[String(i.incharge)]:["all"],onSelectionChange:t=>{const N=Array.from(t)[0];g("incharge",N==="all"?"all":N)},variant:"bordered",size:"sm",radius:x(),className:"w-full",classNames:{trigger:"text-sm",value:"text-foreground",listboxWrapper:"bg-content1",popoverContent:"bg-content1"},style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by in charge",children:[e.jsx(ne,{value:"all",children:"All"},"all"),h.map(t=>e.jsx(ne,{value:t.id,children:t.name},t.id))]})})]})})})})]})}),e.jsx(z,{radius:x(),className:"bg-content1/80 backdrop-blur-md border border-divider/20",style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)",border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                        color-mix(in srgb, var(--theme-content1) 90%, transparent) 20%, 
                                        color-mix(in srgb, var(--theme-content2) 60%, transparent) 10%)`},children:e.jsx(T,{className:"p-0",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsx(He,{filteredData:R,onRefresh:$,loading:I})})})]})]})})})]})};ss.layout=j=>e.jsx(Re,{children:j});export{ss as default};
