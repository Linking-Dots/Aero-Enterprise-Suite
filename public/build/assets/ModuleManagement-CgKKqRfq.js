import{r,j as e,Q as vs,d,F as ys,b as se,s as Cs,c as Pe,a as E,L as Oe,A as Re}from"./app-Bzvwrd0H.js";import{G as Ie}from"./GlassCard-BA-7Eich.js";import{y as ce,z as ze,A as ws,h as U,i as V,j as B,k as K,B as $e,C as de,e as me,f as ue,g as pe,m as N,D as bs,E as Ns}from"./Dashboard-PMT9L6iU.js";import{P as _s}from"./PageHeader-CQH90OfM.js";import{S as Ss}from"./StatsCards-BAsbSv3i.js";import{s as j}from"./toastUtils-Iz8RhFxm.js";import{F as Ve}from"./DocumentIcon-D8od2ICh.js";import{F as Ms}from"./ShieldCheckIcon-Ci88VqTr.js";import{F as he}from"./PlusIcon-BQw3U6ju.js";import{F as Ae}from"./MagnifyingGlassIcon-WrElD3YO.js";import{s as xe}from"./chunk-TQNYOUFX-v8rKt3jl.js";import{m as T}from"./chunk-O5MCAK4F-RA0tlcCK.js";import{F as te}from"./KeyIcon-C67GVAFO.js";import{c as De}from"./chunk-XJ2YRSUP-BBCnKNhp.js";import{F as fe}from"./EllipsisVerticalIcon-DPAKH8XQ.js";import{F as je}from"./PencilSquareIcon-C6YrQtNt.js";import{F as ge}from"./TrashIcon-DcwicuGA.js";import{m as Le}from"./proxy-ByMbOVRp.js";import{t as Fs,F as ks}from"./XMarkIcon-B57lrNTs.js";import{i as u}from"./chunk-SSA7SXE4-kGhgEhoz.js";import{s as ae,l as z}from"./chunk-Y2AYO5NJ-Btdgu39A.js";import{c as qe}from"./chunk-D5XJWRAV-CmJIffgK.js";import{c as w}from"./chunk-IHOGUXIG-qQB_28Ca.js";import"./MapPinIcon-B-THB0O0.js";import"./EnvelopeIcon-CfR7cmdn.js";import"./UserGroupIcon-CqYoflHv.js";import"./ClockIcon-4Z87G53P.js";import"./UserIcon-RT0TlI1U.js";import"./index-CVtaHEqw.js";import"./logo-Pwvcz7fP.js";import"./features-animation-D0YkvCDz.js";import"./create-visual-element-CeiJpb04.js";import"./CheckCircleIcon-mncIOFUm.js";import"./ExclamationTriangleIcon-BEZKRPCj.js";import"./chunk-TLYTI3QM-BYKAmrkG.js";import"./useToggleState-Cbk3iJwk.js";function Es({title:l,titleId:n,...p},h){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:h,"aria-labelledby":n},p),l?r.createElement("title",{id:n},l):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 0 1-1.125-1.125v-3.75ZM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 0 1-1.125-1.125v-8.25ZM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 0 1-1.125-1.125v-2.25Z"}))}const Ps=r.forwardRef(Es);function Os({title:l,titleId:n,...p},h){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:h,"aria-labelledby":n},p),l?r.createElement("title",{id:n},l):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.429 9.75 2.25 12l4.179 2.25m0-4.5 5.571 3 5.571-3m-11.142 0L2.25 7.5 12 2.25l9.75 5.25-4.179 2.25m0 0L21.75 12l-4.179 2.25m0 0 4.179 2.25L12 21.75 2.25 16.5l4.179-2.25m11.142 0-5.571 3-5.571-3"}))}const Rs=r.forwardRef(Os),Is={page:e.jsx(Ve,{className:"w-4 h-4"}),section:e.jsx(Ps,{className:"w-4 h-4"}),widget:e.jsx(Ns,{className:"w-4 h-4"}),action:e.jsx(bs,{className:"w-4 h-4"}),api:e.jsx(ks,{className:"w-4 h-4"})},Ue={page:"primary",section:"secondary",widget:"success",action:"warning",api:"danger"},zs={core_system:"primary",self_service:"secondary",human_resources:"success",project_management:"warning",document_management:"default",customer_relations:"primary",supply_chain:"secondary",retail_sales:"success",financial_management:"warning",system_administration:"danger"},ve={view:{label:"View",description:"Can view/read data"},create:{label:"Create",description:"Can create new records"},update:{label:"Edit",description:"Can modify existing records"},delete:{label:"Delete",description:"Can remove records"},import:{label:"Import",description:"Can import data from files"},export:{label:"Export",description:"Can export data to files"},approve:{label:"Approve",description:"Can approve requests"},assign:{label:"Assign",description:"Can assign to users"},manage:{label:"Manage",description:"Full management access"},operate:{label:"Operate",description:"Can operate/execute"},punch:{label:"Punch",description:"Can punch attendance"},change:{label:"Change",description:"Can change settings"},impersonate:{label:"Impersonate",description:"Can act as another user"},analytics:{label:"Analytics",description:"Can view analytics"},settings:{label:"Settings",description:"Can configure settings"},log:{label:"Log",description:"Can view logs"},schedule:{label:"Schedule",description:"Can manage schedules"},restore:{label:"Restore",description:"Can restore data"},own:{label:"Own",description:"Access to own records only"}},Be=l=>l.split("-").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" "),$s=l=>{const n=l.split(".");if(n.length>=2){const p=Be(n[0]),h=n[1];if(n.length>=3&&h==="own"){const $=n[2];return`${(ve[$]||{label:$.charAt(0).toUpperCase()+$.slice(1)}).label} Own ${p}`}return`${(ve[h]||{label:h.charAt(0).toUpperCase()+h.slice(1)}).label} ${p}`}return l},As=l=>{var p;const n=l.split(".");if(n.length>=2){const h=n.length>=3&&n[1]==="own"?n[2]:n[1];return((p=ve[h])==null?void 0:p.description)||`Permission for ${l}`}return`Permission for ${l}`},Ds=l=>{const n={};l.forEach(y=>{const P=y.name.split(".")[0];n[P]||(n[P]={name:Be(P),permissions:[]}),n[P].permissions.push({...y,displayName:$s(y.name),description:As(y.name)})});const p=Object.keys(n).sort(),h={};return p.forEach(y=>{h[y]=n[y]}),h},Ls=(l,n)=>{const[p,h]=r.useState(l);return r.useEffect(()=>{const y=setTimeout(()=>{h(l)},n);return()=>clearTimeout(y)},[l,n]),p},wt=l=>{var Ee;const{modules:n=[],permissions:p=[],statistics:h={},categories:y={},componentTypes:$={},title:P="Module Permission Registry"}=l,[ye,Ke]=r.useState(n),[D,Te]=r.useState(h),[R,C]=r.useState(!1),[Ce,Ge]=r.useState(""),[G,Qe]=r.useState("all"),[L,Ze]=r.useState("all"),[He,We]=r.useState(new Set),[Je,Xe]=r.useState(new Set),[Ye,Q]=r.useState(!1),[es,Z]=r.useState(!1),[ss,H]=r.useState(!1),[ts,W]=r.useState(!1),[as,J]=r.useState(!1),[X,we]=r.useState(null),[Y,be]=r.useState(null),[ee,Ne]=r.useState(null),[rs,ns]=r.useState(null),[is,ls]=r.useState(null),[x,_e]=r.useState(null),[b,os]=r.useState(null),[m,_]=r.useState({code:"",name:"",description:"",icon:"",category:"core_system",route_prefix:"",is_active:!0,priority:100}),[f,M]=r.useState({code:"",name:"",description:"",icon:"",route:"",is_active:!0,priority:100}),[g,O]=r.useState({code:"",name:"",description:"",type:"page",route:"",is_active:!0}),[S,F]=r.useState([]),q=Ls(Ce,300),re=r.useMemo(()=>ye.filter(s=>{var v;const t=!q||s.name.toLowerCase().includes(q.toLowerCase())||s.code.toLowerCase().includes(q.toLowerCase())||((v=s.description)==null?void 0:v.toLowerCase().includes(q.toLowerCase())),a=G==="all"||s.category===G,c=L==="all"||L==="active"&&s.is_active||L==="inactive"&&!s.is_active;return t&&a&&c}),[ye,q,G,L]),cs=r.useMemo(()=>[{title:"Total Modules",value:D.total_modules||0,icon:e.jsx(ce,{className:"w-6 h-6"}),color:"primary",description:"Top-level modules"},{title:"Sub-Modules",value:D.total_sub_modules||0,icon:e.jsx(ze,{className:"w-6 h-6"}),color:"secondary",description:"Functional areas"},{title:"Components",value:D.total_components||0,icon:e.jsx(Ve,{className:"w-6 h-6"}),color:"success",description:"UI components"},{title:"Permission Rules",value:D.total_permission_requirements||0,icon:e.jsx(Ms,{className:"w-6 h-6"}),color:"warning",description:"Access requirements"}],[D]),Se=s=>{We(t=>{const a=new Set(t);return a.has(s)?a.delete(s):a.add(s),a})},Me=s=>{Xe(t=>{const a=new Set(t);return a.has(s)?a.delete(s):a.add(s),a})},A=async()=>{C(!0);try{const s=await E.get(route("modules.api.index"));Ke(s.data.modules||[]),Te(s.data.statistics||{}),j.success("Data refreshed successfully")}catch(s){j.error("Failed to refresh data"),console.error("Refresh error:",s)}finally{C(!1)}},ne=(s=null)=>{s?(we(s),_({code:s.code,name:s.name,description:s.description||"",icon:s.icon||"",category:s.category||"core_system",route_prefix:s.route_prefix||"",is_active:s.is_active,priority:s.priority||100})):(we(null),_({code:"",name:"",description:"",icon:"",category:"core_system",route_prefix:"",is_active:!0,priority:100})),Q(!0)},Fe=(s,t=null)=>{ns(s),t?(be(t),M({code:t.code,name:t.name,description:t.description||"",icon:t.icon||"",route:t.route||"",is_active:t.is_active,priority:t.priority||100})):(be(null),M({code:"",name:"",description:"",icon:"",route:"",is_active:!0,priority:100})),Z(!0)},ke=(s,t=null)=>{ls(s),t?(Ne(t),O({code:t.code,name:t.name,description:t.description||"",type:t.type||"page",route:t.route||"",is_active:t.is_active})):(Ne(null),O({code:"",name:"",description:"",type:"page",route:"",is_active:!0})),H(!0)},ie=s=>{os(s);const t=s.permission_requirements||s.permissionRequirements||[],a=t.map(c=>Number(c.permission_id));console.log("Opening permission modal:",{target:s,requirements:t,currentPermissions:a}),F(a),W(!0)},ds=async()=>{var s,t;C(!0);try{X?(await E.put(route("modules.update",X.id),m),j.success("Module updated successfully")):(await E.post(route("modules.store"),m),j.success("Module created successfully")),Q(!1),A()}catch(a){j.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to save module")}finally{C(!1)}},ms=async()=>{var s,t;C(!0);try{Y?(await E.put(route("modules.sub-modules.update",Y.id),f),j.success("Sub-module updated successfully")):(await E.post(route("modules.sub-modules.store",rs),f),j.success("Sub-module created successfully")),Z(!1),A()}catch(a){j.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to save sub-module")}finally{C(!1)}},us=async()=>{var s,t;C(!0);try{ee?(await E.put(route("modules.components.update",ee.id),g),j.success("Component updated successfully")):(await E.post(route("modules.components.store",is),g),j.success("Component created successfully")),H(!1),A()}catch(a){j.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to save component")}finally{C(!1)}},ps=async()=>{var s,t,a,c,v;C(!0);try{let i;b.type==="module"?i=route("modules.sync-permissions",b.id):b.type==="sub_module"?i=route("modules.sub-modules.sync-permissions",b.id):i=route("modules.components.sync-permissions",b.id);const o=S.map(I=>{const oe=p.find(gs=>gs.id===I);return{permission:(oe==null?void 0:oe.name)||"",type:"required",group:null}}).filter(I=>I.permission);console.log("Saving permissions:",{endpoint:i,permissionsPayload:o});const k=await E.post(i,{permissions:o});console.log("Save response:",k.data),j.success("Permissions updated successfully"),W(!1),A()}catch(i){console.error("Error saving permissions:",i),console.error("Error response:",(s=i.response)==null?void 0:s.data);const o=(a=(t=i.response)==null?void 0:t.data)!=null&&a.errors?Object.values(i.response.data.errors).flat().join(", "):((v=(c=i.response)==null?void 0:c.data)==null?void 0:v.message)||"Failed to save permissions";j.error(o)}finally{C(!1)}},le=(s,t)=>{_e({...s,type:t}),J(!0)},hs=async()=>{var s,t;if(x){C(!0);try{let a;x.type==="module"?a=route("modules.destroy",x.id):x.type==="sub_module"?a=route("modules.sub-modules.destroy",x.id):a=route("modules.components.destroy",x.id),await E.delete(a),j.success(`${x.type.replace("_"," ")} deleted successfully`),J(!1),_e(null),A()}catch(a){j.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to delete")}finally{C(!1)}}},xs=s=>{var v;const t=He.has(s.id),a=s.sub_modules||[],c=((v=s.permission_requirements)==null?void 0:v.length)||0;return e.jsx(Pe,{className:"mb-3",children:e.jsxs(se,{className:"p-0",children:[e.jsxs("div",{className:`flex items-center justify-between p-4 cursor-pointer hover:bg-default-100 transition-colors ${s.is_active?"":"opacity-60"}`,onClick:()=>Se(s.id),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(d,{isIconOnly:!0,size:"sm",variant:"light",onClick:i=>{i.stopPropagation(),Se(s.id)},children:t?e.jsx(Oe,{className:"w-4 h-4"}):e.jsx($e,{className:"w-4 h-4"})}),e.jsx(ce,{className:"w-6 h-6 text-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:s.name}),e.jsx(w,{size:"sm",variant:"flat",color:zs[s.category]||"default",children:s.code}),!s.is_active&&e.jsx(w,{size:"sm",variant:"flat",color:"danger",children:"Inactive"})]}),e.jsx("p",{className:"text-sm text-default-500 mt-1",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{content:a.length,color:"primary",size:"sm",children:e.jsx(w,{size:"sm",variant:"bordered",children:"Sub-modules"})}),e.jsx(de,{content:c,color:"warning",size:"sm",children:e.jsx(w,{size:"sm",variant:"bordered",children:"Permissions"})}),e.jsxs(me,{children:[e.jsx(ue,{children:e.jsx(d,{isIconOnly:!0,size:"sm",variant:"light",onClick:i=>i.stopPropagation(),children:e.jsx(fe,{className:"w-5 h-5"})})}),e.jsxs(pe,{children:[e.jsx(N,{startContent:e.jsx(je,{className:"w-4 h-4"}),onClick:()=>ne(s),children:"Edit Module"},"edit"),e.jsx(N,{startContent:e.jsx(te,{className:"w-4 h-4"}),onClick:()=>ie({...s,type:"module"}),children:"Manage Permissions"},"permissions"),e.jsx(N,{startContent:e.jsx(he,{className:"w-4 h-4"}),onClick:()=>Fe(s.id),children:"Add Sub-Module"},"add-submodule"),e.jsx(N,{startContent:e.jsx(ge,{className:"w-4 h-4"}),color:"danger",className:"text-danger",onClick:()=>le(s,"module"),children:"Delete Module"},"delete")]})]})]})]}),e.jsx(Re,{children:t&&a.length>0&&e.jsx(Le.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"border-t border-default-200",children:e.jsx("div",{className:"pl-8 py-2",children:a.map(i=>fs(i,s.id))})})})]})},s.id)},fs=(s,t)=>{var v;const a=Je.has(s.id),c=s.components||[];return(v=s.permission_requirements)!=null&&v.length,e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg bg-default-50 hover:bg-default-100 cursor-pointer transition-colors ${s.is_active?"":"opacity-60"}`,onClick:()=>Me(s.id),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(d,{isIconOnly:!0,size:"sm",variant:"light",onClick:i=>{i.stopPropagation(),Me(s.id)},children:a?e.jsx(Oe,{className:"w-4 h-4"}):e.jsx($e,{className:"w-4 h-4"})}),e.jsx(ze,{className:"w-5 h-5 text-secondary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx(w,{size:"sm",variant:"flat",color:"secondary",children:s.code}),!s.is_active&&e.jsx(w,{size:"sm",variant:"flat",color:"danger",children:"Inactive"})]}),s.description&&e.jsx("p",{className:"text-xs text-default-400 mt-0.5",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{content:c.length,color:"success",size:"sm",children:e.jsx(w,{size:"sm",variant:"bordered",children:"Components"})}),e.jsxs(me,{children:[e.jsx(ue,{children:e.jsx(d,{isIconOnly:!0,size:"sm",variant:"light",onClick:i=>i.stopPropagation(),children:e.jsx(fe,{className:"w-4 h-4"})})}),e.jsxs(pe,{children:[e.jsx(N,{startContent:e.jsx(je,{className:"w-4 h-4"}),onClick:()=>Fe(t,s),children:"Edit Sub-Module"},"edit"),e.jsx(N,{startContent:e.jsx(te,{className:"w-4 h-4"}),onClick:()=>ie({...s,type:"sub_module"}),children:"Manage Permissions"},"permissions"),e.jsx(N,{startContent:e.jsx(he,{className:"w-4 h-4"}),onClick:()=>ke(s.id),children:"Add Component"},"add-component"),e.jsx(N,{startContent:e.jsx(ge,{className:"w-4 h-4"}),color:"danger",className:"text-danger",onClick:()=>le(s,"sub_module"),children:"Delete Sub-Module"},"delete")]})]})]})]}),e.jsx(Re,{children:a&&c.length>0&&e.jsx(Le.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"pl-10 mt-2",children:c.map(i=>js(i,s.id))})})]},s.id)},js=(s,t)=>{var c;const a=((c=s.permission_requirements)==null?void 0:c.length)||0;return e.jsxs("div",{className:`flex items-center justify-between p-2 rounded-md bg-default-100 hover:bg-default-200 mb-1 transition-colors ${s.is_active?"":"opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(Fs,{content:s.type,children:e.jsx("span",{className:`text-${Ue[s.type]}`,children:Is[s.type]})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:s.name}),e.jsx(w,{size:"sm",variant:"flat",color:Ue[s.type],children:s.type}),s.route&&e.jsx(w,{size:"sm",variant:"bordered",color:"default",children:s.route})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a>0&&e.jsxs(w,{size:"sm",variant:"flat",color:"warning",children:[a," perms"]}),e.jsxs(me,{children:[e.jsx(ue,{children:e.jsx(d,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(fe,{className:"w-4 h-4"})})}),e.jsxs(pe,{children:[e.jsx(N,{startContent:e.jsx(je,{className:"w-4 h-4"}),onClick:()=>ke(t,s),children:"Edit Component"},"edit"),e.jsx(N,{startContent:e.jsx(te,{className:"w-4 h-4"}),onClick:()=>ie({...s,type:"component"}),children:"Manage Permissions"},"permissions"),e.jsx(N,{startContent:e.jsx(ge,{className:"w-4 h-4"}),color:"danger",className:"text-danger",onClick:()=>le(s,"component"),children:"Delete Component"},"delete")]})]})]})]},s.id)};return e.jsxs(ws,{children:[e.jsx(vs,{title:P}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx(_s,{title:P,subtitle:"Manage module permissions and access control hierarchy",icon:e.jsx(Rs,{className:"w-8 h-8"}),actions:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"flat",startContent:e.jsx(ys,{className:"w-4 h-4"}),onClick:A,isLoading:R,children:"Refresh"}),e.jsx(d,{color:"primary",startContent:e.jsx(he,{className:"w-4 h-4"}),onClick:()=>ne(),children:"Add Module"})]})}),e.jsx(Ss,{stats:cs,className:"mb-6"}),e.jsx(Ie,{className:"mb-6",children:e.jsx(se,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(u,{placeholder:"Search modules...",value:Ce,onChange:s=>Ge(s.target.value),startContent:e.jsx(Ae,{className:"w-4 h-4 text-default-400"}),className:"flex-1"}),e.jsxs(ae,{label:"Category",selectedKeys:[G],onChange:s=>Qe(s.target.value),className:"w-full sm:w-48",children:[e.jsx(z,{value:"all",children:"All Categories"},"all"),Object.entries(y).map(([s,t])=>e.jsx(z,{value:s,children:t},s))]}),e.jsxs(ae,{label:"Status",selectedKeys:[L],onChange:s=>Ze(s.target.value),className:"w-full sm:w-36",children:[e.jsx(z,{value:"all",children:"All"},"all"),e.jsx(z,{value:"active",children:"Active"},"active"),e.jsx(z,{value:"inactive",children:"Inactive"},"inactive")]})]})})}),e.jsxs(Ie,{children:[e.jsxs(qe,{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Module Hierarchy"}),e.jsxs(w,{variant:"flat",color:"default",children:[re.length," modules"]})]}),e.jsx(se,{children:R?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(Cs,{size:"lg"})}):re.length===0?e.jsxs("div",{className:"text-center py-12 text-default-500",children:[e.jsx(ce,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No modules found"}),e.jsx(d,{color:"primary",variant:"flat",className:"mt-4",onClick:()=>ne(),children:"Create First Module"})]}):e.jsx("div",{className:"space-y-2",children:re.map(s=>xs(s))})})]})]}),e.jsx(U,{isOpen:Ye,onClose:()=>Q(!1),size:"2xl",children:e.jsxs(V,{children:[e.jsx(B,{children:X?"Edit Module":"Create New Module"}),e.jsx(K,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{label:"Code",placeholder:"MODULE_CODE",value:m.code,onChange:s=>_({...m,code:s.target.value.toUpperCase()}),isRequired:!0}),e.jsx(u,{label:"Name",placeholder:"Module Name",value:m.name,onChange:s=>_({...m,name:s.target.value}),isRequired:!0}),e.jsx(u,{label:"Icon",placeholder:"Icon class name",value:m.icon,onChange:s=>_({...m,icon:s.target.value}),className:"col-span-2"}),e.jsx(u,{label:"Route Prefix",placeholder:"/module-route",value:m.route_prefix,onChange:s=>_({...m,route_prefix:s.target.value})}),e.jsx(ae,{label:"Category",selectedKeys:[m.category],onChange:s=>_({...m,category:s.target.value}),children:Object.entries(y).map(([s,t])=>e.jsx(z,{value:s,children:t},s))}),e.jsx(u,{label:"Priority",type:"number",value:m.priority,onChange:s=>_({...m,priority:parseInt(s.target.value)})}),e.jsx("div",{className:"flex items-center",children:e.jsx(xe,{isSelected:m.is_active,onValueChange:s=>_({...m,is_active:s}),children:"Active"})}),e.jsx(u,{label:"Description",placeholder:"Module description",value:m.description,onChange:s=>_({...m,description:s.target.value}),className:"col-span-2"})]})}),e.jsxs(T,{children:[e.jsx(d,{variant:"flat",onClick:()=>Q(!1),children:"Cancel"}),e.jsx(d,{color:"primary",onClick:ds,isLoading:R,children:X?"Update":"Create"})]})]})}),e.jsx(U,{isOpen:es,onClose:()=>Z(!1),size:"xl",children:e.jsxs(V,{children:[e.jsx(B,{children:Y?"Edit Sub-Module":"Create New Sub-Module"}),e.jsx(K,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{label:"Code",placeholder:"SUBMODULE_CODE",value:f.code,onChange:s=>M({...f,code:s.target.value.toUpperCase()}),isRequired:!0}),e.jsx(u,{label:"Name",placeholder:"Sub-Module Name",value:f.name,onChange:s=>M({...f,name:s.target.value}),isRequired:!0}),e.jsx(u,{label:"Icon",placeholder:"Icon class name",value:f.icon,onChange:s=>M({...f,icon:s.target.value})}),e.jsx(u,{label:"Route",placeholder:"Named route",value:f.route,onChange:s=>M({...f,route:s.target.value})}),e.jsx(u,{label:"Priority",type:"number",value:f.priority,onChange:s=>M({...f,priority:parseInt(s.target.value)})}),e.jsx("div",{className:"flex items-center",children:e.jsx(xe,{isSelected:f.is_active,onValueChange:s=>M({...f,is_active:s}),children:"Active"})}),e.jsx(u,{label:"Description",placeholder:"Sub-module description",value:f.description,onChange:s=>M({...f,description:s.target.value}),className:"col-span-2"})]})}),e.jsxs(T,{children:[e.jsx(d,{variant:"flat",onClick:()=>Z(!1),children:"Cancel"}),e.jsx(d,{color:"primary",onClick:ms,isLoading:R,children:Y?"Update":"Create"})]})]})}),e.jsx(U,{isOpen:ss,onClose:()=>H(!1),size:"xl",children:e.jsxs(V,{children:[e.jsx(B,{children:ee?"Edit Component":"Create New Component"}),e.jsx(K,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{label:"Code",placeholder:"COMPONENT_CODE",value:g.code,onChange:s=>O({...g,code:s.target.value.toUpperCase()}),isRequired:!0}),e.jsx(u,{label:"Name",placeholder:"Component Name",value:g.name,onChange:s=>O({...g,name:s.target.value}),isRequired:!0}),e.jsx(ae,{label:"Type",selectedKeys:[g.type],onChange:s=>O({...g,type:s.target.value}),children:Object.entries($).map(([s,t])=>e.jsx(z,{value:s,children:t},s))}),e.jsx(u,{label:"Route",placeholder:"Named route",value:g.route,onChange:s=>O({...g,route:s.target.value})}),e.jsx("div",{className:"flex items-center col-span-2",children:e.jsx(xe,{isSelected:g.is_active,onValueChange:s=>O({...g,is_active:s}),children:"Active"})}),e.jsx(u,{label:"Description",placeholder:"Component description",value:g.description,onChange:s=>O({...g,description:s.target.value}),className:"col-span-2"})]})}),e.jsxs(T,{children:[e.jsx(d,{variant:"flat",onClick:()=>H(!1),children:"Cancel"}),e.jsx(d,{color:"primary",onClick:us,isLoading:R,children:ee?"Update":"Create"})]})]})}),e.jsx(U,{isOpen:ts,onClose:()=>W(!1),size:"4xl",scrollBehavior:"inside",children:e.jsxs(V,{children:[e.jsx(B,{className:"flex flex-col gap-1",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5 text-primary"}),"Manage Permissions - ",b==null?void 0:b.name]})}),e.jsxs(K,{children:[e.jsxs("p",{className:"text-sm text-default-500 mb-4",children:["Select the permissions required to access this ",(Ee=b==null?void 0:b.type)==null?void 0:Ee.replace("_","-"),"."]}),e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-4",children:[e.jsx(u,{placeholder:"Search permissions...",startContent:e.jsx(Ae,{className:"w-4 h-4 text-default-400"}),size:"sm",className:"max-w-xs",id:"permission-search",onValueChange:s=>{var t;(t=document.getElementById("permission-search"))==null||t.setAttribute("data-search",s.toLowerCase()),document.dispatchEvent(new CustomEvent("permission-search-change"))}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{size:"sm",variant:"flat",color:"primary",onPress:()=>F(p.map(s=>s.id)),children:"Select All"}),e.jsx(d,{size:"sm",variant:"flat",onPress:()=>F([]),children:"Clear All"})]})]}),e.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:Object.entries(Ds(p)).map(([s,t])=>{const a=t.permissions.map(o=>o.id),c=a.filter(o=>S.includes(o)).length,v=c===a.length,i=c>0&&c<a.length;return e.jsxs(Pe,{className:"bg-default-50 dark:bg-default-100/10",children:[e.jsx(qe,{className:"py-2 px-4",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(De,{isSelected:v,isIndeterminate:i,onValueChange:o=>{F(o?k=>[...new Set([...k,...a])]:k=>k.filter(I=>!a.includes(I)))},size:"sm"}),e.jsx("span",{className:"font-semibold text-foreground",children:t.name})]}),e.jsxs(w,{size:"sm",variant:"flat",color:v?"success":i?"warning":"default",children:[c,"/",a.length]})]})}),e.jsx(se,{className:"pt-0 pb-3 px-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:t.permissions.map(o=>e.jsxs("div",{className:`flex items-start gap-2 p-2 rounded-lg border transition-colors cursor-pointer ${S.includes(o.id)?"bg-primary-50 dark:bg-primary-900/20 border-primary-200 dark:border-primary-800":"bg-default-100/50 dark:bg-default-50/10 border-transparent hover:border-default-300"}`,onClick:()=>{S.includes(o.id)?F(S.filter(k=>k!==o.id)):F([...S,o.id])},children:[e.jsx(De,{isSelected:S.includes(o.id),onValueChange:k=>{F(k?[...S,o.id]:S.filter(I=>I!==o.id))},size:"sm",className:"mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:o.displayName}),e.jsx("p",{className:"text-xs text-default-400 truncate",children:o.description})]})]},o.id))})})]},s)})})]}),e.jsxs(T,{children:[e.jsx(d,{variant:"flat",onClick:()=>W(!1),children:"Cancel"}),e.jsxs(d,{color:"primary",onClick:ps,isLoading:R,children:["Save Permissions (",S.length,")"]})]})]})}),e.jsx(U,{isOpen:as,onClose:()=>J(!1),children:e.jsxs(V,{children:[e.jsx(B,{className:"text-danger",children:"Confirm Delete"}),e.jsxs(K,{children:[e.jsxs("p",{children:["Are you sure you want to delete ",e.jsx("strong",{children:x==null?void 0:x.name}),"?"]}),(x==null?void 0:x.type)==="module"&&e.jsx("p",{className:"text-sm text-warning mt-2",children:"This will also delete all sub-modules and components within this module."}),(x==null?void 0:x.type)==="sub_module"&&e.jsx("p",{className:"text-sm text-warning mt-2",children:"This will also delete all components within this sub-module."})]}),e.jsxs(T,{children:[e.jsx(d,{variant:"flat",onClick:()=>J(!1),children:"Cancel"}),e.jsx(d,{color:"danger",onClick:hs,isLoading:R,children:"Delete"})]})]})})]})};export{wt as default};
