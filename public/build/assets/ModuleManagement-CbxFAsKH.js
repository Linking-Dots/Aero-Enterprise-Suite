import{r,j as e,Q as js,d as l,F as gs,b as ee,s as vs,c as Ee,a as k,K as Pe,A as Oe}from"./app-DSivJ37S.js";import{G as Re}from"./GlassCard-DjjPWFfv.js";import{y as oe,z as Ie,A as ys,h as q,i as U,j as V,k as B,B as ze,C as ce,e as de,f as me,g as ue,m as N,D as Cs,E as ws}from"./Dashboard-FqWk0Tz3.js";import{P as bs}from"./PageHeader-D0rWxG_O.js";import{S as Ns}from"./StatsCards-Fvqv3Gwu.js";import{s as g}from"./toastUtils-YsQodt7k.js";import{F as Ue}from"./DocumentIcon-uxzNeQ_z.js";import{F as _s}from"./ShieldCheckIcon-DfXOg_eE.js";import{F as pe}from"./PlusIcon-H04lwQPO.js";import{F as $e}from"./MagnifyingGlassIcon-D9TuY5Zn.js";import{s as he}from"./chunk-TQNYOUFX-mFi7I5_m.js";import{m as K}from"./chunk-O5MCAK4F-meVClcjg.js";import{F as se}from"./KeyIcon-DjRXVdn6.js";import{c as Ae}from"./chunk-XJ2YRSUP-TBE5AybU.js";import{F as xe}from"./EllipsisVerticalIcon-Ihr4np30.js";import{F as fe}from"./PencilSquareIcon-CXed0DGJ.js";import{F as je}from"./TrashIcon-BwKJpJTf.js";import{m as De}from"./proxy-BqPgdXJb.js";import{t as Ss,F as Ms}from"./XMarkIcon-C5gTZPlc.js";import{i as u}from"./chunk-SSA7SXE4-ClfjWYsI.js";import{s as te,l as I}from"./chunk-Y2AYO5NJ-D8PvnQ9R.js";import{c as Le}from"./chunk-D5XJWRAV-D6OZGc78.js";import{c as w}from"./chunk-IHOGUXIG-CWsnyplo.js";import"./MapPinIcon-CHoFDG-Q.js";import"./EnvelopeIcon-DtWz0RiS.js";import"./UserGroupIcon-CIBswY5O.js";import"./ClockIcon-D1iAV5GK.js";import"./UserIcon-D-ngH0V8.js";import"./index-IZNYJ42U.js";import"./logo-Pwvcz7fP.js";import"./features-animation-B-xGpXuT.js";import"./create-visual-element-BWlUP2Oy.js";import"./CheckCircleIcon-Dtckxt6F.js";import"./ExclamationTriangleIcon-Rrv-mklB.js";import"./chunk-TLYTI3QM-DoYlfc9M.js";import"./useToggleState-DDeneAQW.js";function Fs({title:n,titleId:i,...p},h){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:h,"aria-labelledby":i},p),n?r.createElement("title",{id:i},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 0 1-1.125-1.125v-3.75ZM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 0 1-1.125-1.125v-8.25ZM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 0 1-1.125-1.125v-2.25Z"}))}const ks=r.forwardRef(Fs);function Es({title:n,titleId:i,...p},h){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:h,"aria-labelledby":i},p),n?r.createElement("title",{id:i},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.429 9.75 2.25 12l4.179 2.25m0-4.5 5.571 3 5.571-3m-11.142 0L2.25 7.5 12 2.25l9.75 5.25-4.179 2.25m0 0L21.75 12l-4.179 2.25m0 0 4.179 2.25L12 21.75 2.25 16.5l4.179-2.25m11.142 0-5.571 3-5.571-3"}))}const Ps=r.forwardRef(Es),Os={page:e.jsx(Ue,{className:"w-4 h-4"}),section:e.jsx(ks,{className:"w-4 h-4"}),widget:e.jsx(ws,{className:"w-4 h-4"}),action:e.jsx(Cs,{className:"w-4 h-4"}),api:e.jsx(Ms,{className:"w-4 h-4"})},qe={page:"primary",section:"secondary",widget:"success",action:"warning",api:"danger"},Rs={core_system:"primary",self_service:"secondary",human_resources:"success",project_management:"warning",document_management:"default",customer_relations:"primary",supply_chain:"secondary",retail_sales:"success",financial_management:"warning",system_administration:"danger"},ge={view:{label:"View",description:"Can view/read data"},create:{label:"Create",description:"Can create new records"},update:{label:"Edit",description:"Can modify existing records"},delete:{label:"Delete",description:"Can remove records"},import:{label:"Import",description:"Can import data from files"},export:{label:"Export",description:"Can export data to files"},approve:{label:"Approve",description:"Can approve requests"},assign:{label:"Assign",description:"Can assign to users"},manage:{label:"Manage",description:"Full management access"},operate:{label:"Operate",description:"Can operate/execute"},punch:{label:"Punch",description:"Can punch attendance"},change:{label:"Change",description:"Can change settings"},impersonate:{label:"Impersonate",description:"Can act as another user"},analytics:{label:"Analytics",description:"Can view analytics"},settings:{label:"Settings",description:"Can configure settings"},log:{label:"Log",description:"Can view logs"},schedule:{label:"Schedule",description:"Can manage schedules"},restore:{label:"Restore",description:"Can restore data"},own:{label:"Own",description:"Access to own records only"}},Ve=n=>n.split("-").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" "),Is=n=>{const i=n.split(".");if(i.length>=2){const p=Ve(i[0]),h=i[1];if(i.length>=3&&h==="own"){const z=i[2];return`${(ge[z]||{label:z.charAt(0).toUpperCase()+z.slice(1)}).label} Own ${p}`}return`${(ge[h]||{label:h.charAt(0).toUpperCase()+h.slice(1)}).label} ${p}`}return n},zs=n=>{var p;const i=n.split(".");if(i.length>=2){const h=i.length>=3&&i[1]==="own"?i[2]:i[1];return((p=ge[h])==null?void 0:p.description)||`Permission for ${n}`}return`Permission for ${n}`},$s=n=>{const i={};n.forEach(y=>{const E=y.name.split(".")[0];i[E]||(i[E]={name:Ve(E),permissions:[]}),i[E].permissions.push({...y,displayName:Is(y.name),description:zs(y.name)})});const p=Object.keys(i).sort(),h={};return p.forEach(y=>{h[y]=i[y]}),h},As=(n,i)=>{const[p,h]=r.useState(n);return r.useEffect(()=>{const y=setTimeout(()=>{h(n)},i);return()=>clearTimeout(y)},[n,i]),p},yt=n=>{var ke;const{modules:i=[],permissions:p=[],statistics:h={},categories:y={},componentTypes:z={},title:E="Module Permission Registry"}=n,[ve,Be]=r.useState(i),[A,Ke]=r.useState(h),[O,C]=r.useState(!1),[ye,Te]=r.useState(""),[T,Ge]=r.useState("all"),[D,Qe]=r.useState("all"),[Ze,He]=r.useState(new Set),[We,Je]=r.useState(new Set),[Xe,G]=r.useState(!1),[Ye,Q]=r.useState(!1),[es,Z]=r.useState(!1),[ss,H]=r.useState(!1),[ts,W]=r.useState(!1),[J,Ce]=r.useState(null),[X,we]=r.useState(null),[Y,be]=r.useState(null),[as,rs]=r.useState(null),[is,ns]=r.useState(null),[x,Ne]=r.useState(null),[b,ls]=r.useState(null),[c,_]=r.useState({code:"",name:"",description:"",icon:"",category:"core_system",route_prefix:"",is_active:!0,priority:100}),[f,M]=r.useState({code:"",name:"",description:"",icon:"",route:"",is_active:!0,priority:100}),[v,P]=r.useState({code:"",name:"",description:"",type:"page",route:"",is_active:!0}),[S,F]=r.useState([]),L=As(ye,300),ae=r.useMemo(()=>ve.filter(s=>{var j;const t=!L||s.name.toLowerCase().includes(L.toLowerCase())||s.code.toLowerCase().includes(L.toLowerCase())||((j=s.description)==null?void 0:j.toLowerCase().includes(L.toLowerCase())),a=T==="all"||s.category===T,o=D==="all"||D==="active"&&s.is_active||D==="inactive"&&!s.is_active;return t&&a&&o}),[ve,L,T,D]),os=r.useMemo(()=>[{title:"Total Modules",value:A.total_modules||0,icon:e.jsx(oe,{className:"w-6 h-6"}),color:"primary",description:"Top-level modules"},{title:"Sub-Modules",value:A.total_sub_modules||0,icon:e.jsx(Ie,{className:"w-6 h-6"}),color:"secondary",description:"Functional areas"},{title:"Components",value:A.total_components||0,icon:e.jsx(Ue,{className:"w-6 h-6"}),color:"success",description:"UI components"},{title:"Permission Rules",value:A.total_permission_requirements||0,icon:e.jsx(_s,{className:"w-6 h-6"}),color:"warning",description:"Access requirements"}],[A]),_e=s=>{He(t=>{const a=new Set(t);return a.has(s)?a.delete(s):a.add(s),a})},Se=s=>{Je(t=>{const a=new Set(t);return a.has(s)?a.delete(s):a.add(s),a})},$=async()=>{C(!0);try{const s=await k.get(route("modules.api.index"));Be(s.data.modules||[]),Ke(s.data.statistics||{}),g.success("Data refreshed successfully")}catch(s){g.error("Failed to refresh data"),console.error("Refresh error:",s)}finally{C(!1)}},re=(s=null)=>{s?(Ce(s),_({code:s.code,name:s.name,description:s.description||"",icon:s.icon||"",category:s.category||"core_system",route_prefix:s.route_prefix||"",is_active:s.is_active,priority:s.priority||100})):(Ce(null),_({code:"",name:"",description:"",icon:"",category:"core_system",route_prefix:"",is_active:!0,priority:100})),G(!0)},Me=(s,t=null)=>{rs(s),t?(we(t),M({code:t.code,name:t.name,description:t.description||"",icon:t.icon||"",route:t.route||"",is_active:t.is_active,priority:t.priority||100})):(we(null),M({code:"",name:"",description:"",icon:"",route:"",is_active:!0,priority:100})),Q(!0)},Fe=(s,t=null)=>{ns(s),t?(be(t),P({code:t.code,name:t.name,description:t.description||"",type:t.type||"page",route:t.route||"",is_active:t.is_active})):(be(null),P({code:"",name:"",description:"",type:"page",route:"",is_active:!0})),Z(!0)},ie=s=>{var a;ls(s);const t=((a=s.permission_requirements)==null?void 0:a.map(o=>o.permission_id))||[];F(t),H(!0)},cs=async()=>{var s,t;C(!0);try{J?(await k.put(route("modules.update",J.id),c),g.success("Module updated successfully")):(await k.post(route("modules.store"),c),g.success("Module created successfully")),G(!1),$()}catch(a){g.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to save module")}finally{C(!1)}},ds=async()=>{var s,t;C(!0);try{X?(await k.put(route("modules.sub-modules.update",X.id),f),g.success("Sub-module updated successfully")):(await k.post(route("modules.sub-modules.store",as),f),g.success("Sub-module created successfully")),Q(!1),$()}catch(a){g.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to save sub-module")}finally{C(!1)}},ms=async()=>{var s,t;C(!0);try{Y?(await k.put(route("modules.components.update",Y.id),v),g.success("Component updated successfully")):(await k.post(route("modules.components.store",is),v),g.success("Component created successfully")),Z(!1),$()}catch(a){g.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to save component")}finally{C(!1)}},us=async()=>{var s,t;C(!0);try{let a;b.type==="module"?a=route("modules.sync-permissions",b.id):b.type==="sub_module"?a=route("modules.sub-modules.sync-permissions",b.id):a=route("modules.components.sync-permissions",b.id);const o=S.map(j=>{const d=p.find(m=>m.id===j);return{permission:(d==null?void 0:d.name)||"",type:"required",group:null}}).filter(j=>j.permission);await k.post(a,{permissions:o}),g.success("Permissions updated successfully"),H(!1),$()}catch(a){console.error("Error saving permissions:",a),g.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to save permissions")}finally{C(!1)}},ne=(s,t)=>{Ne({...s,type:t}),W(!0)},ps=async()=>{var s,t;if(x){C(!0);try{let a;x.type==="module"?a=route("modules.destroy",x.id):x.type==="sub_module"?a=route("modules.sub-modules.destroy",x.id):a=route("modules.components.destroy",x.id),await k.delete(a),g.success(`${x.type.replace("_"," ")} deleted successfully`),W(!1),Ne(null),$()}catch(a){g.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to delete")}finally{C(!1)}}},hs=s=>{var j;const t=Ze.has(s.id),a=s.sub_modules||[],o=((j=s.permission_requirements)==null?void 0:j.length)||0;return e.jsx(Ee,{className:"mb-3",children:e.jsxs(ee,{className:"p-0",children:[e.jsxs("div",{className:`flex items-center justify-between p-4 cursor-pointer hover:bg-default-100 transition-colors ${s.is_active?"":"opacity-60"}`,onClick:()=>_e(s.id),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(l,{isIconOnly:!0,size:"sm",variant:"light",onClick:d=>{d.stopPropagation(),_e(s.id)},children:t?e.jsx(Pe,{className:"w-4 h-4"}):e.jsx(ze,{className:"w-4 h-4"})}),e.jsx(oe,{className:"w-6 h-6 text-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:s.name}),e.jsx(w,{size:"sm",variant:"flat",color:Rs[s.category]||"default",children:s.code}),!s.is_active&&e.jsx(w,{size:"sm",variant:"flat",color:"danger",children:"Inactive"})]}),e.jsx("p",{className:"text-sm text-default-500 mt-1",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{content:a.length,color:"primary",size:"sm",children:e.jsx(w,{size:"sm",variant:"bordered",children:"Sub-modules"})}),e.jsx(ce,{content:o,color:"warning",size:"sm",children:e.jsx(w,{size:"sm",variant:"bordered",children:"Permissions"})}),e.jsxs(de,{children:[e.jsx(me,{children:e.jsx(l,{isIconOnly:!0,size:"sm",variant:"light",onClick:d=>d.stopPropagation(),children:e.jsx(xe,{className:"w-5 h-5"})})}),e.jsxs(ue,{children:[e.jsx(N,{startContent:e.jsx(fe,{className:"w-4 h-4"}),onClick:()=>re(s),children:"Edit Module"},"edit"),e.jsx(N,{startContent:e.jsx(se,{className:"w-4 h-4"}),onClick:()=>ie({...s,type:"module"}),children:"Manage Permissions"},"permissions"),e.jsx(N,{startContent:e.jsx(pe,{className:"w-4 h-4"}),onClick:()=>Me(s.id),children:"Add Sub-Module"},"add-submodule"),e.jsx(N,{startContent:e.jsx(je,{className:"w-4 h-4"}),color:"danger",className:"text-danger",onClick:()=>ne(s,"module"),children:"Delete Module"},"delete")]})]})]})]}),e.jsx(Oe,{children:t&&a.length>0&&e.jsx(De.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"border-t border-default-200",children:e.jsx("div",{className:"pl-8 py-2",children:a.map(d=>xs(d,s.id))})})})]})},s.id)},xs=(s,t)=>{var j;const a=We.has(s.id),o=s.components||[];return(j=s.permission_requirements)!=null&&j.length,e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg bg-default-50 hover:bg-default-100 cursor-pointer transition-colors ${s.is_active?"":"opacity-60"}`,onClick:()=>Se(s.id),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(l,{isIconOnly:!0,size:"sm",variant:"light",onClick:d=>{d.stopPropagation(),Se(s.id)},children:a?e.jsx(Pe,{className:"w-4 h-4"}):e.jsx(ze,{className:"w-4 h-4"})}),e.jsx(Ie,{className:"w-5 h-5 text-secondary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx(w,{size:"sm",variant:"flat",color:"secondary",children:s.code}),!s.is_active&&e.jsx(w,{size:"sm",variant:"flat",color:"danger",children:"Inactive"})]}),s.description&&e.jsx("p",{className:"text-xs text-default-400 mt-0.5",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{content:o.length,color:"success",size:"sm",children:e.jsx(w,{size:"sm",variant:"bordered",children:"Components"})}),e.jsxs(de,{children:[e.jsx(me,{children:e.jsx(l,{isIconOnly:!0,size:"sm",variant:"light",onClick:d=>d.stopPropagation(),children:e.jsx(xe,{className:"w-4 h-4"})})}),e.jsxs(ue,{children:[e.jsx(N,{startContent:e.jsx(fe,{className:"w-4 h-4"}),onClick:()=>Me(t,s),children:"Edit Sub-Module"},"edit"),e.jsx(N,{startContent:e.jsx(se,{className:"w-4 h-4"}),onClick:()=>ie({...s,type:"sub_module"}),children:"Manage Permissions"},"permissions"),e.jsx(N,{startContent:e.jsx(pe,{className:"w-4 h-4"}),onClick:()=>Fe(s.id),children:"Add Component"},"add-component"),e.jsx(N,{startContent:e.jsx(je,{className:"w-4 h-4"}),color:"danger",className:"text-danger",onClick:()=>ne(s,"sub_module"),children:"Delete Sub-Module"},"delete")]})]})]})]}),e.jsx(Oe,{children:a&&o.length>0&&e.jsx(De.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"pl-10 mt-2",children:o.map(d=>fs(d,s.id))})})]},s.id)},fs=(s,t)=>{var o;const a=((o=s.permission_requirements)==null?void 0:o.length)||0;return e.jsxs("div",{className:`flex items-center justify-between p-2 rounded-md bg-default-100 hover:bg-default-200 mb-1 transition-colors ${s.is_active?"":"opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(Ss,{content:s.type,children:e.jsx("span",{className:`text-${qe[s.type]}`,children:Os[s.type]})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:s.name}),e.jsx(w,{size:"sm",variant:"flat",color:qe[s.type],children:s.type}),s.route&&e.jsx(w,{size:"sm",variant:"bordered",color:"default",children:s.route})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a>0&&e.jsxs(w,{size:"sm",variant:"flat",color:"warning",children:[a," perms"]}),e.jsxs(de,{children:[e.jsx(me,{children:e.jsx(l,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(xe,{className:"w-4 h-4"})})}),e.jsxs(ue,{children:[e.jsx(N,{startContent:e.jsx(fe,{className:"w-4 h-4"}),onClick:()=>Fe(t,s),children:"Edit Component"},"edit"),e.jsx(N,{startContent:e.jsx(se,{className:"w-4 h-4"}),onClick:()=>ie({...s,type:"component"}),children:"Manage Permissions"},"permissions"),e.jsx(N,{startContent:e.jsx(je,{className:"w-4 h-4"}),color:"danger",className:"text-danger",onClick:()=>ne(s,"component"),children:"Delete Component"},"delete")]})]})]})]},s.id)};return e.jsxs(ys,{children:[e.jsx(js,{title:E}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx(bs,{title:E,subtitle:"Manage module permissions and access control hierarchy",icon:e.jsx(Ps,{className:"w-8 h-8"}),actions:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"flat",startContent:e.jsx(gs,{className:"w-4 h-4"}),onClick:$,isLoading:O,children:"Refresh"}),e.jsx(l,{color:"primary",startContent:e.jsx(pe,{className:"w-4 h-4"}),onClick:()=>re(),children:"Add Module"})]})}),e.jsx(Ns,{stats:os,className:"mb-6"}),e.jsx(Re,{className:"mb-6",children:e.jsx(ee,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(u,{placeholder:"Search modules...",value:ye,onChange:s=>Te(s.target.value),startContent:e.jsx($e,{className:"w-4 h-4 text-default-400"}),className:"flex-1"}),e.jsxs(te,{label:"Category",selectedKeys:[T],onChange:s=>Ge(s.target.value),className:"w-full sm:w-48",children:[e.jsx(I,{value:"all",children:"All Categories"},"all"),Object.entries(y).map(([s,t])=>e.jsx(I,{value:s,children:t},s))]}),e.jsxs(te,{label:"Status",selectedKeys:[D],onChange:s=>Qe(s.target.value),className:"w-full sm:w-36",children:[e.jsx(I,{value:"all",children:"All"},"all"),e.jsx(I,{value:"active",children:"Active"},"active"),e.jsx(I,{value:"inactive",children:"Inactive"},"inactive")]})]})})}),e.jsxs(Re,{children:[e.jsxs(Le,{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Module Hierarchy"}),e.jsxs(w,{variant:"flat",color:"default",children:[ae.length," modules"]})]}),e.jsx(ee,{children:O?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(vs,{size:"lg"})}):ae.length===0?e.jsxs("div",{className:"text-center py-12 text-default-500",children:[e.jsx(oe,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No modules found"}),e.jsx(l,{color:"primary",variant:"flat",className:"mt-4",onClick:()=>re(),children:"Create First Module"})]}):e.jsx("div",{className:"space-y-2",children:ae.map(s=>hs(s))})})]})]}),e.jsx(q,{isOpen:Xe,onClose:()=>G(!1),size:"2xl",children:e.jsxs(U,{children:[e.jsx(V,{children:J?"Edit Module":"Create New Module"}),e.jsx(B,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{label:"Code",placeholder:"MODULE_CODE",value:c.code,onChange:s=>_({...c,code:s.target.value.toUpperCase()}),isRequired:!0}),e.jsx(u,{label:"Name",placeholder:"Module Name",value:c.name,onChange:s=>_({...c,name:s.target.value}),isRequired:!0}),e.jsx(u,{label:"Icon",placeholder:"Icon class name",value:c.icon,onChange:s=>_({...c,icon:s.target.value}),className:"col-span-2"}),e.jsx(u,{label:"Route Prefix",placeholder:"/module-route",value:c.route_prefix,onChange:s=>_({...c,route_prefix:s.target.value})}),e.jsx(te,{label:"Category",selectedKeys:[c.category],onChange:s=>_({...c,category:s.target.value}),children:Object.entries(y).map(([s,t])=>e.jsx(I,{value:s,children:t},s))}),e.jsx(u,{label:"Priority",type:"number",value:c.priority,onChange:s=>_({...c,priority:parseInt(s.target.value)})}),e.jsx("div",{className:"flex items-center",children:e.jsx(he,{isSelected:c.is_active,onValueChange:s=>_({...c,is_active:s}),children:"Active"})}),e.jsx(u,{label:"Description",placeholder:"Module description",value:c.description,onChange:s=>_({...c,description:s.target.value}),className:"col-span-2"})]})}),e.jsxs(K,{children:[e.jsx(l,{variant:"flat",onClick:()=>G(!1),children:"Cancel"}),e.jsx(l,{color:"primary",onClick:cs,isLoading:O,children:J?"Update":"Create"})]})]})}),e.jsx(q,{isOpen:Ye,onClose:()=>Q(!1),size:"xl",children:e.jsxs(U,{children:[e.jsx(V,{children:X?"Edit Sub-Module":"Create New Sub-Module"}),e.jsx(B,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{label:"Code",placeholder:"SUBMODULE_CODE",value:f.code,onChange:s=>M({...f,code:s.target.value.toUpperCase()}),isRequired:!0}),e.jsx(u,{label:"Name",placeholder:"Sub-Module Name",value:f.name,onChange:s=>M({...f,name:s.target.value}),isRequired:!0}),e.jsx(u,{label:"Icon",placeholder:"Icon class name",value:f.icon,onChange:s=>M({...f,icon:s.target.value})}),e.jsx(u,{label:"Route",placeholder:"Named route",value:f.route,onChange:s=>M({...f,route:s.target.value})}),e.jsx(u,{label:"Priority",type:"number",value:f.priority,onChange:s=>M({...f,priority:parseInt(s.target.value)})}),e.jsx("div",{className:"flex items-center",children:e.jsx(he,{isSelected:f.is_active,onValueChange:s=>M({...f,is_active:s}),children:"Active"})}),e.jsx(u,{label:"Description",placeholder:"Sub-module description",value:f.description,onChange:s=>M({...f,description:s.target.value}),className:"col-span-2"})]})}),e.jsxs(K,{children:[e.jsx(l,{variant:"flat",onClick:()=>Q(!1),children:"Cancel"}),e.jsx(l,{color:"primary",onClick:ds,isLoading:O,children:X?"Update":"Create"})]})]})}),e.jsx(q,{isOpen:es,onClose:()=>Z(!1),size:"xl",children:e.jsxs(U,{children:[e.jsx(V,{children:Y?"Edit Component":"Create New Component"}),e.jsx(B,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{label:"Code",placeholder:"COMPONENT_CODE",value:v.code,onChange:s=>P({...v,code:s.target.value.toUpperCase()}),isRequired:!0}),e.jsx(u,{label:"Name",placeholder:"Component Name",value:v.name,onChange:s=>P({...v,name:s.target.value}),isRequired:!0}),e.jsx(te,{label:"Type",selectedKeys:[v.type],onChange:s=>P({...v,type:s.target.value}),children:Object.entries(z).map(([s,t])=>e.jsx(I,{value:s,children:t},s))}),e.jsx(u,{label:"Route",placeholder:"Named route",value:v.route,onChange:s=>P({...v,route:s.target.value})}),e.jsx("div",{className:"flex items-center col-span-2",children:e.jsx(he,{isSelected:v.is_active,onValueChange:s=>P({...v,is_active:s}),children:"Active"})}),e.jsx(u,{label:"Description",placeholder:"Component description",value:v.description,onChange:s=>P({...v,description:s.target.value}),className:"col-span-2"})]})}),e.jsxs(K,{children:[e.jsx(l,{variant:"flat",onClick:()=>Z(!1),children:"Cancel"}),e.jsx(l,{color:"primary",onClick:ms,isLoading:O,children:Y?"Update":"Create"})]})]})}),e.jsx(q,{isOpen:ss,onClose:()=>H(!1),size:"4xl",scrollBehavior:"inside",children:e.jsxs(U,{children:[e.jsx(V,{className:"flex flex-col gap-1",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-primary"}),"Manage Permissions - ",b==null?void 0:b.name]})}),e.jsxs(B,{children:[e.jsxs("p",{className:"text-sm text-default-500 mb-4",children:["Select the permissions required to access this ",(ke=b==null?void 0:b.type)==null?void 0:ke.replace("_","-"),"."]}),e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-4",children:[e.jsx(u,{placeholder:"Search permissions...",startContent:e.jsx($e,{className:"w-4 h-4 text-default-400"}),size:"sm",className:"max-w-xs",id:"permission-search",onValueChange:s=>{var t;(t=document.getElementById("permission-search"))==null||t.setAttribute("data-search",s.toLowerCase()),document.dispatchEvent(new CustomEvent("permission-search-change"))}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{size:"sm",variant:"flat",color:"primary",onPress:()=>F(p.map(s=>s.id)),children:"Select All"}),e.jsx(l,{size:"sm",variant:"flat",onPress:()=>F([]),children:"Clear All"})]})]}),e.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:Object.entries($s(p)).map(([s,t])=>{const a=t.permissions.map(m=>m.id),o=a.filter(m=>S.includes(m)).length,j=o===a.length,d=o>0&&o<a.length;return e.jsxs(Ee,{className:"bg-default-50 dark:bg-default-100/10",children:[e.jsx(Le,{className:"py-2 px-4",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ae,{isSelected:j,isIndeterminate:d,onValueChange:m=>{F(m?R=>[...new Set([...R,...a])]:R=>R.filter(le=>!a.includes(le)))},size:"sm"}),e.jsx("span",{className:"font-semibold text-foreground",children:t.name})]}),e.jsxs(w,{size:"sm",variant:"flat",color:j?"success":d?"warning":"default",children:[o,"/",a.length]})]})}),e.jsx(ee,{className:"pt-0 pb-3 px-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:t.permissions.map(m=>e.jsxs("div",{className:`flex items-start gap-2 p-2 rounded-lg border transition-colors cursor-pointer ${S.includes(m.id)?"bg-primary-50 dark:bg-primary-900/20 border-primary-200 dark:border-primary-800":"bg-default-100/50 dark:bg-default-50/10 border-transparent hover:border-default-300"}`,onClick:()=>{S.includes(m.id)?F(S.filter(R=>R!==m.id)):F([...S,m.id])},children:[e.jsx(Ae,{isSelected:S.includes(m.id),onValueChange:R=>{F(R?[...S,m.id]:S.filter(le=>le!==m.id))},size:"sm",className:"mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:m.displayName}),e.jsx("p",{className:"text-xs text-default-400 truncate",children:m.description})]})]},m.id))})})]},s)})})]}),e.jsxs(K,{children:[e.jsx(l,{variant:"flat",onClick:()=>H(!1),children:"Cancel"}),e.jsxs(l,{color:"primary",onClick:us,isLoading:O,children:["Save Permissions (",S.length,")"]})]})]})}),e.jsx(q,{isOpen:ts,onClose:()=>W(!1),children:e.jsxs(U,{children:[e.jsx(V,{className:"text-danger",children:"Confirm Delete"}),e.jsxs(B,{children:[e.jsxs("p",{children:["Are you sure you want to delete ",e.jsx("strong",{children:x==null?void 0:x.name}),"?"]}),(x==null?void 0:x.type)==="module"&&e.jsx("p",{className:"text-sm text-warning mt-2",children:"This will also delete all sub-modules and components within this module."}),(x==null?void 0:x.type)==="sub_module"&&e.jsx("p",{className:"text-sm text-warning mt-2",children:"This will also delete all components within this sub-module."})]}),e.jsxs(K,{children:[e.jsx(l,{variant:"flat",onClick:()=>W(!1),children:"Cancel"}),e.jsx(l,{color:"danger",onClick:ps,isLoading:O,children:"Delete"})]})]})})]})};export{yt as default};
