import{j as e,r as d,M as ds,e as ae,L as os,F as te,a as ne,H as Ds,g as Y,h as Z,f as ge}from"./app-B8QYX9Px.js";import{g as Ts,a as cs}from"./glassyStyles-CyKP3lIN.js";import{t as ms,v as xs,w as hs,x as se,c as G,a as Ns,f as ce,K as ys,B as k,H as As,I as me,m as P,u as ps,y as be,g as zs,E as Ls,A as Es}from"./App-DkF9RL3Y.js";import{u as Ne,B as xe,T as C,G as Ms,F as Os}from"./logo-BoX8pchB.js";import{P as Ws}from"./PageHeader-XJFWVm9P.js";import{S as Bs}from"./StatsCards-DEVVTSBN.js";import{F as _s}from"./EllipsisVerticalIcon-B1J6VG1L.js";import{F as fe}from"./UserIcon-D9_80nkG.js";import{F as Cs}from"./PencilIcon-q28LArt-.js";import{b as ve,F as je,c as Hs,a as us}from"./SignalIcon-DyWSYoJq.js";import{F as we}from"./LockClosedIcon-BeHuUmSy.js";import{a as he}from"./ShieldCheckIcon-RZqgNGJW.js";import{F as Vs}from"./EnvelopeIcon-B1M8vjD_.js";import{t as Gs,a as qs,b as Js,c as Qs,d as Xs,e as Ys}from"./chunk-F3UDT23P-Hrzl6yhk.js";import{p as ks}from"./chunk-EAPQ7RWQ-OKuZgSIq.js";import{t as Zs}from"./chunk-BOOVDPB6-CftkAAhs.js";import{u as Ps}from"./chunk-S574QCAN-CoPQlLbo.js";import{C as Ks}from"./Clear-Defissbz.js";import{G as et}from"./GlassDialog-w1fMVGB6.js";import{c as ye,F as R,G as st,C as tt}from"./Grow-DP1KP2ex.js";import{D as at}from"./DialogTitle-B_yNWDSa.js";import{D as rt,a as lt}from"./DialogContent-DYCSoO7D.js";import{A as it}from"./Avatar-BIHQefTu.js";import{P as nt}from"./PhotoCamera-DOFbEoe1.js";import{T as z,F as oe}from"./TextField-BAa6JqDO.js";import{I as re}from"./InputLabel-CehJzubO.js";import{S as le,M as dt}from"./Select-8HD_0XQO.js";import{M as y}from"./MenuItem-BN00sQGI.js";import{L as ot}from"./LoadingButton-BJ0_t8OA.js";import{F as gs}from"./CheckCircleIcon-B90VRiLI.js";import{F as bs}from"./XCircleIcon-tcb-l3UC.js";import{F as ct}from"./TrophyIcon-DiD_qCdy.js";import{F as mt}from"./UserPlusIcon-D1Sf0MxE.js";import{F as fs}from"./ChartBarIcon-BBONCpWc.js";import{F as xt}from"./ChartPieIcon-UU3dKDS-.js";import{F as ht}from"./ExclamationTriangleIcon-BW32ASrn.js";import{I as pt}from"./InputAdornment-Cc_eLtv_.js";import{F as ut}from"./TableCellsIcon-DR_7sKkt.js";import{F as gt}from"./AdjustmentsHorizontalIcon-BrcFRj1g.js";import{b as bt}from"./chunk-57V4RE7B-DRnWK4yB.js";import"./create-visual-element-4S4I33NB.js";import"./chunk-D5XJWRAV-zQzkTunB.js";import"./useHasTabbableChild-CrUAHYqA.js";import"./index-Dxlg9OmP.js";import"./index-CokAva9Y.js";import"./Dialog-Bo_XotCr.js";import"./listItemTextClasses-DfTDYmaW.js";import"./Button-CpKhJqSS.js";const ft=ye(e.jsx("path",{d:"M2 17h20v2H2zm1.15-4.05L4 11.47l.85 1.48 1.3-.75-.85-1.48H7v-1.5H5.3l.85-1.47L4.85 7 4 8.47 3.15 7l-1.3.75.85 1.47H1v1.5h1.7l-.85 1.48zm6.7-.75 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H15v-1.5h-1.7l.85-1.47-1.3-.75L12 8.47 11.15 7l-1.3.75.85 1.47H9v1.5h1.7zM23 9.22h-1.7l.85-1.47-1.3-.75L20 8.47 19.15 7l-1.3.75.85 1.47H17v1.5h1.7l-.85 1.48 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H23z"})),vs=ye(e.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),js=ye(e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"})),vt=({allUsers:r,roles:M,isMobile:U,isTablet:u,setUsers:L,pagination:b,onPageChange:w,onRowsPerPageChange:F,totalUsers:I=0,onEdit:q,loading:x=!1,updateUserOptimized:ie,deleteUserOptimized:c,toggleUserStatusOptimized:O,updateUserRolesOptimized:W,toggleSingleDeviceLogin:$,resetUserDevice:B,deviceActions:H={}})=>{const[K,h]=d.useState({});Ne();const V=(s,a="w-5 h-5")=>{const i=(s==null?void 0:s.toLowerCase())||"";return i.includes("mobile")||i.includes("android")||i.includes("iphone")?e.jsx(je,{className:`${a} text-primary`}):i.includes("tablet")||i.includes("ipad")?e.jsx(Hs,{className:`${a} text-secondary`}):e.jsx(As,{className:`${a} text-default-500`})},J=s=>{const a=(s==null?void 0:s.toLowerCase())||"";return a.includes("mobile")||a.includes("android")||a.includes("iphone")?"Mobile Device":a.includes("tablet")||a.includes("ipad")?"Tablet":"Desktop"},S=(s,a,i)=>{h(o=>({...o,[`${s}-${a}`]:i}))},g=(s,a)=>K[`${s}-${a}`]||!1;async function n(s,a){S(s,"role",!0);const i=new Promise(async(o,p)=>{var D;try{const N=await axios.post(route("user.updateRole",{id:s}),{roles:a});N.status===200&&(W&&W(s,a),o([N.data.message||"Role updated successfully"]))}catch(N){((D=N.response)==null?void 0:D.status)===422?p(N.response.data.errors||["Failed to update user role."]):p(["An unexpected error occurred. Please try again later."])}finally{S(s,"role",!1)}});return k.promise(i,{pending:"Updating employee role...",success:{render({data:o}){return o.join(", ")}},error:{render({data:o}){return Array.isArray(o)?o.join(", "):o}}}),i}const _=d.useMemo(()=>{const s=[{name:"#",uid:"sl"},{name:"USER",uid:"user"},{name:"EMAIL",uid:"email"},{name:"DEPARTMENT",uid:"department"},{name:"DEVICE STATUS",uid:"device_status"},{name:"STATUS",uid:"status"},{name:"ROLES",uid:"roles"},{name:"ACTIONS",uid:"actions"}];if(!U&&!u)s.splice(3,0,{name:"PHONE",uid:"phone"});else if(U)s.splice(s.findIndex(a=>a.uid==="department"),1),s.splice(s.findIndex(a=>a.uid==="device_status"),1);else if(u){const a=s.findIndex(i=>i.uid==="device_status");if(a>-1){const i=s.splice(a,1)[0];s.splice(2,0,i)}}return s},[U,u]),Q=async(s,a)=>{if(!g(s,"status")){S(s,"status",!0);try{O?(O(s,!a),k.success(`User status ${a?"deactivated":"activated"} successfully`)):L&&(L(i=>i.map(o=>o.id===s?{...o,active:!a}:o)),k.success(`User status ${a?"deactivated":"activated"} successfully`))}catch(i){console.error("Error toggling user status:",i),k.error("Failed to update user status")}finally{S(s,"status",!1)}}},X=(s,a,i)=>{var p;const o=s[a];switch(a){case"sl":const T=(b!=null&&b.currentPage&&(b!=null&&b.perPage)?Number((b.currentPage-1)*b.perPage):0)+(typeof i=="number"?i:0)+1;return e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-content1/20 backdrop-blur-md rounded-lg border border-divider",children:e.jsx("span",{className:"text-sm font-semibold text-foreground",children:T})})});case"user":return e.jsx(Ps,{className:"w-fit max-w-full",avatarProps:{radius:"lg",size:"sm",src:(s==null?void 0:s.profile_image_url)||(s==null?void 0:s.profile_image),showFallback:!0,name:(s==null?void 0:s.name)||"Unnamed User",isBordered:!0},name:e.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:(s==null?void 0:s.name)||"Unnamed User"})});case"email":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(Vs,{className:"w-4 h-4 text-default-400 mr-2"}),e.jsx("span",{className:"text-sm",children:s.email})]});case"phone":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(ys,{className:"w-4 h-4 text-default-400 mr-2"}),e.jsx("span",{className:"text-sm",children:s.phone||"N/A"})]});case"department":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-4 h-4 text-default-400 mr-2"}),e.jsx("span",{className:"text-sm",children:(s==null?void 0:s.department)||"N/A"})]});case"device_status":const A=g(s.id,"deviceToggle");return e.jsx("div",{className:"flex items-center space-x-2",children:s.single_device_login?e.jsxs(e.Fragment,{children:[e.jsx(G,{size:"sm",variant:"flat",color:s.active_device?"warning":"success",startContent:A?e.jsx("div",{className:"animate-spin",children:e.jsx(te,{className:"w-3 h-3"})}):s.active_device?e.jsx(we,{className:"w-3 h-3"}):e.jsx(ve,{className:"w-3 h-3"}),children:A?"Loading...":s.active_device?"Locked":"Free"}),s.active_device&&!A&&e.jsx(Zs,{content:e.jsxs("div",{className:"bg-content1/20 backdrop-blur-md border border-divider rounded-lg p-4 shadow-2xl max-w-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[V(s.active_device.user_agent,"w-5 h-5"),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-foreground text-sm",children:s.active_device.device_name||"Unknown Device"}),e.jsx("div",{className:"text-xs text-default-500",children:J(s.active_device.user_agent)})]})]}),e.jsx("div",{className:"space-y-2 text-xs",children:e.jsx("div",{className:"pt-2 mt-2 border-t border-white/20",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ns,{className:"w-3 h-3 text-success"}),e.jsx("span",{className:"text-success text-xs font-medium",children:s.active_device.is_active?"Currently Active":"Inactive"})]})})})]}),placement:"top",classNames:{content:"p-0 bg-transparent shadow-none border-none"},children:e.jsx("div",{className:"flex items-center p-1 rounded-sm hover:bg-content1/10 transition-colors cursor-default",children:V(s.active_device.user_agent,"w-4 h-4")})})]}):e.jsx(G,{size:"sm",variant:"flat",color:"default",startContent:A?e.jsx("div",{className:"animate-spin",children:e.jsx(te,{className:"w-3 h-3"})}):e.jsx(he,{className:"w-3 h-3"}),children:A?"Loading...":"Disabled"})});case"status":return e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:s.active,onChange:()=>Q(s.id,s.active),disabled:g(s.id,"status")}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-hidden peer-focus:ring-4 peer-focus:ring-opacity-30 rounded-full peer transition-all duration-300 ${s.active?"bg-green-500 peer-focus:ring-green-300":"bg-red-500 peer-focus:ring-red-300"} peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all`}),g(s.id,"status")&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),e.jsx("span",{className:"ml-2 text-xs",children:s.active?"Active":"Inactive"})]});case"roles":const pe=((p=s.roles)==null?void 0:p.map(j=>typeof j=="object"&&j!==null?j.name:j))||[],ee=new Set(pe),de=Array.from(ee).join(", ")||"No Roles";return e.jsx("div",{className:"flex items-center",children:e.jsxs(ms,{isDisabled:g(s.id,"role"),className:"max-w-[220px]",children:[e.jsx(xs,{children:e.jsx(ae,{className:"capitalize",variant:"bordered",size:"sm",startContent:g(s.id,"role")?e.jsx(ds,{size:"sm"}):null,children:de})}),e.jsx(hs,{disallowEmptySelection:!1,"aria-label":"Multiple selection example",closeOnSelect:!1,selectedKeys:ee,selectionMode:"multiple",variant:"flat",onSelectionChange:j=>{const ue=Array.from(j);n(s.id,ue)},children:(M||[]).map(j=>e.jsx(se,{children:typeof j=="object"&&j!==null?j.name:j},typeof j=="object"&&j!==null?j.name:j))})]})});case"actions":return e.jsx("div",{className:"flex justify-center items-center",children:e.jsxs(ms,{children:[e.jsx(xs,{children:e.jsx(ae,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",children:e.jsx(_s,{className:"w-4 h-4"})})}),e.jsxs(hs,{"aria-label":"User Actions",children:[e.jsx(se,{textValue:"View Profile",href:route("profile",{user:s.id}),as:os,className:"text-blue-500",startContent:e.jsx(fe,{className:"w-4 h-4"}),children:"View Profile"}),e.jsx(se,{textValue:"Edit User",onPress:()=>{q&&q(s)},className:"text-amber-500",startContent:e.jsx(Cs,{className:"w-4 h-4"}),children:"Edit"}),e.jsx(se,{textValue:"Device Toggle",onPress:()=>{$&&!g(s.id,"deviceToggle")&&(S(s.id,"deviceToggle",!0),$(s.id,!s.single_device_login).finally(()=>{S(s.id,"deviceToggle",!1)}))},isDisabled:H[s.id]||g(s.id,"deviceToggle"),startContent:g(s.id,"deviceToggle")?e.jsx("div",{className:"animate-spin",children:e.jsx(te,{className:"w-4 h-4"})}):s.single_device_login?e.jsx(ve,{className:"w-4 h-4"}):e.jsx(we,{className:"w-4 h-4"}),className:s.single_device_login?"text-orange-500":"text-green-500",children:g(s.id,"deviceToggle")?"Processing...":s.single_device_login?"Disable Device Lock":"Enable Device Lock"}),s.single_device_login&&s.active_device&&e.jsx(se,{textValue:"Reset Device",onPress:()=>{B&&!g(s.id,"deviceReset")&&(S(s.id,"deviceReset",!0),B(s.id).finally(()=>{S(s.id,"deviceReset",!1)}))},isDisabled:H[s.id]||g(s.id,"deviceReset"),startContent:g(s.id,"deviceReset")?e.jsx("div",{className:"animate-spin",children:e.jsx(te,{className:"w-4 h-4"})}):e.jsx(te,{className:"w-4 h-4"}),className:"text-red-500",children:g(s.id,"deviceReset")?"Resetting...":"Reset Device"}),e.jsx(se,{textValue:"View Devices",href:route("users.device.show",{user:s.id}),as:os,startContent:e.jsx(je,{className:"w-4 h-4"}),className:"text-blue-500",children:"View Device History"})]})]})});default:return o}},f=()=>!r||!I||x?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-divider bg-content1/50 backdrop-blur-md",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(b.currentPage-1)*b.perPage+1," to ",Math.min(b.currentPage*b.perPage,I)," of ",I," users"]}),e.jsx(ks,{total:Math.ceil(I/b.perPage),initialPage:b.currentPage,page:b.currentPage,onChange:w,size:U?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-content1/20 backdrop-blur-md border-divider hover:bg-content1/30",cursor:"bg-content1/40 backdrop-blur-md border-divider"}})]});return e.jsxs("div",{className:"w-full overflow-hidden flex flex-col border border-divider rounded-lg bg-content1/10 backdrop-blur-md",style:{maxHeight:"calc(100vh - 200px)"},children:[e.jsx("div",{className:"overflow-auto grow relative table-scroll-container frozen-column-container",children:e.jsxs(Gs,{"aria-label":"Users table",removeWrapper:!0,selectionMode:"none",isCompact:U,classNames:{base:"bg-transparent min-w-[800px]",wrapper:"p-0 bg-transparent shadow-none",th:"backdrop-blur-md text-default-500 border-b border-divider font-medium text-xs sticky top-0 z-30 shadow-xs bg-content1/20",td:"border-b border-divider/50 py-3 group-aria-[selected=false]:group-data-[hover=true]:before:bg-default-100",table:"border-collapse",thead:"sticky top-0 z-30",tbody:"divide-y divide-divider/50",tr:"group outline-none tap-highlight-transparent data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 data-[selected=true]:bg-default-100",emptyWrapper:"text-center h-32",loadingWrapper:"h-32"},children:[e.jsx(qs,{columns:_,children:s=>e.jsx(Js,{align:s.uid==="actions"||s.uid==="sl"?"center":"start",width:s.uid==="sl"?60:s.uid==="user"?240:void 0,className:s.uid==="sl"?"sticky-header-sl backdrop-blur-md":s.uid==="user"?"sticky-header-user backdrop-blur-md":"backdrop-blur-md sticky top-0 z-30",children:s.name},s.uid)}),e.jsx(Qs,{items:r||[],emptyContent:"No users found",loadingContent:e.jsx(ds,{}),isLoading:x,children:(s,a)=>{const i=r?r.findIndex(o=>o.id===s.id):a;return e.jsx(Xs,{className:"table-row-hover",children:o=>e.jsx(Ys,{className:o==="sl"?"frozen-column sticky left-0 z-20 backdrop-blur-md border-r border-divider/30":o==="user"?"frozen-column-user sticky z-20 backdrop-blur-md border-r border-divider/30":"",style:o==="user"?{left:"60px"}:{},children:X(s,o,i)})},s.id)}})]})}),f()]})},ws=({user:r,allUsers:M,departments:U,designations:u,setUsers:L,open:b,closeModal:w,editMode:F=!1})=>{const[I,q]=d.useState(!1),[x,ie]=d.useState({id:(r==null?void 0:r.id)||"",name:(r==null?void 0:r.name)||"",user_name:(r==null?void 0:r.user_name)||"",gender:(r==null?void 0:r.gender)||"",birthday:(r==null?void 0:r.birthday)||"",date_of_joining:(r==null?void 0:r.date_of_joining)||"",address:(r==null?void 0:r.address)||"",employee_id:(r==null?void 0:r.employee_id)||"",phone:(r==null?void 0:r.phone)||"",email:(r==null?void 0:r.email)||"",department_id:(r==null?void 0:r.department_id)||"",designation_id:(r==null?void 0:r.designation_id)||"",report_to:(r==null?void 0:r.report_to)||"",password:"",confirmPassword:"",roles:(r==null?void 0:r.roles)||[]}),[c,O]=d.useState({}),[W,$]=d.useState(!1),[B,H]=d.useState(!1),[K,h]=d.useState((r==null?void 0:r.profile_image_url)||(r==null?void 0:r.profile_image)||null),[V,J]=d.useState(null),[S,g]=d.useState(M),n=Ne();d.useEffect(()=>{(r!=null&&r.profile_image_url||r!=null&&r.profile_image)&&h(r.profile_image_url||r.profile_image)},[r]);const _=async a=>{var o;a.preventDefault(),$(!0);const i=new FormData;if(Object.keys(x).forEach(p=>{p==="roles"&&Array.isArray(x[p])?x[p].forEach((D,N)=>{i.append(`roles[${N}]`,D)}):x[p]!==null&&x[p]!==void 0&&i.append(p,x[p])}),V){const p=V.type;if(["image/jpeg","image/jpg","image/png"].includes(p))i.append("profile_image",V);else{k.error("Invalid file type. Only JPEG and PNG are allowed.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}}),$(!1);return}}try{const p=F?route("updateUser",{id:r.id}):route("addUser"),D=F?"put":"post",N=await axios[D](p,i);N.status===200&&(L&&L(F?T=>T.map(A=>A.id===N.data.user.id?N.data.user:A):T=>[...T,N.data.user]),k.success(((o=N.data.messages)==null?void 0:o.length)>0?N.data.messages.join(" "):`User ${F?"updated":"added"} successfully`,{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}}),w())}catch(p){$(!1),Q(p)}finally{$(!1)}},Q=a=>{a.response?a.response.status===422?(O(a.response.data.errors||{}),k.error(a.response.data.error||`Failed to ${F?"update":"add"} user.`,{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}})):k.error("An unexpected error occurred. Please try again later.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}}):a.request?k.error("No response received from the server. Please check your internet connection.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}}):k.error("An error occurred while setting up the request.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}})},X=a=>{const i=a.target.files[0];if(i){const o=URL.createObjectURL(i);h(o),J(i)}},f=(a,i)=>{ie(o=>({...o,[a]:i})),c[a]&&O(o=>{const p={...o};return delete p[a],p})},s=()=>{q(!I)};return e.jsxs(et,{open:b,onClose:w,fullWidth:!0,maxWidth:"md",sx:{"& .MuiPaper-root":{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:n.glassCard.background,border:n.glassCard.border,borderRadius:"16px",color:n.palette.text.primary,boxShadow:n.glassCard.boxShadow}},children:[e.jsx(at,{sx:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",pb:2},children:e.jsxs(xe,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(C,{variant:"h6",component:"div",sx:{fontWeight:600},children:F?"Edit User":"Add New User"}),e.jsx(me,{"aria-label":"close",onClick:w,sx:{color:n.palette.grey[500],"&:hover":{color:n.palette.primary.main}},children:e.jsx(Ks,{})})]})}),e.jsx(rt,{sx:{pt:3},children:e.jsx("form",{onSubmit:_,children:e.jsxs(P,{container:!0,spacing:3,children:[e.jsx(P,{item:!0,xs:12,sx:{display:"flex",justifyContent:"center",mb:2},children:e.jsxs(xe,{onMouseEnter:()=>H(!0),onMouseLeave:()=>H(!1),sx:{position:"relative"},children:[e.jsx(it,{src:K,alt:"Profile",sx:{width:120,height:120,border:"4px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",filter:B?"brightness(70%)":"brightness(100%)",transition:"all 0.3s ease"}}),e.jsxs(xe,{component:"label",htmlFor:"icon-button-file",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",opacity:B?1:0,transition:"opacity 0.3s ease",cursor:"pointer"},children:[e.jsx("input",{accept:"image/*",id:"icon-button-file",type:"file",style:{display:"none"},onChange:X}),e.jsx(nt,{sx:{color:"white",fontSize:32}})]})]})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsx(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(z,{label:"Full Name",value:x.name,onChange:a=>f("name",a.target.value),error:!!c.name,helperText:c.name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}},required:!0})})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsx(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(z,{label:"Username",value:x.user_name,onChange:a=>f("user_name",a.target.value),error:!!c.user_name,helperText:c.user_name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}},required:!0})})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsx(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(z,{label:"Email",type:"email",value:x.email,onChange:a=>f("email",a.target.value),error:!!c.email,helperText:c.email,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}},required:!0})})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsx(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(z,{label:"Phone",value:x.phone,onChange:a=>f("phone",a.target.value),error:!!c.phone,helperText:c.phone,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}}})})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsxs(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(re,{id:"department-label",sx:{color:n.palette.text.secondary},children:"Department"}),e.jsxs(le,{labelId:"department-label",value:x.department_id,onChange:a=>f("department_id",a.target.value),label:"Department",error:!!c.department_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(y,{value:"",children:e.jsx("em",{children:"None"})}),U==null?void 0:U.map(a=>e.jsx(y,{value:a.id,children:a.name},a.id))]}),c.department_id&&e.jsx(oe,{error:!0,children:c.department_id})]})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsxs(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(re,{id:"designation-label",sx:{color:n.palette.text.secondary},children:"Designation"}),e.jsxs(le,{labelId:"designation-label",value:x.designation_id,onChange:a=>f("designation_id",a.target.value),label:"Designation",error:!!c.designation_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(y,{value:"",children:e.jsx("em",{children:"None"})}),u==null?void 0:u.map(a=>e.jsx(y,{value:a.id,children:a.name},a.id))]}),c.designation_id&&e.jsx(oe,{error:!0,children:c.designation_id})]})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsxs(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(re,{id:"gender-label",sx:{color:n.palette.text.secondary},children:"Gender"}),e.jsxs(le,{labelId:"gender-label",value:x.gender,onChange:a=>f("gender",a.target.value),label:"Gender",error:!!c.gender,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(y,{value:"",children:e.jsx("em",{children:"Select Gender"})}),e.jsx(y,{value:"male",children:"Male"}),e.jsx(y,{value:"female",children:"Female"}),e.jsx(y,{value:"other",children:"Other"})]}),c.gender&&e.jsx(oe,{error:!0,children:c.gender})]})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsx(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(z,{label:"Employee ID",value:x.employee_id,onChange:a=>f("employee_id",a.target.value),error:!!c.employee_id,helperText:c.employee_id,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}}})})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsx(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(z,{label:"Date of Birth",type:"date",value:x.birthday,onChange:a=>f("birthday",a.target.value),error:!!c.birthday,helperText:c.birthday,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:n.palette.text.secondary}}})})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsx(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(z,{label:"Date of Joining",type:"date",value:x.date_of_joining,onChange:a=>f("date_of_joining",a.target.value),error:!!c.date_of_joining,helperText:c.date_of_joining,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:n.palette.text.secondary}}})})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsxs(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(re,{id:"report-to-label",sx:{color:n.palette.text.secondary},children:"Reports To"}),e.jsxs(le,{labelId:"report-to-label",value:x.report_to,onChange:a=>f("report_to",a.target.value),label:"Reports To",error:!!c.report_to,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(y,{value:"",children:e.jsx("em",{children:"None"})}),S==null?void 0:S.filter(a=>a.id!==x.id).map(a=>e.jsx(y,{value:a.id,children:a.name},a.id))]}),c.report_to&&e.jsx(oe,{error:!0,children:c.report_to})]})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(z,{label:"Address",multiline:!0,rows:3,value:x.address,onChange:a=>f("address",a.target.value),error:!!c.address,helperText:c.address,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}}})})}),!F&&e.jsxs(e.Fragment,{children:[e.jsx(P,{item:!0,xs:12,md:6,children:e.jsx(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(z,{label:"Password",type:I?"text":"password",value:x.password,onChange:a=>f("password",a.target.value),error:!!c.password,helperText:c.password,required:!F,InputProps:{endAdornment:e.jsx(me,{"aria-label":"toggle password visibility",onClick:s,edge:"end",children:I?e.jsx(js,{}):e.jsx(vs,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}}})})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsx(R,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(z,{label:"Confirm Password",type:I?"text":"password",value:x.confirmPassword,onChange:a=>f("confirmPassword",a.target.value),error:!!c.confirmPassword,helperText:c.confirmPassword||(x.password!==x.confirmPassword&&x.confirmPassword?"Passwords do not match":""),required:!F,InputProps:{endAdornment:e.jsx(me,{"aria-label":"toggle password visibility",onClick:s,edge:"end",children:I?e.jsx(js,{}):e.jsx(vs,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}}})})})]})]})})}),e.jsxs(lt,{sx:{justifyContent:"space-between",p:3,borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(Button,{onClick:w,variant:"bordered",color:"default",size:"lg",className:"bg-white/5 hover:bg-white/10 border border-white/10",children:"Cancel"}),e.jsx(ot,{onClick:_,loading:W,loadingPosition:"start",startIcon:e.jsx(ft,{}),variant:"contained",sx:{background:"linear-gradient(45deg, #3a7bd5 0%, #2456bd 100%)",boxShadow:"0 4px 20px 0 rgba(58, 123, 213, 0.4)","&:hover":{background:"linear-gradient(45deg, #2456bd 0%, #1a3c8a 100%)"}},children:F?"Update User":"Add User"})]})]})},jt=({title:r,roles:M})=>{var ke,Pe,Re,Fe,Se,Ie,Ue,$e,De,Te,Ae,ze,Le,Ee,Me,Oe,We,Be,He,Ve,Ge,qe,Je,Qe,Xe,Ye,Ze;const U=Ne(),u=ps(U.breakpoints.down("sm")),L=ps(U.breakpoints.down("md")),[b,w]=d.useState([]),[F,I]=d.useState(!0),[q,x]=d.useState(null),[ie,c]=d.useState(0),[O,W]=d.useState(1),[$,B]=d.useState(null),[H,K]=d.useState({}),[h,V]=d.useState({search:"",role:"all",status:"all",department:"all"}),[J,S]=d.useState(!1),[g,n]=d.useState("table"),[_,Q]=d.useState({currentPage:1,perPage:10,total:b.length}),[X,f]=d.useState({}),[s,a]=d.useState({overview:{total_users:0,active_users:0,inactive_users:0,deleted_users:0,total_roles:0,total_departments:0},distribution:{by_role:[],by_department:[],by_status:[]},activity:{recent_registrations:{new_users_30_days:0,new_users_90_days:0,new_users_year:0,recently_active:0},user_growth_rate:0,current_month_registrations:0},security:{access_metrics:{users_with_roles:0,users_without_roles:0,admin_users:0,regular_users:0},role_distribution:[]},health:{status_ratio:{active_percentage:0,inactive_percentage:0,deleted_percentage:0},system_metrics:{user_activation_rate:0,role_coverage:0,department_coverage:0}},quick_metrics:{total_users:0,active_ratio:0,role_diversity:0,department_diversity:0,recent_activity:0,system_health_score:0}}),i=d.useMemo(()=>({data:b,total:ie,current_page:_.currentPage,per_page:_.perPage,last_page:O}),[b,ie,_.currentPage,_.perPage,O]),o=d.useCallback(async()=>{try{const{data:t}=await ne.get(route("users.stats"));t.stats&&a(t.stats)}catch(t){console.error("Error fetching user stats:",t)}},[]),p=d.useCallback((t,l)=>{K(m=>({...m,[l]:t.currentTarget}))},[]),D=d.useCallback(t=>{K(l=>({...l,[t]:null}))},[]),N=d.useCallback(async()=>{I(!0);try{const t=await ne.get(route("users.paginate"),{params:{page:_.currentPage,perPage:_.perPage,search:h.search||void 0,role:h.role!=="all"?h.role:void 0,status:h.status!=="all"?h.status:void 0,department:h.department!=="all"?h.department:void 0}});if(t.status===200){const{users:l}=t.data;l.data&&Array.isArray(l.data)?(w(l.data),c(l.total||l.data.length),W(l.last_page||1)):Array.isArray(l)?(w(l),c(l.length),W(1)):(console.error("Unexpected users data format:",l),w([]),c(0),W(1))}}catch(t){console.error("Error fetching users:",t),k.error("Failed to load users data"),w([])}finally{I(!1)}},[h,_.currentPage,_.perPage]);d.useEffect(()=>{N()},[N]),d.useEffect(()=>{o();const t=setInterval(o,6e4);return()=>clearInterval(t)},[o]);const T=(t,l)=>{V(m=>({...m,[t]:l})),Q(m=>({...m,currentPage:1}))},A=t=>{Q(l=>({...l,currentPage:t})),window.scrollTo({top:0,behavior:"smooth"})},pe=t=>{Q(l=>({...l,currentPage:1,perPage:t}))},ee=d.useCallback((t,l=null)=>{B(t),x(l)},[]),de=d.useCallback(()=>{B(null),x(null)},[]),j=d.useCallback(t=>{w(t)},[]),ue=d.useCallback(t=>{w(l=>l.map(m=>m.id===t.id?{...m,...t}:m))},[]),Rs=d.useCallback(t=>{w(l=>l.filter(m=>m.id!==t)),o()},[o]),Fs=d.useCallback((t,l)=>{w(m=>m.map(v=>v.id===t?{...v,active:l}:v)),o()},[o]),Ss=d.useCallback((t,l)=>{w(m=>m.map(v=>v.id===t?{...v,roles:l}:v)),o()},[o]),_e=d.useCallback(async(t,l)=>{f(m=>({...m,[t]:!0}));try{(await ne.post(route("users.device.toggle"),{user_id:t,enabled:l})).status===200&&(w(v=>v.map(E=>E.id===t?{...E,single_device_login:l,active_device:l?E.active_device:null}:E)),k.success(l?"Single device login enabled for user":"Single device login disabled for user"))}catch(m){console.error("Error toggling single device login:",m),k.error("Failed to update device settings")}finally{f(m=>({...m,[t]:!1}))}},[]),Ce=d.useCallback(async t=>{f(l=>({...l,[t]:!0}));try{(await ne.post(route("users.device.reset"),{user_id:t})).status===200&&(w(m=>m.map(v=>v.id===t?{...v,active_device:null}:v)),k.success("User device has been reset"))}catch(l){console.error("Error resetting user device:",l),k.error("Failed to reset user device")}finally{f(l=>({...l,[t]:!1}))}},[]);d.useCallback(async t=>{try{const l=await ne.get(route("users.device.list",{user:t}));if(l.status===200){const m=l.data.devices;k.info(`User has ${m.length} device record(s)`)}}catch(l){console.error("Error fetching user devices:",l),k.error("Failed to fetch device information")}},[]);const Is=({user:t,index:l})=>{var m;return e.jsx(Y,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 transition-all duration-200 cursor-pointer h-full",onPress:()=>ge.visit(route("profile",{user:t.id})),children:e.jsxs(Z,{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3 pb-3 border-b border-white/10",children:[e.jsx(Ps,{avatarProps:{radius:"lg",src:(t==null?void 0:t.profile_image_url)||(t==null?void 0:t.profile_image),size:"md",fallback:e.jsx(fe,{className:"w-5 h-5"})},classNames:{name:"font-semibold text-foreground text-sm",description:"text-default-500 text-xs"}}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground text-sm line-clamp-1",children:t.name}),e.jsx("p",{className:"text-default-500 text-xs",children:t.email})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ae,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>{ge.visit(route("profile",{user:t.id}))},children:e.jsx(Cs,{className:"w-4 h-4"})}),e.jsx(me,{size:"small",onClick:v=>p(v,`device-menu-${t.id}`),sx:{color:"rgba(255, 255, 255, 0.6)","&:hover":{color:"rgba(255, 255, 255, 0.9)",backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:e.jsx(_s,{className:"w-4 h-4"})}),e.jsxs(dt,{anchorEl:H[`device-menu-${t.id}`],open:!!H[`device-menu-${t.id}`],onClose:()=>D(`device-menu-${t.id}`),sx:{"& .MuiPaper-root":{backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(16px)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px",minWidth:"200px"},"& .MuiMenuItem-root":{color:"rgba(255, 255, 255, 0.9)",padding:"8px 16px","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.15)"},"&.Mui-disabled":{color:"rgba(255, 255, 255, 0.3)"}}},children:[e.jsxs(y,{onClick:()=>{D(`device-menu-${t.id}`),_e(t.id,!t.single_device_login)},disabled:X[t.id],sx:{gap:1},children:[t.single_device_login?e.jsx(ve,{className:"w-4 h-4"}):e.jsx(we,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{children:t.single_device_login?"Disable Device Lock":"Enable Device Lock"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)"},children:t.single_device_login?"Disable device restriction":"Enable device restriction"})]})]}),t.single_device_login&&t.active_device&&e.jsxs(y,{onClick:()=>{D(`device-menu-${t.id}`),Ce(t.id)},disabled:X[t.id],sx:{gap:1},children:[e.jsx(te,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{children:"Reset Device"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)"},children:"Allow login from new device"})]})]}),e.jsxs(y,{onClick:()=>{D(`device-menu-${t.id}`),ge.visit(route("users.device.show",{user:t.id}))},sx:{gap:1},children:[e.jsx(je,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{children:"View Devices"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)"},children:"View device history"})]})]})]})]})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[t.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ys,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs line-clamp-1",children:t.phone})]}),(t.department||t.department_id)&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ce,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs",children:typeof t.department=="string"?t.department:"N/A"})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10 flex flex-wrap gap-2",children:[e.jsx(G,{size:"sm",variant:t.active?"solid":"bordered",color:t.active?"success":"danger",className:"text-xs",startContent:t.active?e.jsx(gs,{className:"w-3 h-3"}):e.jsx(bs,{className:"w-3 h-3"}),children:t.active?"Active":"Inactive"}),(m=t.roles)==null?void 0:m.map((v,E)=>e.jsx(G,{size:"sm",variant:"flat",color:"secondary",className:"text-xs",startContent:e.jsx(fe,{className:"w-3 h-3"}),children:v},E)),t.single_device_login&&e.jsx(G,{size:"sm",variant:"flat",color:t.active_device?"warning":"default",className:"text-xs",startContent:e.jsx(he,{className:"w-3 h-3"}),children:t.active_device?"Device Locked":"Device Free"})]})]})})},Us=d.useMemo(()=>{var t,l,m,v,E,Ke,es,ss,ts,as,rs,ls,is,ns;return[{title:"Total Users",value:((t=s==null?void 0:s.overview)==null?void 0:t.total_users)||0,icon:e.jsx(be,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All users"},{title:"Active Users",value:((l=s==null?void 0:s.overview)==null?void 0:l.active_users)||0,icon:e.jsx(gs,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:`${((v=(m=s==null?void 0:s.health)==null?void 0:m.status_ratio)==null?void 0:v.active_percentage)||0}% Active`},{title:"Inactive Users",value:((E=s==null?void 0:s.overview)==null?void 0:E.inactive_users)||0,icon:e.jsx(bs,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:`${((es=(Ke=s==null?void 0:s.health)==null?void 0:Ke.status_ratio)==null?void 0:es.inactive_percentage)||0}% Inactive`},{title:"Total Roles",value:((ss=s==null?void 0:s.overview)==null?void 0:ss.total_roles)||0,icon:e.jsx(he,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Role diversity"},{title:"Role Coverage",value:`${((as=(ts=s==null?void 0:s.health)==null?void 0:ts.system_metrics)==null?void 0:as.role_coverage)||0}%`,icon:e.jsx(ct,{className:"w-5 h-5"}),color:"text-emerald-400",iconBg:"bg-emerald-500/20",description:"Users with roles"},{title:"Recent Activity",value:((ls=(rs=s==null?void 0:s.activity)==null?void 0:rs.recent_registrations)==null?void 0:ls.recently_active)||0,icon:e.jsx(Ns,{className:"w-5 h-5"}),color:"text-cyan-400",iconBg:"bg-cyan-500/20",description:"Active last 7 days"},{title:"System Health",value:`${((is=s==null?void 0:s.quick_metrics)==null?void 0:is.system_health_score)||0}%`,icon:e.jsx(us,{className:"w-5 h-5"}),color:"text-pink-400",iconBg:"bg-pink-500/20",description:"Overall health"},{title:"Departments",value:((ns=s==null?void 0:s.overview)==null?void 0:ns.total_departments)||0,icon:e.jsx(ce,{className:"w-5 h-5"}),color:"text-indigo-400",iconBg:"bg-indigo-500/20",description:"Department diversity"}]},[s]),$s=d.useMemo(()=>{const t=[];return t.push({label:u?"Add":"Add User",icon:e.jsx(mt,{className:"w-4 h-4"}),onPress:()=>ee("add"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),t.push({label:u?"":"Export",isIconOnly:u,icon:e.jsx(fs,{className:"w-4 h-4"}),variant:"bordered",className:"border-[rgba(var(--theme-primary-rgb),0.3)] bg-[rgba(var(--theme-primary-rgb),0.05)] hover:bg-[rgba(var(--theme-primary-rgb),0.1)]"}),t},[u,ee]);return e.jsxs(e.Fragment,{children:[e.jsx(Ds,{title:r}),$==="add"&&e.jsx(ws,{user:null,open:$==="add",setUsers:j,closeModal:de,editMode:!1}),$==="edit"&&q&&e.jsx(ws,{user:q,open:$==="edit",setUsers:j,closeModal:de,editMode:!0}),e.jsx(xe,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(st,{in:!0,children:e.jsx(Ms,{children:e.jsx(Ws,{title:"Users Management",subtitle:"Manage users accounts and roles",icon:e.jsx(be,{className:"w-8 h-8"}),actionButtons:$s,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(Bs,{stats:Us,className:"mb-6"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mb-6",children:[e.jsx(Y,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(Z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(xt,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx(C,{variant:"h6",className:"font-semibold text-foreground",children:"Role Distribution"}),e.jsx(C,{variant:"caption",className:"text-default-500",children:"User roles breakdown"})]})]}),e.jsx("div",{className:"space-y-3",children:(Pe=(ke=s==null?void 0:s.distribution)==null?void 0:ke.by_role)==null?void 0:Pe.slice(0,5).map((t,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-linear-to-r from-purple-400 to-pink-400"}),e.jsx("span",{className:"text-sm text-foreground truncate",children:t.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:t.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",children:["(",t.percentage,"%)"]})]})]},l))})]})}),e.jsx(Y,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(Z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(ce,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx(C,{variant:"h6",className:"font-semibold text-foreground",children:"Department Distribution"}),e.jsx(C,{variant:"caption",className:"text-default-500",children:"Users by department"})]})]}),e.jsx("div",{className:"space-y-3",children:(Fe=(Re=s==null?void 0:s.distribution)==null?void 0:Re.by_department)==null?void 0:Fe.slice(0,5).map((t,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-linear-to-r from-blue-400 to-cyan-400"}),e.jsx("span",{className:"text-sm text-foreground truncate",children:t.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:t.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",children:["(",t.percentage,"%)"]})]})]},l))})]})}),e.jsx(Y,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(Z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e.jsx(he,{className:"w-5 h-5 text-red-400"})}),e.jsxs("div",{children:[e.jsx(C,{variant:"h6",className:"font-semibold text-foreground",children:"Security Metrics"}),e.jsx(C,{variant:"caption",className:"text-default-500",children:"Access control overview"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Users with Roles"}),e.jsx("span",{className:"text-sm font-medium text-green-400",children:((Ie=(Se=s==null?void 0:s.security)==null?void 0:Se.access_metrics)==null?void 0:Ie.users_with_roles)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Users without Roles"}),e.jsx("span",{className:"text-sm font-medium text-red-400",children:(($e=(Ue=s==null?void 0:s.security)==null?void 0:Ue.access_metrics)==null?void 0:$e.users_without_roles)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Admin Users"}),e.jsx("span",{className:"text-sm font-medium text-orange-400",children:((Te=(De=s==null?void 0:s.security)==null?void 0:De.access_metrics)==null?void 0:Te.admin_users)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Role Coverage"}),e.jsxs("span",{className:"text-sm font-medium text-blue-400",children:[((ze=(Ae=s==null?void 0:s.health)==null?void 0:Ae.system_metrics)==null?void 0:ze.role_coverage)||0,"%"]})]})]})]})}),e.jsx(Y,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(Z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(fs,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx(C,{variant:"h6",className:"font-semibold text-foreground",children:"Activity Trends"}),e.jsx(C,{variant:"caption",className:"text-default-500",children:"Recent user activity"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Recently Active"}),e.jsx("span",{className:"text-sm font-medium text-green-400",children:((Ee=(Le=s==null?void 0:s.activity)==null?void 0:Le.recent_registrations)==null?void 0:Ee.recently_active)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"New (30 days)"}),e.jsx("span",{className:"text-sm font-medium text-blue-400",children:((Oe=(Me=s==null?void 0:s.activity)==null?void 0:Me.recent_registrations)==null?void 0:Oe.new_users_30_days)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"New (90 days)"}),e.jsx("span",{className:"text-sm font-medium text-cyan-400",children:((Be=(We=s==null?void 0:s.activity)==null?void 0:We.recent_registrations)==null?void 0:Be.new_users_90_days)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Growth Rate"}),e.jsxs("span",{className:"text-sm font-medium text-purple-400",children:[((He=s==null?void 0:s.activity)==null?void 0:He.user_growth_rate)||0,"%"]})]})]})]})}),e.jsx(Y,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(Z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-teal-500/20 rounded-lg",children:e.jsx(us,{className:"w-5 h-5 text-teal-400"})}),e.jsxs("div",{children:[e.jsx(C,{variant:"h6",className:"font-semibold text-foreground",children:"System Health"}),e.jsx(C,{variant:"caption",className:"text-default-500",children:"Overall system metrics"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Health Score"}),e.jsxs("span",{className:"text-sm font-medium text-teal-400",children:[((Ve=s==null?void 0:s.quick_metrics)==null?void 0:Ve.system_health_score)||0,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Activation Rate"}),e.jsxs("span",{className:"text-sm font-medium text-green-400",children:[((qe=(Ge=s==null?void 0:s.health)==null?void 0:Ge.system_metrics)==null?void 0:qe.user_activation_rate)||0,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Dept. Coverage"}),e.jsxs("span",{className:"text-sm font-medium text-blue-400",children:[((Qe=(Je=s==null?void 0:s.health)==null?void 0:Je.system_metrics)==null?void 0:Qe.department_coverage)||0,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Total Departments"}),e.jsx("span",{className:"text-sm font-medium text-purple-400",children:((Xe=s==null?void 0:s.overview)==null?void 0:Xe.total_departments)||0})]})]})]})}),e.jsx(Y,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(Z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(ht,{className:"w-5 h-5 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx(C,{variant:"h6",className:"font-semibold text-foreground",children:"Status Breakdown"}),e.jsx(C,{variant:"caption",className:"text-default-500",children:"User status distribution"})]})]}),e.jsx("div",{className:"space-y-3",children:(Ze=(Ye=s==null?void 0:s.distribution)==null?void 0:Ye.by_status)==null?void 0:Ze.map((t,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${t.name==="Active"?"bg-green-400":t.name==="Inactive"?"bg-red-400":"bg-gray-400"}`}),e.jsx("span",{className:"text-sm text-foreground",children:t.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:t.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",children:["(",t.percentage,"%)"]})]})]},l))})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(z,{placeholder:"Search by name, email or phone...",value:h.search,onChange:t=>T("search",t.target.value),InputProps:{startAdornment:e.jsx(pt,{position:"start",children:e.jsx(zs,{className:"w-4 h-4"})})},fullWidth:!0,size:u?"small":"medium",sx:Ts("search")})}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs(bt,{variant:"bordered",className:"bg-white/5",children:[e.jsxs(ae,{isIconOnly:u,color:g==="table"?"primary":"default",onPress:()=>n("table"),className:g==="table"?"bg-blue-500/20":"",children:[e.jsx(ut,{className:"w-4 h-4"}),!u&&e.jsx("span",{className:"ml-1",children:"Table"})]}),e.jsxs(ae,{isIconOnly:u,color:g==="grid"?"primary":"default",onPress:()=>n("grid"),className:g==="grid"?"bg-blue-500/20":"",children:[e.jsx(Ls,{className:"w-4 h-4"}),!u&&e.jsx("span",{className:"ml-1",children:"Grid"})]})]}),e.jsxs(ae,{isIconOnly:u,variant:"bordered",onPress:()=>S(!J),className:J?"bg-purple-500/20":"bg-white/5",children:[e.jsx(gt,{className:"w-4 h-4"}),!u&&e.jsx("span",{className:"ml-1",children:"Filters"})]})]})]}),J&&e.jsx(Os,{in:!0,timeout:300,children:e.jsxs("div",{className:"mb-6 p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(R,{fullWidth:!0,size:"small",sx:cs(),children:[e.jsx(re,{children:"Status"}),e.jsxs(le,{value:h.status,onChange:t=>T("status",t.target.value),children:[e.jsx(y,{value:"all",children:"All Statuses"}),e.jsx(y,{value:"active",children:"Active Only"}),e.jsx(y,{value:"inactive",children:"Inactive Only"})]})]}),e.jsxs(R,{fullWidth:!0,size:"small",sx:cs(),children:[e.jsx(re,{children:"Role"}),e.jsxs(le,{value:h.role,onChange:t=>T("role",t.target.value),children:[e.jsx(y,{value:"all",children:"All Roles"}),M==null?void 0:M.map(t=>e.jsx(y,{value:t.toLowerCase(),children:t},t.toLowerCase()))]})]})]}),(h.search||h.status!=="all"||h.role!=="all")&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-white/10",children:[h.search&&e.jsxs(G,{variant:"flat",color:"primary",size:"sm",onClose:()=>T("search",""),children:["Search: ",h.search]}),h.status!=="all"&&e.jsxs(G,{variant:"flat",color:"secondary",size:"sm",onClose:()=>T("status","all"),children:["Status: ",h.status==="active"?"Active":"Inactive"]}),h.role!=="all"&&e.jsxs(G,{variant:"flat",color:"warning",size:"sm",onClose:()=>T("role","all"),children:["Role: ",h.role]})]})]})}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsxs(C,{variant:"h6",className:"font-semibold text-foreground",children:[g==="table"?"User Table":"User Grid",e.jsxs("span",{className:"text-sm text-default-500 ml-2",children:["(",i.total||0," ",i.total===1?"user":"users",")"]})]})}),F?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(tt,{size:40}),e.jsx(C,{className:"mt-4",color:"textSecondary",children:"Loading users data..."})]}):g==="table"?e.jsx(vt,{allUsers:i.data,roles:M,setUsers:j,isMobile:u,isTablet:L,pagination:_,onPageChange:A,onRowsPerPageChange:pe,totalUsers:i.total,loading:F,onEdit:t=>ee("edit",t),updateUserOptimized:ue,deleteUserOptimized:Rs,toggleUserStatusOptimized:Fs,updateUserRolesOptimized:Ss,toggleSingleDeviceLogin:_e,resetUserDevice:Ce,deviceActions:X}):e.jsxs("div",{className:"p-4",children:[i.data&&i.data.length>0?e.jsx("div",{className:`grid gap-4 ${u?"grid-cols-1":L?"grid-cols-2":"grid-cols-3 xl:grid-cols-4"}`,children:i.data.map((t,l)=>e.jsx(Is,{user:t,index:l},t.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(be,{className:"w-12 h-12 mx-auto text-default-300 mb-2"}),e.jsx(C,{variant:"body1",color:"textSecondary",children:"No users found"}),e.jsx(C,{variant:"caption",color:"textSecondary",children:"Try adjusting your search or filters"})]}),i.data&&i.data.length>0&&e.jsx("div",{className:"flex justify-center mt-6 border-t border-white/10 pt-4",children:e.jsx(ks,{total:Math.ceil(i.total/_.perPage),initialPage:_.currentPage,page:_.currentPage,onChange:A,size:u?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})})]})]})]})})})})})]})};jt.layout=r=>e.jsx(Es,{children:r});export{jt as default};
