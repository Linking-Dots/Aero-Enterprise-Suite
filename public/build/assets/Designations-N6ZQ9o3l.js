import{J as Z,r as n,j as e,s as K,d as N,m as de,f as I,a as T,Q as ce}from"./app-1wDtHJfv.js";import{G as me}from"./GlassCard-B83pENyi.js";import{P as ue}from"./PageHeader-9nikL3YR.js";import{S as he}from"./StatsCards-DjVEPKG4.js";import{B as z,d as pe,a as xe,b as fe,m as $,v as ge,G as je,c as be,e as we,f as ve,g as _e,A as ye}from"./Dashboard-DAH0WTtA.js";import"./dayjs.min-CB5aPOb8.js";import{N as Ne}from"./NoDataMessage-_5dR3Q2L.js";import{F as q}from"./EyeIcon-CaUHJiax.js";import{F as J}from"./PencilIcon-DS345ba5.js";import{F as X}from"./TrashIcon-BOfYUd3c.js";import{F as De}from"./EllipsisVerticalIcon-BAMPIK-c.js";import{F as ee}from"./CheckCircleIcon-DxtX0hHm.js";import{F as te}from"./XCircleIcon-C9Uwmwpq.js";import{t as Pe,a as Ce,b as Se,c as Fe}from"./chunk-F3UDT23P-Ddk_NhTJ.js";import{t as Ee,a as Te}from"./chunk-YRZGWF2W-GPQtuccW.js";import{p as Me}from"./chunk-EAPQ7RWQ-C-NuR2Jr.js";import{t as L,F as Re}from"./XMarkIcon-COO2Zh6A.js";import{c as Ie}from"./chunk-IHOGUXIG--xwDCpLC.js";import{B as D}from"./react-toastify.esm-DxP-_4Mw.js";import{X as Ae}from"./x-CsvrQCNF.js";import{s as ke}from"./chunk-Y2AYO5NJ-D3udvIa2.js";import{s as $e}from"./chunk-TQNYOUFX-DExNwiNX.js";import{F as Le}from"./ExclamationTriangleIcon-BNzDyZlC.js";import{m as ze}from"./chunk-O5MCAK4F-CYBHZL2o.js";import{F as Be}from"./UserGroupIcon-DWIGy9_q.js";import{F as Oe}from"./PlusIcon-B4_vrwYX.js";import{m as Ge}from"./proxy-gSCNGD6s.js";import{F as We}from"./MagnifyingGlassIcon-Cq7i1gc0.js";import{i as Ve}from"./chunk-SSA7SXE4-BCD6fJ-v.js";import"./chunk-D5XJWRAV-D9B8eKHA.js";import"./chunk-TLYTI3QM-DLc-6b8G.js";import"./MapPinIcon-BayS-kgA.js";import"./EnvelopeIcon-CD6s87Wn.js";import"./ClockIcon-go4BFxdq.js";import"./UserIcon-C0zK6YZ8.js";import"./ShieldCheckIcon-ClK_nS3-.js";import"./KeyIcon-TrMOO77X.js";import"./index-2e9fqbYw.js";import"./logo-Pwvcz7fP.js";import"./features-animation-XmBiLvPP.js";import"./create-visual-element-CS80Zc6Z.js";import"./chunk-XJ2YRSUP-D9xMI4St.js";import"./useToggleState-ryUbPf2n.js";import"./createLucideIcon-2yXPV9aY.js";const He=({designations:d,onEdit:o,onDelete:P,onView:r,loading:c,isMobile:v,isTablet:m,pagination:a,onPageChange:C,onRowsPerPageChange:i,canEditDesignation:x=!1,canDeleteDesignation:j=!1})=>{var b,f;const{auth:l}=Z().props,u=x||((b=l.permissions)==null?void 0:b.includes("designations.update"))||!1,h=j||((f=l.permissions)==null?void 0:f.includes("designations.delete"))||!1,S=n.useMemo(()=>[{name:"TITLE",uid:"title"},{name:"DEPARTMENT",uid:"department_name"},{name:"EMPLOYEES",uid:"employee_count"},{name:"STATUS",uid:"status"},{name:"ACTIONS",uid:"actions"}],[]),F=(s,w)=>{switch(w){case"title":return e.jsx("span",{className:"font-semibold text-foreground",children:s.title});case"department_name":return e.jsx("span",{className:"text-default-500",children:s.department_name||"-"});case"employee_count":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:s.employee_count||0})]});case"status":return e.jsx(Ie,{size:"sm",variant:s.is_active?"solid":"bordered",color:s.is_active?"success":"danger",startContent:s.is_active?e.jsx(ee,{className:"w-3 h-3"}):e.jsx(te,{className:"w-3 h-3"}),children:s.is_active?"Active":"Inactive"});case"actions":return e.jsx("div",{className:"flex justify-end items-center",children:v?e.jsxs(pe,{children:[e.jsx(xe,{children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(De,{className:"w-4 h-4"})})}),e.jsxs(fe,{"aria-label":"Designation actions",children:[e.jsx($,{startContent:e.jsx(q,{className:"w-4 h-4"}),onPress:()=>r(s),children:"View Details"},"view"),u&&e.jsx($,{startContent:e.jsx(J,{className:"w-4 h-4"}),onPress:()=>o(s),children:"Edit Designation"},"edit"),h&&e.jsx($,{className:"text-danger",color:"danger",startContent:e.jsx(X,{className:"w-4 h-4"}),isDisabled:s.employee_count>0,onPress:()=>P(s),children:"Delete Designation"},"delete")]})]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{content:"View Designation",children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>r(s),children:e.jsx(q,{className:"w-4 h-4"})})}),u&&e.jsx(L,{content:"Edit Designation",children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-blue-500",onPress:()=>o(s),children:e.jsx(J,{className:"w-4 h-4"})})}),h&&e.jsx(L,{content:s.employee_count>0?"Cannot delete designation with employees":"Delete Designation",children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-danger",isDisabled:s.employee_count>0,onPress:()=>P(s),children:e.jsx(X,{className:"w-4 h-4"})})})]})});default:return e.jsx("span",{children:s[w]})}},g=()=>!d||!d.data||c?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(a.currentPage-1)*a.perPage+1," to ",Math.min(a.currentPage*a.perPage,d.total)," of ",d.total," designations"]}),e.jsx(Me,{total:Math.ceil(d.total/a.perPage),initialPage:a.currentPage,page:a.currentPage,onChange:C,size:v?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]});return!c&&(!d||!d.data||d.data.length===0)?e.jsx("div",{className:"w-full",children:e.jsx(Ne,{message:"No designations found",icon:e.jsx(z,{className:"w-12 h-12 text-default-300"}),description:"Try adjusting your search or filters"})}):e.jsx("div",{className:"w-full",children:e.jsxs(Pe,{"aria-label":"Designations table",removeWrapper:!0,classNames:{base:"bg-transparent",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs",td:"border-b border-white/5 py-3"},bottomContent:g(),children:[e.jsx(Ee,{columns:S,children:s=>e.jsx(Te,{children:s.name},s.uid)}),e.jsx(Ce,{items:d.data||[],emptyContent:!c&&"No designations found",loadingContent:e.jsx(K,{}),isLoading:c,children:s=>e.jsx(Se,{children:w=>e.jsx(Fe,{children:F(s,w)})},s.id)})]})})},Qe=({open:d,onClose:o,onSuccess:P,designation:r=null,departments:c=[]})=>{var F;const v=de(),m=useMediaQuery(v.breakpoints.down("md")),[a,C]=n.useState(!1),[i,x]=n.useState({}),j={title:"",department_id:"",is_active:!0},[l,u]=n.useState(j);n.useEffect(()=>{u(r?{title:r.title||"",department_id:r.department_id||"",is_active:r.is_active??!0}:j),x({})},[r,d]);const h=g=>{const{name:b,value:f,type:s,checked:w}=g.target;u(_=>({..._,[b]:s==="checkbox"?w:f})),i[b]&&x(_=>({..._,[b]:null}))},S=async()=>{var g,b;C(!0),x({});try{const f={...l};let s;r!=null&&r.id?(s=await T.put(`/designations/${r.id}`,f),D.success("Designation updated successfully")):(s=await T.post("/designations",f),D.success("Designation created successfully")),P(s.data.designation),o()}catch(f){if((b=(g=f.response)==null?void 0:g.data)!=null&&b.errors){x(f.response.data.errors);const s=Object.values(f.response.data.errors)[0];s&&D.error(s[0])}else D.error("An error occurred while saving the designation")}finally{C(!1)}};return e.jsxs(je,{open:d,onClose:a?void 0:o,maxWidth:"sm",fullWidth:!0,fullScreen:m,"aria-labelledby":"designation-form-dialog",children:[e.jsxs(DialogTitle,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(Typography,{variant:"h6",component:"div",children:r?"Edit Designation":"Create New Designation"}),e.jsx(IconButton,{edge:"end",color:"inherit",onClick:o,disabled:a,"aria-label":"close",children:e.jsx(Ae,{className:"w-5 h-5"})})]}),e.jsx(I,{}),e.jsx(DialogContent,{sx:{pt:2},children:e.jsxs(Grid,{container:!0,spacing:3,children:[e.jsx(Grid,{item:!0,xs:12,children:e.jsx(Typography,{variant:"subtitle1",color:"primary",gutterBottom:!0,children:"Designation Information"})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(TextField,{name:"title",label:"Designation Title",fullWidth:!0,required:!0,value:l.title,onChange:h,error:!!i.title,helperText:((F=i.title)==null?void 0:F[0])||"",disabled:a})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,error:!!i.department_id,children:[e.jsx(InputLabel,{id:"department-label",children:"Department"}),e.jsxs(ke,{labelId:"department-label",name:"department_id",value:l.department_id,onChange:h,label:"Department",disabled:a,children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"Select Department"})}),c.map(g=>e.jsx(MenuItem,{value:g.id,children:g.name},g.id))]}),i.department_id&&e.jsx(FormHelperText,{children:i.department_id[0]})]})}),e.jsxs(Grid,{item:!0,xs:12,children:[e.jsx(FormControlLabel,{control:e.jsx($e,{checked:l.is_active,onChange:h,name:"is_active",color:"success",disabled:a}),label:"Designation is active"}),i.is_active&&e.jsx(FormHelperText,{error:!0,children:i.is_active[0]})]})]})}),e.jsx(I,{}),e.jsxs(DialogActions,{sx:{px:3,py:2},children:[e.jsx(N,{onClick:o,disabled:a,color:"inherit",children:"Cancel"}),e.jsx(N,{onClick:S,variant:"contained",color:"primary",disabled:a,children:a?"Saving...":r?"Update Designation":"Create Designation"})]})]})},Ue=({open:d,onClose:o,onSuccess:P,designation:r})=>{const[c,v]=n.useState(!1),[m,a]=n.useState(null),C=async()=>{var i,x,j,l;if(r){v(!0),a(null);try{await T.delete(`/hr/designations/${r.id}`),D.success("Designation deleted successfully"),P(),o()}catch(u){if((x=(i=u.response)==null?void 0:i.data)!=null&&x.message)a(u.response.data.message),D.error(u.response.data.message);else if((l=(j=u.response)==null?void 0:j.data)!=null&&l.errors){const h=Object.values(u.response.data.errors)[0];a(h),D.error(h)}else a("An error occurred while deleting the designation"),D.error("An error occurred while deleting the designation")}finally{v(!1)}}};return r?e.jsx(be,{isOpen:d,onOpenChange:c?void 0:o,size:"lg",children:e.jsxs(we,{children:[e.jsxs(ve,{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Delete Designation"}),e.jsx(N,{isIconOnly:!0,variant:"light",onPress:o,isDisabled:c,"aria-label":"close",children:e.jsx(Re,{className:"w-5 h-5"})})]}),e.jsx(I,{}),e.jsx(_e,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-8 h-8 text-yellow-500"}),e.jsxs("p",{className:"text-sm",children:["Are you sure you want to delete the designation ",e.jsx("strong",{children:r.title}),"?"]})]}),r.employee_count>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded",children:["This designation has ",r.employee_count," employees assigned to it. You cannot delete a designation with active employees. Please reassign these employees to other designations first."]}),m&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded",children:m}),e.jsx("p",{className:"text-sm text-default-500 mt-1",children:"This action cannot be undone. All associated data will be permanently removed."})]})}),e.jsx(I,{}),e.jsxs(ze,{children:[e.jsx(N,{onPress:o,isDisabled:c,variant:"light",children:"Cancel"}),e.jsx(N,{onPress:C,color:"danger",isDisabled:c||r.employee_count>0,isLoading:c,children:c?"Deleting...":"Delete Designation"})]})]})}):null},Lt=({title:d,initialDesignations:o,departments:P,managers:r,parentDesignations:c,stats:v,filters:m})=>{var Q,U,Y;const{auth:a}=Z().props,[C,i]=n.useState(o||{data:[]}),[x,j]=n.useState(!1),[l,u]=n.useState({type:null,designation:null}),[h,S]=n.useState({search:(m==null?void 0:m.search)||"",status:(m==null?void 0:m.status)||"all",parentDesignation:(m==null?void 0:m.parentDesignation)||"all"}),[F,g]=n.useState(!1),[b,f]=n.useState("table"),[s,w]=n.useState({currentPage:(o==null?void 0:o.current_page)||1,perPage:(o==null?void 0:o.per_page)||10}),[_,se]=n.useState(v||{total:0,active:0,inactive:0,parent_designations:0}),[B,ae]=n.useState(window.innerWidth<768);n.useEffect(()=>{const t=()=>ae(window.innerWidth<768);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const O=((Q=a.permissions)==null?void 0:Q.includes("designations.create"))||!1,G=((U=a.permissions)==null?void 0:U.includes("designations.update"))||!1,W=((Y=a.permissions)==null?void 0:Y.includes("designations.delete"))||!1,A=n.useCallback(async()=>{j(!0);try{const t=await T.get(route("designations.json"),{params:{page:s.currentPage,per_page:s.perPage,search:h.search,status:h.status,parent_designation:h.parentDesignation}});i(t.data.designations||t.data)}catch(t){console.error("Error fetching designations:",t),D.error("Failed to load designations data")}finally{j(!1)}},[s,h]),k=n.useCallback(async()=>{try{const t=await T.get(route("designations.stats"));t.status===200&&se(t.data.stats)}catch(t){console.error("Error fetching designation stats:",t)}},[]);n.useEffect(()=>{A(),k()},[A,k]);const re=(t,y)=>{S(p=>({...p,[t]:y})),w(p=>({...p,currentPage:1}))},ne=t=>{w(y=>({...y,currentPage:t})),window.scrollTo({top:0,behavior:"smooth"})},oe=t=>{w({currentPage:1,perPage:t})},M=(t,y=null)=>{u({type:t,designation:y})},V=()=>{u({type:null,designation:null})},H=(t=null,y=null)=>{y==="add"&&t?i(p=>{const E=[t,...p.data];return{...p,data:E,total:(p.total||0)+1}}):y==="edit"&&t?i(p=>{const E=p.data.map(R=>R.id===t.id?t:R);return{...p,data:E}}):y==="delete"&&t?i(p=>{const E=p.data.filter(R=>R.id!==t.id);return{...p,data:E,total:(p.total||1)-1}}):(A(),k())},ie=n.useMemo(()=>[{title:"Total Designations",value:_.total,icon:e.jsx(z,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All designations"},{title:"Active",value:_.active,icon:e.jsx(ee,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Active designations"},{title:"Inactive",value:_.inactive,icon:e.jsx(te,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Inactive designations"},{title:"Parent Designations",value:_.parent_designations,icon:e.jsx(Be,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Top-level designations"}],[_]),le=n.useMemo(()=>{const t=[];return O&&t.push({label:B?"Add":"Add Designation",icon:e.jsx(Oe,{className:"w-4 h-4"}),onPress:()=>M("add_designation"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),t},[O,B]);return e.jsxs(ye,{children:[e.jsx(ce,{title:d}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(Ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:e.jsx(me,{children:e.jsx(ue,{title:"Designation Management",subtitle:"Manage company designations and hierarchy",icon:e.jsx(z,{className:"w-8 h-8"}),variant:"default",actionButtons:le,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(he,{stats:ie,className:"mb-6"}),e.jsx("div",{className:"mb-6",children:e.jsx(Ve,{label:"Search",placeholder:"Search designations...",value:h.search,onValueChange:t=>re("search",t),startContent:e.jsx(We,{className:"w-4 h-4 text-default-400"}),variant:"bordered",classNames:{base:"w-full",input:"bg-transparent",inputWrapper:["backdrop-blur-xl","backdrop-saturate-200","bg-white/10","border","border-white/20","hover:bg-white/20","focus-within:!bg-white/20","!cursor-text"]}})}),e.jsx("div",{children:x?e.jsxs("div",{className:"text-center py-6",children:[e.jsx(K,{size:"lg"}),e.jsx("p",{className:"mt-4 text-default-500",children:"Loading..."})]}):e.jsx(He,{designations:C,loading:x,onEdit:G?t=>M("edit_designation",t):void 0,onDelete:W?t=>M("delete_designation",t):void 0,onView:t=>M("view_designation",t),pagination:s,onPageChange:ne,onRowsPerPageChange:oe,canEditDesignation:G,canDeleteDesignation:W})})]})})})})}),(l.type==="add_designation"||l.type==="edit_designation")&&e.jsx(Qe,{open:!0,departments:P,onClose:V,onSuccess:t=>H(t,l.type==="add_designation"?"add":"edit"),designation:l.designation,managers:r,parentDesignations:c}),l.type==="delete_designation"&&e.jsx(Ue,{open:!0,onClose:V,onSuccess:t=>H(t,"delete"),designation:l.designation})]})};export{Lt as default};
