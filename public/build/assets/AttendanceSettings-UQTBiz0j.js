import{r as u,j as e,H as de,a as F}from"./app-B8QYX9Px.js";import{m as n,C as ce,I as O,B as b,A as pe}from"./App-DkF9RL3Y.js";import{u as ue,B as c,G as R,T as l}from"./logo-BoX8pchB.js";import{G as xe,F as ge}from"./Grow-DP1KP2ex.js";import{C as M}from"./CardHeader-Bhq2T4qN.js";import{C as P}from"./CardContent-B5B4Qw18.js";import{T as x,F as me}from"./TextField-BAa6JqDO.js";import{I as be}from"./InputLabel-CehJzubO.js";import{S as he,O as fe}from"./Select-8HD_0XQO.js";import{M as ye}from"./MenuItem-BN00sQGI.js";import{C as je}from"./CardActions-B9P5pLKM.js";import{L as E}from"./LoadingButton-BJ0_t8OA.js";import{F as ke}from"./PencilSquareIcon-wKCO7LYU.js";import{D as $}from"./Dialog-Bo_XotCr.js";import{D as G}from"./DialogTitle-B_yNWDSa.js";import{D as H,a as z}from"./DialogContent-DYCSoO7D.js";import{B as j}from"./Button-CpKhJqSS.js";import{F as N}from"./MapPinIcon-D7avcCzM.js";import{D as U}from"./Divider-DfNajlN5.js";import{F as _e}from"./TrashIcon-DFtGfjbZ.js";import{F as Ce}from"./PlusIcon-BzbZnk-Z.js";import"./EnvelopeIcon-B1M8vjD_.js";import"./UserIcon-D9_80nkG.js";import"./ShieldCheckIcon-RZqgNGJW.js";import"./ExclamationTriangleIcon-BW32ASrn.js";import"./create-visual-element-4S4I33NB.js";import"./listItemTextClasses-DfTDYmaW.js";const ve=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],we=({title:k,attendanceSettings:q,attendanceTypes:J})=>{const t=ue(),[o,V]=u.useState(q||{}),[_,T]=u.useState(J||[]),[K,S]=u.useState(!1),[Q,D]=u.useState(!1),[d,C]=u.useState(null),[v,I]=u.useState({config:{}}),[g,h]=u.useState({tolerance:100,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]}),[m,X]=u.useState({office_start_time:(o==null?void 0:o.office_start_time)||"09:00",office_end_time:(o==null?void 0:o.office_end_time)||"18:00",break_time_duration:(o==null?void 0:o.break_time_duration)||60,late_mark_after:(o==null?void 0:o.late_mark_after)||15,early_leave_before:(o==null?void 0:o.early_leave_before)||15,overtime_after:(o==null?void 0:o.overtime_after)||30,auto_punch_out:(o==null?void 0:o.auto_punch_out)??!1,auto_punch_out_time:(o==null?void 0:o.auto_punch_out_time)||"20:00",weekend_days:(o==null?void 0:o.weekend_days)||["saturday","sunday"]}),[Y,B]=u.useState(!1),[i,A]=u.useState({}),f=(r,a)=>{X(s=>({...s,[r]:a}))},Z=async r=>{r.preventDefault(),B(!0);try{const a=await F.post(route("attendance-settings.update"),m);a.status===200&&(V(a.data.attendanceSettings),A({}),b.success(a.data.message||"Attendance settings updated successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}}))}catch(a){a.response&&a.response.status===422?(A(a.response.data.errors||{}),b.error(a.response.data.error||"Failed to update attendance settings.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}})):b.error("An unexpected error occurred. Please try again later.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}})}finally{B(!1)}},ee=r=>{r.slug==="route-waypoint"||r.name.toLowerCase().includes("waypoint")||r.name.toLowerCase().includes("route")?te(r):(C(r),I({config:r.config||{}}),S(!0))},w=()=>S(!1),re=(r,a)=>{I(s=>({...s,config:{...s.config,[r]:a}}))},ae=async()=>{if(!d)return;const r=await F.post(route("attendance-types.update",d.id),{config:v.config});T(_.map(a=>a.id===d.id?r.data.attendanceType:a)),w()},te=(r=null)=>{var a,s;if(r){C(r);const p=((a=r.config)==null?void 0:a.waypoints)||[],y=((s=r.config)==null?void 0:s.tolerance)||100;p.length>0?h({tolerance:y,waypoints:p}):h({tolerance:y,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]})}D(!0)},W=()=>{D(!1),C(null),h({tolerance:100,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]})},L=(r,a,s)=>{h(p=>({...p,waypoints:p.waypoints.map((y,le)=>le===r?{...y,[a]:s}:y)}))},oe=()=>{h(r=>({...r,waypoints:[...r.waypoints,{lat:"",lng:""}]}))},ne=r=>{g.waypoints.length>2&&h(a=>({...a,waypoints:a.waypoints.filter((s,p)=>p!==r)}))},se=r=>{h(a=>({...a,tolerance:r}))},ie=async()=>{const r=g.waypoints.filter(a=>a.lat&&a.lng);if(r.length===0){b.error("Please add at least one valid waypoint.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}});return}if(!g.tolerance||g.tolerance<=0){b.error("Please enter a valid tolerance value.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}});return}try{if(d){const a={...d.config,tolerance:g.tolerance,waypoints:r},s=await F.post(route("attendance-types.update",d.id),{config:a});T(_.map(p=>p.id===d.id?s.data.attendanceType:p)),b.success("Waypoints updated successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}})}else b.success("Waypoints saved successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}});W()}catch{b.error("Failed to save waypoints.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}})}};return e.jsxs(e.Fragment,{children:[e.jsx(de,{title:k}),e.jsx(c,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsxs(n,{container:!0,spacing:4,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(xe,{in:!0,children:e.jsxs(R,{children:[e.jsx(M,{title:"Attendance Settings"}),e.jsxs("form",{onSubmit:Z,children:[e.jsxs(P,{children:[e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Office Timing"}),e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,sm:6,children:e.jsx(x,{label:"Office Start Time",type:"time",value:m.office_start_time,onChange:r=>f("office_start_time",r.target.value),fullWidth:!0,InputLabelProps:{shrink:!0},error:!!i.office_start_time,helperText:i.office_start_time})}),e.jsx(n,{item:!0,xs:12,sm:6,children:e.jsx(x,{label:"Office End Time",type:"time",value:m.office_end_time,onChange:r=>f("office_end_time",r.target.value),fullWidth:!0,InputLabelProps:{shrink:!0},error:!!i.office_end_time,helperText:i.office_end_time})}),e.jsx(n,{item:!0,xs:12,sm:6,children:e.jsx(x,{label:"Break Time Duration (minutes)",type:"number",value:m.break_time_duration,onChange:r=>f("break_time_duration",parseInt(r.target.value)),fullWidth:!0,error:!!i.break_time_duration,helperText:i.break_time_duration})}),e.jsx(n,{item:!0,xs:12,sm:6,children:e.jsx(x,{label:"Late Mark After (minutes)",type:"number",value:m.late_mark_after,onChange:r=>f("late_mark_after",parseInt(r.target.value)),fullWidth:!0,error:!!i.late_mark_after,helperText:i.late_mark_after})})]}),e.jsx(l,{variant:"h6",gutterBottom:!0,sx:{marginTop:2},children:"Attendance Rules"}),e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,sm:6,children:e.jsx(x,{label:"Early Leave Before (minutes)",type:"number",value:m.early_leave_before,onChange:r=>f("early_leave_before",parseInt(r.target.value)),fullWidth:!0,error:!!i.early_leave_before,helperText:i.early_leave_before})}),e.jsx(n,{item:!0,xs:12,sm:6,children:e.jsx(x,{label:"Overtime After (minutes)",type:"number",value:m.overtime_after,onChange:r=>f("overtime_after",parseInt(r.target.value)),fullWidth:!0,error:!!i.overtime_after,helperText:i.overtime_after})})]}),e.jsx(l,{variant:"h6",gutterBottom:!0,sx:{marginTop:2},children:"Weekend Settings"}),e.jsx(n,{container:!0,spacing:3,children:e.jsx(n,{item:!0,xs:12,children:e.jsxs(ge,{fullWidth:!0,children:[e.jsx(be,{id:"weekend-days",children:"Weekend Days"}),e.jsx(he,{labelId:"weekend-days",multiple:!0,value:m.weekend_days,onChange:r=>f("weekend_days",r.target.value),input:e.jsx(fe,{label:"Weekend Days"}),error:!!i.weekend_days,renderValue:r=>e.jsx(c,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:r.map(a=>e.jsx(ce,{label:a.charAt(0).toUpperCase()+a.slice(1)},a))}),MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:ve.map(r=>e.jsx(ye,{value:r,children:r.charAt(0).toUpperCase()+r.slice(1)},r))}),e.jsx(me,{children:i.weekend_days})]})})})]}),e.jsx(je,{sx:{justifyContent:"center"},children:e.jsx(E,{loading:Y,sx:{borderRadius:"50px",padding:"6px 16px"},variant:"outlined",color:"primary",type:"submit",children:"Save"})})]})]})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(R,{children:[e.jsx(M,{title:"Attendance Types"}),e.jsx(P,{children:e.jsx(n,{container:!0,spacing:2,children:_.map(r=>e.jsx(n,{item:!0,xs:12,children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderRadius:3,background:"rgba(255,255,255,0.12)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.18)",backdropFilter:"blur(12px) saturate(180%)",transition:"box-shadow 0.2s","&:hover":{boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.18)"}},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(c,{sx:{mr:1},children:r.icon}),e.jsxs(c,{children:[e.jsx(l,{variant:"subtitle1",sx:{fontWeight:600},children:r.name}),e.jsx(l,{variant:"body2",color:"text.secondary",children:r.description}),e.jsxs(l,{variant:"caption",color:"text.secondary",children:["Slug: ",r.slug]}),e.jsxs(l,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5},children:["Config: ",JSON.stringify(r.config)]})]})]}),e.jsx(c,{children:e.jsx(O,{onClick:()=>ee(r),children:e.jsx(ke,{style:{width:20,height:20,color:t.palette.primary.main}})})})]})},r.id))})})]})})]})}),e.jsxs($,{open:K,onClose:w,maxWidth:"sm",fullWidth:!0,children:[e.jsx(G,{children:"Edit Attendance Type Config"}),e.jsx(H,{children:d&&e.jsxs(e.Fragment,{children:[e.jsxs(l,{variant:"subtitle1",sx:{mb:2},children:[d.name," (",d.slug,")"]}),Object.keys(v.config).length===0&&e.jsx(l,{variant:"body2",color:"text.secondary",children:"No config fields available for this type."}),Object.entries(v.config).map(([r,a])=>e.jsx(x,{label:r,value:a,onChange:s=>re(r,s.target.value),fullWidth:!0,margin:"normal"},r))]})}),e.jsxs(z,{children:[e.jsx(j,{onClick:w,children:"Cancel"}),e.jsx(j,{onClick:ae,variant:"contained",children:"Save"})]})]}),e.jsxs($,{open:Q,onClose:W,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,borderRadius:3,boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37)"}},children:[e.jsxs(G,{sx:{display:"flex",alignItems:"center",gap:2,borderBottom:"1px solid rgba(255,255,255,0.1)",pb:2},children:[e.jsx(N,{style:{width:24,height:24,color:t.palette.primary.main}}),e.jsx(l,{variant:"h6",component:"span",children:d?`Manage Waypoints - ${d.name}`:"Manage Waypoints"})]}),e.jsxs(H,{sx:{pt:3},children:[e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Define location waypoints for attendance tracking. Each waypoint requires latitude and longitude coordinates."}),e.jsx(c,{sx:{mb:4},children:e.jsxs(c,{sx:{p:2.5,borderRadius:3,background:"rgba(255,255,255,0.08)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.12)",backdropFilter:"blur(12px) saturate(180%)"},children:[e.jsxs(l,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",gap:1,color:t.palette.primary.main,fontWeight:600,mb:2},children:[e.jsxs("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Location Tolerance Settings"]}),e.jsx(x,{label:"Tolerance (meters)",placeholder:"e.g., 100",type:"number",value:g.tolerance,onChange:r=>se(parseInt(r.target.value)||0),fullWidth:!0,inputProps:{min:1,max:1e4,step:1},helperText:"Distance in meters within which attendance can be marked from each waypoint",sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})]})}),e.jsx(U,{sx:{my:3,opacity:.3}}),e.jsx(n,{container:!0,spacing:3,children:g.waypoints.map((r,a)=>e.jsxs(n,{item:!0,xs:12,children:[e.jsxs(c,{sx:{p:2.5,borderRadius:3,background:"rgba(255,255,255,0.08)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.12)",backdropFilter:"blur(12px) saturate(180%)"},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(l,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",gap:1,color:t.palette.primary.main,fontWeight:600},children:[e.jsx(N,{style:{width:16,height:16}}),"Waypoint ",a+1]}),g.waypoints.length>2&&e.jsx(O,{onClick:()=>ne(a),size:"small",sx:{color:t.palette.error.main,"&:hover":{background:"rgba(255,0,0,0.08)"}},children:e.jsx(_e,{style:{width:16,height:16}})})]}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,sm:6,children:e.jsx(x,{label:"Latitude",placeholder:"e.g., 40.7128",type:"number",value:r.lat,onChange:s=>L(a,"lat",s.target.value),fullWidth:!0,inputProps:{step:"any",min:-90,max:90},sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})}),e.jsx(n,{item:!0,xs:12,sm:6,children:e.jsx(x,{label:"Longitude",placeholder:"e.g., -74.0060",type:"number",value:r.lng,onChange:s=>L(a,"lng",s.target.value),fullWidth:!0,inputProps:{step:"any",min:-180,max:180},sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})})]})]}),a<g.waypoints.length-1&&e.jsx(U,{sx:{my:2,opacity:.3}})]},a))}),e.jsx(c,{sx:{mt:3,display:"flex",justifyContent:"center"},children:e.jsx(j,{startIcon:e.jsx(Ce,{style:{width:20,height:20}}),onClick:oe,variant:"outlined",sx:{borderRadius:3,background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.2)",color:t.palette.primary.main,"&:hover":{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.3)"}},children:"Add Another Waypoint"})})]}),e.jsxs(z,{sx:{p:3,borderTop:"1px solid rgba(255,255,255,0.1)",gap:2},children:[e.jsx(j,{onClick:W,sx:{borderRadius:3,color:t.palette.text.secondary,"&:hover":{background:"rgba(255,255,255,0.05)"}},children:"Cancel"}),e.jsx(E,{onClick:ie,variant:"contained",sx:{borderRadius:3,background:`linear-gradient(135deg, ${t.palette.primary.main}, ${t.palette.primary.dark})`,boxShadow:"0 4px 20px rgba(0,0,0,0.15)","&:hover":{boxShadow:"0 6px 25px rgba(0,0,0,0.2)"}},children:"Save Waypoints"})]})]})]})};we.layout=k=>e.jsx(pe,{children:k});export{we as default};
