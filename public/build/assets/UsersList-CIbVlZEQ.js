import{a as t,j as e,L as Le,F as ee,b as Se,H as it,r as xe}from"./app-BiR4HUU6.js";import{r as d,n as Ie,g as je}from"./react-core-SLWS96gT.js";import{e as Ze,h as pe,q as Xe,B as P,k as lt,r as De,b as we,c as nt,o as dt,A as ot}from"./App-WMq6RoU3.js";import{G as ct}from"./logo-Bl0iXllB.js";import{P as mt}from"./PageHeader-Bpq-xkFY.js";import{S as ut}from"./StatsCards-BERqnUUA.js";import{u as Ae,Z as Ue,B as ge,T as _,o as Ne,p as ht,h as C,a6 as pt,j as S,i as L,I as ue,M as z,m as he,q as gt,r as bt,a as ze,G as ft,F as vt,f as xt}from"./mui-libraries-CQTi8RHu.js";import{F as Ye}from"./EllipsisVerticalIcon-B_1nfmYU.js";import{F as ye}from"./UserIcon-CGZSeVa1.js";import{F as Ke}from"./PencilIcon-KhnBq3g6.js";import{b as _e,F as Pe,c as wt,a as Ee}from"./SignalIcon-Xm5LjO8M.js";import{F as Ce}from"./LockClosedIcon-C1mDI3TC.js";import{a as be}from"./ShieldCheckIcon-BRKjP3CW.js";import{F as Nt}from"./EnvelopeIcon-C4jDV72b.js";import{k as yt,m as _t,n as Pt,o as Ct,q as kt,v as Rt,N as Oe,G as et,O as ke,b as K,P as Re,Q as V,S as Fe,f as Q,t as Ft,L as tt,s as te,g as X,e as Y,i as St,D as It,l as ie}from"./ui-libraries-CePrafQA.js";import{C as jt}from"./Clear-CdK_0SvM.js";import{G as Dt}from"./GlassDialog-DV54zn6N.js";import{P as At}from"./PhotoCamera-Bc15zNHu.js";import{L as Ut}from"./LoadingButton-ClHswgR_.js";import{a as le}from"./utilities-DyZVG5is.js";import{F as Ve}from"./CheckCircleIcon-CDPGBXlV.js";import{F as qe}from"./XCircleIcon-CL14Mpox.js";import{F as Tt}from"./TrophyIcon-mR0I5bLc.js";import{F as $t}from"./UserPlusIcon-HaxtqVIQ.js";import{F as Me}from"./ChartBarIcon-B6NbD6y8.js";import{F as Lt}from"./ChartPieIcon-CUZay0zN.js";import{F as zt}from"./ExclamationTriangleIcon-EI717oj0.js";import{F as Et}from"./TableCellsIcon-CqcjJ1H-.js";import{F as Ot}from"./AdjustmentsHorizontalIcon-DtQJ8a7G.js";import"./app-B9RuXsJe.js";const Vt=({allUsers:c,roles:A,isMobile:k,isTablet:f,setUsers:E,pagination:x,onPageChange:v,onRowsPerPageChange:F,totalUsers:I=0,onEdit:Z,loading:u=!1,updateUserOptimized:ae,deleteUserOptimized:o,toggleUserStatusOptimized:q,updateUserRolesOptimized:M,toggleSingleDeviceLogin:U,resetUserDevice:B,deviceActions:p={}})=>{const[re,H]=d.useState({});Ae();const W=(a,s="w-5 h-5")=>{const m=a?.toLowerCase()||"";return m.includes("mobile")||m.includes("android")||m.includes("iphone")?e(Pe,{className:`${s} text-primary`}):m.includes("tablet")||m.includes("ipad")?e(wt,{className:`${s} text-secondary`}):e(lt,{className:`${s} text-default-500`})},$=a=>{const s=a?.toLowerCase()||"";return s.includes("mobile")||s.includes("android")||s.includes("iphone")?"Mobile Device":s.includes("tablet")||s.includes("ipad")?"Tablet":"Desktop"},j=(a,s,m)=>{H(l=>({...l,[`${a}-${s}`]:m}))},g=(a,s)=>re[`${a}-${s}`]||!1;async function n(a,s){j(a,"role",!0);const m=new Promise(async(l,D)=>{try{const N=await axios.post(route("user.updateRole",{id:a}),{roles:s});N.status===200&&(M&&M(a,s),l([N.data.message||"Role updated successfully"]))}catch(N){N.response?.status===422?D(N.response.data.errors||["Failed to update user role."]):D(["An unexpected error occurred. Please try again later."])}finally{j(a,"role",!1)}});return P.promise(m,{pending:"Updating employee role...",success:{render({data:l}){return l.join(", ")}},error:{render({data:l}){return Array.isArray(l)?l.join(", "):l}}}),m}const G=d.useMemo(()=>{const a=[{name:"#",uid:"sl"},{name:"USER",uid:"user"},{name:"EMAIL",uid:"email"},{name:"DEPARTMENT",uid:"department"},{name:"DEVICE STATUS",uid:"device_status"},{name:"STATUS",uid:"status"},{name:"ROLES",uid:"roles"},{name:"ACTIONS",uid:"actions"}];if(!k&&!f)a.splice(3,0,{name:"PHONE",uid:"phone"});else if(k)a.splice(a.findIndex(s=>s.uid==="department"),1),a.splice(a.findIndex(s=>s.uid==="device_status"),1);else if(f){const s=a.findIndex(m=>m.uid==="device_status");if(s>-1){const m=a.splice(s,1)[0];a.splice(2,0,m)}}return a},[k,f]),J=async(a,s)=>{if(!g(a,"status")){j(a,"status",!0);try{q?(q(a,!s),P.success(`User status ${s?"deactivated":"activated"} successfully`)):E&&(E(m=>m.map(l=>l.id===a?{...l,active:!s}:l)),P.success(`User status ${s?"deactivated":"activated"} successfully`))}catch(m){console.error("Error toggling user status:",m),P.error("Failed to update user status")}finally{j(a,"status",!1)}}},h=(a,s,m)=>{const l=a[s];switch(s){case"sl":const O=(x?.currentPage&&x?.perPage?Number((x.currentPage-1)*x.perPage):0)+(typeof m=="number"?m:0)+1;return e("div",{className:"flex items-center justify-center",children:e("div",{className:"flex items-center justify-center w-8 h-8 bg-content1/20 backdrop-blur-md rounded-lg border border-divider",children:e("span",{className:"text-sm font-semibold text-foreground",children:O})})});case"user":return e(tt,{className:"w-fit max-w-full",avatarProps:{radius:"lg",size:"sm",src:a?.profile_image_url||a?.profile_image,showFallback:!0,name:a?.name||"Unnamed User",isBordered:!0},name:e("span",{className:"text-sm font-medium whitespace-nowrap",children:a?.name||"Unnamed User"})});case"email":return t("div",{className:"flex items-center",children:[e(Nt,{className:"w-4 h-4 text-default-400 mr-2"}),e("span",{className:"text-sm",children:a.email})]});case"phone":return t("div",{className:"flex items-center",children:[e(Xe,{className:"w-4 h-4 text-default-400 mr-2"}),e("span",{className:"text-sm",children:a.phone||"N/A"})]});case"department":return t("div",{className:"flex items-center",children:[e(pe,{className:"w-4 h-4 text-default-400 mr-2"}),e("span",{className:"text-sm",children:a?.department||"N/A"})]});case"device_status":const T=g(a.id,"deviceToggle");return e("div",{className:"flex items-center space-x-2",children:a.single_device_login?t(Se,{children:[e(Q,{size:"sm",variant:"flat",color:a.active_device?"warning":"success",startContent:T?e("div",{className:"animate-spin",children:e(ee,{className:"w-3 h-3"})}):a.active_device?e(Ce,{className:"w-3 h-3"}):e(_e,{className:"w-3 h-3"}),children:T?"Loading...":a.active_device?"Locked":"Free"}),a.active_device&&!T&&e(Ft,{content:t("div",{className:"bg-content1/20 backdrop-blur-md border border-divider rounded-lg p-4 shadow-2xl max-w-sm",children:[t("div",{className:"flex items-center gap-3 mb-3",children:[W(a.active_device.user_agent,"w-5 h-5"),t("div",{children:[e("div",{className:"font-semibold text-foreground text-sm",children:a.active_device.device_name||"Unknown Device"}),e("div",{className:"text-xs text-default-500",children:$(a.active_device.user_agent)})]})]}),e("div",{className:"space-y-2 text-xs",children:e("div",{className:"pt-2 mt-2 border-t border-white/20",children:t("div",{className:"flex items-center gap-1",children:[e(Ze,{className:"w-3 h-3 text-success"}),e("span",{className:"text-success text-xs font-medium",children:a.active_device.is_active?"Currently Active":"Inactive"})]})})})]}),placement:"top",classNames:{content:"p-0 bg-transparent shadow-none border-none"},children:e("div",{className:"flex items-center p-1 rounded hover:bg-content1/10 transition-colors cursor-default",children:W(a.active_device.user_agent,"w-4 h-4")})})]}):e(Q,{size:"sm",variant:"flat",color:"default",startContent:T?e("div",{className:"animate-spin",children:e(ee,{className:"w-3 h-3"})}):e(be,{className:"w-3 h-3"}),children:T?"Loading...":"Disabled"})});case"status":return t("div",{className:"flex items-center justify-center",children:[t("label",{className:"relative inline-flex items-center cursor-pointer",children:[e("input",{type:"checkbox",className:"sr-only peer",checked:a.active,onChange:()=>J(a.id,a.active),disabled:g(a.id,"status")}),e("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-opacity-30 rounded-full peer transition-all duration-300 ${a.active?"bg-green-500 peer-focus:ring-green-300":"bg-red-500 peer-focus:ring-red-300"} peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all`}),g(a.id,"status")&&e("div",{className:"absolute inset-0 flex items-center justify-center",children:e("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),e("span",{className:"ml-2 text-xs",children:a.active?"Active":"Inactive"})]});case"roles":const se=a.roles?.map(y=>typeof y=="object"&&y!==null?y.name:y)||[],ce=new Set(se),fe=Array.from(ce).join(", ")||"No Roles";return e("div",{className:"flex items-center",children:t(Fe,{isDisabled:g(a.id,"role"),className:"max-w-[220px]",children:[e(ke,{children:e(K,{className:"capitalize",variant:"bordered",size:"sm",startContent:g(a.id,"role")?e(Oe,{size:"sm"}):null,children:fe})}),e(Re,{disallowEmptySelection:!1,"aria-label":"Multiple selection example",closeOnSelect:!1,selectedKeys:ce,selectionMode:"multiple",variant:"flat",onSelectionChange:y=>{const ve=Array.from(y);n(a.id,ve)},children:(A||[]).map(y=>e(V,{children:typeof y=="object"&&y!==null?y.name:y},typeof y=="object"&&y!==null?y.name:y))})]})});case"actions":return e("div",{className:"flex justify-center items-center",children:t(Fe,{children:[e(ke,{children:e(K,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",children:e(Ye,{className:"w-4 h-4"})})}),t(Re,{"aria-label":"User Actions",children:[e(V,{textValue:"View Profile",href:route("profile",{user:a.id}),as:Le,className:"text-blue-500",startContent:e(ye,{className:"w-4 h-4"}),children:"View Profile"}),e(V,{textValue:"Edit User",onPress:()=>{Z&&Z(a)},className:"text-amber-500",startContent:e(Ke,{className:"w-4 h-4"}),children:"Edit"}),e(V,{textValue:"Device Toggle",onPress:()=>{U&&!g(a.id,"deviceToggle")&&(j(a.id,"deviceToggle",!0),U(a.id,!a.single_device_login).finally(()=>{j(a.id,"deviceToggle",!1)}))},isDisabled:p[a.id]||g(a.id,"deviceToggle"),startContent:g(a.id,"deviceToggle")?e("div",{className:"animate-spin",children:e(ee,{className:"w-4 h-4"})}):a.single_device_login?e(_e,{className:"w-4 h-4"}):e(Ce,{className:"w-4 h-4"}),className:a.single_device_login?"text-orange-500":"text-green-500",children:g(a.id,"deviceToggle")?"Processing...":a.single_device_login?"Disable Device Lock":"Enable Device Lock"}),a.single_device_login&&a.active_device&&e(V,{textValue:"Reset Device",onPress:()=>{B&&!g(a.id,"deviceReset")&&(j(a.id,"deviceReset",!0),B(a.id).finally(()=>{j(a.id,"deviceReset",!1)}))},isDisabled:p[a.id]||g(a.id,"deviceReset"),startContent:g(a.id,"deviceReset")?e("div",{className:"animate-spin",children:e(ee,{className:"w-4 h-4"})}):e(ee,{className:"w-4 h-4"}),className:"text-red-500",children:g(a.id,"deviceReset")?"Resetting...":"Reset Device"}),e(V,{textValue:"View Devices",href:route("users.device.show",{user:a.id}),as:Le,startContent:e(Pe,{className:"w-4 h-4"}),className:"text-blue-500",children:"View Device History"})]})]})});default:return l}};return t("div",{className:"w-full overflow-hidden flex flex-col border border-divider rounded-lg bg-content1/10 backdrop-blur-md",style:{maxHeight:"calc(100vh - 200px)"},children:[e("div",{className:"overflow-auto grow relative table-scroll-container frozen-column-container",children:t(yt,{"aria-label":"Users table",removeWrapper:!0,classNames:{base:"bg-transparent min-w-[800px]",th:"backdrop-blur-md text-default-500 border-b border-divider font-medium text-xs sticky top-0 z-30 shadow-sm",td:"border-b border-divider/50 py-3",table:"border-collapse",thead:"sticky top-0 z-30",tr:""},children:[e(_t,{columns:G,children:a=>e(Pt,{align:a.uid==="actions"||a.uid==="sl"?"center":"start",width:a.uid==="sl"?60:a.uid==="user"?240:void 0,className:a.uid==="sl"?"sticky-header-sl backdrop-blur-md":a.uid==="user"?"sticky-header-user backdrop-blur-md":"backdrop-blur-md sticky top-0 z-30",children:a.name},a.uid)}),e(Ct,{items:c||[],emptyContent:"No users found",loadingContent:e(Oe,{}),isLoading:u,children:(a,s)=>{const m=c?c.findIndex(l=>l.id===a.id):s;return e(kt,{className:"table-row-hover",children:l=>e(Rt,{className:l==="sl"?"frozen-column sticky left-0 z-20 backdrop-blur-md border-r border-divider/30":l==="user"?"frozen-column-user sticky z-20 backdrop-blur-md border-r border-divider/30":"",style:l==="user"?{left:"60px"}:{},children:h(a,l,m)})},a.id)}})]})}),!c||!I||u?null:t("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-divider bg-content1/50 backdrop-blur-md",children:[t("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(x.currentPage-1)*x.perPage+1," to ",Math.min(x.currentPage*x.perPage,I)," of ",I," users"]}),e(et,{total:Math.ceil(I/x.perPage),initialPage:x.currentPage,page:x.currentPage,onChange:v,size:k?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-content1/20 backdrop-blur-md border-divider hover:bg-content1/30",cursor:"bg-content1/40 backdrop-blur-md border-divider"}})]})]})};var ne={},Be;function qt(){if(Be)return ne;Be=1;var c=Ue();Object.defineProperty(ne,"__esModule",{value:!0}),ne.default=void 0;var A=c(De()),k=Ie();return ne.default=(0,A.default)((0,k.jsx)("path",{d:"M2 17h20v2H2zm1.15-4.05L4 11.47l.85 1.48 1.3-.75-.85-1.48H7v-1.5H5.3l.85-1.47L4.85 7 4 8.47 3.15 7l-1.3.75.85 1.47H1v1.5h1.7l-.85 1.48zm6.7-.75 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H15v-1.5h-1.7l.85-1.47-1.3-.75L12 8.47 11.15 7l-1.3.75.85 1.47H9v1.5h1.7zM23 9.22h-1.7l.85-1.47-1.3-.75L20 8.47 19.15 7l-1.3.75.85 1.47H17v1.5h1.7l-.85 1.48 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H23z"}),"Password"),ne}var Mt=qt();const Bt=je(Mt);var de={},He;function Ht(){if(He)return de;He=1;var c=Ue();Object.defineProperty(de,"__esModule",{value:!0}),de.default=void 0;var A=c(De()),k=Ie();return de.default=(0,A.default)((0,k.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),de}var Wt=Ht();const We=je(Wt);var oe={},Ge;function Gt(){if(Ge)return oe;Ge=1;var c=Ue();Object.defineProperty(oe,"__esModule",{value:!0}),oe.default=void 0;var A=c(De()),k=Ie();return oe.default=(0,A.default)((0,k.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),oe}var Jt=Gt();const Je=je(Jt),Qe=({user:c,allUsers:A,departments:k,designations:f,setUsers:E,open:x,closeModal:v,editMode:F=!1})=>{const[I,Z]=d.useState(!1),[u,ae]=d.useState({id:c?.id||"",name:c?.name||"",user_name:c?.user_name||"",gender:c?.gender||"",birthday:c?.birthday||"",date_of_joining:c?.date_of_joining||"",address:c?.address||"",employee_id:c?.employee_id||"",phone:c?.phone||"",email:c?.email||"",department_id:c?.department_id||"",designation_id:c?.designation_id||"",report_to:c?.report_to||"",password:"",confirmPassword:"",roles:c?.roles||[]}),[o,q]=d.useState({}),[M,U]=d.useState(!1),[B,p]=d.useState(!1),[re,H]=d.useState(c?.profile_image_url||c?.profile_image||null),[W,$]=d.useState(null),[j,g]=d.useState(A),n=Ae();d.useEffect(()=>{(c?.profile_image_url||c?.profile_image)&&H(c.profile_image_url||c.profile_image)},[c]);const G=async s=>{s.preventDefault(),U(!0);const m=new FormData;if(Object.keys(u).forEach(l=>{l==="roles"&&Array.isArray(u[l])?u[l].forEach((D,N)=>{m.append(`roles[${N}]`,D)}):u[l]!==null&&u[l]!==void 0&&m.append(l,u[l])}),W){const l=W.type;if(["image/jpeg","image/jpg","image/png"].includes(l))m.append("profile_image",W);else{P.error("Invalid file type. Only JPEG and PNG are allowed.",{icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}}),U(!1);return}}try{const l=F?route("updateUser",{id:c.id}):route("addUser"),D=F?"put":"post",N=await axios[D](l,m);N.status===200&&(E&&E(F?O=>O.map(T=>T.id===N.data.user.id?N.data.user:T):O=>[...O,N.data.user]),P.success(N.data.messages?.length>0?N.data.messages.join(" "):`User ${F?"updated":"added"} successfully`,{icon:"🟢",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}}),v())}catch(l){U(!1),J(l)}finally{U(!1)}},J=s=>{s.response?s.response.status===422?(q(s.response.data.errors||{}),P.error(s.response.data.error||`Failed to ${F?"update":"add"} user.`,{icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}})):P.error("An unexpected error occurred. Please try again later.",{icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}}):s.request?P.error("No response received from the server. Please check your internet connection.",{icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}}):P.error("An error occurred while setting up the request.",{icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",background:n.glassCard.background,border:n.glassCard.border,color:n.palette.text.primary}})},h=s=>{const m=s.target.files[0];if(m){const l=URL.createObjectURL(m);H(l),$(m)}},w=(s,m)=>{ae(l=>({...l,[s]:m})),o[s]&&q(l=>{const D={...l};return delete D[s],D})},a=()=>{Z(!I)};return t(Dt,{open:x,onClose:v,fullWidth:!0,maxWidth:"md",sx:{"& .MuiPaper-root":{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:n.glassCard.background,border:n.glassCard.border,borderRadius:"16px",color:n.palette.text.primary,boxShadow:n.glassCard.boxShadow}},children:[e(ht,{sx:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",pb:2},children:t(ge,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e(_,{variant:"h6",component:"div",sx:{fontWeight:600},children:F?"Edit User":"Add New User"}),e(Ne,{"aria-label":"close",onClick:v,sx:{color:n.palette.grey[500],"&:hover":{color:n.palette.primary.main}},children:e(jt,{})})]})}),e(gt,{sx:{pt:3},children:e("form",{onSubmit:G,children:t(C,{container:!0,spacing:3,children:[e(C,{item:!0,xs:12,sx:{display:"flex",justifyContent:"center",mb:2},children:t(ge,{onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),sx:{position:"relative"},children:[e(pt,{src:re,alt:"Profile",sx:{width:120,height:120,border:"4px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",filter:B?"brightness(70%)":"brightness(100%)",transition:"all 0.3s ease"}}),t(ge,{component:"label",htmlFor:"icon-button-file",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",opacity:B?1:0,transition:"opacity 0.3s ease",cursor:"pointer"},children:[e("input",{accept:"image/*",id:"icon-button-file",type:"file",style:{display:"none"},onChange:h}),e(At,{sx:{color:"white",fontSize:32}})]})]})}),e(C,{item:!0,xs:12,md:6,children:e(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Full Name",value:u.name,onChange:s=>w("name",s.target.value),error:!!o.name,helperText:o.name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}},required:!0})})}),e(C,{item:!0,xs:12,md:6,children:e(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Username",value:u.user_name,onChange:s=>w("user_name",s.target.value),error:!!o.user_name,helperText:o.user_name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}},required:!0})})}),e(C,{item:!0,xs:12,md:6,children:e(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Email",type:"email",value:u.email,onChange:s=>w("email",s.target.value),error:!!o.email,helperText:o.email,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}},required:!0})})}),e(C,{item:!0,xs:12,md:6,children:e(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Phone",value:u.phone,onChange:s=>w("phone",s.target.value),error:!!o.phone,helperText:o.phone,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}}})})}),e(C,{item:!0,xs:12,md:6,children:t(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e(ue,{id:"department-label",sx:{color:n.palette.text.secondary},children:"Department"}),t(te,{labelId:"department-label",value:u.department_id,onChange:s=>w("department_id",s.target.value),label:"Department",error:!!o.department_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e(z,{value:"",children:e("em",{children:"None"})}),k?.map(s=>e(z,{value:s.id,children:s.name},s.id))]}),o.department_id&&e(he,{error:!0,children:o.department_id})]})}),e(C,{item:!0,xs:12,md:6,children:t(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e(ue,{id:"designation-label",sx:{color:n.palette.text.secondary},children:"Designation"}),t(te,{labelId:"designation-label",value:u.designation_id,onChange:s=>w("designation_id",s.target.value),label:"Designation",error:!!o.designation_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e(z,{value:"",children:e("em",{children:"None"})}),f?.map(s=>e(z,{value:s.id,children:s.name},s.id))]}),o.designation_id&&e(he,{error:!0,children:o.designation_id})]})}),e(C,{item:!0,xs:12,md:6,children:t(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e(ue,{id:"gender-label",sx:{color:n.palette.text.secondary},children:"Gender"}),t(te,{labelId:"gender-label",value:u.gender,onChange:s=>w("gender",s.target.value),label:"Gender",error:!!o.gender,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e(z,{value:"",children:e("em",{children:"Select Gender"})}),e(z,{value:"male",children:"Male"}),e(z,{value:"female",children:"Female"}),e(z,{value:"other",children:"Other"})]}),o.gender&&e(he,{error:!0,children:o.gender})]})}),e(C,{item:!0,xs:12,md:6,children:e(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Employee ID",value:u.employee_id,onChange:s=>w("employee_id",s.target.value),error:!!o.employee_id,helperText:o.employee_id,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}}})})}),e(C,{item:!0,xs:12,md:6,children:e(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Date of Birth",type:"date",value:u.birthday,onChange:s=>w("birthday",s.target.value),error:!!o.birthday,helperText:o.birthday,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:n.palette.text.secondary}}})})}),e(C,{item:!0,xs:12,md:6,children:e(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Date of Joining",type:"date",value:u.date_of_joining,onChange:s=>w("date_of_joining",s.target.value),error:!!o.date_of_joining,helperText:o.date_of_joining,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:n.palette.text.secondary}}})})}),e(C,{item:!0,xs:12,md:6,children:t(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e(ue,{id:"report-to-label",sx:{color:n.palette.text.secondary},children:"Reports To"}),t(te,{labelId:"report-to-label",value:u.report_to,onChange:s=>w("report_to",s.target.value),label:"Reports To",error:!!o.report_to,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e(z,{value:"",children:e("em",{children:"None"})}),j?.filter(s=>s.id!==u.id).map(s=>e(z,{value:s.id,children:s.name},s.id))]}),o.report_to&&e(he,{error:!0,children:o.report_to})]})}),e(C,{item:!0,xs:12,children:e(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Address",multiline:!0,rows:3,value:u.address,onChange:s=>w("address",s.target.value),error:!!o.address,helperText:o.address,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}}})})}),!F&&t(Se,{children:[e(C,{item:!0,xs:12,md:6,children:e(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Password",type:I?"text":"password",value:u.password,onChange:s=>w("password",s.target.value),error:!!o.password,helperText:o.password,required:!F,InputProps:{endAdornment:e(Ne,{"aria-label":"toggle password visibility",onClick:a,edge:"end",children:I?e(We,{}):e(Je,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}}})})}),e(C,{item:!0,xs:12,md:6,children:e(S,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Confirm Password",type:I?"text":"password",value:u.confirmPassword,onChange:s=>w("confirmPassword",s.target.value),error:!!o.confirmPassword,helperText:o.confirmPassword||(u.password!==u.confirmPassword&&u.confirmPassword?"Passwords do not match":""),required:!F,InputProps:{endAdornment:e(Ne,{"aria-label":"toggle password visibility",onClick:a,edge:"end",children:I?e(We,{}):e(Je,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:n.palette.text.secondary}}})})})]})]})})}),t(bt,{sx:{justifyContent:"space-between",p:3,borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:[e(Button,{onClick:v,variant:"bordered",color:"default",size:"lg",className:"bg-white/5 hover:bg-white/10 border border-white/10",children:"Cancel"}),e(Ut,{onClick:G,loading:M,loadingPosition:"start",startIcon:e(Bt,{}),variant:"contained",sx:{background:"linear-gradient(45deg, #3a7bd5 0%, #2456bd 100%)",boxShadow:"0 4px 20px 0 rgba(58, 123, 213, 0.4)","&:hover":{background:"linear-gradient(45deg, #2456bd 0%, #1a3c8a 100%)"}},children:F?"Update User":"Add User"})]})]})},Qt=({title:c,roles:A})=>{const k=Ae(),f=ze(k.breakpoints.down("sm")),E=ze(k.breakpoints.down("md")),[x,v]=d.useState([]),[F,I]=d.useState(!0),[Z,u]=d.useState(null),[ae,o]=d.useState(0),[q,M]=d.useState(1),[U,B]=d.useState(null),[p,re]=d.useState({search:"",role:"all",status:"all",department:"all"}),[H,W]=d.useState(!1),[$,j]=d.useState("table"),[g,n]=d.useState({currentPage:1,perPage:10,total:x.length}),[G,J]=d.useState({}),[h,w]=d.useState({overview:{total_users:0,active_users:0,inactive_users:0,deleted_users:0,total_roles:0,total_departments:0},distribution:{by_role:[],by_department:[],by_status:[]},activity:{recent_registrations:{new_users_30_days:0,new_users_90_days:0,new_users_year:0,recently_active:0},user_growth_rate:0,current_month_registrations:0},security:{access_metrics:{users_with_roles:0,users_without_roles:0,admin_users:0,regular_users:0},role_distribution:[]},health:{status_ratio:{active_percentage:0,inactive_percentage:0,deleted_percentage:0},system_metrics:{user_activation_rate:0,role_coverage:0,department_coverage:0}},quick_metrics:{total_users:0,active_ratio:0,role_diversity:0,department_diversity:0,recent_activity:0,system_health_score:0}}),a=d.useMemo(()=>({data:x,total:ae,current_page:g.currentPage,per_page:g.perPage,last_page:q}),[x,ae,g.currentPage,g.perPage,q]),s=d.useCallback(async()=>{try{const{data:r}=await le.get(route("users.stats"));r.stats&&w(r.stats)}catch(r){console.error("Error fetching user stats:",r)}},[]),m=d.useCallback(async()=>{I(!0);try{const r=await le.get(route("users.paginate"),{params:{page:g.currentPage,perPage:g.perPage,search:p.search||void 0,role:p.role!=="all"?p.role:void 0,status:p.status!=="all"?p.status:void 0,department:p.department!=="all"?p.department:void 0}});if(r.status===200){const{users:i}=r.data;i.data&&Array.isArray(i.data)?(v(i.data),o(i.total||i.data.length),M(i.last_page||1)):Array.isArray(i)?(v(i),o(i.length),M(1)):(console.error("Unexpected users data format:",i),v([]),o(0),M(1))}}catch(r){console.error("Error fetching users:",r),P.error("Failed to load users data"),v([])}finally{I(!1)}},[p,g.currentPage,g.perPage]);d.useEffect(()=>{m()},[m]),d.useEffect(()=>{s();const r=setInterval(s,6e4);return()=>clearInterval(r)},[s]);const l=(r,i)=>{re(b=>({...b,[r]:i})),n(b=>({...b,currentPage:1}))},D=r=>{n(i=>({...i,currentPage:r})),window.scrollTo({top:0,behavior:"smooth"})},N=r=>{n(i=>({...i,currentPage:1,perPage:r}))},O=d.useCallback((r,i=null)=>{B(r),u(i)},[]),T=d.useCallback(()=>{B(null),u(null)},[]),se=d.useCallback(r=>{v(r)},[]),ce=d.useCallback(r=>{v(i=>i.map(b=>b.id===r.id?{...b,...r}:b))},[]),fe=d.useCallback(r=>{v(i=>i.filter(b=>b.id!==r)),s()},[s]),y=d.useCallback((r,i)=>{v(b=>b.map(R=>R.id===r?{...R,active:i}:R)),s()},[s]),ve=d.useCallback((r,i)=>{v(b=>b.map(R=>R.id===r?{...R,roles:i}:R)),s()},[s]),Te=d.useCallback(async(r,i)=>{J(b=>({...b,[r]:!0}));try{(await le.post(route("users.device.toggle"),{user_id:r,enabled:i})).status===200&&(v(R=>R.map(me=>me.id===r?{...me,single_device_login:i,active_device:i?me.active_device:null}:me)),P.success(i?"Single device login enabled for user":"Single device login disabled for user"))}catch(b){console.error("Error toggling single device login:",b),P.error("Failed to update device settings")}finally{J(b=>({...b,[r]:!1}))}},[]),$e=d.useCallback(async r=>{J(i=>({...i,[r]:!0}));try{(await le.post(route("users.device.reset"),{user_id:r})).status===200&&(v(b=>b.map(R=>R.id===r?{...R,active_device:null}:R)),P.success("User device has been reset"))}catch(i){console.error("Error resetting user device:",i),P.error("Failed to reset user device")}finally{J(i=>({...i,[r]:!1}))}},[]);d.useCallback(async r=>{try{const i=await le.get(route("users.device.list",{user:r}));if(i.status===200){const b=i.data.devices;P.info(`User has ${b.length} device record(s)`)}}catch(i){console.error("Error fetching user devices:",i),P.error("Failed to fetch device information")}},[]);const at=({user:r,index:i})=>e(X,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 transition-all duration-200 cursor-pointer h-full",onPress:()=>xe.visit(route("profile",{user:r.id})),children:t(Y,{className:"p-4 flex flex-col h-full",children:[t("div",{className:"flex items-start gap-3 mb-3 pb-3 border-b border-white/10",children:[e(tt,{avatarProps:{radius:"lg",src:r?.profile_image_url||r?.profile_image,size:"md",fallback:e(ye,{className:"w-5 h-5"})},classNames:{name:"font-semibold text-foreground text-sm",description:"text-default-500 text-xs"}}),e("div",{className:"flex-1 min-w-0",children:t("div",{className:"flex items-start justify-between",children:[t("div",{children:[e("h3",{className:"font-semibold text-foreground text-sm line-clamp-1",children:r.name}),e("p",{className:"text-default-500 text-xs",children:r.email})]}),t("div",{className:"flex items-center gap-1",children:[e(K,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>{xe.visit(route("profile",{user:r.id}))},children:e(Ke,{className:"w-4 h-4"})}),t(Fe,{children:[e(ke,{children:e(K,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",children:e(Ye,{className:"w-4 h-4"})})}),t(Re,{"aria-label":"Device Actions",children:[e(V,{description:r.single_device_login?"Disable device restriction":"Enable device restriction",startContent:r.single_device_login?e(_e,{className:"w-4 h-4"}):e(Ce,{className:"w-4 h-4"}),onPress:()=>{Te(r.id,!r.single_device_login)},isDisabled:G[r.id],children:r.single_device_login?"Disable Device Lock":"Enable Device Lock"},"toggle-device"),r.single_device_login&&r.active_device&&e(V,{description:"Allow login from new device",startContent:e(ee,{className:"w-4 h-4"}),color:"warning",onPress:()=>{$e(r.id)},isDisabled:G[r.id],children:"Reset Device"},"reset-device"),e(V,{description:"View device history",startContent:e(Pe,{className:"w-4 h-4"}),onPress:()=>{xe.visit(route("users.device.show",{user:r.id}))},children:"View Devices"},"view-devices")]})]})]})]})})]}),t("div",{className:"flex-1 flex flex-col gap-3",children:[r.phone&&t("div",{className:"flex items-center gap-2 text-sm",children:[e(Xe,{className:"w-4 h-4 text-default-400 shrink-0"}),e("span",{className:"text-default-600 text-xs line-clamp-1",children:r.phone})]}),(r.department||r.department_id)&&t("div",{className:"flex items-center gap-2 text-sm",children:[e(pe,{className:"w-4 h-4 text-default-400 shrink-0"}),e("span",{className:"text-default-600 text-xs",children:typeof r.department=="string"?r.department:"N/A"})]})]}),t("div",{className:"mt-3 pt-3 border-t border-white/10 flex flex-wrap gap-2",children:[e(Q,{size:"sm",variant:r.active?"solid":"bordered",color:r.active?"success":"danger",className:"text-xs",startContent:r.active?e(Ve,{className:"w-3 h-3"}):e(qe,{className:"w-3 h-3"}),children:r.active?"Active":"Inactive"}),r.roles?.map((b,R)=>e(Q,{size:"sm",variant:"flat",color:"secondary",className:"text-xs",startContent:e(ye,{className:"w-3 h-3"}),children:b},R)),r.single_device_login&&e(Q,{size:"sm",variant:"flat",color:r.active_device?"warning":"default",className:"text-xs",startContent:e(be,{className:"w-3 h-3"}),children:r.active_device?"Device Locked":"Device Free"})]})]})}),rt=d.useMemo(()=>[{title:"Total Users",value:h?.overview?.total_users||0,icon:e(we,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All users"},{title:"Active Users",value:h?.overview?.active_users||0,icon:e(Ve,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:`${h?.health?.status_ratio?.active_percentage||0}% Active`},{title:"Inactive Users",value:h?.overview?.inactive_users||0,icon:e(qe,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:`${h?.health?.status_ratio?.inactive_percentage||0}% Inactive`},{title:"Total Roles",value:h?.overview?.total_roles||0,icon:e(be,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Role diversity"},{title:"Role Coverage",value:`${h?.health?.system_metrics?.role_coverage||0}%`,icon:e(Tt,{className:"w-5 h-5"}),color:"text-emerald-400",iconBg:"bg-emerald-500/20",description:"Users with roles"},{title:"Recent Activity",value:h?.activity?.recent_registrations?.recently_active||0,icon:e(Ze,{className:"w-5 h-5"}),color:"text-cyan-400",iconBg:"bg-cyan-500/20",description:"Active last 7 days"},{title:"System Health",value:`${h?.quick_metrics?.system_health_score||0}%`,icon:e(Ee,{className:"w-5 h-5"}),color:"text-pink-400",iconBg:"bg-pink-500/20",description:"Overall health"},{title:"Departments",value:h?.overview?.total_departments||0,icon:e(pe,{className:"w-5 h-5"}),color:"text-indigo-400",iconBg:"bg-indigo-500/20",description:"Department diversity"}],[h]),st=d.useMemo(()=>{const r=[];return r.push({label:f?"Add":"Add User",icon:e($t,{className:"w-4 h-4"}),onPress:()=>O("add"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),r.push({label:f?"":"Export",isIconOnly:f,icon:e(Me,{className:"w-4 h-4"}),variant:"bordered",className:"border-[rgba(var(--theme-primary-rgb),0.3)] bg-[rgba(var(--theme-primary-rgb),0.05)] hover:bg-[rgba(var(--theme-primary-rgb),0.1)]"}),r},[f,O]);return t(Se,{children:[e(it,{title:c}),U==="add"&&e(Qe,{user:null,open:U==="add",setUsers:se,closeModal:T,editMode:!1}),U==="edit"&&Z&&e(Qe,{user:Z,open:U==="edit",setUsers:se,closeModal:T,editMode:!0}),e(ge,{sx:{display:"flex",justifyContent:"center",p:2},children:e(ft,{in:!0,children:e(ct,{children:e(mt,{title:"Users Management",subtitle:"Manage users accounts and roles",icon:e(we,{className:"w-8 h-8"}),actionButtons:st,children:t("div",{className:"p-4 sm:p-6",children:[e(ut,{stats:rt,className:"mb-6"}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mb-6",children:[e(X,{className:"bg-white/5 backdrop-blur-md border-white/10",children:t(Y,{className:"p-4",children:[t("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e(Lt,{className:"w-5 h-5 text-purple-400"})}),t("div",{children:[e(_,{variant:"h6",className:"font-semibold text-foreground",children:"Role Distribution"}),e(_,{variant:"caption",className:"text-default-500",children:"User roles breakdown"})]})]}),e("div",{className:"space-y-3",children:h?.distribution?.by_role?.slice(0,5).map((r,i)=>t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center gap-2",children:[e("div",{className:"w-3 h-3 rounded-full bg-linear-to-r from-purple-400 to-pink-400"}),e("span",{className:"text-sm text-foreground truncate",children:r.name})]}),t("div",{className:"text-right",children:[e("span",{className:"text-sm font-medium text-foreground",children:r.count}),t("span",{className:"text-xs text-default-500 ml-1",children:["(",r.percentage,"%)"]})]})]},i))})]})}),e(X,{className:"bg-white/5 backdrop-blur-md border-white/10",children:t(Y,{className:"p-4",children:[t("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e(pe,{className:"w-5 h-5 text-blue-400"})}),t("div",{children:[e(_,{variant:"h6",className:"font-semibold text-foreground",children:"Department Distribution"}),e(_,{variant:"caption",className:"text-default-500",children:"Users by department"})]})]}),e("div",{className:"space-y-3",children:h?.distribution?.by_department?.slice(0,5).map((r,i)=>t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center gap-2",children:[e("div",{className:"w-3 h-3 rounded-full bg-linear-to-r from-blue-400 to-cyan-400"}),e("span",{className:"text-sm text-foreground truncate",children:r.name})]}),t("div",{className:"text-right",children:[e("span",{className:"text-sm font-medium text-foreground",children:r.count}),t("span",{className:"text-xs text-default-500 ml-1",children:["(",r.percentage,"%)"]})]})]},i))})]})}),e(X,{className:"bg-white/5 backdrop-blur-md border-white/10",children:t(Y,{className:"p-4",children:[t("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e(be,{className:"w-5 h-5 text-red-400"})}),t("div",{children:[e(_,{variant:"h6",className:"font-semibold text-foreground",children:"Security Metrics"}),e(_,{variant:"caption",className:"text-default-500",children:"Access control overview"})]})]}),t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Users with Roles"}),e("span",{className:"text-sm font-medium text-green-400",children:h?.security?.access_metrics?.users_with_roles||0})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Users without Roles"}),e("span",{className:"text-sm font-medium text-red-400",children:h?.security?.access_metrics?.users_without_roles||0})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Admin Users"}),e("span",{className:"text-sm font-medium text-orange-400",children:h?.security?.access_metrics?.admin_users||0})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Role Coverage"}),t("span",{className:"text-sm font-medium text-blue-400",children:[h?.health?.system_metrics?.role_coverage||0,"%"]})]})]})]})}),e(X,{className:"bg-white/5 backdrop-blur-md border-white/10",children:t(Y,{className:"p-4",children:[t("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e(Me,{className:"w-5 h-5 text-green-400"})}),t("div",{children:[e(_,{variant:"h6",className:"font-semibold text-foreground",children:"Activity Trends"}),e(_,{variant:"caption",className:"text-default-500",children:"Recent user activity"})]})]}),t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Recently Active"}),e("span",{className:"text-sm font-medium text-green-400",children:h?.activity?.recent_registrations?.recently_active||0})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"New (30 days)"}),e("span",{className:"text-sm font-medium text-blue-400",children:h?.activity?.recent_registrations?.new_users_30_days||0})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"New (90 days)"}),e("span",{className:"text-sm font-medium text-cyan-400",children:h?.activity?.recent_registrations?.new_users_90_days||0})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Growth Rate"}),t("span",{className:"text-sm font-medium text-purple-400",children:[h?.activity?.user_growth_rate||0,"%"]})]})]})]})}),e(X,{className:"bg-white/5 backdrop-blur-md border-white/10",children:t(Y,{className:"p-4",children:[t("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-teal-500/20 rounded-lg",children:e(Ee,{className:"w-5 h-5 text-teal-400"})}),t("div",{children:[e(_,{variant:"h6",className:"font-semibold text-foreground",children:"System Health"}),e(_,{variant:"caption",className:"text-default-500",children:"Overall system metrics"})]})]}),t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Health Score"}),t("span",{className:"text-sm font-medium text-teal-400",children:[h?.quick_metrics?.system_health_score||0,"%"]})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Activation Rate"}),t("span",{className:"text-sm font-medium text-green-400",children:[h?.health?.system_metrics?.user_activation_rate||0,"%"]})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Dept. Coverage"}),t("span",{className:"text-sm font-medium text-blue-400",children:[h?.health?.system_metrics?.department_coverage||0,"%"]})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Total Departments"}),e("span",{className:"text-sm font-medium text-purple-400",children:h?.overview?.total_departments||0})]})]})]})}),e(X,{className:"bg-white/5 backdrop-blur-md border-white/10",children:t(Y,{className:"p-4",children:[t("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e(zt,{className:"w-5 h-5 text-yellow-400"})}),t("div",{children:[e(_,{variant:"h6",className:"font-semibold text-foreground",children:"Status Breakdown"}),e(_,{variant:"caption",className:"text-default-500",children:"User status distribution"})]})]}),e("div",{className:"space-y-3",children:h?.distribution?.by_status?.map((r,i)=>t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center gap-2",children:[e("div",{className:`w-3 h-3 rounded-full ${r.name==="Active"?"bg-green-400":r.name==="Inactive"?"bg-red-400":"bg-gray-400"}`}),e("span",{className:"text-sm text-foreground",children:r.name})]}),t("div",{className:"text-right",children:[e("span",{className:"text-sm font-medium text-foreground",children:r.count}),t("span",{className:"text-xs text-default-500 ml-1",children:["(",r.percentage,"%)"]})]})]},i))})]})})]}),t("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e("div",{className:"flex-1",children:e(St,{label:"Search Users",variant:"bordered",placeholder:"Search by name, email or phone...",value:p.search,onValueChange:r=>l("search",r),startContent:e(nt,{className:"w-4 h-4"}),classNames:{input:"bg-transparent",inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},size:f?"sm":"md"})}),t("div",{className:"flex gap-2 items-end",children:[t(It,{variant:"bordered",className:"bg-white/5",children:[t(K,{isIconOnly:f,color:$==="table"?"primary":"default",onPress:()=>j("table"),className:$==="table"?"bg-blue-500/20":"",children:[e(Et,{className:"w-4 h-4"}),!f&&e("span",{className:"ml-1",children:"Table"})]}),t(K,{isIconOnly:f,color:$==="grid"?"primary":"default",onPress:()=>j("grid"),className:$==="grid"?"bg-blue-500/20":"",children:[e(dt,{className:"w-4 h-4"}),!f&&e("span",{className:"ml-1",children:"Grid"})]})]}),t(K,{isIconOnly:f,variant:"bordered",onPress:()=>W(!H),className:H?"bg-purple-500/20":"bg-white/5",children:[e(Ot,{className:"w-4 h-4"}),!f&&e("span",{className:"ml-1",children:"Filters"})]})]})]}),H&&e(vt,{in:!0,timeout:300,children:t("div",{className:"mb-6 p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:[t("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[t(te,{label:"Status",variant:"bordered",selectedKeys:p.status!=="all"?[p.status]:[],onSelectionChange:r=>{const i=Array.from(r)[0]||"all";l("status",i)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e(ie,{value:"all",children:"All Statuses"},"all"),e(ie,{value:"active",children:"Active Only"},"active"),e(ie,{value:"inactive",children:"Inactive Only"},"inactive")]}),t(te,{label:"Role",variant:"bordered",selectedKeys:p.role!=="all"?[p.role]:[],onSelectionChange:r=>{const i=Array.from(r)[0]||"all";l("role",i)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e(ie,{value:"all",children:"All Roles"},"all"),A?.map(r=>e(ie,{value:r.toLowerCase(),children:r},r.toLowerCase()))]})]}),(p.search||p.status!=="all"||p.role!=="all")&&t("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-white/10",children:[p.search&&t(Q,{variant:"flat",color:"primary",size:"sm",onClose:()=>l("search",""),children:["Search: ",p.search]}),p.status!=="all"&&t(Q,{variant:"flat",color:"secondary",size:"sm",onClose:()=>l("status","all"),children:["Status: ",p.status==="active"?"Active":"Inactive"]}),p.role!=="all"&&t(Q,{variant:"flat",color:"warning",size:"sm",onClose:()=>l("role","all"),children:["Role: ",p.role]})]})]})}),t("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[e("div",{className:"p-4 border-b border-white/10",children:t(_,{variant:"h6",className:"font-semibold text-foreground",children:[$==="table"?"User Table":"User Grid",t("span",{className:"text-sm text-default-500 ml-2",children:["(",a.total||0," ",a.total===1?"user":"users",")"]})]})}),F?t("div",{className:"text-center py-8",children:[e(xt,{size:40}),e(_,{className:"mt-4",color:"textSecondary",children:"Loading users data..."})]}):$==="table"?e(Vt,{allUsers:a.data,roles:A,setUsers:se,isMobile:f,isTablet:E,pagination:g,onPageChange:D,onRowsPerPageChange:N,totalUsers:a.total,loading:F,onEdit:r=>O("edit",r),updateUserOptimized:ce,deleteUserOptimized:fe,toggleUserStatusOptimized:y,updateUserRolesOptimized:ve,toggleSingleDeviceLogin:Te,resetUserDevice:$e,deviceActions:G}):t("div",{className:"p-4",children:[a.data&&a.data.length>0?e("div",{className:`grid gap-4 ${f?"grid-cols-1":E?"grid-cols-2":"grid-cols-3 xl:grid-cols-4"}`,children:a.data.map((r,i)=>e(at,{user:r,index:i},r.id))}):t("div",{className:"text-center py-8",children:[e(we,{className:"w-12 h-12 mx-auto text-default-300 mb-2"}),e(_,{variant:"body1",color:"textSecondary",children:"No users found"}),e(_,{variant:"caption",color:"textSecondary",children:"Try adjusting your search or filters"})]}),a.data&&a.data.length>0&&e("div",{className:"flex justify-center mt-6 border-t border-white/10 pt-4",children:e(et,{total:Math.ceil(a.total/g.perPage),initialPage:g.currentPage,page:g.currentPage,onChange:D,size:f?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})})]})]})]})})})})})]})};Qt.layout=c=>e(ot,{children:c});export{Qt as default};
