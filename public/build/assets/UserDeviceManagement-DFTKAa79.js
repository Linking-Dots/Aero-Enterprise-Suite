import{r as n,j as e,a as $,f as Fe,F as B,H as Re,c as f,L as $e}from"./app-C1U45Ebj.js";import{u as de,a as W,B as v,G as Ae,g as Me,b as Oe,K as Pe,c as O,L as me,U as ue,h as Ue,D as H,E as z,H as V,J as h,I as Te,A as Ie}from"./App-whY0_PgO.js";import{u as Ee,B as A,G as k,F as Be,T as i}from"./logo-CfQNLy2U.js";import{G as We}from"./GlassDialog-DlDj20KD.js";import{P as He}from"./PageHeader-BguKKtkP.js";import{S as ze}from"./StatsCards-CTb1gp2_.js";import{F as P,a as Ve,b as Ge,c as Ke}from"./SignalIcon-Da0djnin.js";import{F as Y}from"./CheckCircleIcon-B_RrSLXz.js";import{F as qe}from"./ArrowLeftIcon-Bx_vDJ5e.js";import{F as he}from"./DocumentArrowDownIcon-BXxQ19kw.js";import{a as Je}from"./ShieldCheckIcon-BOaBImyC.js";import{F as Qe}from"./LockClosedIcon-CyayZHE1.js";import{F as Ze}from"./GlobeAltIcon-DQpReNcy.js";import{F as Xe}from"./FunnelIcon-DQeo0PRv.js";import{C as Ye}from"./CircularProgress-CE3Tiwse.js";import{F as xe}from"./ExclamationTriangleIcon-C6Etxr_V.js";import{F as es}from"./MapPinIcon-B6rOTr6b.js";import{F as ss}from"./XCircleIcon-D5i3OHpc.js";import{F as ts}from"./EllipsisVerticalIcon-Bd0t_Shn.js";import{F as rs}from"./EyeIcon-CRCsgu04.js";import{D as as}from"./DialogTitle-n4i8VQ5D.js";import{D as ns,a as is}from"./DialogContent-Buy6bhT7.js";import{F as ls}from"./IdentificationIcon-CawgN18_.js";import{i as cs}from"./chunk-SSA7SXE4-CwjhqkNF.js";import{t as os,a as ds,b as D,c as ms,d as us,e as S}from"./chunk-F3UDT23P-C9zYK25D.js";import{t as hs}from"./chunk-BOOVDPB6-5to7tsiY.js";import{p as xs}from"./chunk-EAPQ7RWQ-X8us5Cw9.js";import"./EnvelopeIcon-DYtxSQqd.js";import"./UserIcon-Ch89lSMO.js";import"./create-visual-element-BuHeE9lo.js";import"./Dialog-CLSehbXy.js";import"./chunk-D5XJWRAV-D_e-q5OY.js";import"./useHasTabbableChild-zsiyx3Qk.js";import"./index-C-LltKoZ.js";import"./index-CokAva9Y.js";function fs({title:x,titleId:b,..._},w){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:w,"aria-labelledby":b},_),x?n.createElement("title",{id:b},x):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const G=n.forwardRef(fs);function gs({title:x,titleId:b,..._},w){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:w,"aria-labelledby":b},_),x?n.createElement("title",{id:b},x):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 20.25h12m-7.5-3v3m3-3v3m-10.125-3h17.25c.621 0 1.125-.504 1.125-1.125V4.875c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125Z"}))}const bs=n.forwardRef(gs);function ps({title:x,titleId:b,..._},w){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:w,"aria-labelledby":b},_),x?n.createElement("title",{id:b},x):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const js=n.forwardRef(ps),vs=({title:x,user:b,devices:_})=>{var ie,le,ce,oe;const w=Ee(),N=de(w.breakpoints.down("sm"));de(w.breakpoints.down("md"));const[a,K]=n.useState(b),[d,M]=n.useState(_||[]),[fe,L]=n.useState(!1),[j,C]=n.useState({}),[ee,se]=n.useState(!1),[o,te]=n.useState(null),[ge,re]=n.useState(!1),[l,ae]=n.useState({search:"",status:"all",type:"all",dateRange:"all"}),[q,be]=n.useState(!1),[F,J]=n.useState({currentPage:1,perPage:10}),p=n.useMemo(()=>{const s=new Date,t=new Date(s.getTime()-300*1e3),r=new Date(s.getTime()-1440*60*1e3),c=d.filter(g=>g.is_active),m=d.filter(g=>g.is_active&&g.last_seen_at&&new Date(g.last_seen_at)>t),u=d.filter(g=>g.last_seen_at&&new Date(g.last_seen_at)>r),E=d.filter(g=>g.user_agent&&g.user_agent.toLowerCase().includes("mobile"));return{total:d.length,active:c.length,online:m.length,recent:u.length,mobile:E.length,desktop:d.length-E.length,inactive:d.length-c.length}},[d]),pe=n.useMemo(()=>[{title:"Total Devices",value:p.total,icon:e.jsx(P,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All registered devices"},{title:"Active Sessions",value:p.active,icon:e.jsx(Y,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Currently active devices"},{title:"Online Now",value:p.online,icon:e.jsx(Ve,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Active within 5 minutes"},{title:"Recent Activity",value:p.recent,icon:e.jsx(W,{className:"w-5 h-5"}),color:"text-orange-400",iconBg:"bg-orange-500/20",description:"Active within 24 hours"}],[p]),R=n.useCallback(async()=>{L(!0);try{const s=await $.get(route("users.device.list",{user:a.id}));s.status===200&&(M(s.data.devices||[]),s.data.user&&K(t=>({...t,...s.data.user})))}catch(s){console.error("Error fetching devices:",s),v.error("Failed to fetch device information"),M([])}finally{L(!1)}},[a.id]),je=n.useCallback(async()=>{se(!0),await R(),se(!1),v.success("Device data refreshed")},[R]),ve=n.useCallback(()=>{const s=d.map(u=>({"Device Name":u.device_name||"Unknown","User Agent":u.user_agent,"IP Address":u.ip_address,Location:u.location||"Unknown",Status:u.is_active?"Active":"Inactive","Last Seen":u.last_seen_at?new Date(u.last_seen_at).toLocaleString():"Never",Created:u.created_at?new Date(u.created_at).toLocaleString():"Unknown"})),t=[Object.keys(s[0]||{}).join(","),...s.map(u=>Object.values(u).map(E=>`"${E}"`).join(","))].join(`
`),r=new Blob([t],{type:"text/csv"}),c=window.URL.createObjectURL(r),m=document.createElement("a");m.href=c,m.download=`${a.name}_devices_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(c),v.success("Device data exported successfully")},[d,a.name]),we=n.useMemo(()=>{const s=[];return s.push({label:N?"Back":"Back to Users",icon:e.jsx(qe,{className:"w-4 h-4"}),onClick:()=>Fe.visit(route("users")),variant:"light"}),s.push({label:N?"Refresh":"Refresh Data",icon:e.jsx(B,{className:"w-4 h-4"}),onClick:je,variant:"flat",color:"primary",isLoading:ee}),p.total>0&&s.push({label:N?"Export":"Export Devices",icon:e.jsx(he,{className:"w-4 h-4"}),onClick:ve,variant:"flat"}),s},[N,p.total,ee]),Ne=async s=>{C(t=>({...t,toggle:!0}));try{const t=await $.post(route("users.device.toggle"),{user_id:a.id,enabled:s});if(t.status===200&&t.data.success){const r={...a,single_device_login:t.data.user.single_device_login,active_device:t.data.user.active_device};K(r),v.success(t.data.message||(s?"Single device login enabled":"Single device login disabled")),L(!0);try{const c=await $.get(route("users.device.list",{user:a.id}));c.status===200&&M(c.data.devices||[])}catch(c){console.error("Error refreshing devices:",c)}finally{L(!1)}}}catch(t){console.error("Error toggling single device login:",t),v.error("Failed to update device settings")}finally{C(t=>({...t,toggle:!1}))}},ye=async()=>{C(s=>({...s,reset:!0}));try{(await $.post(route("users.device.reset"),{user_id:a.id})).status===200&&(K(t=>({...t,active_device:null})),M(t=>t.map(r=>({...r,is_active:!1}))),v.success("User device has been reset"),setTimeout(async()=>{try{L(!0);const t=await $.get(route("users.device.list",{user:a.id}));t.status===200&&M(t.data.devices||[])}catch(t){console.error("Error refreshing devices after reset:",t)}finally{L(!1)}},1e3))}catch(s){console.error("Error resetting user device:",s),v.error("Failed to reset user device")}finally{C(s=>({...s,reset:!1}))}},Q=n.useCallback(async s=>{C(t=>({...t,[`logout_${s}`]:!0}));try{(await $.post(route("users.device.logout"),{user_id:a.id,device_id:s})).status===200&&(v.success("Device logged out successfully"),await R())}catch(t){console.error("Error logging out device:",t),v.error("Failed to logout device")}finally{C(t=>({...t,[`logout_${s}`]:!1}))}},[a.id,R]),y=n.useMemo(()=>{let s=[...d];if(l.search){const t=l.search.toLowerCase();s=s.filter(r=>(r.device_name||"").toLowerCase().includes(t)||(r.user_agent||"").toLowerCase().includes(t)||(r.ip_address||"").toLowerCase().includes(t)||(r.location||"").toLowerCase().includes(t))}if(l.status!=="all"&&(s=s.filter(t=>l.status==="active"?t.is_active:l.status==="inactive"?!t.is_active:!0)),l.type!=="all"&&(s=s.filter(t=>{const r=(t.user_agent||"").toLowerCase();return l.type==="mobile"?r.includes("mobile")||r.includes("android")||r.includes("iphone"):l.type==="desktop"?!(r.includes("mobile")||r.includes("android")||r.includes("iphone")):!0})),l.dateRange!=="all"){const t=new Date;s=s.filter(r=>{if(!r.last_seen_at)return!1;const c=new Date(r.last_seen_at),m=(t-c)/(1e3*60*60);switch(l.dateRange){case"hour":return m<=1;case"day":return m<=24;case"week":return m<=168;case"month":return m<=720;default:return!0}})}return s},[d,l]),_e=n.useMemo(()=>{const s=(F.currentPage-1)*F.perPage,t=s+F.perPage;return y.slice(s,t)},[y,F]),ne=Math.ceil(y.length/F.perPage),U=(s,t)=>{ae(r=>({...r,[s]:t})),J(r=>({...r,currentPage:1}))},T=(s,t="w-5 h-5")=>{const r=(s||"").toLowerCase();return r.includes("iphone")||r.includes("ipod")?e.jsx(P,{className:`${t} text-default-600`}):r.includes("android")&&r.includes("mobile")?e.jsx(P,{className:`${t} text-default-600`}):r.includes("ipad")||r.includes("android")&&r.includes("tablet")?e.jsx(Ke,{className:`${t} text-default-600`}):r.includes("smart-tv")||r.includes("smarttv")||r.includes("tizen")||r.includes("webos")?e.jsx(bs,{className:`${t} text-default-600`}):e.jsx(ue,{className:`${t} text-default-600`})},Z=s=>{const t=(s||"").toLowerCase();return t.includes("iphone")||t.includes("ipod")?"iPhone":t.includes("android")&&t.includes("mobile")?"Android Phone":t.includes("ipad")?"iPad":t.includes("android")&&t.includes("tablet")?"Android Tablet":t.includes("smart-tv")||t.includes("smarttv")?"Smart TV":t.includes("windows")?"Windows PC":t.includes("mac")?"Mac":t.includes("linux")?"Linux":"Desktop"},ke=s=>{const t=(s||"").toLowerCase();return t.includes("chrome")&&!t.includes("edg")?"Chrome":t.includes("firefox")?"Firefox":t.includes("safari")&&!t.includes("chrome")?"Safari":t.includes("edg")?"Edge":t.includes("opera")?"Opera":"Unknown Browser"},De=s=>{const t=(s||"").toLowerCase();if(t.includes("windows nt 10"))return"Windows 10/11";if(t.includes("windows nt 6.3"))return"Windows 8.1";if(t.includes("windows nt 6.1"))return"Windows 7";if(t.includes("windows"))return"Windows";if(t.includes("mac os x")){const r=t.match(/mac os x ([0-9_]+)/);return r?`macOS ${r[1].replace(/_/g,".")}`:"macOS"}if(t.includes("android")){const r=t.match(/android ([0-9.]+)/);return r?`Android ${r[1]}`:"Android"}if(t.includes("iphone os")){const r=t.match(/iphone os ([0-9_]+)/);return r?`iOS ${r[1].replace(/_/g,".")}`:"iOS"}return t.includes("linux")?"Linux":"Unknown OS"},Se=s=>{te(s),re(!0)},I=()=>{re(!1),te(null)},X=s=>{if(!s)return"Never";const t=new Date(s),c=Math.floor((new Date-t)/(1e3*60));if(c<1)return"Just now";if(c<60)return`${c}m ago`;const m=Math.floor(c/60);if(m<24)return`${m}h ago`;const u=Math.floor(m/24);return u<7?`${u}d ago`:t.toLocaleDateString()},Le=s=>{if(!s.is_active)return"default";if(s.last_seen_at){const t=new Date,r=new Date(s.last_seen_at),c=(t-r)/(1e3*60);if(c<=5)return"success";if(c<=60)return"warning"}return"primary"},Ce=s=>{if(!s.is_active)return"Inactive";if(s.last_seen_at){const t=new Date,r=new Date(s.last_seen_at),c=(t-r)/(1e3*60);if(c<=5)return"Online";if(c<=60)return"Recent"}return"Active"};return n.useEffect(()=>{R()},[R]),e.jsxs(e.Fragment,{children:[e.jsx(Re,{title:x}),e.jsx(A,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(Ae,{in:!0,children:e.jsx(k,{children:e.jsx(He,{title:`Device Management - ${a.name}`,subtitle:`Manage ${a.name}'s device access, restrictions and session history`,icon:e.jsx(P,{className:"w-8 h-8"}),actionButtons:we,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(ze,{stats:pe,className:"mb-6"}),e.jsx("div",{className:"mb-6",children:e.jsx(k,{variant:"glass",className:"overflow-hidden",children:e.jsxs("div",{className:"flex flex-col lg:flex-row",children:[e.jsxs("div",{className:"lg:w-2/5 bg-linear-to-br from-white/5 to-white/10 p-6 border-r border-white/10",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"relative inline-block mb-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-linear-to-br from-primary/60 via-secondary/60 to-accent/60 p-1 shadow-2xl",children:e.jsx("div",{className:"w-full h-full rounded-full bg-white/10 backdrop-blur-md flex items-center justify-center overflow-hidden border border-white/20",children:a.profile_image_url?e.jsx("img",{src:a.profile_image_url,alt:a.name,className:"w-full h-full object-cover rounded-full"}):e.jsx("span",{className:"text-2xl font-bold text-white",children:((le=(ie=a.name)==null?void 0:ie.charAt(0))==null?void 0:le.toUpperCase())||"U"})})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-success/80 backdrop-blur-xs border-2 border-white/30 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"})})]}),e.jsx("h2",{className:"text-xl font-bold text-foreground mb-1",children:a.name}),e.jsx("p",{className:"text-sm text-default-500 mb-3",children:a.email})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white/5 backdrop-blur-xs rounded-lg p-3 border border-white/10 hover:bg-white/10 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/20 backdrop-blur-xs rounded-lg flex items-center justify-center border border-primary/30",children:e.jsx(Me,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-default-400 uppercase tracking-wide",children:"Department"}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:((ce=a.department)==null?void 0:ce.name)||"No Department"})]})]})}),e.jsx("div",{className:"bg-white/5 backdrop-blur-xs rounded-lg p-3 border border-white/10 hover:bg-white/10 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-secondary/20 backdrop-blur-xs rounded-lg flex items-center justify-center border border-secondary/30",children:e.jsx(Oe,{className:"w-5 h-5 text-secondary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-default-400 uppercase tracking-wide",children:"Member Since"}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:a.created_at?new Date(a.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown"})]})]})}),e.jsx("div",{className:"bg-white/5 backdrop-blur-xs rounded-lg p-3 border border-white/10 hover:bg-white/10 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-success/20 backdrop-blur-xs rounded-lg flex items-center justify-center border border-success/30",children:e.jsx(Pe,{className:"w-5 h-5 text-success"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-default-400 uppercase tracking-wide",children:"User ID"}),e.jsxs("p",{className:"text-sm font-medium text-foreground",children:["#",a.id]})]})]})}),e.jsxs("div",{className:"pt-4 border-t border-white/10",children:[e.jsx("p",{className:"text-xs text-default-400 uppercase tracking-wide mb-3",children:"Quick Actions"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{as:$e,href:route("profile",{user:a.id}),size:"sm",variant:"flat",className:"bg-primary/20 text-primary border-primary/30 hover:bg-primary/30 backdrop-blur-xs",startContent:e.jsx(G,{className:"w-4 h-4"}),children:"View Profile"}),e.jsx(f,{size:"sm",variant:"flat",className:"bg-secondary/20 text-secondary border-secondary/30 hover:bg-secondary/30 backdrop-blur-xs",startContent:e.jsx(he,{className:"w-4 h-4"}),children:"Export Data"})]})]})]})]}),e.jsxs("div",{className:"lg:w-3/5 p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Device Security Settings"}),e.jsx("p",{className:"text-sm text-default-400",children:"Manage device access restrictions and session controls"})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-xs rounded-xl p-5 border border-white/10 hover:bg-white/10 transition-colors mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/20 backdrop-blur-xs rounded-xl flex items-center justify-center border border-primary/30",children:e.jsx(Je,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground",children:"Single Device Login"}),e.jsx("p",{className:"text-xs text-default-400",children:"Restrict user to one active device"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:a.single_device_login,onChange:s=>{Ne(s.target.checked)},disabled:j.toggle}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-hidden peer-focus:ring-4 peer-focus:ring-opacity-30 rounded-full peer transition-all duration-300 ${a.single_device_login?"bg-green-500 peer-focus:ring-green-300":"bg-red-500 peer-focus:ring-red-300"} peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all`}),j.toggle&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg border border-white/10",children:[e.jsx("span",{className:"text-sm font-medium text-default-600",children:"Current Status:"}),e.jsx(O,{size:"sm",variant:"flat",className:`font-semibold backdrop-blur-xs ${a.single_device_login?a.active_device?"bg-warning/20 text-warning border-warning/30":"bg-success/20 text-success border-success/30":"bg-default/20 text-default-600 border-default/30"}`,startContent:a.single_device_login?a.active_device?e.jsx(Qe,{className:"w-3 h-3"}):e.jsx(Ge,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"}),children:a.single_device_login?a.active_device?"Device Locked":"Device Free":"Disabled"})]}),a.single_device_login&&a.active_device&&e.jsxs("div",{className:"bg-warning/10 backdrop-blur-xs border border-warning/20 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-warning/20 backdrop-blur-xs rounded-lg flex items-center justify-center shrink-0 border border-warning/30",children:(oe=a.active_device.device_name)!=null&&oe.toLowerCase().includes("mobile")?e.jsx(P,{className:"w-5 h-5 text-warning"}):e.jsx(ue,{className:"w-5 h-5 text-warning"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-semibold text-warning mb-1",children:"Active Device"}),e.jsx("p",{className:"text-sm text-warning/80 mb-2",children:a.active_device.device_name||"Unknown Device"}),a.active_device.last_seen_at&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-warning/70",children:[e.jsx(W,{className:"w-3 h-3"}),"Last seen: ",X(a.active_device.last_seen_at)]})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-warning/20",children:e.jsx(f,{size:"sm",variant:"flat",className:"bg-danger/20 text-danger border-danger/30 hover:bg-danger/30 backdrop-blur-xs",startContent:j.reset?e.jsx(B,{className:"w-4 h-4 animate-spin"}):e.jsx(B,{className:"w-4 h-4"}),isDisabled:j.reset,onClick:()=>ye(),children:j.reset?"Resetting...":"Reset Device Lock"})})]}),a.single_device_login&&!a.active_device&&e.jsx("div",{className:"bg-success/10 backdrop-blur-xs border border-success/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Y,{className:"w-8 h-8 text-success shrink-0"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-success mb-1",children:"Ready for Device Lock"}),e.jsx("p",{className:"text-sm text-success/80",children:"Single device login is enabled. The user's next login will lock their session to that device."})]})]})}),!a.single_device_login&&e.jsx("div",{className:"bg-primary/10 backdrop-blur-xs border border-primary/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ze,{className:"w-8 h-8 text-primary shrink-0"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-primary mb-1",children:"Multiple Device Access"}),e.jsx("p",{className:"text-sm text-primary/80",children:"User can log in from multiple devices simultaneously. Enable single device login for enhanced security."})]})]})})]})]})]})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(cs,{label:"Search Devices",variant:"bordered",placeholder:"Search by device name, IP, location...",value:l.search,onValueChange:s=>U("search",s),startContent:e.jsx(Ue,{className:"w-4 h-4"}),classNames:{input:"bg-transparent",inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},size:N?"sm":"md"})}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs(f,{isIconOnly:N,variant:"bordered",onPress:()=>be(!q),className:"bg-white/5 border-white/20",children:[e.jsx(Xe,{className:"w-4 h-4"}),!N&&e.jsx("span",{className:"ml-2",children:"Filters"})]}),e.jsx("div",{className:"hidden md:flex items-center gap-4 px-4 py-2 bg-white/5 rounded-lg border border-white/20",children:e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-default-500",children:"Showing: "}),e.jsx("span",{className:"font-medium text-foreground",children:y.length}),e.jsxs("span",{className:"text-default-500",children:[" / ",d.length]})]})})]})]}),q&&e.jsx(Be,{in:q,children:e.jsx("div",{className:"mb-6 p-4 bg-white/5 rounded-lg border border-white/10",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Status"}),e.jsxs(H,{children:[e.jsx(z,{children:e.jsx(f,{variant:"bordered",className:"w-full justify-between bg-white/5",children:l.status==="all"?"All Status":l.status==="active"?"Active Only":"Inactive Only"})}),e.jsxs(V,{selectedKeys:[l.status],onSelectionChange:s=>U("status",Array.from(s)[0]),children:[e.jsx(h,{children:"All Status"},"all"),e.jsx(h,{children:"Active Only"},"active"),e.jsx(h,{children:"Inactive Only"},"inactive")]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Device Type"}),e.jsxs(H,{children:[e.jsx(z,{children:e.jsx(f,{variant:"bordered",className:"w-full justify-between bg-white/5",children:l.type==="all"?"All Types":l.type==="mobile"?"Mobile Only":"Desktop Only"})}),e.jsxs(V,{selectedKeys:[l.type],onSelectionChange:s=>U("type",Array.from(s)[0]),children:[e.jsx(h,{children:"All Types"},"all"),e.jsx(h,{children:"Mobile Only"},"mobile"),e.jsx(h,{children:"Desktop Only"},"desktop")]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Activity"}),e.jsxs(H,{children:[e.jsx(z,{children:e.jsx(f,{variant:"bordered",className:"w-full justify-between bg-white/5",children:l.dateRange==="all"?"All Time":l.dateRange==="hour"?"Last Hour":l.dateRange==="day"?"Last 24 Hours":l.dateRange==="week"?"Last Week":"Last Month"})}),e.jsxs(V,{selectedKeys:[l.dateRange],onSelectionChange:s=>U("dateRange",Array.from(s)[0]),children:[e.jsx(h,{children:"All Time"},"all"),e.jsx(h,{children:"Last Hour"},"hour"),e.jsx(h,{children:"Last 24 Hours"},"day"),e.jsx(h,{children:"Last Week"},"week"),e.jsx(h,{children:"Last Month"},"month")]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(f,{variant:"flat",color:"primary",className:"w-full",onPress:()=>{ae({search:"",status:"all",type:"all",dateRange:"all"}),J(s=>({...s,currentPage:1}))},children:"Clear Filters"})})]})})}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(i,{variant:"h6",className:"font-semibold text-foreground",children:"Device History"}),e.jsxs(i,{variant:"caption",className:"text-default-500",children:[y.length," device",y.length!==1?"s":""," found",y.length!==d.length&&e.jsxs("span",{children:[" (filtered from ",d.length," total)"]})]})]}),p.total>0&&e.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[e.jsxs(O,{size:"sm",variant:"flat",color:"primary",children:[p.active," Active"]}),e.jsxs(O,{size:"sm",variant:"flat",color:"success",children:[p.online," Online"]})]})]})}),fe?e.jsx("div",{className:"flex justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ye,{size:40}),e.jsx(i,{className:"mt-4 text-default-500",children:"Loading device data..."})]})}):y.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(xe,{className:"w-12 h-12 text-default-300 mx-auto mb-4"}),e.jsx(i,{variant:"h6",className:"text-foreground mb-2",children:"No devices found"}),e.jsx(i,{variant:"body2",className:"text-default-500",children:d.length===0?`${a.name} has no device records yet`:"Try adjusting your search or filters"}),d.length===0&&e.jsx(i,{variant:"caption",className:"text-default-400 block mt-2",children:"Device records are created when users log in"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(os,{"aria-label":"Device history table",className:"w-full",classNames:{wrapper:"shadow-none bg-transparent",th:"bg-white/10 backdrop-blur-md text-default-600 border-b border-white/10",td:"border-b border-white/5"},children:[e.jsxs(ds,{children:[e.jsx(D,{children:"Device"}),e.jsx(D,{children:"Type"}),e.jsx(D,{children:"IP Address"}),e.jsx(D,{children:"Location"}),e.jsx(D,{children:"Status"}),e.jsx(D,{children:"Last Seen"}),e.jsx(D,{children:"Actions"})]}),e.jsx(ms,{children:_e.map(s=>e.jsxs(us,{className:"hover:bg-white/5 transition-colors",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"shrink-0",children:T(s.user_agent)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium text-sm text-foreground truncate",children:s.device_name||"Unknown Device"}),e.jsx("div",{className:"text-xs text-default-500 truncate max-w-48",title:s.user_agent,children:s.user_agent})]})]})}),e.jsx(S,{children:e.jsx(O,{size:"sm",variant:"flat",color:Z(s.user_agent)==="Mobile"?"secondary":"default",startContent:T(s.user_agent),children:Z(s.user_agent)})}),e.jsx(S,{children:e.jsx("span",{className:"text-sm font-mono text-foreground",children:s.ip_address})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(es,{className:"w-3 h-3 text-default-400 shrink-0"}),e.jsx("span",{className:"text-sm text-foreground truncate",children:s.location||"Unknown"})]})}),e.jsx(S,{children:e.jsx(O,{size:"sm",variant:"flat",color:Le(s),startContent:s.is_active?e.jsx(Y,{className:"w-3 h-3"}):e.jsx(ss,{className:"w-3 h-3"}),children:Ce(s)})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"w-3 h-3 text-default-400 shrink-0"}),e.jsx("span",{className:"text-sm text-foreground",children:X(s.last_seen_at)})]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[s.is_active&&e.jsx(hs,{content:"Force logout this device",children:e.jsx(f,{isIconOnly:!0,size:"sm",variant:"light",color:"danger",onPress:()=>Q(s.id),isDisabled:j[`logout_${s.id}`],className:"min-w-0 w-8 h-8",children:j[`logout_${s.id}`]?e.jsx("div",{className:"animate-spin",children:e.jsx(B,{className:"w-3 h-3"})}):e.jsx(G,{className:"w-3 h-3"})})}),e.jsxs(H,{children:[e.jsx(z,{children:e.jsx(f,{isIconOnly:!0,size:"sm",variant:"light",className:"min-w-0 w-8 h-8",children:e.jsx(ts,{className:"w-3 h-3"})})}),e.jsxs(V,{"aria-label":"Device Actions",children:[e.jsx(h,{description:"View detailed device information",startContent:e.jsx(rs,{className:"w-4 h-4"}),onPress:()=>Se(s),children:"Device Details"},"details"),s.is_active&&e.jsx(h,{description:"Force logout this device",startContent:e.jsx(G,{className:"w-4 h-4"}),color:"warning",onPress:()=>Q(s.id),children:"Force Logout"},"logout")]})]})]})})]},s.id))})]}),ne>1&&e.jsx("div",{className:"flex justify-center items-center p-4 border-t border-white/10",children:e.jsx(xs,{total:ne,page:F.currentPage,onChange:s=>J(t=>({...t,currentPage:s})),showControls:!0,showShadow:!0,color:"primary",size:N?"sm":"md",classNames:{wrapper:"gap-2",item:"bg-white/10 backdrop-blur-md",cursor:"bg-primary text-primary-foreground"}})})]})]})]})})})})}),e.jsxs(We,{open:ge,closeModal:I,maxWidth:"md",fullWidth:!0,children:[e.jsxs(as,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[o&&T(o.user_agent,"w-6 h-6"),e.jsxs("div",{children:[e.jsx(i,{variant:"h6",className:"font-semibold text-foreground",children:"Device Information"}),e.jsx(i,{variant:"body2",className:"text-default-500",children:(o==null?void 0:o.device_name)||"Unknown Device"})]})]}),e.jsx(Te,{onClick:I,sx:{position:"absolute",right:8,top:8,color:"text.secondary"},children:e.jsx(me,{className:"w-5 h-5"})})]}),e.jsx(ns,{dividers:!0,children:o&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(k,{variant:"glass",children:e.jsxs(A,{p:3,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/20 backdrop-blur-xs rounded-lg flex items-center justify-center border border-primary/30",children:T(o.user_agent,"w-5 h-5")}),e.jsxs("div",{children:[e.jsx(i,{variant:"subtitle1",className:"font-semibold text-foreground",children:"Device Type"}),e.jsx(i,{variant:"body2",className:"text-default-500",children:Z(o.user_agent)})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-default-400",children:"Browser:"}),e.jsx("span",{className:"text-foreground",children:ke(o.user_agent)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-default-400",children:"OS:"}),e.jsx("span",{className:"text-foreground",children:De(o.user_agent)})]})]})]})}),e.jsx(k,{variant:"glass",children:e.jsxs(A,{p:3,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-secondary/20 backdrop-blur-xs rounded-lg flex items-center justify-center border border-secondary/30",children:e.jsx(js,{className:"w-5 h-5 text-secondary"})}),e.jsxs("div",{children:[e.jsx(i,{variant:"subtitle1",className:"font-semibold text-foreground",children:"Connection"}),e.jsx(i,{variant:"body2",className:"text-default-500",children:"Network Information"})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-default-400",children:"IP Address:"}),e.jsx("span",{className:"text-foreground font-mono",children:o.ip_address})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-default-400",children:"Location:"}),e.jsx("span",{className:"text-foreground",children:o.location||"Unknown"})]})]})]})})]}),e.jsx(k,{variant:"glass",children:e.jsxs(A,{p:3,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-success/20 backdrop-blur-xs rounded-lg flex items-center justify-center border border-success/30",children:e.jsx(W,{className:"w-5 h-5 text-success"})}),e.jsxs("div",{children:[e.jsx(i,{variant:"subtitle1",className:"font-semibold text-foreground",children:"Activity Timeline"}),e.jsx(i,{variant:"body2",className:"text-default-500",children:"Session and usage information"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-white/5 rounded-lg border border-white/10",children:[e.jsx(i,{variant:"h6",className:"font-bold text-foreground",children:o.is_active?"Active":"Inactive"}),e.jsx(i,{variant:"caption",className:"text-default-400",children:"Current Status"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/5 rounded-lg border border-white/10",children:[e.jsx(i,{variant:"h6",className:"font-bold text-foreground",children:X(o.last_seen_at)}),e.jsx(i,{variant:"caption",className:"text-default-400",children:"Last Seen"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/5 rounded-lg border border-white/10",children:[e.jsx(i,{variant:"h6",className:"font-bold text-foreground",children:o.created_at?new Date(o.created_at).toLocaleDateString():"Unknown"}),e.jsx(i,{variant:"caption",className:"text-default-400",children:"First Login"})]})]})]})}),e.jsx(k,{variant:"glass",children:e.jsxs(A,{p:3,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-warning/20 backdrop-blur-xs rounded-lg flex items-center justify-center border border-warning/30",children:e.jsx(ls,{className:"w-5 h-5 text-warning"})}),e.jsxs("div",{children:[e.jsx(i,{variant:"subtitle1",className:"font-semibold text-foreground",children:"Technical Information"}),e.jsx(i,{variant:"body2",className:"text-default-500",children:"Detailed device specifications"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(i,{variant:"caption",className:"text-default-400 uppercase tracking-wide",children:"Device ID"}),e.jsx(i,{variant:"body2",className:"text-foreground font-mono mt-1 p-2 bg-white/5 rounded border border-white/10",children:o.id})]}),e.jsxs("div",{children:[e.jsx(i,{variant:"caption",className:"text-default-400 uppercase tracking-wide",children:"User Agent"}),e.jsx(i,{variant:"body2",className:"text-foreground break-all mt-1 p-2 bg-white/5 rounded border border-white/10",children:o.user_agent})]})]})]})}),o.is_active&&e.jsx(k,{variant:"glass",children:e.jsxs(A,{p:3,className:"bg-danger/10 backdrop-blur-xs border border-danger/20",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(xe,{className:"w-6 h-6 text-danger shrink-0"}),e.jsxs("div",{children:[e.jsx(i,{variant:"subtitle1",className:"font-semibold text-danger",children:"Security Actions"}),e.jsx(i,{variant:"body2",className:"text-danger/80",children:"Manage device access and security"})]})]}),e.jsx(f,{size:"sm",variant:"flat",className:"bg-danger/20 text-danger border-danger/30 hover:bg-danger/30 backdrop-blur-xs",startContent:e.jsx(G,{className:"w-4 h-4"}),onPress:()=>{Q(o.id),I()},isDisabled:j[`logout_${o.id}`],children:j[`logout_${o.id}`]?"Logging out...":"Force Logout Device"})]})})]})}),e.jsx(is,{children:e.jsx(f,{variant:"flat",onPress:I,className:"bg-default/20 text-default-700 border-default/30 hover:bg-default/30",children:"Close"})})]})]})};vs.layout=x=>e.jsx(Ie,{children:x});export{vs as default};
