import{J as Z,r as n,j as e,s as K,d as N,g as de,f as I,a as F,Q as ce}from"./app-DS9iZEKq.js";import{G as me}from"./GlassCard-CqENOh1t.js";import{P as ue}from"./PageHeader-CN2qPkVs.js";import{S as he}from"./StatsCards-BVahdC5I.js";import{J as z,B as pe,C as xe,D as fe,E as $,x as ge,G as je,s as be,m as we,k as ve,n as _e,o as ye,q as Ne,d as De,A as Pe,g as Ce}from"./App-nQmRcJSC.js";import"./dayjs.min-Dr2S9fhw.js";import{N as Se}from"./NoDataMessage-BYuHRJyO.js";import{F as U}from"./EyeIcon-BVwFmxSD.js";import{F as Y}from"./PencilIcon-rJDlxCgv.js";import{F as X}from"./TrashIcon-DELe9MKo.js";import{F as Ee}from"./EllipsisVerticalIcon-D1YwX2WD.js";import{F as ee}from"./CheckCircleIcon-DFd8y743.js";import{F as te}from"./XCircleIcon-Ci28ZKSL.js";import{t as Te,a as Fe,b as Me,c as Re}from"./chunk-F3UDT23P-WFnnz-uI.js";import{t as Ie,a as Ae}from"./chunk-YRZGWF2W-Cx5yjF8C.js";import{p as ke}from"./chunk-EAPQ7RWQ-g3LtTV2e.js";import{t as L,c as $e,B as D,a as Le}from"./react-toastify.esm-rpuZ5CTS.js";import{X as ze}from"./x-DFaF2Y7x.js";import{s as Be}from"./chunk-TQNYOUFX-DV6xdcTD.js";import{F as Oe}from"./ExclamationTriangleIcon-D-KgF480.js";import{F as Ge}from"./PlusIcon-ktWmcH2C.js";import{m as We}from"./proxy-CgsDR1tR.js";import{i as Ve}from"./chunk-SSA7SXE4-Bz5itbyi.js";import"./chunk-TLYTI3QM-pzFPAu9G.js";import"./EnvelopeIcon-DNqGig46.js";import"./UserIcon-Cs5a2oYq.js";import"./ShieldCheckIcon-CVd5Pmux.js";import"./KeyIcon-COxOQ1sk.js";import"./logo-Pwvcz7fP.js";import"./features-animation-DsbzML27.js";import"./create-visual-element-JcEUXaCD.js";import"./chunk-XJ2YRSUP-zrxGI-UH.js";import"./useToggleState-QCmg4yKE.js";import"./createLucideIcon-MydKmyJo.js";const He=({designations:d,onEdit:o,onDelete:P,onView:r,loading:c,isMobile:v,isTablet:m,pagination:a,onPageChange:C,onRowsPerPageChange:l,canEditDesignation:x=!1,canDeleteDesignation:j=!1})=>{var b,f;const{auth:i}=Z().props,u=x||((b=i.permissions)==null?void 0:b.includes("designations.update"))||!1,h=j||((f=i.permissions)==null?void 0:f.includes("designations.delete"))||!1,S=n.useMemo(()=>[{name:"TITLE",uid:"title"},{name:"DEPARTMENT",uid:"department_name"},{name:"EMPLOYEES",uid:"employee_count"},{name:"STATUS",uid:"status"},{name:"ACTIONS",uid:"actions"}],[]),E=(s,w)=>{switch(w){case"title":return e.jsx("span",{className:"font-semibold text-foreground",children:s.title});case"department_name":return e.jsx("span",{className:"text-default-500",children:s.department_name||"-"});case"employee_count":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:s.employee_count||0})]});case"status":return e.jsx($e,{size:"sm",variant:s.is_active?"solid":"bordered",color:s.is_active?"success":"danger",startContent:s.is_active?e.jsx(ee,{className:"w-3 h-3"}):e.jsx(te,{className:"w-3 h-3"}),children:s.is_active?"Active":"Inactive"});case"actions":return e.jsx("div",{className:"flex justify-end items-center",children:v?e.jsxs(pe,{children:[e.jsx(xe,{children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(Ee,{className:"w-4 h-4"})})}),e.jsxs(fe,{"aria-label":"Designation actions",children:[e.jsx($,{startContent:e.jsx(U,{className:"w-4 h-4"}),onPress:()=>r(s),children:"View Details"},"view"),u&&e.jsx($,{startContent:e.jsx(Y,{className:"w-4 h-4"}),onPress:()=>o(s),children:"Edit Designation"},"edit"),h&&e.jsx($,{className:"text-danger",color:"danger",startContent:e.jsx(X,{className:"w-4 h-4"}),isDisabled:s.employee_count>0,onPress:()=>P(s),children:"Delete Designation"},"delete")]})]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{content:"View Designation",children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>r(s),children:e.jsx(U,{className:"w-4 h-4"})})}),u&&e.jsx(L,{content:"Edit Designation",children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-blue-500",onPress:()=>o(s),children:e.jsx(Y,{className:"w-4 h-4"})})}),h&&e.jsx(L,{content:s.employee_count>0?"Cannot delete designation with employees":"Delete Designation",children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-danger",isDisabled:s.employee_count>0,onPress:()=>P(s),children:e.jsx(X,{className:"w-4 h-4"})})})]})});default:return e.jsx("span",{children:s[w]})}},g=()=>!d||!d.data||c?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(a.currentPage-1)*a.perPage+1," to ",Math.min(a.currentPage*a.perPage,d.total)," of ",d.total," designations"]}),e.jsx(ke,{total:Math.ceil(d.total/a.perPage),initialPage:a.currentPage,page:a.currentPage,onChange:C,size:v?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]});return!c&&(!d||!d.data||d.data.length===0)?e.jsx("div",{className:"w-full",children:e.jsx(Se,{message:"No designations found",icon:e.jsx(z,{className:"w-12 h-12 text-default-300"}),description:"Try adjusting your search or filters"})}):e.jsx("div",{className:"w-full",children:e.jsxs(Te,{"aria-label":"Designations table",removeWrapper:!0,classNames:{base:"bg-transparent",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs",td:"border-b border-white/5 py-3"},bottomContent:g(),children:[e.jsx(Ie,{columns:S,children:s=>e.jsx(Ae,{children:s.name},s.uid)}),e.jsx(Fe,{items:d.data||[],emptyContent:!c&&"No designations found",loadingContent:e.jsx(K,{}),isLoading:c,children:s=>e.jsx(Me,{children:w=>e.jsx(Re,{children:E(s,w)})},s.id)})]})})},Qe=({open:d,onClose:o,onSuccess:P,designation:r=null,departments:c=[]})=>{var E;const v=de(),m=useMediaQuery(v.breakpoints.down("md")),[a,C]=n.useState(!1),[l,x]=n.useState({}),j={title:"",department_id:"",is_active:!0},[i,u]=n.useState(j);n.useEffect(()=>{u(r?{title:r.title||"",department_id:r.department_id||"",is_active:r.is_active??!0}:j),x({})},[r,d]);const h=g=>{const{name:b,value:f,type:s,checked:w}=g.target;u(_=>({..._,[b]:s==="checkbox"?w:f})),l[b]&&x(_=>({..._,[b]:null}))},S=async()=>{var g,b;C(!0),x({});try{const f={...i};let s;r!=null&&r.id?(s=await F.put(`/designations/${r.id}`,f),D.success("Designation updated successfully")):(s=await F.post("/designations",f),D.success("Designation created successfully")),P(s.data.designation),o()}catch(f){if((b=(g=f.response)==null?void 0:g.data)!=null&&b.errors){x(f.response.data.errors);const s=Object.values(f.response.data.errors)[0];s&&D.error(s[0])}else D.error("An error occurred while saving the designation")}finally{C(!1)}};return e.jsxs(je,{open:d,onClose:a?void 0:o,maxWidth:"sm",fullWidth:!0,fullScreen:m,"aria-labelledby":"designation-form-dialog",children:[e.jsxs(DialogTitle,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(Typography,{variant:"h6",component:"div",children:r?"Edit Designation":"Create New Designation"}),e.jsx(IconButton,{edge:"end",color:"inherit",onClick:o,disabled:a,"aria-label":"close",children:e.jsx(ze,{className:"w-5 h-5"})})]}),e.jsx(I,{}),e.jsx(DialogContent,{sx:{pt:2},children:e.jsxs(Grid,{container:!0,spacing:3,children:[e.jsx(Grid,{item:!0,xs:12,children:e.jsx(Typography,{variant:"subtitle1",color:"primary",gutterBottom:!0,children:"Designation Information"})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(TextField,{name:"title",label:"Designation Title",fullWidth:!0,required:!0,value:i.title,onChange:h,error:!!l.title,helperText:((E=l.title)==null?void 0:E[0])||"",disabled:a})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,error:!!l.department_id,children:[e.jsx(InputLabel,{id:"department-label",children:"Department"}),e.jsxs(be,{labelId:"department-label",name:"department_id",value:i.department_id,onChange:h,label:"Department",disabled:a,children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"Select Department"})}),c.map(g=>e.jsx(MenuItem,{value:g.id,children:g.name},g.id))]}),l.department_id&&e.jsx(FormHelperText,{children:l.department_id[0]})]})}),e.jsxs(Grid,{item:!0,xs:12,children:[e.jsx(FormControlLabel,{control:e.jsx(Be,{checked:i.is_active,onChange:h,name:"is_active",color:"success",disabled:a}),label:"Designation is active"}),l.is_active&&e.jsx(FormHelperText,{error:!0,children:l.is_active[0]})]})]})}),e.jsx(I,{}),e.jsxs(DialogActions,{sx:{px:3,py:2},children:[e.jsx(N,{onClick:o,disabled:a,color:"inherit",children:"Cancel"}),e.jsx(N,{onClick:S,variant:"contained",color:"primary",disabled:a,children:a?"Saving...":r?"Update Designation":"Create Designation"})]})]})},qe=({open:d,onClose:o,onSuccess:P,designation:r})=>{const[c,v]=n.useState(!1),[m,a]=n.useState(null),C=async()=>{var l,x,j,i;if(r){v(!0),a(null);try{await F.delete(`/hr/designations/${r.id}`),D.success("Designation deleted successfully"),P(),o()}catch(u){if((x=(l=u.response)==null?void 0:l.data)!=null&&x.message)a(u.response.data.message),D.error(u.response.data.message);else if((i=(j=u.response)==null?void 0:j.data)!=null&&i.errors){const h=Object.values(u.response.data.errors)[0];a(h),D.error(h)}else a("An error occurred while deleting the designation"),D.error("An error occurred while deleting the designation")}finally{v(!1)}}};return r?e.jsx(we,{isOpen:d,onOpenChange:c?void 0:o,size:"lg",children:e.jsxs(ve,{children:[e.jsxs(_e,{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Delete Designation"}),e.jsx(N,{isIconOnly:!0,variant:"light",onPress:o,isDisabled:c,"aria-label":"close",children:e.jsx(Le,{className:"w-5 h-5"})})]}),e.jsx(I,{}),e.jsx(ye,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"w-8 h-8 text-yellow-500"}),e.jsxs("p",{className:"text-sm",children:["Are you sure you want to delete the designation ",e.jsx("strong",{children:r.title}),"?"]})]}),r.employee_count>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded",children:["This designation has ",r.employee_count," employees assigned to it. You cannot delete a designation with active employees. Please reassign these employees to other designations first."]}),m&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded",children:m}),e.jsx("p",{className:"text-sm text-default-500 mt-1",children:"This action cannot be undone. All associated data will be permanently removed."})]})}),e.jsx(I,{}),e.jsxs(Ne,{children:[e.jsx(N,{onPress:o,isDisabled:c,variant:"light",children:"Cancel"}),e.jsx(N,{onPress:C,color:"danger",isDisabled:c||r.employee_count>0,isLoading:c,children:c?"Deleting...":"Delete Designation"})]})]})}):null},St=({title:d,initialDesignations:o,departments:P,managers:r,parentDesignations:c,stats:v,filters:m})=>{var Q,q,J;const{auth:a}=Z().props,[C,l]=n.useState(o||{data:[]}),[x,j]=n.useState(!1),[i,u]=n.useState({type:null,designation:null}),[h,S]=n.useState({search:(m==null?void 0:m.search)||"",status:(m==null?void 0:m.status)||"all",parentDesignation:(m==null?void 0:m.parentDesignation)||"all"}),[E,g]=n.useState(!1),[b,f]=n.useState("table"),[s,w]=n.useState({currentPage:(o==null?void 0:o.current_page)||1,perPage:(o==null?void 0:o.per_page)||10}),[_,se]=n.useState(v||{total:0,active:0,inactive:0,parent_designations:0}),[B,ae]=n.useState(window.innerWidth<768);n.useEffect(()=>{const t=()=>ae(window.innerWidth<768);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const O=((Q=a.permissions)==null?void 0:Q.includes("designations.create"))||!1,G=((q=a.permissions)==null?void 0:q.includes("designations.update"))||!1,W=((J=a.permissions)==null?void 0:J.includes("designations.delete"))||!1,A=n.useCallback(async()=>{j(!0);try{const t=await F.get(route("designations.json"),{params:{page:s.currentPage,per_page:s.perPage,search:h.search,status:h.status,parent_designation:h.parentDesignation}});l(t.data.designations||t.data)}catch(t){console.error("Error fetching designations:",t),D.error("Failed to load designations data")}finally{j(!1)}},[s,h]),k=n.useCallback(async()=>{try{const t=await F.get(route("designations.stats"));t.status===200&&se(t.data.stats)}catch(t){console.error("Error fetching designation stats:",t)}},[]);n.useEffect(()=>{A(),k()},[A,k]);const re=(t,y)=>{S(p=>({...p,[t]:y})),w(p=>({...p,currentPage:1}))},ne=t=>{w(y=>({...y,currentPage:t})),window.scrollTo({top:0,behavior:"smooth"})},oe=t=>{w({currentPage:1,perPage:t})},M=(t,y=null)=>{u({type:t,designation:y})},V=()=>{u({type:null,designation:null})},H=(t=null,y=null)=>{y==="add"&&t?l(p=>{const T=[t,...p.data];return{...p,data:T,total:(p.total||0)+1}}):y==="edit"&&t?l(p=>{const T=p.data.map(R=>R.id===t.id?t:R);return{...p,data:T}}):y==="delete"&&t?l(p=>{const T=p.data.filter(R=>R.id!==t.id);return{...p,data:T,total:(p.total||1)-1}}):(A(),k())},le=n.useMemo(()=>[{title:"Total Designations",value:_.total,icon:e.jsx(z,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All designations"},{title:"Active",value:_.active,icon:e.jsx(ee,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Active designations"},{title:"Inactive",value:_.inactive,icon:e.jsx(te,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Inactive designations"},{title:"Parent Designations",value:_.parent_designations,icon:e.jsx(De,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Top-level designations"}],[_]),ie=n.useMemo(()=>{const t=[];return O&&t.push({label:B?"Add":"Add Designation",icon:e.jsx(Ge,{className:"w-4 h-4"}),onPress:()=>M("add_designation"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),t},[O,B]);return e.jsxs(Pe,{children:[e.jsx(ce,{title:d}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(We.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:e.jsx(me,{children:e.jsx(ue,{title:"Designation Management",subtitle:"Manage company designations and hierarchy",icon:e.jsx(z,{className:"w-8 h-8"}),variant:"default",actionButtons:ie,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(he,{stats:le,className:"mb-6"}),e.jsx("div",{className:"mb-6",children:e.jsx(Ve,{label:"Search",placeholder:"Search designations...",value:h.search,onValueChange:t=>re("search",t),startContent:e.jsx(Ce,{className:"w-4 h-4 text-default-400"}),variant:"bordered",classNames:{base:"w-full",input:"bg-transparent",inputWrapper:["backdrop-blur-xl","backdrop-saturate-200","bg-white/10","border","border-white/20","hover:bg-white/20","focus-within:!bg-white/20","!cursor-text"]}})}),e.jsx("div",{children:x?e.jsxs("div",{className:"text-center py-6",children:[e.jsx(K,{size:"lg"}),e.jsx("p",{className:"mt-4 text-default-500",children:"Loading..."})]}):e.jsx(He,{designations:C,loading:x,onEdit:G?t=>M("edit_designation",t):void 0,onDelete:W?t=>M("delete_designation",t):void 0,onView:t=>M("view_designation",t),pagination:s,onPageChange:ne,onRowsPerPageChange:oe,canEditDesignation:G,canDeleteDesignation:W})})]})})})})}),(i.type==="add_designation"||i.type==="edit_designation")&&e.jsx(Qe,{open:!0,departments:P,onClose:V,onSuccess:t=>H(t,i.type==="add_designation"?"add":"edit"),designation:i.designation,managers:r,parentDesignations:c}),i.type==="delete_designation"&&e.jsx(qe,{open:!0,onClose:V,onSuccess:t=>H(t,"delete"),designation:i.designation})]})};export{St as default};
