import{J as re,r as i,j as e,s as ne,b as R,e as A,Q as ye}from"./app-2c7u7EvZ.js";import{G as be}from"./GlassCard-DJHboOiP.js";import{P as je}from"./PageHeader-DWmJCwc5.js";import{S as _e}from"./StatsCards-GckFiXHe.js";import{J as W,d as we,a as Ne,b as Fe,m as Z,E as Se,c as oe,e as le,f as ie,g as de,A as Ce}from"./Dashboard-ut-uTYa1.js";import"./dayjs.min-CL0Q_Aa-.js";import{N as De,B as Pe}from"./NoDataMessage-FhYVBCuM.js";import{F as ee}from"./PencilIcon-DDDpFkFq.js";import{F as T}from"./TrashIcon-DwHhiRbj.js";import{F as Ie}from"./EllipsisVerticalIcon-BpkoZ2Uz.js";import{F as ce}from"./CheckCircleIcon-BK5yRv8r.js";import{F as me}from"./XCircleIcon-CqbL1tWl.js";import{t as Ee,a as Re,b as ke,c as Ae}from"./chunk-F3UDT23P-dWfslj-A.js";import{t as ze,a as Me}from"./chunk-YRZGWF2W-CVnTuOqD.js";import{p as Te}from"./chunk-EAPQ7RWQ-D21rBybJ.js";import{t as te}from"./XMarkIcon-Cv9cS_ra.js";import{c as ae}from"./chunk-IHOGUXIG-C9esasSB.js";import{s as B}from"./toastUtils-9mT78FF5.js";import{B as se}from"./briefcase-N23c85rn.js";import{i as H}from"./chunk-SSA7SXE4-CYs09r68.js";import{s as L,l as E}from"./chunk-Y2AYO5NJ-BOC3jhcU.js";import{s as Be}from"./chunk-TQNYOUFX-Gz7swghj.js";import{m as ue}from"./chunk-O5MCAK4F-ok9r27sp.js";import{F as Le}from"./ExclamationTriangleIcon-0OwFYDN5.js";import{F as $e}from"./UserGroupIcon-DKyx_-H9.js";import{F as Oe}from"./PlusIcon-BbebGUZi.js";import{m as Ve}from"./proxy--RyoqgPN.js";import{F as We}from"./MagnifyingGlassIcon-B0trLquL.js";import"./chunk-D5XJWRAV-CqAxdy3X.js";import"./chunk-TLYTI3QM-BbQtNAl7.js";import"./EnvelopeIcon-CFXOPER_.js";import"./MapPinIcon-BxpL7FKX.js";import"./ClockIcon-DrPRI1xR.js";import"./UserIcon-DpR6Yxvw.js";import"./ShieldCheckIcon-Bn1mNc_N.js";import"./KeyIcon-CXuJ5V_o.js";import"./index-BzR0Ydkt.js";import"./logo-Pwvcz7fP.js";import"./features-animation-CjaMVz5S.js";import"./create-visual-element-DqSzzSQU.js";import"./createLucideIcon-Dekl8mjq.js";import"./chunk-XJ2YRSUP-DLGgeZNc.js";import"./useToggleState-BrFcryJF.js";const He=({designations:v,onEdit:x,onDelete:b,onView:n,loading:y,isMobile:j,isTablet:_,pagination:l,onPageChange:C,onRowsPerPageChange:m,canEditDesignation:d=!1,canDeleteDesignation:N=!1})=>{var g,a;const{auth:o}=re().props,h=d||((g=o.permissions)==null?void 0:g.includes("designations.update"))||!1,w=N||((a=o.permissions)==null?void 0:a.includes("designations.delete"))||!1,F=i.useMemo(()=>[{name:"TITLE",uid:"title"},{name:"DEPARTMENT",uid:"department_name"},{name:"HIERARCHY",uid:"hierarchy_level"},{name:"EMPLOYEES",uid:"employee_count"},{name:"STATUS",uid:"status"},{name:"ACTIONS",uid:"actions"}],[]),f=(s,u)=>{switch(u){case"title":return e.jsx("span",{className:"font-semibold text-foreground",children:s.title});case"department_name":return e.jsx("span",{className:"text-default-500",children:s.department_name||"-"});case"hierarchy_level":const r={1:"primary",2:"secondary",3:"success",4:"warning",5:"danger"},D=s.hierarchy_level||1,P=D<=5?D:"default";return e.jsxs(ae,{size:"sm",variant:"flat",color:r[P]||"default",startContent:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),children:["Level ",D]});case"employee_count":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:s.employee_count||0})]});case"status":return e.jsx(ae,{size:"sm",variant:s.is_active?"solid":"bordered",color:s.is_active?"success":"danger",startContent:s.is_active?e.jsx(ce,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"}),children:s.is_active?"Active":"Inactive"});case"actions":return e.jsx("div",{className:"flex justify-end items-center",children:j?e.jsxs(we,{children:[e.jsx(Ne,{children:e.jsx(R,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(Ie,{className:"w-4 h-4"})})}),e.jsxs(Fe,{"aria-label":"Designation actions",children:[h&&e.jsx(Z,{startContent:e.jsx(ee,{className:"w-4 h-4"}),onPress:()=>x(s),children:"Edit Designation"},"edit"),w&&e.jsx(Z,{className:"text-danger",color:"danger",startContent:e.jsx(T,{className:"w-4 h-4"}),isDisabled:s.employee_count>0,onPress:()=>b(s),children:"Delete Designation"},"delete")]})]}):e.jsxs(e.Fragment,{children:[h&&e.jsx(te,{content:"Edit Designation",children:e.jsx(R,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-blue-500",onPress:()=>x(s),children:e.jsx(ee,{className:"w-4 h-4"})})}),w&&e.jsx(te,{content:s.employee_count>0?"Cannot delete designation with employees":"Delete Designation",children:e.jsx(R,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-danger",isDisabled:s.employee_count>0,onPress:()=>b(s),children:e.jsx(T,{className:"w-4 h-4"})})})]})});default:return e.jsx("span",{children:s[u]})}},c=()=>!v||!v.data||y?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(l.currentPage-1)*l.perPage+1," to ",Math.min(l.currentPage*l.perPage,v.total)," of ",v.total," designations"]}),e.jsx(Te,{total:Math.ceil(v.total/l.perPage),initialPage:l.currentPage,page:l.currentPage,onChange:C,size:j?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]});return!y&&(!v||!v.data||v.data.length===0)?e.jsx("div",{className:"w-full",children:e.jsx(De,{message:"No designations found",icon:e.jsx(W,{className:"w-12 h-12 text-default-300"}),description:"Try adjusting your search or filters"})}):e.jsx("div",{className:"w-full",children:e.jsxs(Ee,{"aria-label":"Designations table",removeWrapper:!0,classNames:{base:"bg-transparent",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs",td:"border-b border-white/5 py-3"},bottomContent:c(),children:[e.jsx(ze,{columns:F,children:s=>e.jsx(Me,{children:s.name},s.uid)}),e.jsx(Re,{items:v.data||[],emptyContent:!y&&"No designations found",loadingContent:e.jsx(ne,{}),isLoading:y,children:s=>e.jsx(ke,{children:u=>e.jsx(Ae,{children:f(s,u)})},s.id)})]})})},qe=({open:v,onClose:x,onSuccess:b,designation:n=null,departments:y=[],designations:j=[]})=>{const _=()=>{var s;if(typeof window>"u")return"lg";const g=((s=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:s.trim())||"12px",a=parseInt(g);return a===0?"none":a<=4?"sm":a<=8?"md":a<=16?"lg":"full"},[l,C]=i.useState(!1),[m,d]=i.useState({}),N={title:"",department_id:"",hierarchy_level:1,parent_id:"",is_active:!0},[o,h]=i.useState(N);i.useEffect(()=>{h(n?{title:n.title||"",department_id:n.department_id||"",hierarchy_level:n.hierarchy_level||1,parent_id:n.parent_id||"",is_active:n.is_active??!0}:N),d({})},[n,v]);const w=(j==null?void 0:j.filter(c=>!(n!=null&&n.id&&c.id===n.id||o.department_id&&c.department_id!==parseInt(o.department_id)||o.hierarchy_level&&c.hierarchy_level>=o.hierarchy_level)))||[],F=(c,g)=>{h(a=>({...a,[c]:g})),m[c]&&d(a=>({...a,[c]:null})),c==="department_id"&&g!==o.department_id&&h(a=>({...a,parent_id:""})),c==="hierarchy_level"&&g===1&&h(a=>({...a,parent_id:""}))},f=async c=>{c.preventDefault(),C(!0),d({});const g=new Promise(async(a,s)=>{try{const u={...o,parent_id:o.hierarchy_level===1?null:o.parent_id||null};let r;n!=null&&n.id?(r=await A.put(`/designations/${n.id}`,u),a([r.data.message||"Designation updated successfully"])):(r=await A.post("/designations",u),a([r.data.message||"Designation created successfully"])),b(r.data.designation),x()}catch(u){if(console.error("Full error object:",u),u.response)if(u.response.status===422){d(u.response.data.errors||{});const r=Object.values(u.response.data.errors||{}).flat();s(r.length>0?r.join(", "):"Validation failed")}else s(`HTTP Error ${u.response.status}: ${u.response.data.message||"An unexpected error occurred"}`);else u.request?s("No response received from the server. Please check your internet connection."):s("An error occurred while setting up the request.")}finally{C(!1)}});B.promise(g,{pending:`${n?"Updating":"Creating"} designation...`,success:{render({data:a}){return a.join(", ")}},error:{render({data:a}){return a}}})};return e.jsx(oe,{isOpen:v,onClose:l?void 0:x,size:"2xl",radius:_(),scrollBehavior:"inside",classNames:{base:"backdrop-blur-md mx-2 my-2 sm:mx-4 sm:my-8 max-h-[95vh]",backdrop:"bg-black/50 backdrop-blur-sm",header:"border-b border-divider",body:"overflow-y-auto",footer:"border-t border-divider",closeButton:"hover:bg-white/5 active:bg-white/10"},style:{border:"var(--borderWidth, 2px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))"},children:e.jsx(le,{children:c=>{var g,a,s,u;return e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"flex flex-col gap-1",style:{borderColor:"var(--theme-divider, #E4E4E7)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{size:20,style:{color:"var(--theme-primary)"}}),e.jsx("span",{className:"text-lg font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:n?"Edit Designation":"Create New Designation"})]})}),e.jsxs("form",{onSubmit:f,children:[e.jsx(de,{className:"py-4 px-4 sm:py-6 sm:px-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(H,{label:"Designation Title",placeholder:"Enter designation title",value:o.title,onChange:r=>F("title",r.target.value),isInvalid:!!m.title,errorMessage:(g=m.title)==null?void 0:g[0],isRequired:!0,variant:"bordered",size:"sm",radius:_(),startContent:e.jsx(se,{size:16,className:"text-default-400"}),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx(L,{label:"Department",placeholder:"Select Department",selectedKeys:o.department_id?new Set([String(o.department_id)]):new Set,onSelectionChange:r=>{const D=Array.from(r)[0];F("department_id",D||"")},isInvalid:!!m.department_id,errorMessage:(a=m.department_id)==null?void 0:a[0],isRequired:!0,variant:"bordered",size:"sm",radius:_(),startContent:e.jsx(Pe,{size:16,className:"text-default-400"}),classNames:{trigger:"min-h-unit-10",value:"text-small"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:y==null?void 0:y.map(r=>e.jsx(E,{value:r.id,children:r.name},r.id))})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx(H,{type:"number",label:"Hierarchy Level",placeholder:"Enter hierarchy level",value:String(o.hierarchy_level),onChange:r=>F("hierarchy_level",parseInt(r.target.value)||1),isInvalid:!!m.hierarchy_level,errorMessage:(s=m.hierarchy_level)==null?void 0:s[0],min:1,max:10,isRequired:!0,variant:"bordered",size:"sm",radius:_(),description:"1 = Highest (CEO/Director), 2 = Manager, 3+ = Staff levels",classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),o.hierarchy_level>1&&e.jsx("div",{className:"col-span-2",children:e.jsx(L,{label:"Parent Designation (Optional)",placeholder:o.department_id?w.length===0?"No higher-level designations available":"Select parent designation":"Select department first",selectedKeys:o.parent_id?new Set([String(o.parent_id)]):new Set,onSelectionChange:r=>{const D=Array.from(r)[0];F("parent_id",D||"")},isInvalid:!!m.parent_id,errorMessage:(u=m.parent_id)==null?void 0:u[0],isDisabled:!o.department_id||w.length===0,variant:"bordered",size:"sm",radius:_(),description:"Parent must be a higher-level designation in the same department",classNames:{trigger:"min-h-unit-10",value:"text-small"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:w==null?void 0:w.map(r=>e.jsxs(E,{value:r.id,children:[r.title," (Level ",r.hierarchy_level,")"]},String(r.id)))})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:"color-mix(in srgb, var(--theme-content2) 30%, transparent)"},children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Active Status"}),e.jsx("p",{className:"text-xs text-default-500 mt-1",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Active designations can be assigned to employees"})]}),e.jsx(Be,{isSelected:o.is_active,onValueChange:r=>F("is_active",r),color:o.is_active?"success":"default",size:"sm"})]})})]})}),e.jsxs(ue,{className:"flex justify-between px-4 sm:px-6 py-3 sm:py-4",style:{borderColor:"var(--theme-divider, #E4E4E7)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(R,{variant:"light",onPress:c,isDisabled:l,radius:_(),style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(R,{type:"submit",variant:"solid",color:"primary",isLoading:l,isDisabled:l,radius:_(),style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:n?"Update Designation":"Create Designation"})]})]})]})}})})},Ke=({open:v,onClose:x,onSuccess:b,designation:n})=>{const[y,j]=i.useState(!1),_=()=>{var N;if(typeof window>"u")return"lg";const m=((N=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:N.trim())||"12px",d=parseInt(m);return d===0?"none":d<=4?"sm":d<=8?"md":d<=16?"lg":"full"},l=async()=>{if(!n){B.error("Invalid designation provided");return}j(!0);const C=new Promise(async(m,d)=>{var N,o,h,w,F,f,c,g;try{const a=await A.delete(`/designations/${n.id}`);a.status===200&&(b&&b(n,"delete"),m(a.data.message||"Designation deleted successfully"))}catch(a){console.error("Error deleting designation:",a),((N=a.response)==null?void 0:N.status)===400||((o=a.response)==null?void 0:o.status)===422?d(((w=(h=a.response)==null?void 0:h.data)==null?void 0:w.error)||((f=(F=a.response)==null?void 0:F.data)==null?void 0:f.message)||"Cannot delete designation with assigned employees"):((c=a.response)==null?void 0:c.status)===404?d("Designation not found or already deleted"):((g=a.response)==null?void 0:g.status)===403?d("You do not have permission to delete this designation"):d("An error occurred while deleting the designation")}finally{j(!1)}});B.promise(C,{pending:{render(){return"Deleting designation..."},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},success:{render({data:m}){return x(),m},icon:"✅",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},error:{render({data:m}){return m},icon:"❌",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}}})};return n?e.jsx(oe,{isOpen:v,onOpenChange:y?void 0:x,size:"lg",radius:_(),classNames:{base:"bg-content1",backdrop:"bg-black/50 backdrop-blur-sm"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(le,{children:[e.jsxs(ie,{className:"flex gap-3 items-center",style:{fontFamily:'var(--fontFamily, "Inter")',borderBottom:"1px solid var(--theme-divider)"},children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-danger) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(T,{className:"w-5 h-5",style:{color:"var(--theme-danger)"}})}),e.jsx("span",{className:"text-lg font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Delete Designation"})]}),e.jsx(de,{className:"py-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-warning) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-warning) 30%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:[e.jsx(Le,{className:"w-6 h-6 flex-shrink-0",style:{color:"var(--theme-warning)"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Are you sure you want to delete this designation?"}),e.jsx("p",{className:"text-sm font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")',color:"var(--theme-primary)"},children:n.title})]})]}),n.employee_count>0&&e.jsx("div",{className:"p-4 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-danger) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-danger) 30%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsxs("p",{className:"text-sm",style:{fontFamily:'var(--fontFamily, "Inter")',color:"var(--theme-danger)"},children:["This designation has ",e.jsx("strong",{children:n.employee_count})," employees assigned to it. You cannot delete a designation with active employees. Please reassign these employees to other designations first."]})}),e.jsx("p",{className:"text-sm text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"This action cannot be undone. All associated data will be permanently removed."})]})}),e.jsxs(ue,{style:{borderTop:"1px solid var(--theme-divider)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(R,{onPress:x,isDisabled:y,variant:"light",radius:_(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(R,{onPress:l,color:"danger",isDisabled:y||n.employee_count>0,isLoading:y,radius:_(),startContent:!y&&e.jsx(T,{className:"w-4 h-4"}),style:{fontFamily:'var(--fontFamily, "Inter")'},children:y?"Deleting...":"Delete Designation"})]})]})}):null},Mt=({title:v,initialDesignations:x,departments:b,managers:n,parentDesignations:y,allDesignations:j,stats:_,filters:l})=>{var J,Q,X;const{auth:C}=re().props,[m,d]=i.useState(x||{data:[]}),[N,o]=i.useState(!1),[h,w]=i.useState({type:null,designation:null}),F=i.useMemo(()=>{if(!b||b.length===0)return"all";const t={};j==null||j.forEach(p=>{p.department_id&&(t[p.department_id]=(t[p.department_id]||0)+1)});const S=Object.entries(t).sort((p,I)=>I[1]-p[1])[0];return S?String(S[0]):"all"},[b,j]),[f,c]=i.useState({search:(l==null?void 0:l.search)||"",status:(l==null?void 0:l.status)||"all",department:(l==null?void 0:l.department)||F,parentDesignation:(l==null?void 0:l.parentDesignation)||"all"}),[g,a]=i.useState(!1),[s,u]=i.useState("table"),[r,D]=i.useState({currentPage:(x==null?void 0:x.current_page)||1,perPage:(x==null?void 0:x.per_page)||10}),[P,pe]=i.useState(_||{total:0,active:0,inactive:0,parent_designations:0}),[k,he]=i.useState(window.innerWidth<768);i.useEffect(()=>{const t=()=>he(window.innerWidth<768);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const q=((J=C.permissions)==null?void 0:J.includes("designations.create"))||!1,K=((Q=C.permissions)==null?void 0:Q.includes("designations.update"))||!1,Y=((X=C.permissions)==null?void 0:X.includes("designations.delete"))||!1,$=i.useCallback(async()=>{o(!0);try{const t=await A.get(route("designations.json"),{params:{page:r.currentPage,per_page:r.perPage,search:f.search,status:f.status,department:f.department!=="all"?f.department:void 0,parent_designation:f.parentDesignation}});d(t.data.designations||t.data)}catch(t){console.error("Error fetching designations:",t),B.error("Failed to load designations data")}finally{o(!1)}},[r,f]),O=i.useCallback(async()=>{try{const t=await A.get(route("designations.stats"));t.status===200&&pe(t.data.stats)}catch(t){console.error("Error fetching designation stats:",t)}},[]);i.useEffect(()=>{$(),O()},[$,O]);const V=(t,S)=>{c(p=>({...p,[t]:S})),D(p=>({...p,currentPage:1}))},fe=t=>{D(S=>({...S,currentPage:t})),window.scrollTo({top:0,behavior:"smooth"})},xe=t=>{D({currentPage:1,perPage:t})},z=(t,S=null)=>{w({type:t,designation:S})},U=()=>{w({type:null,designation:null})},G=(t=null,S=null)=>{S==="add"&&t?d(p=>{const I=[t,...p.data];return{...p,data:I,total:(p.total||0)+1}}):S==="edit"&&t?d(p=>{const I=p.data.map(M=>M.id===t.id?t:M);return{...p,data:I}}):S==="delete"&&t?d(p=>{const I=p.data.filter(M=>M.id!==t.id);return{...p,data:I,total:(p.total||1)-1}}):($(),O())},ge=i.useMemo(()=>[{title:"Total Designations",value:P.total,icon:e.jsx(W,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All designations"},{title:"Active",value:P.active,icon:e.jsx(ce,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Active designations"},{title:"Inactive",value:P.inactive,icon:e.jsx(me,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Inactive designations"},{title:"Parent Designations",value:P.parent_designations,icon:e.jsx($e,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Top-level designations"}],[P]),ve=i.useMemo(()=>{const t=[];return q&&t.push({label:k?"Add":"Add Designation",icon:e.jsx(Oe,{className:"w-4 h-4"}),onPress:()=>z("add_designation"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),t},[q,k]);return e.jsxs(Ce,{children:[e.jsx(ye,{title:v}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(Ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:e.jsx(be,{children:e.jsx(je,{title:"Designation Management",subtitle:"Manage company designations and hierarchy",icon:e.jsx(W,{className:"w-8 h-8"}),variant:"default",actionButtons:ve,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(_e,{stats:ge,className:"mb-6"}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(H,{label:"Search Designations",placeholder:"Search by title...",value:f.search,onValueChange:t=>V("search",t),startContent:e.jsx(We,{className:"w-4 h-4 text-default-400"}),variant:"bordered",size:k?"sm":"md",classNames:{base:"w-full",input:"bg-transparent",inputWrapper:"border-default-200 hover:border-default-300"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(L,{label:"Department",selectedKeys:f.department?[f.department]:[],onSelectionChange:t=>V("department",Array.from(t)[0]),variant:"bordered",size:k?"sm":"md",className:"w-48",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(E,{children:"All Departments"},"all"),b==null?void 0:b.map(t=>e.jsx(E,{children:t.name},String(t.id)))]}),e.jsxs(L,{label:"Status",selectedKeys:f.status?[f.status]:[],onSelectionChange:t=>V("status",Array.from(t)[0]),variant:"bordered",size:k?"sm":"md",className:"w-32",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(E,{children:"All Status"},"all"),e.jsx(E,{children:"Active"},"active"),e.jsx(E,{children:"Inactive"},"inactive")]})]})]}),e.jsx("div",{children:N?e.jsxs("div",{className:"text-center py-6",children:[e.jsx(ne,{size:"lg"}),e.jsx("p",{className:"mt-4 text-default-500",children:"Loading..."})]}):e.jsx(He,{designations:m,loading:N,onEdit:K?t=>z("edit_designation",t):void 0,onDelete:Y?t=>z("delete_designation",t):void 0,onView:t=>z("view_designation",t),pagination:r,onPageChange:fe,onRowsPerPageChange:xe,canEditDesignation:K,canDeleteDesignation:Y})})]})})})})}),(h.type==="add_designation"||h.type==="edit_designation")&&e.jsx(qe,{open:!0,departments:b,designations:j,onClose:U,onSuccess:t=>G(t,h.type==="add_designation"?"add":"edit"),designation:h.designation}),h.type==="delete_designation"&&e.jsx(Ke,{open:!0,onClose:U,onSuccess:t=>G(t,"delete"),designation:h.designation})]})};export{Mt as default};
