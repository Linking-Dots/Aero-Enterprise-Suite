import{J as ca,r as i,a as K,j as e,Q as ma,c as M,b as V,d as p,F as _e}from"./app-CYJJYj_G.js";import{A as ua,c as fa,e as Ce,g as pa,t as xa,h as ke,F as ha,i as ya,k as _,m as ee,n as ae,o as te,p as se}from"./App-By70QgC6.js";import{B as y,F as ga,c as W,t as ne,a as Ie}from"./react-toastify.esm-DbDVqxB9.js";import{L as j,M as Se,T as Pe,u as ze,a as Le}from"./leaflet-fwcwEnue.js";import"./leaflet-routing-machine-DVgTQwAU.js";import{m as va}from"./proxy-ZxPCHiG8.js";import{F as ba}from"./CheckCircleIcon-DhI0uoNx.js";import{F as ja}from"./XCircleIcon-D-sJOJzy.js";import{F as wa}from"./PencilIcon-D8clUcHf.js";import{F as Re}from"./PlusIcon-DqBI9d6Y.js";import{M as Me}from"./Marker-CGXGMv06.js";import{F as Ae}from"./TrashIcon-DI1gV98r.js";import{u as le}from"./index-BT2tN3hg.js";import{i as x}from"./chunk-SSA7SXE4-zXXButdJ.js";import{c as oe}from"./chunk-XJ2YRSUP-BcwRZnyp.js";import{t as Fa,a as Na,b as _a,c as re}from"./chunk-F3UDT23P-B_7xyp3H.js";import{t as Ca,a as ie}from"./chunk-YRZGWF2W-DLqgRlqD.js";import{t as ka}from"./chunk-QESP63UR-lNZMnEoa.js";import{s as Ia}from"./chunk-TQNYOUFX-CXWf9wMI.js";import{m as de}from"./chunk-O5MCAK4F-YJLh4mYq.js";import"./EnvelopeIcon-BhzoUnmu.js";import"./UserIcon-J9rWPhKY.js";import"./ShieldCheckIcon-27RFwm3O.js";import"./KeyIcon-Ih9mQfvZ.js";import"./logo-CRQuu9GD.js";import"./features-animation-DZftqGkW.js";import"./create-visual-element-uE2hcwFC.js";import"./CheckCircleIcon-CB27TTnf.js";import"./ExclamationTriangleIcon-kh5LKRlc.js";import"./useToggleState-DOM68Zzm.js";delete j.Icon.Default.prototype._getIconUrl;j.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const Sa=({onLocationSelect:g,isAddingWaypoint:c})=>(Le({click(v){if(c){const{lat:r,lng:w}=v.latlng;g({lat:r.toFixed(6),lng:w.toFixed(6)})}}}),null),Pa=({onLocationSelect:g,isAddingPoint:c})=>(Le({click(v){if(c){const{lat:r,lng:w}=v.latlng;g({lat:r.toFixed(6),lng:w.toFixed(6)})}}}),null),Ra=({waypoints:g})=>{const c=ze();return i.useEffect(()=>{if(!c||g.length<2)return;c.eachLayer(r=>{r.options&&(r.options.isRoute||r.options.isRoutingControl)&&c.removeLayer(r)}),c.getContainer().querySelectorAll(".leaflet-routing-container").forEach(r=>r.remove());const v=g.filter(r=>r.lat&&r.lng);if(v.length>=2){const r=v.map(C=>j.latLng(parseFloat(C.lat),parseFloat(C.lng))),w=j.Routing.control({waypoints:r,routeWhileDragging:!1,addWaypoints:!1,createMarker:()=>null,lineOptions:{styles:[{color:"var(--theme-primary, #3b82f6)",weight:4,opacity:.8,dashArray:"8, 4"}]},show:!1,fitSelectedRoutes:!1,router:j.Routing.osrmv1({serviceUrl:"https://router.project-osrm.org/route/v1"})}).addTo(c);w.on("routesfound",function(C){const A=C.routes,o=A[0].summary,d=o.totalDistance,$=o.totalTime,F=A[0].coordinates,k=Math.floor(F.length/2),I=F[k];j.popup({autoClose:!1,closeOnClick:!1,className:"route-info-popup"}).setLatLng([I.lat,I.lng]).setContent(`
                        <div style="
                            font-family: var(--fontFamily, 'Inter'); 
                            text-align: center;
                            padding: 8px;
                            min-width: 150px;
                        ">
                            <div style="
                                background: var(--theme-primary, #3b82f6);
                                color: white;
                                padding: 4px 8px;
                                border-radius: 6px;
                                margin-bottom: 6px;
                                font-weight: bold;
                                font-size: 12px;
                            ">Route Information</div>
                            <div style="font-size: 11px; line-height: 1.4;">
                                <div><strong>Waypoints:</strong> ${v.length}</div>
                                <div><strong>Distance:</strong> ${(d/1e3).toFixed(2)} km</div>
                                <div><strong>Est. Time:</strong> ${Math.round($/60)} min</div>
                            </div>
                        </div>
                    `).openOn(c),setTimeout(()=>{const q=j.latLngBounds(r);c.fitBounds(q,{padding:[40,40],maxZoom:15})},100)}),c._waypointRoutingControl=w}return()=>{c._waypointRoutingControl&&(c.removeControl(c._waypointRoutingControl),delete c._waypointRoutingControl),c.getContainer().querySelectorAll(".leaflet-routing-container").forEach(r=>r.remove())}},[c,g]),null},Ma=({polygonPoints:g})=>{const c=ze();return i.useEffect(()=>{if(!c||g.length<3)return;c.eachLayer(r=>{r.options&&r.options.isPolygon&&c.removeLayer(r)});const v=g.filter(r=>r.lat&&r.lng);if(v.length>=3){const r=v.map(o=>[parseFloat(o.lat),parseFloat(o.lng)]),w=j.polygon(r,{color:"var(--theme-primary, #3b82f6)",fillColor:"var(--theme-primary, #3b82f6)",fillOpacity:.2,weight:3,opacity:.8,isPolygon:!0}).addTo(c),C=w.getLatLngs()[0].reduce((o,d,$,F)=>{const k=($+1)%F.length,I=F[k];return o+(d.lat*I.lng-I.lat*d.lng)},0),A=Math.abs(C/2*111.32*111.32/1e6).toFixed(3);j.popup().setLatLng(w.getBounds().getCenter()).setContent(`
                    <div style="font-family: var(--fontFamily, 'Inter'); text-align: center;">
                        <strong>Geofence Area</strong><br>
                        <small>Points: ${v.length}</small><br>
                        <small>Area: ~${A} kmÂ²</small>
                    </div>
                `).openOn(c),v.length>0&&c.fitBounds(w.getBounds(),{padding:[30,30]})}return()=>{c.eachLayer(r=>{r.options&&r.options.isPolygon&&c.removeLayer(r)})}},[c,g]),null},dt=()=>{var ge,ve,be;const{title:g,attendanceSettings:c,attendanceTypes:v}=ca().props,[r,w]=i.useState(!1),[C,A]=i.useState(!1);i.useEffect(()=>{const t=()=>{w(window.innerWidth<640),A(window.innerWidth<768)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const o=()=>{var l;if(typeof window>"u")return"lg";const n=((l=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:l.trim())||"12px",s=parseInt(n);return s===0?"none":s<=4?"sm":s<=8?"md":s<=16?"lg":"full"},[d,$]=i.useState(c||{}),[F,k]=i.useState(v||[]),[I,q]=i.useState(!1),[Oe,ce]=i.useState(!1),[a,J]=i.useState(null),[z,We]=i.useState(""),[$e,Ee]=i.useState("general"),{isOpen:De,onOpen:me,onClose:Y}=le(),{isOpen:Be,onOpen:ue,onClose:X}=le(),{isOpen:Ve,onOpen:fe,onClose:T}=le(),[S,E]=i.useState({name:"",description:"",is_active:!1}),[u,D]=i.useState({tolerance:300,waypoints:[]}),[P,L]=i.useState(!1),[qe,Z]=i.useState([23.8103,90.4125]),[Ze,U]=i.useState(13),[f,G]=i.useState({polygon:[]}),[R,O]=i.useState(!1),[Ue,Q]=i.useState([23.8103,90.4125]),[Ge,H]=i.useState(13),Qe=i.useMemo(()=>z?F.filter(t=>{var n;return t.name.toLowerCase().includes(z.toLowerCase())||((n=t.description)==null?void 0:n.toLowerCase().includes(z.toLowerCase()))||t.slug.toLowerCase().includes(z.toLowerCase())}):F,[F,z]),pe=i.useCallback(async t=>{var n,s;q(!0);try{const l=await K.post("/settings/attendance/update",t);l.data.attendanceSettings&&($(l.data.attendanceSettings),y.success(l.data.message||"Settings updated successfully"))}catch(l){console.error("Settings update error:",l),y.error(((s=(n=l.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to update settings")}finally{q(!1)}},[]),He=i.useCallback(t=>{t.preventDefault();const n=new FormData(t.target),s=Object.fromEntries(n.entries()),l=[];s.weekend_saturday&&l.push("saturday"),s.weekend_sunday&&l.push("sunday"),s.weekend_friday&&l.push("friday");const m={...s,weekend_days:l,break_time_duration:parseInt(s.break_time_duration)||0,late_mark_after:parseInt(s.late_mark_after)||0,early_leave_before:parseInt(s.early_leave_before)||0,overtime_after:parseInt(s.overtime_after)||0};delete m.weekend_saturday,delete m.weekend_sunday,delete m.weekend_friday,pe(m)},[pe]),Ke=i.useCallback((t=null)=>{J(t?{...t,config:t.config||{}}:null),E(t?{name:t.name||"",description:t.description||"",is_active:t.is_active||!1}:{name:"",description:"",is_active:!1}),me()},[me]),xe=i.useCallback(async t=>{var n,s;ce(!0);try{const l=await K.put(`/settings/attendance-type/${a.id}`,t);if(l.data.attendanceType){const m=l.data.attendanceType;k(h=>h.map(b=>b.id===m.id?m:b)),y.success(l.data.message||"Attendance type updated successfully"),Y()}}catch(l){console.error("Type update error:",l),y.error(((s=(n=l.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to update attendance type")}finally{ce(!1)}},[a,Y]),Je=i.useCallback(t=>{var h;t.preventDefault();const n=new FormData(t.target),s=Object.fromEntries(n.entries());let l=(a==null?void 0:a.config)||{};(a==null?void 0:a.slug)==="geo_polygon"?l={...l}:(a==null?void 0:a.slug)==="wifi_ip"?l={allowed_ips:s.allowed_ips?s.allowed_ips.split(",").map(b=>b.trim()).filter(Boolean):[],allowed_ranges:s.allowed_ranges?s.allowed_ranges.split(",").map(b=>b.trim()).filter(Boolean):[]}:(a==null?void 0:a.slug)==="route_waypoint"?l={tolerance:parseInt(s.tolerance)||300,waypoints:((h=a==null?void 0:a.config)==null?void 0:h.waypoints)||[]}:(a==null?void 0:a.slug)==="qr_code"&&(l={max_distance:parseInt(s.max_distance)||50});const m={name:S.name,description:S.description,is_active:S.is_active,config:l};xe(m)},[a,S,xe]),Ye=i.useCallback(t=>{var s,l;J(t);const n=((s=t.config)==null?void 0:s.waypoints)||[];if(D({tolerance:((l=t.config)==null?void 0:l.tolerance)||300,waypoints:n}),n.length>0){const m=n[0];Z([parseFloat(m.lat),parseFloat(m.lng)]),U(15)}else Z([23.8103,90.4125]),U(13);L(!1),ue()},[ue]),Xe=()=>{L(!0),y.info("Click on the map to add a waypoint")},Te=i.useCallback(t=>{D(n=>({...n,waypoints:[...n.waypoints,t]})),L(!1),y.success("Waypoint added successfully")},[]),ea=t=>{D(n=>({...n,waypoints:n.waypoints.filter((s,l)=>l!==t)}))},he=(t,n,s)=>{D(l=>({...l,waypoints:l.waypoints.map((m,h)=>h===t?{...m,[n]:s}:m)}))},aa=t=>{t.lat&&t.lng&&(Z([parseFloat(t.lat),parseFloat(t.lng)]),U(16))},ta=i.useCallback(t=>{var s;J(t);const n=((s=t.config)==null?void 0:s.polygon)||[];if(G({polygon:n}),n.length>0){const l=n.reduce((h,b)=>h+parseFloat(b.lat),0),m=n.reduce((h,b)=>h+parseFloat(b.lng),0);Q([l/n.length,m/n.length]),H(15)}else Q([23.8103,90.4125]),H(13);O(!1),fe()},[fe]),sa=()=>{O(!0),y.info("Click on the map to add a polygon point")},na=i.useCallback(t=>{G(n=>({...n,polygon:[...n.polygon,t]})),O(!1),y.success("Polygon point added successfully")},[]),la=t=>{G(n=>({...n,polygon:n.polygon.filter((s,l)=>l!==t)}))},ye=(t,n,s)=>{G(l=>({...l,polygon:l.polygon.map((m,h)=>h===t?{...m,[n]:s}:m)}))},oa=t=>{t.lat&&t.lng&&(Q([parseFloat(t.lat),parseFloat(t.lng)]),H(16))},ra=i.useCallback(async()=>{if(f.polygon.length<3){y.error("Minimum 3 points required for a polygon");return}try{const t=f.polygon.filter(l=>l.lat&&l.lng),n={...a.config,polygon:t},s=await K.put(`/settings/attendance-type/${a.id}`,{config:n});k(l=>l.map(m=>m.id===a.id?s.data.attendanceType:m)),y.success("Polygon updated successfully"),T()}catch{y.error("Failed to update polygon")}},[a,f,T]),ia=i.useCallback(async()=>{try{const t=u.waypoints.filter(l=>l.lat&&l.lng),n={...a.config,tolerance:u.tolerance,waypoints:t},s=await K.put(`/settings/attendance-type/${a.id}`,{config:n});k(l=>l.map(m=>m.id===a.id?s.data.attendanceType:m)),y.success("Waypoints updated successfully"),X()}catch{y.error("Failed to update waypoints")}},[a,u,X]),da=t=>({color:t?"success":"default",icon:t?ba:ja,text:t?"Active":"Inactive"});return e.jsxs(ua,{title:g,children:[e.jsx(ma,{title:g}),e.jsx("div",{className:"flex flex-col w-full h-full p-4",role:"main","aria-label":"Attendance Settings",children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"w-full",children:e.jsx(va.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:e.jsxs(M,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                        var(--theme-content1, #FAFAFA) 20%, 
                                        var(--theme-content2, #F4F4F5) 10%, 
                                        var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(fa,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                            color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                            color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${r?"p-4":"p-6"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                            ${r?"p-2":"p-3"} 
                                                            rounded-xl flex items-center justify-center
                                                        `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(Ce,{className:`
                                                                ${r?"w-6 h-6":"w-8 h-8"}
                                                            `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                                ${r?"text-xl":"text-2xl"}
                                                                font-bold text-foreground
                                                                ${r?"truncate":""}
                                                            `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Attendance Settings"}),e.jsx("p",{className:`
                                                                ${r?"text-xs":"text-sm"} 
                                                                text-default-500
                                                                ${r?"truncate":""}
                                                            `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Configure attendance policies, working hours, and tracking methods"})]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:e.jsx(x,{placeholder:"Search attendance types...",value:z,onChange:t=>We(t.target.value),startContent:e.jsx(pa,{className:"w-4 h-4 text-default-400"}),variant:"bordered",size:"sm",radius:o(),className:"w-64","aria-label":"Search attendance types",style:{fontFamily:'var(--fontFamily, "Inter")'}})})]})})})}),e.jsx(V,{className:"p-6",children:e.jsxs(xa,{selectedKey:$e,onSelectionChange:Ee,variant:"underlined",className:"w-full",radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(ke,{title:"General Settings",children:e.jsxs("form",{onSubmit:He,className:"space-y-8 mt-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h5",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx(ga,{className:"w-5 h-5 text-primary"}),"Office Timing"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(x,{type:"time",label:"Office Start Time",name:"office_start_time",defaultValue:(d==null?void 0:d.office_start_time)||"09:00",variant:"bordered",radius:o(),className:"max-w-full",labelPlacement:"outside",isRequired:!0,style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(x,{type:"time",label:"Office End Time",name:"office_end_time",defaultValue:(d==null?void 0:d.office_end_time)||"18:00",variant:"bordered",radius:o(),className:"max-w-full",labelPlacement:"outside",isRequired:!0,style:{fontFamily:'var(--fontFamily, "Inter")'}})]}),e.jsx(x,{type:"number",label:"Break Time Duration (minutes)",name:"break_time_duration",defaultValue:(d==null?void 0:d.break_time_duration)||"60",variant:"bordered",radius:o(),className:"max-w-md",labelPlacement:"outside",min:"0",max:"480",style:{fontFamily:'var(--fontFamily, "Inter")'}})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h5",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx(Ce,{className:"w-5 h-5 text-primary"}),"Attendance Policies"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(x,{type:"number",label:"Late Mark After (minutes)",name:"late_mark_after",defaultValue:(d==null?void 0:d.late_mark_after)||"15",variant:"bordered",radius:o(),className:"max-w-full",labelPlacement:"outside",min:"0",max:"120",style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(x,{type:"number",label:"Early Leave Before (minutes)",name:"early_leave_before",defaultValue:(d==null?void 0:d.early_leave_before)||"30",variant:"bordered",radius:o(),className:"max-w-full",labelPlacement:"outside",min:"0",max:"120",style:{fontFamily:'var(--fontFamily, "Inter")'}})]}),e.jsx(x,{type:"number",label:"Overtime After (minutes)",name:"overtime_after",defaultValue:(d==null?void 0:d.overtime_after)||"30",variant:"bordered",radius:o(),className:"max-w-md",labelPlacement:"outside",min:"0",max:"240",style:{fontFamily:'var(--fontFamily, "Inter")'}})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h5",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx(ha,{className:"w-5 h-5 text-primary"}),"Weekend Configuration"]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(oe,{name:"weekend_friday",defaultSelected:(ge=d==null?void 0:d.weekend_days)==null?void 0:ge.includes("friday"),radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Friday"}),e.jsx(oe,{name:"weekend_saturday",defaultSelected:(ve=d==null?void 0:d.weekend_days)==null?void 0:ve.includes("saturday"),radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Saturday"}),e.jsx(oe,{name:"weekend_sunday",defaultSelected:(be=d==null?void 0:d.weekend_days)==null?void 0:be.includes("sunday"),radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Sunday"})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(p,{type:"submit",color:"primary",variant:"shadow",isLoading:I,size:r?"sm":"md",className:"font-semibold",radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Save attendance settings",children:"Save Settings"})})]})},"general"),e.jsx(ke,{title:"Attendance Types",children:e.jsx("div",{className:"mt-6",children:e.jsx(ya,{className:"max-h-[600px]",children:e.jsxs(Fa,{"aria-label":"Attendance types table",radius:o(),className:"min-w-full",classNames:{wrapper:"shadow-none bg-transparent",th:"bg-content2/50 text-default-600 font-semibold",td:"text-foreground"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsxs(Ca,{children:[e.jsx(ie,{children:"TYPE"}),e.jsx(ie,{children:"STATUS"}),e.jsx(ie,{children:"ACTIONS"})]}),e.jsx(Na,{children:Qe.map(t=>{const n=da(t.is_active),s=n.icon;return e.jsxs(_a,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:t.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground",children:t.name}),e.jsx("p",{className:"text-sm text-default-500",children:t.description})]})]})}),e.jsx(re,{children:e.jsx(W,{startContent:e.jsx(s,{className:"w-4 h-4"}),variant:"flat",color:n.color,size:"sm",radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:n.text})}),e.jsx(re,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{content:"Edit attendance type",children:e.jsx(p,{isIconOnly:!0,size:"sm",variant:"light",color:"primary",radius:o(),onPress:()=>Ke(t),children:e.jsx(wa,{className:"w-4 h-4"})})}),t.slug==="route_waypoint"&&e.jsx(ne,{content:"Configure waypoints",children:e.jsx(p,{isIconOnly:!0,size:"sm",variant:"light",color:"secondary",radius:o(),onPress:()=>Ye(t),children:e.jsx(_,{className:"w-4 h-4"})})}),t.slug==="geo_polygon"&&e.jsx(ne,{content:"Configure polygon boundary",children:e.jsx(p,{isIconOnly:!0,size:"sm",variant:"light",color:"warning",radius:o(),onPress:()=>ta(t),children:e.jsx(_,{className:"w-4 h-4"})})})]})})]},t.id)})})]})})})},"types")]})})]})})})})}),e.jsx(ee,{isOpen:De,onClose:Y,size:"2xl",scrollBehavior:"inside",radius:o(),classNames:{base:"bg-content1",backdrop:"bg-black/50",header:"border-b border-divider",footer:"border-t border-divider"},children:e.jsx(ae,{children:t=>{var n,s,l,m,h,b,je,we,Fe,Ne;return e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"flex flex-col gap-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:a==null?void 0:a.icon}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold",children:["Edit ",a==null?void 0:a.name]}),e.jsx("p",{className:"text-sm text-default-500",children:"Configure attendance type settings"})]})]})}),e.jsx(se,{children:e.jsxs("form",{id:"editTypeForm",onSubmit:Je,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(x,{label:"Name",name:"name",value:S.name,onChange:N=>E(B=>({...B,name:N.target.value})),variant:"bordered",radius:o(),isRequired:!0,style:{fontFamily:'var(--fontFamily, "Inter")'}},`name-${a==null?void 0:a.id}`),e.jsx(ka,{label:"Description",name:"description",value:S.description,onChange:N=>E(B=>({...B,description:N.target.value})),variant:"bordered",radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'}},`description-${a==null?void 0:a.id}`),e.jsx(Ia,{name:"is_active",isSelected:S.is_active,onValueChange:N=>E(B=>({...B,is_active:N})),radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Active"},`switch-${a==null?void 0:a.id}-${a==null?void 0:a.is_active}`)]}),(a==null?void 0:a.slug)==="wifi_ip"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-lg font-semibold",children:"Network Configuration"}),e.jsx(x,{label:"Allowed IPs (comma-separated)",name:"allowed_ips",defaultValue:((s=(n=a==null?void 0:a.config)==null?void 0:n.allowed_ips)==null?void 0:s.join(", "))||"",variant:"bordered",radius:o(),placeholder:"192.168.1.1, 10.0.0.1",style:{fontFamily:'var(--fontFamily, "Inter")'}},`allowed_ips-${a==null?void 0:a.id}`),e.jsx(x,{label:"Allowed IP Ranges (comma-separated)",name:"allowed_ranges",defaultValue:((m=(l=a==null?void 0:a.config)==null?void 0:l.allowed_ranges)==null?void 0:m.join(", "))||"",variant:"bordered",radius:o(),placeholder:"192.168.1.0/24, 10.0.0.0/16",style:{fontFamily:'var(--fontFamily, "Inter")'}},`allowed_ranges-${a==null?void 0:a.id}`)]}),(a==null?void 0:a.slug)==="route_waypoint"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-lg font-semibold",children:"Route Configuration"}),e.jsx(x,{label:"Tolerance (meters)",name:"tolerance",type:"number",defaultValue:((h=a==null?void 0:a.config)==null?void 0:h.tolerance)||300,variant:"bordered",radius:o(),min:"10",max:"1000",style:{fontFamily:'var(--fontFamily, "Inter")'}},`tolerance-${a==null?void 0:a.id}`),e.jsxs("p",{className:"text-sm text-default-500",children:["Current waypoints: ",((je=(b=a==null?void 0:a.config)==null?void 0:b.waypoints)==null?void 0:je.length)||0," configured"]})]}),(a==null?void 0:a.slug)==="qr_code"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-lg font-semibold",children:"QR Code Configuration"}),e.jsx(x,{label:"Max Distance (meters)",name:"max_distance",type:"number",defaultValue:((we=a==null?void 0:a.config)==null?void 0:we.max_distance)||50,variant:"bordered",radius:o(),min:"1",max:"500",style:{fontFamily:'var(--fontFamily, "Inter")'}},`max_distance-${a==null?void 0:a.id}`)]}),(a==null?void 0:a.slug)==="geo_polygon"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-lg font-semibold",children:"Geofence Configuration"}),e.jsxs("p",{className:"text-sm text-default-500",children:["Polygon boundaries: ",((Ne=(Fe=a==null?void 0:a.config)==null?void 0:Fe.polygon)==null?void 0:Ne.length)||0," points configured"]})]})]})}),e.jsxs(de,{children:[e.jsx(p,{color:"danger",variant:"light",onPress:t,radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(p,{color:"primary",onPress:()=>{const N=document.getElementById("editTypeForm");N&&N.requestSubmit()},isLoading:Oe,radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Update Type"})]})]})}})}),e.jsx(ee,{isOpen:Be,onClose:()=>{L(!1),X()},size:"5xl",scrollBehavior:"inside",radius:o(),classNames:{base:"bg-content1",backdrop:"bg-black/50",header:"border-b border-divider",footer:"border-t border-divider"},children:e.jsx(ae,{children:t=>e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"flex flex-col gap-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{className:"w-6 h-6 text-primary"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Configure Route Waypoints"}),e.jsxs("p",{className:"text-sm text-default-500",children:["Set route waypoints for ",a==null?void 0:a.name]})]})]})}),e.jsx(se,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{label:"Tolerance (meters)",type:"number",value:u.tolerance,onChange:n=>D(s=>({...s,tolerance:parseInt(n.target.value)||300})),variant:"bordered",radius:o(),min:"10",max:"1000",className:"max-w-xs",style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsxs(W,{variant:"flat",color:"primary",size:"sm",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[u.waypoints.length," waypoint",u.waypoints.length!==1?"s":""]}),u.waypoints.length>=2&&e.jsxs(W,{variant:"flat",color:"success",size:"sm",style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Road Route: ",u.waypoints.length-1," segment",u.waypoints.length>2?"s":""]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold",children:"Interactive Route Map"}),e.jsx("p",{className:"text-sm text-default-500",children:u.waypoints.length>=2?"Actual road route is displayed between waypoints with distance and time estimates":"Add waypoints to visualize the actual road route path"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{color:P?"danger":"primary",variant:P?"flat":"solid",size:"sm",onPress:()=>{P?(L(!1),y.info("Waypoint adding mode disabled")):Xe()},startContent:P?e.jsx(Ie,{className:"w-4 h-4"}):e.jsx(Re,{className:"w-4 h-4"}),radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:P?"Cancel Adding":"Add Waypoint"}),u.waypoints.length>0&&e.jsx(p,{color:"secondary",variant:"flat",size:"sm",onPress:()=>{if(u.waypoints.length>0){const s=j.latLngBounds(u.waypoints.map(l=>[parseFloat(l.lat),parseFloat(l.lng)])).getCenter();Z([s.lat,s.lng]),U(12)}},startContent:e.jsx(_e,{className:"w-4 h-4"}),radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Fit All"})]})]}),P&&e.jsx("div",{className:"p-3 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-primary) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx("p",{className:"text-sm text-primary font-medium",children:"ð Click anywhere on the map to add a waypoint"})}),e.jsx(M,{style:{borderRadius:"var(--borderRadius, 8px)",overflow:"hidden"},children:e.jsx("div",{style:{height:"400px",width:"100%"},children:e.jsxs(Se,{center:qe,zoom:Ze,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,doubleClickZoom:!0,dragging:!0,touchZoom:!0,children:[e.jsx(Pe,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),u.waypoints.map((n,s)=>n.lat&&n.lng&&e.jsx(Me,{position:[parseFloat(n.lat),parseFloat(n.lng)],icon:j.divIcon({html:`<div style="
                                                                        background: var(--theme-primary, #3b82f6);
                                                                        color: white;
                                                                        border-radius: 50%;
                                                                        width: 30px;
                                                                        height: 30px;
                                                                        display: flex;
                                                                        align-items: center;
                                                                        justify-content: center;
                                                                        font-weight: bold;
                                                                        font-size: 12px;
                                                                        border: 2px solid white;
                                                                        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
                                                                    ">${s+1}</div>`,className:"custom-waypoint-marker",iconSize:[30,30],iconAnchor:[15,15]})},`waypoint-${s}`)),e.jsx(Ra,{waypoints:u.waypoints}),e.jsx(Sa,{onLocationSelect:Te,isAddingWaypoint:P})]})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-lg font-semibold",children:"Waypoint List"}),u.waypoints.length===0?e.jsx(M,{children:e.jsxs(V,{className:"text-center py-8",children:[e.jsx(_,{className:"w-12 h-12 text-default-300 mx-auto mb-3"}),e.jsx("p",{className:"text-default-500",children:"No waypoints configured"}),e.jsx("p",{className:"text-sm text-default-400 mt-1",children:'Click "Add Waypoint" and then click on the map to add waypoints'})]})}):e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:u.waypoints.map((n,s)=>e.jsx(M,{className:"border border-divider",children:e.jsxs(V,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white",style:{background:"var(--theme-primary, #3b82f6)"},children:s+1}),e.jsxs("h6",{className:"font-medium",children:["Waypoint ",s+1]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{isIconOnly:!0,color:"secondary",variant:"light",size:"sm",onPress:()=>aa(n),radius:o(),title:"Center map on waypoint",children:e.jsx(_,{className:"w-4 h-4"})}),e.jsx(p,{isIconOnly:!0,color:"danger",variant:"light",size:"sm",onPress:()=>ea(s),radius:o(),children:e.jsx(Ae,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(x,{label:"Latitude",type:"number",step:"any",value:n.lat,onChange:l=>he(s,"lat",l.target.value),variant:"bordered",radius:o(),placeholder:"e.g., 23.7588",size:"sm",style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(x,{label:"Longitude",type:"number",step:"any",value:n.lng,onChange:l=>he(s,"lng",l.target.value),variant:"bordered",radius:o(),placeholder:"e.g., 90.3783",size:"sm",style:{fontFamily:'var(--fontFamily, "Inter")'}})]})]})},s))})]})]})}),e.jsxs(de,{children:[e.jsx(p,{color:"danger",variant:"light",onPress:()=>{L(!1),t()},radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsxs(p,{color:"primary",onPress:ia,radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Save Waypoints (",u.waypoints.length,")"]})]})]})})}),e.jsx(ee,{isOpen:Ve,onClose:()=>{O(!1),T()},size:"5xl",scrollBehavior:"inside",radius:o(),classNames:{base:"bg-content1",backdrop:"bg-black/50",header:"border-b border-divider",footer:"border-t border-divider"},children:e.jsx(ae,{children:t=>e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"flex flex-col gap-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{className:"w-6 h-6 text-warning"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Configure Geo Polygon"}),e.jsxs("p",{className:"text-sm text-default-500",children:["Set polygon boundary for ",a==null?void 0:a.name]})]})]})}),e.jsx(se,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(W,{variant:"flat",color:"warning",size:"sm",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[f.polygon.length," point",f.polygon.length!==1?"s":""]}),f.polygon.length>=3&&e.jsx(W,{variant:"flat",color:"success",size:"sm",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Valid polygon boundary"}),f.polygon.length>0&&f.polygon.length<3&&e.jsx(W,{variant:"flat",color:"danger",size:"sm",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Minimum 3 points required"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold",children:"Interactive Polygon Map"}),e.jsx("p",{className:"text-sm text-default-500",children:f.polygon.length>=3?"Polygon boundary is displayed with fill area":"Add points to create the polygon boundary (minimum 3 points)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{color:R?"danger":"warning",variant:R?"flat":"solid",size:"sm",onPress:()=>{R?(O(!1),y.info("Point adding mode disabled")):sa()},startContent:R?e.jsx(Ie,{className:"w-4 h-4"}):e.jsx(Re,{className:"w-4 h-4"}),radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:R?"Cancel Adding":"Add Point"}),f.polygon.length>0&&e.jsx(p,{color:"secondary",variant:"flat",size:"sm",onPress:()=>{if(f.polygon.length>0){const s=j.latLngBounds(f.polygon.map(l=>[parseFloat(l.lat),parseFloat(l.lng)])).getCenter();Q([s.lat,s.lng]),H(12)}},startContent:e.jsx(_e,{className:"w-4 h-4"}),radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Fit All"})]})]}),R&&e.jsx("div",{className:"p-3 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-warning) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-warning) 25%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx("p",{className:"text-sm text-warning font-medium",children:"ð Click anywhere on the map to add a polygon point"})}),e.jsx(M,{style:{borderRadius:"var(--borderRadius, 8px)",overflow:"hidden"},children:e.jsx("div",{style:{height:"400px",width:"100%"},children:e.jsxs(Se,{center:Ue,zoom:Ge,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,doubleClickZoom:!0,dragging:!0,touchZoom:!0,children:[e.jsx(Pe,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),f.polygon.map((n,s)=>n.lat&&n.lng&&e.jsx(Me,{position:[parseFloat(n.lat),parseFloat(n.lng)],icon:j.divIcon({html:`<div style="
                                                                        background: var(--theme-warning, #f5a524);
                                                                        color: white;
                                                                        border-radius: 50%;
                                                                        width: 30px;
                                                                        height: 30px;
                                                                        display: flex;
                                                                        align-items: center;
                                                                        justify-content: center;
                                                                        font-weight: bold;
                                                                        font-size: 12px;
                                                                        border: 2px solid white;
                                                                        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
                                                                    ">${s+1}</div>`,className:"custom-polygon-marker",iconSize:[30,30],iconAnchor:[15,15]})},`polygon-point-${s}`)),e.jsx(Ma,{polygonPoints:f.polygon}),e.jsx(Pa,{onLocationSelect:na,isAddingPoint:R})]})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-lg font-semibold",children:"Polygon Points"}),f.polygon.length===0?e.jsx(M,{children:e.jsxs(V,{className:"text-center py-8",children:[e.jsx(_,{className:"w-12 h-12 text-default-300 mx-auto mb-3"}),e.jsx("p",{className:"text-default-500",children:"No polygon points configured"}),e.jsx("p",{className:"text-sm text-default-400 mt-1",children:'Click "Add Point" and then click on the map to add points (minimum 3 required)'})]})}):e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:f.polygon.map((n,s)=>e.jsx(M,{className:"border border-divider",children:e.jsxs(V,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white",style:{background:"var(--theme-warning, #f5a524)"},children:s+1}),e.jsxs("h6",{className:"font-medium",children:["Point ",s+1]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{isIconOnly:!0,color:"secondary",variant:"light",size:"sm",onPress:()=>oa(n),radius:o(),title:"Center map on point",children:e.jsx(_,{className:"w-4 h-4"})}),e.jsx(p,{isIconOnly:!0,color:"danger",variant:"light",size:"sm",onPress:()=>la(s),radius:o(),children:e.jsx(Ae,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(x,{label:"Latitude",type:"number",step:"any",value:n.lat,onChange:l=>ye(s,"lat",l.target.value),variant:"bordered",radius:o(),placeholder:"e.g., 23.7588",size:"sm",style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(x,{label:"Longitude",type:"number",step:"any",value:n.lng,onChange:l=>ye(s,"lng",l.target.value),variant:"bordered",radius:o(),placeholder:"e.g., 90.3783",size:"sm",style:{fontFamily:'var(--fontFamily, "Inter")'}})]})]})},s))})]})]})}),e.jsxs(de,{children:[e.jsx(p,{color:"danger",variant:"light",onPress:()=>{O(!1),t()},radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsxs(p,{color:"warning",onPress:ra,isDisabled:f.polygon.length<3,radius:o(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Save Polygon (",f.polygon.length,"/3+ points)"]})]})]})})})]})};export{dt as default};
