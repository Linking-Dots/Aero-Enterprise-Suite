import{R as Je,r as a,j as e,A as Ge,b as se,o as Ve,J as ye,a as V,c as ve,e as _e,d as ke}from"./app-CFOXYWdD.js";import{m as Ue,G as Qe}from"./logo-AMLCgbkx.js";import{d}from"./dayjs.min-DTClqbqG.js";import{c as te,o as Xe,f as Q,g as x,u as Ce,r as Me,F as qe}from"./App-D44H3aE5.js";import{P as Ze}from"./PageHeader-DIUdhN7v.js";import{F as T}from"./CheckCircleIcon-WfVI_0Z3.js";import{F as $e}from"./XCircleIcon-CXS-JZ21.js";import{F as A}from"./ExclamationTriangleIcon-Kx82ewut.js";import{i as ae}from"./chunk-SSA7SXE4-B38lyIff.js";import{F as es}from"./UserIcon-B8KaJTnW.js";import{F as Pe}from"./DocumentArrowDownIcon-CebuwUHN.js";import{l as ss}from"./chunk-JOT4BT4P-DD-bNesh.js";import{s as Ye}from"./chunk-TLYTI3QM-CvGR7vge.js";import{t as Le,a as Se,b as Fe,c as N}from"./chunk-F3UDT23P-DfyL8aGa.js";import{t as Re}from"./chunk-YRZGWF2W-CVS3z9wo.js";import{t as Ae}from"./chunk-TSPNSPCL-CDimUInN.js";import{p as Te}from"./chunk-EAPQ7RWQ-CTPnoxCw.js";import{c as ts}from"./chunk-D5XJWRAV-Bs0mRdwq.js";import{u as as}from"./chunk-S574QCAN-C6iBC3Hs.js";const rs=Je.memo(({absentUsers:C,selectedDate:n,getUserLeave:M})=>{const[y,_]=a.useState(5),[f,j]=a.useState(""),c=a.useMemo(()=>{if(!f.trim())return C;const l=f.toLowerCase();return C.filter(o=>{var E,I,O,h;const b=((E=o.name)==null?void 0:E.toLowerCase())||"",v=((I=o.employee_id)==null?void 0:I.toString().toLowerCase())||"",$=((O=o.email)==null?void 0:O.toLowerCase())||"",P=((h=o.phone)==null?void 0:h.toString().toLowerCase())||"";return b.includes(l)||v.includes(l)||$.includes(l)||P.includes(l)})},[C,f]),L=()=>{_(l=>l+5)},S=l=>{j(l.target.value),_(5)},U=l=>{switch(l==null?void 0:l.toLowerCase()){case"approved":return e.jsx(T,{className:"w-4 h-4 text-success"});case"rejected":return e.jsx($e,{className:"w-4 h-4 text-danger"});default:return e.jsx(x,{className:"w-4 h-4 text-warning"})}},X=c.length;return C.length===0?e.jsxs("div",{className:"h-full",children:[e.jsx(Ze,{title:"Perfect Attendance!",subtitle:`No employees are absent on ${d(n).format("MMMM D, YYYY")}`,icon:e.jsx(T,{className:"w-6 h-6"}),variant:"gradient",actionButtons:[{label:"0",variant:"flat",color:"success",icon:e.jsx(T,{className:"w-4 h-4"}),className:"bg-green-500/10 text-green-500 border-green-500/20"}]}),e.jsxs("div",{role:"region","aria-label":"No absent employees today",className:"text-center py-12 bg-white/10 backdrop-blur-md border border-white/20 rounded-lg h-96 flex flex-col items-center justify-center",children:[e.jsx(T,{className:"w-12 h-12 text-success mx-auto mb-4"}),e.jsx("p",{className:"text-success mb-2 text-sm font-medium",children:"Perfect Attendance!"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"No employees are absent today."}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1 block text-xs",children:"All employees are either present or on approved leave."})]})]}):e.jsxs("div",{className:"h-full",children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("div",{className:"mb-4",children:e.jsxs("h3",{className:"font-semibold text-red-600 flex items-center gap-2 text-lg",children:[e.jsx($e,{className:"w-5 h-5"}),"Absent Employees (",X,")"]})})}),e.jsx("div",{className:"mb-3 m-2",children:e.jsx(ae,{type:"text",placeholder:"Search absent employees...",value:f,onChange:S,startContent:e.jsx(te,{className:"w-4 h-4 text-default-400"}),variant:"bordered","aria-label":"Search absent employees",classNames:{inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 h-10",input:"text-sm"}})}),f&&e.jsx("div",{className:"mb-2",children:e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:[c.length," of ",C.length," employees found"]})}),f&&c.length===0&&e.jsxs("div",{className:"text-center py-8 bg-white/10 backdrop-blur-md border border-white/20 rounded-lg",children:[e.jsx(te,{className:"w-8 h-8 text-default-300 mx-auto mb-2"}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:['No employees found matching "',f,'"']})]}),e.jsxs("div",{role:"region","aria-label":"Absent employees list",className:"overflow-y-auto max-h-[520px]",children:[e.jsx(Ge,{children:c.slice(0,y).map(l=>{var b,v;const o=M(l.id);return e.jsx(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},className:"p-3 m-2 bg-white/10 backdrop-blur-md border border-white/20 hover:bg-white/15 transition-all duration-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(Xe,{src:l.profile_image_url||l.profile_image,name:l.name,isBordered:!0,size:"sm",showFallback:!0}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"truncate text-sm font-medium text-gray-900 dark:text-white",children:l.name}),l.employee_id&&e.jsxs("p",{className:"block text-xs text-gray-500 dark:text-gray-400",children:["ID: ",l.employee_id]}),o?e.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[e.jsxs("p",{className:"flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(Q,{className:"w-3 h-3"}),o.from_date===o.to_date?o.from_date:`${o.from_date} - ${o.to_date}`]}),e.jsxs("p",{className:"flex items-center gap-1 text-xs text-primary",children:[U(o.status),o.leave_type," Leave"]})]}):e.jsxs("p",{className:"flex items-center gap-1 mt-1 text-xs text-red-600",children:[e.jsx(A,{className:"w-3 h-3"}),"Absent without leave"]})]})]}),o&&e.jsx("div",{className:"bg-white/20 backdrop-blur-md border border-white/30 rounded-md px-1.5 py-0.5 ml-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[U(o.status),e.jsx("span",{className:`font-semibold text-xs ${((b=o.status)==null?void 0:b.toLowerCase())==="approved"?"text-green-600":((v=o.status)==null?void 0:v.toLowerCase())==="rejected"?"text-red-600":"text-orange-600"}`,children:o.status})]})})]})},l.id)})}),y<c.length&&e.jsx("div",{className:"text-center mt-4 pb-4",children:e.jsxs(se,{variant:"bordered",onPress:L,startContent:e.jsx(Ve,{className:"w-4 h-4"}),size:"sm",color:"warning",fullWidth:!0,children:["Show More (",c.length-y," remaining)"]})})]})]})}),$s=({handleDateChange:C,selectedDate:n,updateTimeSheet:M,externalFilterData:y,externalEmployee:_})=>{var ge,je,be;const{auth:f}=ye().props,{url:j}=ye(),c=Ce("(min-width: 1025px)"),L=Ce("(min-width: 641px) and (max-width: 1024px)"),[S,U]=a.useState([]),[X,l]=a.useState([]),[o,b]=a.useState([]),[v,$]=a.useState(""),[P,E]=a.useState(0),[I,O]=a.useState(0),[h,ns]=a.useState(10),[k,q]=a.useState(1),[w,re]=a.useState(_||""),[W,Y]=a.useState(!1),[B,ls]=a.useState(0),[os,ne]=a.useState(null),[le,cs]=a.useState(!0),[Z,oe]=a.useState(new Date),[H,F]=a.useState(""),ce=a.useRef(null),m=a.useRef({currentMonth:d().format("YYYY-MM"),employee:_||"",filterData:y||{currentMonth:d().format("YYYY-MM")},selectedDate:n,perPage:10,updateTimeSheet:M,refreshKey:0,currentPage:1}),[u,ie]=a.useState(y||{currentMonth:d().format("YYYY-MM")}),K=a.useCallback(async()=>{try{return Y(!1),await me(n,k,h,w,u,!0),j!=="/attendance-employee"&&await xe(n,w),oe(new Date),!0}catch(s){return console.error("Error refreshing timesheet:",s),!1}finally{Y(!0)}},[n,k,h,w,u,j]),ee=a.useCallback(async()=>{if(n)try{const s=route("check-timesheet-updates",{date:d(n).format("YYYY-MM-DD"),month:u.currentMonth}),r=await fetch(s);if(!r.ok){const g=await r.json().catch(()=>({}));throw new Error(`HTTP ${r.status}: ${g.message||"Failed to check for updates"}`)}const t=await r.json();t.success&&t.last_updated!==ce.current&&t.last_updated&&(ce.current=t.last_updated,await K(),ne(new Date)),oe(new Date)}catch(s){console.error("Error checking for timesheet updates:",s)}},[n,u.currentMonth,K]),de=a.useMemo(()=>Z?Z.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}):null,[Z]),me=async(s,r,t,g,i,J=!1)=>{var D,z;if(!s){Y(!0),$("No date selected");return}const G=j!=="/attendance-employee"?route("admin.getPresentUsersForDate"):route("getCurrentUserAttendanceForDate");try{Y(!1),$("");const p=await V.get(G,{params:{page:r,perPage:t,employee:g,date:d(s).format("YYYY-MM-DD"),currentYear:i!=null&&i.currentMonth?d(i.currentMonth).year():"",currentMonth:i!=null&&i.currentMonth?d(i.currentMonth).format("MM"):"",_t:J?Date.now():void 0}});p.status===200?(U(p.data.attendances||[]),E(p.data.total||0),O(p.data.last_page||1),q(p.data.current_page||1),ne(new Date),$("")):$(`Unexpected response: ${p.status}`)}catch(p){console.error("Error fetching attendance data:",p),$(((z=(D=p.response)==null?void 0:D.data)==null?void 0:z.message)||"An error occurred while retrieving attendance data."),U([]),E(0)}finally{Y(!0)}},xe=async(s,r)=>{if(j==="/attendance-employee"){b([]),l([]);return}if(!s){b([]),l([]);return}try{const t=await V.get(route("admin.getAbsentUsersForDate"),{params:{date:d(s).format("YYYY-MM-DD"),employee:r||"",_t:Date.now()}});t.status===200?(b(t.data.absent_users||[]),l(t.data.leaves||[])):(console.warn("Unexpected response getting absent users:",t.status),b([]),l([]))}catch(t){console.error("Error fetching absent users:",t),b([]),l([])}},he=s=>{q(s)};a.useCallback((s,r)=>{ie(t=>({...t,[s]:r}))},[]);const Ee=s=>X.find(r=>String(r.user_id)===String(s)),ue=(s,r)=>{if(!s)return null;try{let t;if(typeof s=="string"){const g=d(r).format("YYYY-MM-DD");if(s.match(/^\d{2}:\d{2}:\d{2}$/)){const i=`${g}T${s}`;t=new Date(i)}else if(s.includes("T")||s.includes(" "))t=new Date(s);else if(s.match(/^\d{2}:\d{2}$/)){const i=`${g}T${s}:00`;t=new Date(i)}else t=new Date(`${g}T${s}`)}else t=new Date(s);return isNaN(t.getTime())?(console.warn("Invalid time data:",s),"Invalid time"):t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}catch(t){return console.warn("Error formatting time:",{timeString:s,date:r,error:t}),"Invalid time"}},R=((ge=f.permissions)==null?void 0:ge.includes("attendance.view"))||!1,Ie=((je=f.permissions)==null?void 0:je.includes("attendance.manage"))||!1,De=((be=f.permissions)==null?void 0:be.includes("attendance.export"))||Ie||!1;a.useMemo(()=>o,[o]);const pe=[...!R||j==="/attendance-employee"?[{name:"Date",uid:"date",icon:Q,ariaLabel:"Attendance date"}]:[],...R&&j!=="/attendance-employee"?[{name:"Employee",uid:"employee",icon:es,ariaLabel:"Employee name and information"}]:[],{name:"Clock In",uid:"clockin_time",icon:x,ariaLabel:"First punch in time"},{name:"Clock Out",uid:"clockout_time",icon:x,ariaLabel:"Last punch out time"},{name:"Work Hours",uid:"production_time",icon:x,ariaLabel:"Total working hours"},{name:"Punches",uid:"punch_details",icon:x,ariaLabel:"Number of time punches recorded"}],fe=(s,r)=>{var i,J,G,D,z,p,we;const t="text-xs sm:text-sm md:text-base whitespace-nowrap",g=d(s.date).isSame(d(),"day");switch(r){case"date":return e.jsx(N,{className:`${t}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4 text-primary shrink-0"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{children:d(s.date).format("MMM D, YYYY")})})]})});case"employee":return e.jsx(N,{className:"whitespace-nowrap",children:e.jsx(as,{avatarProps:{radius:"lg",size:"sm",src:((i=s.user)==null?void 0:i.profile_image_url)||((J=s.user)==null?void 0:J.profile_image),showFallback:!0,name:((G=s.user)==null?void 0:G.name)||"Unnamed User",isBordered:!0},description:(D=s.user)!=null&&D.phone?e.jsx(ss,{href:`tel:${(z=s.user)==null?void 0:z.phone}`,size:"sm",className:"text-xs text-blue-500 hover:underline",children:(p=s.user)==null?void 0:p.phone}):e.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-400 italic",children:[e.jsx(PhoneOff,{className:"w-3 h-3"})," No Phone"]}),name:e.jsx("span",{className:"text-sm font-medium",children:((we=s.user)==null?void 0:we.name)||"Unnamed User"})})});case"clockin_time":return e.jsx(N,{className:`${t}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-success"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.punchin_time?ue(s.punchin_time,s.date)||"Invalid time":"Not clocked in"}),s.punchin_time&&e.jsx("span",{className:"text-xs text-default-500",children:"First punch"})]})]})});case"clockout_time":return e.jsx(N,{className:`${t}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-danger"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.punchout_time?ue(s.punchout_time,s.date)||"Invalid time":s.punchin_time?g?"Currently working":"Missing punch-out":"Not started"}),s.punchout_time&&e.jsx("span",{className:"text-xs text-default-500",children:"Last punch"})]})]})});case"production_time":const We=s.total_work_minutes>0,Ne=s.has_incomplete_punch,Be=s.punchin_time&&!s.punchout_time&&g;if(We){const He=Math.floor(s.total_work_minutes/60),Ke=Math.floor(s.total_work_minutes%60);return e.jsx(N,{className:`${t}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:`w-4 h-4 ${Ne?"text-warning":"text-primary"}`}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:`${He}h ${Ke}m`}),e.jsx("span",{className:"text-xs text-default-500",children:Ne?"Partial data - in progress":"Total worked time"})]})]})})}else{if(Be)return e.jsx(N,{className:`${t}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-warning"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-warning",children:"In Progress"}),e.jsx("span",{className:"text-xs text-default-500",children:"Currently working"})]})]})});if(s.punchin_time&&!s.punchout_time&&!g)return e.jsx(N,{className:`${t}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-danger"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-danger",children:"Incomplete punch"}),e.jsx("span",{className:"text-xs text-default-500",children:"Missing punch out"})]})]})})}return e.jsx(N,{className:`${t}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-warning"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-warning",children:"No work time"}),e.jsx("span",{className:"text-xs text-default-500",children:"No attendance"})]})]})});case"punch_details":return e.jsx(N,{className:`${t}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-default-400"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-xs font-medium",children:[s.punch_count||0," punch",(s.punch_count||0)!==1?"es":""]}),s.complete_punches!==s.punch_count&&e.jsxs("span",{className:"text-xs text-warning",children:[s.complete_punches," complete"]}),s.complete_punches===s.punch_count&&s.punch_count>0&&e.jsx("span",{className:"text-xs text-success",children:"All complete"})]})]})});default:return e.jsx(N,{className:`${t}`,children:"N/A"})}},ze=a.useCallback(async()=>{F("excel");try{const s=await V.get(route("attendance.exportExcel"),{params:{date:n},responseType:"blob"}),r=window.URL.createObjectURL(new Blob([s.data])),t=document.createElement("a");t.href=r,t.setAttribute("download",`Daily_Timesheet_${d(n).format("YYYY_MM_DD")}.xlsx`),document.body.appendChild(t),t.click(),t.remove(),window.URL.revokeObjectURL(r),F("")}catch(s){console.error("Error downloading Excel:",s),alert("Failed to download attendance excel."),F("")}},[n]),Oe=a.useCallback(async()=>{F("pdf");try{const s=await V.get(route("attendance.exportPdf"),{params:{date:n},responseType:"blob"}),r=window.URL.createObjectURL(new Blob([s.data])),t=document.createElement("a");t.href=r,t.setAttribute("download",`Daily_Timesheet_${d(n).format("YYYY_MM_DD")}.pdf`),document.body.appendChild(t),t.click(),t.remove(),window.URL.revokeObjectURL(r),F("")}catch(s){console.error("Error downloading PDF:",s),alert("Failed to download attendance pdf."),F("")}},[n]);return a.useEffect(()=>{if(n){if((w!==m.current.employee||u!==m.current.filterData||n!==m.current.selectedDate||h!==m.current.perPage||M!==m.current.updateTimeSheet||B!==m.current.refreshKey)&&k!==1){m.current={...m.current,employee:w,filterData:u,selectedDate:n,perPage:h,updateTimeSheet:M,refreshKey:B},q(1);return}(async()=>{Y(!1);try{await Promise.all([me(n,k,h,w,u),j!=="/attendance-employee"?xe(n,w):Promise.resolve()])}catch(t){console.error("Error updating attendance data:",t)}finally{Y(!0)}})(),m.current={...m.current,employee:w,filterData:u,selectedDate:n,perPage:h,updateTimeSheet:M,refreshKey:B,currentPage:k}}},[n,k,h,w,u,M,B]),a.useEffect(()=>{y&&ie(y)},[y]),a.useEffect(()=>{_!==void 0&&re(_)},[_]),a.useEffect(()=>{JSON.stringify(u)!==JSON.stringify(m.current.filterData)&&(m.current={...m.current,filterData:{...u}},K())},[u,K]),a.useEffect(()=>{if(!le||!n)return;ee();const s=setInterval(ee,5e3);return()=>{clearInterval(s)}},[le,ee,n]),j==="/attendance-employee"?e.jsx("div",{role:"region","aria-label":"Attendance data table",className:"w-full",children:v?e.jsx(ve,{className:"p-4 bg-danger-50 border-danger-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-danger"}),e.jsx("p",{className:"text-danger",children:v})]})}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{orientation:"horizontal",className:"overflow-y-hidden",children:e.jsx(Ye,{className:"rounded-lg",isLoaded:W,children:e.jsxs(Le,{selectionMode:"multiple",selectionBehavior:"toggle",isCompact:!0,removeWrapper:!0,"aria-label":"Employee attendance timesheet table",isHeaderSticky:!0,classNames:{base:"max-h-[520px] overflow-auto",table:"min-h-[200px] w-full",thead:"z-10",tbody:"overflow-y-auto"},children:[e.jsx(Re,{columns:pe,children:s=>e.jsx(Ae,{align:"start","aria-label":s.ariaLabel||s.name,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.icon&&e.jsx(s.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:s.name})]})},s.uid)}),e.jsx(Se,{items:S,emptyContent:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(x,{className:"w-16 h-16 text-default-300 mb-4"}),e.jsx("h6",{className:"text-lg font-semibold mb-2",children:"No Attendance Records"}),e.jsx("p",{className:"text-default-500",children:"No attendance records found for the selected date"})]}),children:s=>e.jsx(Fe,{children:r=>fe(s,r)},s.id||s.user_id)})]})})}),P>h&&e.jsx("div",{className:"py-4 flex justify-center",children:e.jsx(Te,{initialPage:1,isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:k,total:I,onChange:he,"aria-label":"Timesheet pagination"})})]})}):e.jsx("div",{className:"flex justify-center p-2",role:"main","aria-label":"Timesheet Management",children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"w-full",children:e.jsx(Ue.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:e.jsxs(Qe,{children:[e.jsx(ts,{className:"bg-linear-to-br from-slate-50/50 to-white/30 backdrop-blur-xs border-b border-white/20 p-0",children:e.jsx("div",{className:`${c?"p-6":L?"p-4":"p-3"} w-full`,children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                        ${c?"p-3":L?"p-2.5":"p-2"} 
                                                        rounded-xl bg-linear-to-br from-[rgba(var(--theme-primary-rgb),0.2)] to-[rgba(var(--theme-secondary-rgb),0.2)] border border-[rgba(var(--theme-primary-rgb),0.3)] backdrop-blur-xs
                                                    `,children:e.jsx(x,{className:`
                                                                ${c?"w-8 h-8":L?"w-6 h-6":"w-5 h-5"}
                                                            `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                            ${c?"text-2xl":L?"text-xl":"text-lg"}
                                                            font-bold bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) bg-clip-text text-transparent
                                                            ${c?"":"truncate"}
                                                        `,style:{fontFamily:"var(--font-current)",transition:"all var(--transition)"},children:"Daily Timesheet"}),e.jsx("p",{className:`
                                                            ${c?"text-sm":"text-xs"} 
                                                            text-default-500
                                                            ${c?"":"truncate"}
                                                        `,style:{fontFamily:"var(--font-current)",transition:"all var(--transition)"},children:new Date(n).toLocaleString("en-US",{month:c?"long":"short",day:"numeric",year:c?"numeric":void 0})})]})]}),"                                                ",e.jsxs("div",{className:"flex items-center gap-4",children:[de&&e.jsxs("span",{className:"text-xs text-default-500",children:["Updated: ",de]}),e.jsx("div",{className:"flex items-center gap-2",children:De&&e.jsxs(e.Fragment,{children:[e.jsx(se,{color:"success",variant:"flat",size:c?"md":"sm",startContent:e.jsx(Pe,{className:`
                                                                            ${c?"w-4 h-4":"w-3.5 h-3.5"}
                                                                        `}),className:"bg-linear-to-r from-[rgba(var(--theme-success-rgb),0.1)] to-[rgba(var(--theme-success-rgb),0.2)] hover:from-[rgba(var(--theme-success-rgb),0.2)] hover:to-[rgba(var(--theme-success-rgb),0.3)] border border-[rgba(var(--theme-success-rgb),0.2)] backdrop-blur-xs",onPress:ze,isDisabled:!W||S.length===0||H!=="",isLoading:H==="excel",style:{fontFamily:"var(--font-current)",transition:"all var(--transition)"},children:c?"Excel":"XLS"}),e.jsx(se,{color:"danger",variant:"flat",size:c?"md":"sm",startContent:e.jsx(Pe,{className:`
                                                                            ${c?"w-4 h-4":"w-3.5 h-3.5"}
                                                                        `}),className:"bg-linear-to-r from-[rgba(var(--theme-danger-rgb),0.1)] to-[rgba(var(--theme-danger-rgb),0.2)] hover:from-[rgba(var(--theme-danger-rgb),0.2)] hover:to-[rgba(var(--theme-danger-rgb),0.3)] border border-[rgba(var(--theme-danger-rgb),0.2)] backdrop-blur-xs",onPress:Oe,isDisabled:!W||S.length===0||H!=="",isLoading:H==="pdf",style:{fontFamily:"var(--font-current)",transition:"all var(--transition)"},children:"PDF"})]})})]})]}),c&&e.jsxs("div",{className:"flex items-center gap-6 pt-2 border-t border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-success"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Present: ",P]})]}),R&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-warning"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Absent: ",o.length]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4 text-primary"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Total: ",P+o.length]})]})]})]})})}),e.jsx(_e,{}),e.jsx(ke,{children:e.jsx("div",{role:"search","aria-label":"Timesheet filters",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:R&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-1",children:e.jsx(ae,{type:"text",label:"Search Employee",placeholder:"Enter employee name",value:w,onChange:s=>re(s.target.value),variant:"bordered",size:"sm",startContent:e.jsx(te,{className:"w-4 h-4 text-default-400"}),classNames:{input:"bg-transparent",inputWrapper:"bg-white/10 backdrop-blur-md border-white/20"},"aria-label":"Search employees"})}),e.jsx("div",{className:"col-span-1",children:e.jsx(ae,{label:"Select Date",type:"date",variant:"bordered",onChange:C,value:new Date(n).toISOString().slice(0,10)||"",size:"sm",startContent:e.jsx(Q,{className:"w-4 h-4 text-default-400"}),classNames:{input:"bg-transparent",inputWrapper:"bg-white/10 backdrop-blur-md border-white/20"},"aria-label":"Select date for timesheet"})})]})})})}),e.jsx(_e,{}),e.jsx(ke,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6",children:[e.jsx("div",{className:`${R?"md:col-span-9":"md:col-span-12"}`,children:v?e.jsx(ve,{className:"p-4 bg-danger-50 border-danger-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-danger"}),e.jsx("p",{className:"text-danger",children:v})]})}):e.jsxs("div",{role:"region","aria-label":"Present employees attendance table",className:"border-r border-gray-200 pr-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("h6",{className:"text-lg font-semibold text-blue-600 flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"Present Employees (",P,")"]})}),e.jsx(Me,{orientation:"horizontal",className:"overflow-y-hidden",children:e.jsx(Ye,{className:"rounded-lg",isLoaded:W,children:e.jsxs(Le,{isCompact:!0,removeWrapper:!0,"aria-label":"Employee attendance timesheet table",isHeaderSticky:!0,classNames:{base:"max-h-[520px] overflow-auto",table:"min-h-[200px] w-full",thead:"z-10",tbody:"overflow-y-auto"},children:[e.jsx(Re,{columns:pe,children:s=>e.jsx(Ae,{align:"start",children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.icon&&e.jsx(s.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:s.name})]})},s.uid)}),e.jsx(Se,{items:S,emptyContent:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(x,{className:"w-12 h-12 text-default-300 mb-4"}),e.jsx("p",{className:"text-default-500",children:"No attendance records found"})]}),children:s=>e.jsx(Fe,{children:r=>fe(s,r)},s.id||s.user_id)})]})})}),P>h&&e.jsx("div",{className:"py-4 flex justify-center",children:e.jsx(Te,{initialPage:1,isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:k,total:I,onChange:he,"aria-label":"Timesheet pagination"})})]})}),R&&e.jsx("div",{className:"md:col-span-3",children:e.jsx(rs,{absentUsers:o,selectedDate:n,getUserLeave:Ee})})]})})]})})})})})};export{$s as T};
