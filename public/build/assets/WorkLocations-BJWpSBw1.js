import{m as ye,n as Ne,i as we,k as ke,r as i,o as _e,p as Ce,q as X,v as G,h as Fe,j as e,J as Le,S as Se,d as W,F as Y,c as K,f as Q,b as U,R as Pe,Q as Re}from"./app-Cxcpl1Gx.js";import{x as Ie,u as D,k as A,i as Z,b as E,c as ie,B as We,C as $e,D as De,E as ee,m as le,n as ce,o as de,p as me,s as Ae,l as Me,g as Ee,A as Te}from"./App-DeydwTFj.js";import{B as T,t as ae,F as q,c as te}from"./react-toastify.esm-DJaDf_tZ.js";import{F as se}from"./PencilIcon-BUreBPew.js";import{F as re}from"./TrashIcon-CCP_IlUH.js";import{F as V}from"./UserIcon-7jPaNw5u.js";import{F as ue}from"./CheckCircleIcon-BRJxgPDr.js";import{c as ne,$ as Ve}from"./useProgressBar-BNTtY2Rs.js";import{F as ze}from"./CheckCircleIcon-Bjd7c9Z9.js";import{F as Oe}from"./ExclamationTriangleIcon-DHpkapK1.js";import{F as Be}from"./EllipsisVerticalIcon-CB3_mbC3.js";import{u as qe}from"./chunk-S574QCAN-CqE2q7NV.js";import{t as Je,a as Ke,b as Qe,c as Ue}from"./chunk-F3UDT23P-jOWee1N-.js";import{t as He,a as Xe}from"./chunk-YRZGWF2W-_qQWbuAO.js";import{S as Ge}from"./StatsCards-J7ErQqG4.js";import{i as J}from"./chunk-SSA7SXE4-CFoa1ngp.js";import{m as xe}from"./chunk-O5MCAK4F-N0e_i_PQ.js";import{F as Ye}from"./ExclamationTriangleIcon-aIxfp1U5.js";import{F as Ze}from"./ChartBarIcon-DgwiIzTE.js";import{F as ea}from"./PlusIcon-vly_2yFN.js";import{m as aa}from"./proxy-lFVLbX3H.js";import"./EnvelopeIcon-CVouYG3i.js";import"./ShieldCheckIcon-DwGf7sJq.js";import"./KeyIcon-BRQMV5c3.js";import"./logo-DXcsmTTZ.js";import"./features-animation-tLJ-KL0g.js";import"./create-visual-element-DcEhP5JW.js";import"./NumberFormatter-DNR9MAW-.js";import"./chunk-XJ2YRSUP-QlzE6No0.js";import"./useToggleState-Dnk57j1c.js";import"./chunk-TLYTI3QM-BmP2YiFh.js";function ta(s){var w,_,d;const n=ye(),[f,x]=Ne(s,ne.variantKeys),{ref:m,as:l,id:C,className:b,classNames:o,label:h,valueLabel:k,value:F=void 0,minValue:L=0,maxValue:N=100,strokeWidth:c,showValueLabel:r=!1,formatOptions:p={style:"percent"},...a}=f,u=l||"div",v=we(m),S=ke(o==null?void 0:o.base,b),[,z]=Ie({rerender:!0,delay:100}),R=((w=s.isIndeterminate)!=null?w:!0)&&F===void 0,M=(d=(_=s.disableAnimation)!=null?_:n==null?void 0:n.disableAnimation)!=null?d:!1,{progressBarProps:O,labelProps:B}=Ve({id:C,label:h,value:F,minValue:L,maxValue:N,valueLabel:k,formatOptions:p,isIndeterminate:R,"aria-labelledby":s["aria-labelledby"],"aria-label":s["aria-label"]}),t=i.useMemo(()=>ne({...x,disableAnimation:M,isIndeterminate:R}),[_e(x),M,R]),g=M?!0:z,j=16,y=c||(s.size==="sm"?2:3),I=16-y,P=2*I*Math.PI,fe=i.useMemo(()=>g?R?.25:F?Ce((F-L)/(N-L),1):0:0,[g,F,L,N,R]),H=P-fe*P,pe=i.useCallback(($={})=>({ref:v,"data-indeterminate":G(R),"data-disabled":G(s.isDisabled),className:t.base({class:S}),...X(O,a,$)}),[v,t,R,s.isDisabled,S,O,a]),ge=i.useCallback(($={})=>({className:t.label({class:o==null?void 0:o.label}),...X(B,$)}),[t,o,B]),be=i.useCallback(($={})=>({viewBox:"0 0 32 32",fill:"none",strokeWidth:y,className:t.svg({class:o==null?void 0:o.svg}),...$}),[y,t,o]),ve=i.useCallback(($={})=>({cx:j,cy:j,r:I,role:"presentation",strokeDasharray:`${P} ${P}`,strokeDashoffset:H,transform:"rotate(-90 16 16)",strokeLinecap:"round",className:t.indicator({class:o==null?void 0:o.indicator}),...$}),[t,o,H,P,I]),je=i.useCallback(($={})=>({cx:j,cy:j,r:I,role:"presentation",strokeDasharray:`${P} ${P}`,strokeDashoffset:0,transform:"rotate(-90 16 16)",strokeLinecap:"round",className:t.track({class:o==null?void 0:o.track}),...$}),[t,o,P,I]);return{Component:u,domRef:v,slots:t,classNames:o,label:h,showValueLabel:r,getProgressBarProps:pe,getLabelProps:ge,getSvgProps:be,getIndicatorProps:ve,getTrackProps:je}}var he=Fe((s,w)=>{const{Component:_,slots:d,classNames:n,label:f,showValueLabel:x,getProgressBarProps:m,getLabelProps:l,getSvgProps:C,getIndicatorProps:b,getTrackProps:o}=ta({ref:w,...s}),h=m();return e.jsxs(_,{...h,children:[e.jsxs("div",{className:d.svgWrapper({class:n==null?void 0:n.svgWrapper}),children:[e.jsxs("svg",{...C(),children:[e.jsx("circle",{...o()}),e.jsx("circle",{...b()})]}),x&&e.jsx("span",{className:d.value({class:n==null?void 0:n.value}),children:h["aria-valuetext"]})]}),f&&e.jsx("span",{...l(),children:f})]})});he.displayName="HeroUI.CircularProgress";var sa=he;const ra=({allData:s,setData:w,loading:_,handleClickOpen:d,openModal:n,setCurrentRow:f,users:x,auth:m})=>{var r,p;const{permissions:l}=Le().props.auth;D("(min-width: 1025px)"),D("(min-width: 641px) and (max-width: 1024px)");const C=D("(max-width: 640px)"),b=()=>{var S;if(typeof window>"u")return"lg";const u=((S=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:S.trim())||"12px",v=parseInt(u);return v===0?"none":v<=4?"sm":v<=8?"md":v<=16?"lg":"full"},o=i.useCallback(()=>{Se.reload({only:["jurisdictions"],onSuccess:()=>{T.success("Work locations data refreshed successfully")}})},[]),h=(l==null?void 0:l.includes("jurisdiction.update"))||((r=m==null?void 0:m.roles)==null?void 0:r.includes("Administrator")),k=(l==null?void 0:l.includes("jurisdiction.delete"))||((p=m==null?void 0:m.roles)==null?void 0:p.includes("Administrator")),F=a=>a.incharge_user?{label:"Active",color:"success",icon:e.jsx(ze,{className:"w-3 h-3"})}:{label:"Pending",color:"warning",icon:e.jsx(Oe,{className:"w-3 h-3"})},L=({location:a})=>{var v;const u=F(a);return e.jsxs(K,{className:"mb-4 bg-content1/80 backdrop-blur-md",children:[e.jsx(ie,{className:"pb-2",children:e.jsxs("div",{className:"flex items-start justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(A,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h6",{className:"font-semibold text-foreground truncate",children:a.location}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsx(te,{size:"sm",variant:"flat",color:u.color,startContent:u.icon,children:u.label})})]})]}),(h||k)&&e.jsxs(We,{placement:"bottom-end",children:[e.jsx($e,{children:e.jsx(W,{variant:"light",size:"sm",isIconOnly:!0,className:"text-default-400",children:e.jsx(Be,{className:"w-4 h-4"})})}),e.jsxs(De,{"aria-label":"Location actions",children:[h&&e.jsx(ee,{startContent:e.jsx(se,{className:"w-4 h-4"}),onPress:()=>{f(a),n("editWorkLocation")},children:"Edit Location"},"edit"),k&&e.jsx(ee,{className:"text-danger",color:"danger",startContent:e.jsx(re,{className:"w-4 h-4"}),onPress:()=>d(a.id,"deleteWorkLocation"),children:"Delete Location"},"delete")]})]})]})}),e.jsx(Q,{}),e.jsx(U,{className:"pt-3",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-default-400"}),e.jsxs("span",{className:"text-sm text-default-500",children:["Chainage: ",a.start_chainage," - ",a.end_chainage]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4 text-default-400"}),e.jsxs("span",{className:"text-sm text-default-500",children:["Incharge: ",((v=a.incharge_user)==null?void 0:v.name)||"Not assigned"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-default-400"}),e.jsxs("span",{className:"text-sm text-default-500",children:["Created: ",new Date(a.created_at).toLocaleDateString()]})]})]})})]},a.id)},N=[{name:"Location",uid:"location",icon:A,sortable:!0},{name:"Start Chainage",uid:"start_chainage",icon:E,sortable:!0},{name:"End Chainage",uid:"end_chainage",icon:E,sortable:!0},{name:"Incharge",uid:"incharge",icon:V,sortable:!0},{name:"Status",uid:"status",icon:ue,sortable:!1},{name:"Created",uid:"created_at",icon:q,sortable:!0},...h||k?[{name:"Actions",uid:"actions",sortable:!1}]:[]],c=i.useCallback((a,u)=>{const v=a[u];switch(u){case"location":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded bg-primary/10",children:e.jsx(A,{className:"w-3 h-3 text-primary"})}),e.jsx("span",{className:"font-medium text-foreground",children:v})]});case"start_chainage":case"end_chainage":return e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{className:"text-sm font-medium text-foreground",children:v})});case"incharge":return e.jsx("div",{className:"flex items-center gap-2",children:a.incharge_user?e.jsx(qe,{name:a.incharge_user.name,description:a.incharge_user.email,avatarProps:{size:"sm",name:a.incharge_user.name,className:"bg-primary/10 text-primary"}}):e.jsxs("div",{className:"flex items-center gap-2 text-default-400",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Not assigned"})]})});case"status":const S=F(a);return e.jsx(te,{size:"sm",variant:"flat",color:S.color,startContent:S.icon,children:S.label});case"created_at":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{className:"text-sm text-default-500",children:new Date(v).toLocaleDateString()})]});case"actions":return e.jsxs("div",{className:"flex items-center gap-2",children:[h&&e.jsx(ae,{content:"Edit location",children:e.jsx(W,{variant:"light",size:"sm",isIconOnly:!0,onPress:()=>{f(a),n("editWorkLocation")},children:e.jsx(se,{className:"w-4 h-4"})})}),k&&e.jsx(ae,{content:"Delete location",color:"danger",children:e.jsx(W,{variant:"light",size:"sm",isIconOnly:!0,color:"danger",onPress:()=>d(a.id,"deleteWorkLocation"),children:e.jsx(re,{className:"w-4 h-4"})})})]});default:return e.jsx("span",{children:v})}},[h,k,f,n,d]);return C?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-default-700",children:"Work Locations"}),e.jsx(W,{variant:"flat",color:"primary",size:"sm",radius:b(),style:{backgroundColor:"rgba(var(--color-primary), 0.1)",borderColor:"rgba(var(--color-primary), 0.3)",color:"var(--color-text)"},onClick:o,startContent:e.jsx(Y,{className:"w-4 h-4"}),children:"Refresh"})]}),e.jsx(Z,{className:"max-h-[70vh]",children:s==null?void 0:s.map(a=>e.jsx(L,{location:a},a.id))})]}):e.jsxs("div",{className:"max-h-[84vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-default-700",children:"Work Locations"}),e.jsx(W,{variant:"flat",color:"primary",size:"sm",radius:b(),style:{backgroundColor:"rgba(var(--color-primary), 0.1)",borderColor:"rgba(var(--color-primary), 0.3)",color:"var(--color-text)"},onClick:o,startContent:e.jsx(Y,{className:"w-4 h-4"}),children:"Refresh"})]}),e.jsx(Z,{className:"max-h-[70vh]",children:e.jsxs(Je,{isStriped:!0,selectionMode:"none",isCompact:!0,isHeaderSticky:!0,removeWrapper:!0,"aria-label":"Work Locations Management Table",classNames:{wrapper:"min-h-[200px]",table:"min-h-[300px]",thead:"[&>tr]:first:shadow-small bg-default-100/80",tbody:"divide-y divide-default-200/50",tr:"group hover:bg-default-50/50 transition-colors h-12",td:"py-2 px-3 text-sm",th:"py-2 px-3 text-xs font-semibold"},children:[e.jsx(He,{columns:N,children:a=>e.jsx(Xe,{align:a.uid==="actions"?"center":"start",className:"bg-default-100/80 backdrop-blur-md",children:e.jsxs("div",{className:"flex items-center gap-1",children:[a.icon&&e.jsx(a.icon,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-semibold",children:a.name})]})},a.uid)}),e.jsx(Ke,{items:s||[],emptyContent:"No work locations found",isLoading:_,loadingContent:e.jsx(sa,{size:40}),children:a=>e.jsx(Qe,{children:u=>e.jsx(Ue,{children:c(a,u)},u)},a.id)})]})})]})},oe=({modalType:s,open:w,closeModal:_,setData:d,currentRow:n,users:f})=>{const[x,m]=i.useState({location:"",start_chainage:"",end_chainage:"",incharge:""}),[l,C]=i.useState(!1),[b,o]=i.useState({}),h=()=>{var a;if(typeof window>"u")return"lg";const r=((a=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:a.trim())||"12px",p=parseInt(r);return p===0?"none":p<=4?"sm":p<=8?"md":p<=16?"lg":"full"};i.useEffect(()=>{m(s==="update"&&n?{location:n.location||"",start_chainage:n.start_chainage||"",end_chainage:n.end_chainage||"",incharge:n.incharge||""}:{location:"",start_chainage:"",end_chainage:"",incharge:""}),o({})},[s,n,w]);const k=(c,r)=>{m(p=>({...p,[c]:r})),b[c]&&o(p=>({...p,[c]:null}))},F=()=>{const c={};return x.location.trim()||(c.location="Location name is required"),x.start_chainage.trim()||(c.start_chainage="Start chainage is required"),x.end_chainage.trim()||(c.end_chainage="End chainage is required"),x.incharge||(c.incharge="Incharge is required"),o(c),Object.keys(c).length===0},L=async()=>{if(!F())return;C(!0);const c=s==="add"?"/work-locations/add":"/work-locations/update",r="POST",p=s==="update"?{...x,id:n.id}:x;try{const a=await fetch(c,{method:r,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify(p)}),u=await a.json();a.ok?(d(u.work_locations),T.success(u.message||`Work location ${s==="add"?"added":"updated"} successfully!`),_()):u.error&&typeof u.error=="object"?o(u.error):T.error(u.error||"An error occurred")}catch{T.error("Network error occurred. Please try again.")}finally{C(!1)}},N=()=>{l||_()};return e.jsx(le,{isOpen:w,onClose:N,size:"lg",placement:"center",classNames:{base:"bg-content1",backdrop:"bg-black/50 backdrop-blur-sm",header:"border-b border-divider",footer:"border-t border-divider",closeButton:"hover:bg-default-100 text-default-500 hover:text-default-700"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsx(ce,{children:c=>e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"flex flex-col gap-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",color:"var(--theme-primary)"},children:e.jsx(A,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:s==="add"?"Add New Work Location":"Edit Work Location"}),e.jsx("p",{className:"text-sm text-default-500",children:s==="add"?"Create a new work location with jurisdiction details":"Update work location information and assignments"})]})]})}),e.jsx(me,{className:"py-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Location Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"Enter work location name",value:x.location,onChange:r=>k("location",r.target.value),variant:"bordered",radius:h(),startContent:e.jsx(A,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                         focus-within:bg-content2/90 border-divider/50 
                                                         hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'},isInvalid:!!b.location,errorMessage:b.location})]}),e.jsx(Q,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Start Chainage ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"e.g., 0+000",value:x.start_chainage,onChange:r=>k("start_chainage",r.target.value),variant:"bordered",radius:h(),startContent:e.jsx(E,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                             focus-within:bg-content2/90 border-divider/50 
                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'},isInvalid:!!b.start_chainage,errorMessage:b.start_chainage})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["End Chainage ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"e.g., 5+000",value:x.end_chainage,onChange:r=>k("end_chainage",r.target.value),variant:"bordered",radius:h(),startContent:e.jsx(E,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                             focus-within:bg-content2/90 border-divider/50 
                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'},isInvalid:!!b.end_chainage,errorMessage:b.end_chainage})]})]}),e.jsx(Q,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Location Incharge ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(Ae,{placeholder:"Select an incharge",selectedKeys:x.incharge?[x.incharge.toString()]:[],onSelectionChange:r=>{const p=Array.from(r)[0];k("incharge",p||"")},variant:"bordered",radius:h(),startContent:e.jsx(V,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:`bg-content2/50 hover:bg-content2/70 
                                                     focus-within:bg-content2/90 border-divider/50 
                                                     hover:border-divider data-[focus]:border-primary`,value:"text-foreground"},style:{fontFamily:'var(--fontFamily, "Inter")'},isInvalid:!!b.incharge,errorMessage:b.incharge,children:f==null?void 0:f.map(r=>e.jsx(Me,{value:r.id,textValue:r.name,children:r.name},r.id))})]})]})}),e.jsxs(xe,{children:[e.jsx(W,{color:"danger",variant:"light",onPress:N,disabled:l,radius:h(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(W,{color:"primary",onPress:L,isLoading:l,radius:h(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:s==="add"?"Add Location":"Update Location"})]})]})})})},na=({open:s,handleClose:w,handleDelete:_})=>{const d=()=>{var l;if(typeof window>"u")return"lg";const x=((l=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:l.trim())||"12px",m=parseInt(x);return m===0?"none":m<=4?"sm":m<=8?"md":m<=16?"lg":"full"},n=()=>{_(),w()};return e.jsx(le,{isOpen:s,onClose:w,size:"md",placement:"center",classNames:{base:"bg-content1",backdrop:"bg-black/50 backdrop-blur-sm",header:"border-b border-divider",footer:"border-t border-divider",closeButton:"hover:bg-default-100 text-default-500 hover:text-default-700"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsx(ce,{children:f=>e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"flex flex-col gap-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-danger/10",children:e.jsx(Ye,{className:"w-5 h-5 text-danger"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Delete Work Location"}),e.jsx("p",{className:"text-sm text-default-500",children:"This action cannot be undone"})]})]})}),e.jsx(me,{className:"py-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-danger/5 border border-danger/20",children:[e.jsx("p",{className:"text-sm text-foreground mb-2",children:"Are you sure you want to delete this work location?"}),e.jsx("p",{className:"text-xs text-default-500",children:"This will permanently remove the work location from the system. Any associated daily works or reports may be affected."})]}),e.jsxs("div",{className:"text-xs text-default-400",children:[e.jsx("strong",{children:"Note:"})," Make sure to reassign any ongoing work or responsibilities before deleting this location."]})]})}),e.jsxs(xe,{children:[e.jsx(W,{color:"default",variant:"light",onPress:w,radius:d(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(W,{color:"danger",onPress:n,radius:d(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Delete Location"})]})]})})})},oa=Pe.memo(({auth:s,title:w,jurisdictions:_,users:d})=>{const n=D("(min-width: 1025px)"),f=D("(min-width: 641px) and (max-width: 1024px)"),x=D("(max-width: 640px)"),m=()=>{var y;if(typeof window>"u")return"lg";const g=((y=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:y.trim())||"12px",j=parseInt(g);return j===0?"none":j<=4?"sm":j<=8?"md":j<=16?"lg":"full"},[l,C]=i.useState(_||[]),[b,o]=i.useState(!1),[h,k]=i.useState(),[F,L]=i.useState(null),[N,c]=i.useState(null),[r,p]=i.useState(""),a=i.useCallback(t=>{p(t.target.value)},[]),u=()=>{const t=new Promise(async(g,j)=>{try{const y=await fetch("/work-locations/delete",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({id:F})});if(y.ok){const I=await y.json();C(I.work_locations),g("Work location deleted successfully!")}else j("Failed to delete work location. Please try again.")}catch{j("Failed to delete work location. Please try again.")}});T.promise(t,{pending:"Deleting work location...",success:{render({data:g}){return e.jsx(e.Fragment,{children:g})}},error:{render({data:g}){return e.jsx(e.Fragment,{children:g})}}})},v=i.useCallback((t,g)=>{L(t),c(g)},[]),S=i.useCallback(()=>{c(null),L(null)},[]),z=i.useCallback(t=>{c(t)},[]),R=i.useCallback(()=>{c(null)},[]),M=i.useMemo(()=>{const t=l.length,g=l.filter(y=>y.incharge_user).length,j=l.filter(y=>!y.incharge_user).length;return[{title:"Total Locations",value:t,icon:e.jsx(Ze,{className:"w-5 h-5"}),color:"text-blue-600",description:"All work locations"},{title:"Active",value:g,icon:e.jsx(ue,{className:"w-5 h-5"}),color:"text-green-600",description:"With assigned staff"},{title:"Pending",value:j,icon:e.jsx(q,{className:"w-5 h-5"}),color:"text-orange-600",description:"Needs assignment"},{title:"Staff",value:(d==null?void 0:d.length)||0,icon:e.jsx(V,{className:"w-5 h-5"}),color:"text-purple-600",description:"Available staff"}]},[l,d]),O=[...s.roles.includes("Administrator")||s.permissions.includes("jurisdiction.create")?[{label:"Add Location",icon:e.jsx(ea,{className:"w-4 h-4"}),onPress:()=>z("addWorkLocation"),className:"bg-linear-to-r from-blue-500 to-purple-500 text-white font-medium"}]:[]],B=i.useMemo(()=>r?l.filter(t=>{var g,j,y,I,P;return((g=t.location)==null?void 0:g.toLowerCase().includes(r.toLowerCase()))||((j=t.start_chainage)==null?void 0:j.toLowerCase().includes(r.toLowerCase()))||((y=t.end_chainage)==null?void 0:y.toLowerCase().includes(r.toLowerCase()))||((P=(I=t.incharge_user)==null?void 0:I.name)==null?void 0:P.toLowerCase().includes(r.toLowerCase()))}):l,[l,r]);return e.jsxs(e.Fragment,{children:[e.jsx(Re,{title:w}),N==="addWorkLocation"&&e.jsx(oe,{modalType:"add",open:N==="addWorkLocation",setData:C,closeModal:R,users:d}),N==="editWorkLocation"&&e.jsx(oe,{modalType:"update",open:N==="editWorkLocation",currentRow:h,setData:C,closeModal:R,users:d}),N==="deleteWorkLocation"&&e.jsx(na,{open:N==="deleteWorkLocation",handleClose:S,handleDelete:u}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(aa.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full max-w-[2000px]",children:e.jsxs(K,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                var(--theme-content1, #FAFAFA) 20%, 
                                var(--theme-content2, #F4F4F5) 10%, 
                                var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(ie,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                    color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                    color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${n?"p-6":f?"p-4":"p-3"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                    ${n?"p-3":f?"p-2.5":"p-2"} 
                                                    rounded-xl flex items-center justify-center
                                                `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(A,{className:`
                                                        ${n?"w-8 h-8":f?"w-6 h-6":"w-5 h-5"}
                                                    `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                        ${n?"text-2xl":f?"text-xl":"text-lg"}
                                                        font-bold text-foreground
                                                        ${n?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Work Locations Management"}),e.jsx("p",{className:`
                                                        ${n?"text-sm":"text-xs"} 
                                                        text-default-500
                                                        ${n?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Manage jurisdictions and work location assignments"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex items-center gap-2",children:O.map((t,g)=>e.jsx(W,{size:n?"md":"sm",variant:t.variant||"flat",color:t.color||"primary",startContent:t.icon,onPress:t.onPress,className:`${t.className||""} font-medium`,style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)"},children:t.label},g))})})]})})})}),e.jsxs(U,{className:"pt-6",children:[e.jsx(Ge,{stats:M}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"w-full sm:w-auto sm:min-w-[300px]",children:e.jsx(J,{type:"text",placeholder:"Search by location, chainage, or incharge...",value:r,onChange:t=>a(t),variant:"bordered",size:x?"sm":"md",radius:m(),startContent:e.jsx(Ee,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                         focus-within:bg-content2/90 border-divider/50 
                                                         hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)"}})})}),e.jsx(K,{radius:m(),className:"bg-content2/50 backdrop-blur-md border border-divider/30",style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)",backgroundColor:"var(--theme-content2)",borderColor:"var(--theme-divider)"},children:e.jsx(U,{className:"p-4",children:e.jsx(ra,{allData:B,setData:C,loading:b,setLoading:o,handleClickOpen:v,openModal:z,setCurrentRow:k,users:d,auth:s})})})]})]})})})]})});oa.layout=s=>e.jsx(Te,{children:s});export{oa as default};
