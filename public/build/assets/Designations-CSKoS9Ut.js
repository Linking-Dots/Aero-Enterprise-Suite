import{u as ie,r as o,j as e,G as _e,c as R,a as A,H as De}from"./app-CmFfjWsP.js";import{u as le,T,B as H,G as Ne}from"./logo-Bb-VUmpc.js";import{P as Ce}from"./PageHeader-VPvENNef.js";import{S as Pe}from"./StatsCards-DlhJAGRq.js";import{z as V,D as Se,E as Te,H as Ee,J as G,c as Fe,K as Ie,u as U,I as ce,L as de,k as I,l as Ae,N as ke,O as Me,B as D,e as Re,A as Be,G as $e,h as ze}from"./App-DKNf4kbj.js";import"./dayjs.min-Yb-mO8Jg.js";import{N as Le}from"./NoDataMessage-DTSaGzbI.js";import{F as se}from"./EyeIcon-DH514du3.js";import{F as te}from"./PencilIcon-G8jhViOO.js";import{F as ae}from"./TrashIcon-BNDxSKX0.js";import{F as Oe}from"./EllipsisVerticalIcon-DYnqK8rG.js";import{F as me}from"./CheckCircleIcon-DcAHPOOH.js";import{F as ue}from"./XCircleIcon-DRvI_4Zc.js";import{t as Ge,a as We,b as He,c as Ve,d as Ue,e as Ye}from"./chunk-F3UDT23P-DZAw_N80.js";import{p as qe}from"./chunk-EAPQ7RWQ-DgLMMHg6.js";import{t as W}from"./chunk-BOOVDPB6-DSWITBr2.js";import{G as Je}from"./GlassDialog-C5_CkNH7.js";import{D as he}from"./DialogTitle-JICgBhou.js";import{D as B}from"./Divider-BqW5YimP.js";import{D as pe,a as xe}from"./DialogContent-RSy4PdMH.js";import{T as Qe,I as Ke,F as re}from"./TextField-CZkJRVYj.js";import{S as Xe,M as ne}from"./Select-D2ehSAHQ.js";import{B as $}from"./Button-CPbP042r.js";import{D as Ze}from"./Dialog-ydNep9GA.js";import{F as es}from"./ExclamationTriangleIcon-DVI7Fufz.js";import{A as oe}from"./Alert-Dm1ESiov.js";import{C as fe}from"./CircularProgress-BjwqTAiA.js";import{F as ss}from"./PlusIcon-CjH05r6-.js";import{i as ts}from"./chunk-SSA7SXE4-DCTIi96t.js";import"./create-visual-element-CNNoQd8i.js";import"./chunk-D5XJWRAV-D-wO4tV2.js";import"./EnvelopeIcon-B03bj0NI.js";import"./UserIcon-C42ICOt3.js";import"./ShieldCheckIcon-B_1qhU2x.js";import"./useHasTabbableChild-mvVqOm0Y.js";import"./index-8-ppjCsZ.js";import"./index-CokAva9Y.js";import"./Popover-BA5NTheW.js";import"./useSlot-DSwTWDBd.js";const as=({designations:i,onEdit:n,onDelete:N,onView:r,loading:c,isMobile:y,isTablet:d,pagination:a,onPageChange:v,onRowsPerPageChange:m,canEditDesignation:j=!1,canDeleteDesignation:x=!1})=>{var w,g;const{auth:p}=ie().props,u=j||((w=p.permissions)==null?void 0:w.includes("designations.update"))||!1,l=x||((g=p.permissions)==null?void 0:g.includes("designations.delete"))||!1,S=o.useMemo(()=>[{name:"TITLE",uid:"title"},{name:"DEPARTMENT",uid:"department_name"},{name:"EMPLOYEES",uid:"employee_count"},{name:"STATUS",uid:"status"},{name:"ACTIONS",uid:"actions"}],[]),b=(t,P)=>{switch(P){case"title":return e.jsx("span",{className:"font-semibold text-foreground",children:t.title});case"department_name":return e.jsx("span",{className:"text-default-500",children:t.department_name||"-"});case"employee_count":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:t.employee_count||0})]});case"status":return e.jsx(Fe,{size:"sm",variant:t.is_active?"solid":"bordered",color:t.is_active?"success":"danger",startContent:t.is_active?e.jsx(me,{className:"w-3 h-3"}):e.jsx(ue,{className:"w-3 h-3"}),children:t.is_active?"Active":"Inactive"});case"actions":return e.jsx("div",{className:"flex justify-end items-center",children:y?e.jsxs(Se,{children:[e.jsx(Te,{children:e.jsx(R,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(Oe,{className:"w-4 h-4"})})}),e.jsxs(Ee,{"aria-label":"Designation actions",children:[e.jsx(G,{startContent:e.jsx(se,{className:"w-4 h-4"}),onPress:()=>r(t),children:"View Details"},"view"),u&&e.jsx(G,{startContent:e.jsx(te,{className:"w-4 h-4"}),onPress:()=>n(t),children:"Edit Designation"},"edit"),l&&e.jsx(G,{className:"text-danger",color:"danger",startContent:e.jsx(ae,{className:"w-4 h-4"}),isDisabled:t.employee_count>0,onPress:()=>N(t),children:"Delete Designation"},"delete")]})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{content:"View Designation",children:e.jsx(R,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>r(t),children:e.jsx(se,{className:"w-4 h-4"})})}),u&&e.jsx(W,{content:"Edit Designation",children:e.jsx(R,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-blue-500",onPress:()=>n(t),children:e.jsx(te,{className:"w-4 h-4"})})}),l&&e.jsx(W,{content:t.employee_count>0?"Cannot delete designation with employees":"Delete Designation",children:e.jsx(R,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-danger",isDisabled:t.employee_count>0,onPress:()=>N(t),children:e.jsx(ae,{className:"w-4 h-4"})})})]})});default:return e.jsx("span",{children:t[P]})}},f=()=>!i||!i.data||c?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(a.currentPage-1)*a.perPage+1," to ",Math.min(a.currentPage*a.perPage,i.total)," of ",i.total," designations"]}),e.jsx(qe,{total:Math.ceil(i.total/a.perPage),initialPage:a.currentPage,page:a.currentPage,onChange:v,size:y?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]});return!c&&(!i||!i.data||i.data.length===0)?e.jsx("div",{className:"w-full",children:e.jsx(Le,{message:"No designations found",icon:e.jsx(V,{className:"w-12 h-12 text-default-300"}),description:"Try adjusting your search or filters"})}):e.jsx("div",{className:"w-full",children:e.jsxs(Ge,{"aria-label":"Designations table",removeWrapper:!0,classNames:{base:"bg-transparent",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs",td:"border-b border-white/5 py-3"},bottomContent:f(),children:[e.jsx(We,{columns:S,children:t=>e.jsx(He,{children:t.name},t.uid)}),e.jsx(Ve,{items:i.data||[],emptyContent:!c&&"No designations found",loadingContent:e.jsx(_e,{}),isLoading:c,children:t=>e.jsx(Ue,{children:P=>e.jsx(Ye,{children:b(t,P)})},t.id)})]})})},rs=({open:i,onClose:n,onSuccess:N,designation:r=null,departments:c=[]})=>{var b;const y=le(),d=U(y.breakpoints.down("md")),[a,v]=o.useState(!1),[m,j]=o.useState({}),x={title:"",department_id:"",is_active:!0},[p,u]=o.useState(x);o.useEffect(()=>{u(r?{title:r.title||"",department_id:r.department_id||"",is_active:r.is_active??!0}:x),j({})},[r,i]);const l=f=>{const{name:w,value:g,type:t,checked:P}=f.target;u(C=>({...C,[w]:t==="checkbox"?P:g})),m[w]&&j(C=>({...C,[w]:null}))},S=async()=>{var f,w;v(!0),j({});try{const g={...p};let t;r!=null&&r.id?(t=await A.put(`/designations/${r.id}`,g),D.success("Designation updated successfully")):(t=await A.post("/designations",g),D.success("Designation created successfully")),N(t.data.designation),n()}catch(g){if((w=(f=g.response)==null?void 0:f.data)!=null&&w.errors){j(g.response.data.errors);const t=Object.values(g.response.data.errors)[0];t&&D.error(t[0])}else D.error("An error occurred while saving the designation")}finally{v(!1)}};return e.jsxs(Je,{open:i,onClose:a?void 0:n,maxWidth:"sm",fullWidth:!0,fullScreen:d,"aria-labelledby":"designation-form-dialog",children:[e.jsxs(he,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(T,{variant:"h6",component:"div",children:r?"Edit Designation":"Create New Designation"}),e.jsx(ce,{edge:"end",color:"inherit",onClick:n,disabled:a,"aria-label":"close",children:e.jsx(de,{className:"w-5 h-5"})})]}),e.jsx(B,{}),e.jsx(pe,{sx:{pt:2},children:e.jsxs(I,{container:!0,spacing:3,children:[e.jsx(I,{item:!0,xs:12,children:e.jsx(T,{variant:"subtitle1",color:"primary",gutterBottom:!0,children:"Designation Information"})}),e.jsx(I,{item:!0,xs:12,md:6,children:e.jsx(Qe,{name:"title",label:"Designation Title",fullWidth:!0,required:!0,value:p.title,onChange:l,error:!!m.title,helperText:((b=m.title)==null?void 0:b[0])||"",disabled:a})}),e.jsx(I,{item:!0,xs:12,md:6,children:e.jsxs(Ae,{fullWidth:!0,error:!!m.department_id,children:[e.jsx(Ke,{id:"department-label",children:"Department"}),e.jsxs(Xe,{labelId:"department-label",name:"department_id",value:p.department_id,onChange:l,label:"Department",disabled:a,children:[e.jsx(ne,{value:"",children:e.jsx("em",{children:"Select Department"})}),c.map(f=>e.jsx(ne,{value:f.id,children:f.name},f.id))]}),m.department_id&&e.jsx(re,{children:m.department_id[0]})]})}),e.jsxs(I,{item:!0,xs:12,children:[e.jsx(ke,{control:e.jsx(Me,{checked:p.is_active,onChange:l,name:"is_active",color:"success",disabled:a}),label:"Designation is active"}),m.is_active&&e.jsx(re,{error:!0,children:m.is_active[0]})]})]})}),e.jsx(B,{}),e.jsxs(xe,{sx:{px:3,py:2},children:[e.jsx($,{onClick:n,disabled:a,color:"inherit",children:"Cancel"}),e.jsx($,{onClick:S,variant:"contained",color:"primary",disabled:a,children:a?"Saving...":r?"Update Designation":"Create Designation"})]})]})},ns=({open:i,onClose:n,onSuccess:N,designation:r})=>{const[c,y]=o.useState(!1),[d,a]=o.useState(null),v=async()=>{var m,j,x,p;if(r){y(!0),a(null);try{await A.delete(`/hr/designations/${r.id}`),D.success("Designation deleted successfully"),N(),n()}catch(u){if((j=(m=u.response)==null?void 0:m.data)!=null&&j.message)a(u.response.data.message),D.error(u.response.data.message);else if((p=(x=u.response)==null?void 0:x.data)!=null&&p.errors){const l=Object.values(u.response.data.errors)[0];a(l),D.error(l)}else a("An error occurred while deleting the designation"),D.error("An error occurred while deleting the designation")}finally{y(!1)}}};return r?e.jsxs(Ze,{open:i,onClose:c?void 0:n,maxWidth:"sm",fullWidth:!0,"aria-labelledby":"delete-designation-dialog",children:[e.jsxs(he,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(T,{variant:"h6",children:"Delete Designation"}),e.jsx(ce,{edge:"end",color:"inherit",onClick:n,disabled:c,"aria-label":"close",children:e.jsx(de,{className:"w-5 h-5"})})]}),e.jsx(B,{}),e.jsx(pe,{children:e.jsxs(H,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(H,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(es,{className:"w-8 h-8 text-yellow-500"}),e.jsxs(T,{variant:"body1",children:["Are you sure you want to delete the designation ",e.jsx("strong",{children:r.title}),"?"]})]}),r.employee_count>0&&e.jsxs(oe,{severity:"warning",sx:{mt:2},children:["This designation has ",r.employee_count," employees assigned to it. You cannot delete a designation with active employees. Please reassign these employees to other designations first."]}),d&&e.jsx(oe,{severity:"error",sx:{mt:2},children:d}),e.jsx(T,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"This action cannot be undone. All associated data will be permanently removed."})]})}),e.jsx(B,{}),e.jsxs(xe,{sx:{px:3,py:2},children:[e.jsx($,{onClick:n,disabled:c,color:"inherit",children:"Cancel"}),e.jsx($,{onClick:v,variant:"contained",color:"error",disabled:c||r.employee_count>0,startIcon:c&&e.jsx(fe,{size:20,color:"inherit"}),children:c?"Deleting...":"Delete Designation"})]})]}):null},Vs=({title:i,initialDesignations:n,departments:N,managers:r,parentDesignations:c,stats:y,filters:d})=>{var X,Z,ee;const{auth:a}=ie().props,v=le(),m=U(v.breakpoints.down("sm"));U(v.breakpoints.down("md"));const[j,x]=o.useState(n||{data:[]}),[p,u]=o.useState(!1),[l,S]=o.useState({type:null,designation:null}),[b,f]=o.useState({search:(d==null?void 0:d.search)||"",status:(d==null?void 0:d.status)||"all",parentDesignation:(d==null?void 0:d.parentDesignation)||"all"}),[w,g]=o.useState(!1),[t,P]=o.useState("table"),[C,z]=o.useState({currentPage:(n==null?void 0:n.current_page)||1,perPage:(n==null?void 0:n.per_page)||10}),[E,ge]=o.useState(y||{total:0,active:0,inactive:0,parent_designations:0}),Y=((X=a.permissions)==null?void 0:X.includes("designations.create"))||!1,q=((Z=a.permissions)==null?void 0:Z.includes("designations.update"))||!1,J=((ee=a.permissions)==null?void 0:ee.includes("designations.delete"))||!1,L=o.useCallback(async()=>{u(!0);try{const s=await A.get(route("designations.json"),{params:{page:C.currentPage,per_page:C.perPage,search:b.search,status:b.status,parent_designation:b.parentDesignation}});x(s.data.designations||s.data)}catch(s){console.error("Error fetching designations:",s),D.error("Failed to load designations data")}finally{u(!1)}},[C,b]),O=o.useCallback(async()=>{try{const s=await A.get(route("designations.stats"));s.status===200&&ge(s.data.stats)}catch(s){console.error("Error fetching designation stats:",s)}},[]);o.useEffect(()=>{L(),O()},[L,O]);const je=(s,_)=>{f(h=>({...h,[s]:_})),z(h=>({...h,currentPage:1}))},be=s=>{z(_=>({..._,currentPage:s})),window.scrollTo({top:0,behavior:"smooth"})},we=s=>{z({currentPage:1,perPage:s})},k=(s,_=null)=>{S({type:s,designation:_})},Q=()=>{S({type:null,designation:null})},K=(s=null,_=null)=>{_==="add"&&s?x(h=>{const F=[s,...h.data];return{...h,data:F,total:(h.total||0)+1}}):_==="edit"&&s?x(h=>{const F=h.data.map(M=>M.id===s.id?s:M);return{...h,data:F}}):_==="delete"&&s?x(h=>{const F=h.data.filter(M=>M.id!==s.id);return{...h,data:F,total:(h.total||1)-1}}):(L(),O())},ye=o.useMemo(()=>[{title:"Total Designations",value:E.total,icon:e.jsx(V,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All designations"},{title:"Active",value:E.active,icon:e.jsx(me,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Active designations"},{title:"Inactive",value:E.inactive,icon:e.jsx(ue,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Inactive designations"},{title:"Parent Designations",value:E.parent_designations,icon:e.jsx(Re,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Top-level designations"}],[E]),ve=o.useMemo(()=>{const s=[];return Y&&s.push({label:m?"Add":"Add Designation",icon:e.jsx(ss,{className:"w-4 h-4"}),onPress:()=>k("add_designation"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),s},[Y,m]);return e.jsxs(Be,{children:[e.jsx(De,{title:i}),e.jsx(H,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx($e,{in:!0,timeout:800,children:e.jsx(Ne,{children:e.jsx(Ce,{title:"Designation Management",subtitle:"Manage company designations and hierarchy",icon:e.jsx(V,{className:"w-8 h-8"}),variant:"default",actionButtons:ve,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(Pe,{stats:ye,className:"mb-6"}),e.jsx("div",{className:"mb-6",children:e.jsx(ts,{label:"Search",placeholder:"Search designations...",value:b.search,onValueChange:s=>je("search",s),startContent:e.jsx(ze,{className:"w-4 h-4"}),size:"md"})}),e.jsx("div",{children:p?e.jsxs("div",{className:"text-center py-6",children:[e.jsx(fe,{size:40}),e.jsx(T,{className:"mt-4",children:"Loading..."})]}):e.jsx(as,{designations:j,loading:p,onEdit:q?s=>k("edit_designation",s):void 0,onDelete:J?s=>k("delete_designation",s):void 0,onView:s=>k("view_designation",s),pagination:C,onPageChange:be,onRowsPerPageChange:we,canEditDesignation:q,canDeleteDesignation:J})})]})})})})}),(l.type==="add_designation"||l.type==="edit_designation")&&e.jsx(rs,{open:!0,departments:N,onClose:Q,onSuccess:s=>K(s,l.type==="add_designation"?"add":"edit"),designation:l.designation,managers:r,parentDesignations:c}),l.type==="delete_designation"&&e.jsx(ns,{open:!0,onClose:Q,onSuccess:s=>K(s,"delete"),designation:l.designation})]})};export{Vs as default};
