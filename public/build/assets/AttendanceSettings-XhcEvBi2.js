import{r as c,j as e,H as Z,e as I,b as g,k as D,a as v}from"./app-D00qZUV_.js";import{u as ee,e as M,s as ae,A as re}from"./App-CBKq6AfW.js";import{G as N}from"./logo-CkhZy88E.js";import{c as te,B as p}from"./react-toastify.esm-_Te1n1pU.js";import{m as A}from"./proxy-CATldSAx.js";import{F as oe}from"./PencilSquareIcon-Bpd0imLl.js";import{F as L}from"./MapPinIcon-Dd1qwX3z.js";import{F as ne}from"./TrashIcon-CvN3eJJC.js";import{F as se}from"./PlusIcon-E5ITwJiX.js";import{u as O}from"./index-HziR83Z9.js";import{i as h}from"./chunk-SSA7SXE4-9JcL3FLw.js";import"./EnvelopeIcon-C2ghq-ql.js";import"./UserIcon-Bhn9e0vt.js";import"./ShieldCheckIcon-BL5m_bNY.js";import"./KeyIcon-C5wjYuzk.js";import"./features-animation-DlKdVSZX.js";import"./create-visual-element-C0h919DM.js";import"./CheckCircleIcon-B_eFrWu0.js";import"./ExclamationTriangleIcon-Tjm5PGF2.js";import"./index-Cubd-ssQ.js";const ie=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],le=({title:b,attendanceSettings:R,attendanceTypes:P})=>{ee("(max-width: 768px)");const[t,G]=c.useState(R||{}),[y,w]=c.useState(P||[]),C=O(),T=O(),[s,f]=c.useState(null),[j,F]=c.useState({config:{}}),[l,u]=c.useState({tolerance:100,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]}),[d,E]=c.useState({office_start_time:(t==null?void 0:t.office_start_time)||"09:00",office_end_time:(t==null?void 0:t.office_end_time)||"18:00",break_time_duration:(t==null?void 0:t.break_time_duration)||60,late_mark_after:(t==null?void 0:t.late_mark_after)||15,early_leave_before:(t==null?void 0:t.early_leave_before)||15,overtime_after:(t==null?void 0:t.overtime_after)||30,auto_punch_out:(t==null?void 0:t.auto_punch_out)??!1,auto_punch_out_time:(t==null?void 0:t.auto_punch_out_time)||"20:00",weekend_days:(t==null?void 0:t.weekend_days)||["saturday","sunday"]}),[$,W]=c.useState(!1),[n,S]=c.useState({}),x=(a,r)=>{E(o=>({...o,[a]:r}))},z=async a=>{a.preventDefault(),W(!0);try{const r=await v.post(route("attendance-settings.update"),d);r.status===200&&(G(r.data.attendanceSettings),S({}),p.success(r.data.message||"Attendance settings updated successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}))}catch(r){r.response&&r.response.status===422?(S(r.response.data.errors||{}),p.error(r.response.data.error||"Failed to update attendance settings.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}})):p.error("An unexpected error occurred. Please try again later.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}})}finally{W(!1)}},H=a=>{a.slug==="route-waypoint"||a.name.toLowerCase().includes("waypoint")||a.name.toLowerCase().includes("route")?J(a):(f(a),F({config:a.config||{}}),C.onOpen())},k=()=>C.onClose(),U=(a,r)=>{F(o=>({...o,config:{...o.config,[a]:r}}))},q=async()=>{if(!s)return;const a=await v.post(route("attendance-types.update",s.id),{config:j.config});w(y.map(r=>r.id===s.id?a.data.attendanceType:r)),k()},J=(a=null)=>{var r,o;if(a){f(a);const i=((r=a.config)==null?void 0:r.waypoints)||[],m=((o=a.config)==null?void 0:o.tolerance)||100;i.length>0?u({tolerance:m,waypoints:i}):u({tolerance:m,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]})}T.onOpen()},_=()=>{T.onClose(),f(null),u({tolerance:100,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]})},B=(a,r,o)=>{u(i=>({...i,waypoints:i.waypoints.map((m,Y)=>Y===a?{...m,[r]:o}:m)}))},Q=()=>{u(a=>({...a,waypoints:[...a.waypoints,{lat:"",lng:""}]}))},V=a=>{l.waypoints.length>2&&u(r=>({...r,waypoints:r.waypoints.filter((o,i)=>i!==a)}))},K=a=>{u(r=>({...r,tolerance:a}))},X=async()=>{const a=l.waypoints.filter(r=>r.lat&&r.lng);if(a.length===0){p.error("Please add at least one valid waypoint.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}});return}if(!l.tolerance||l.tolerance<=0){p.error("Please enter a valid tolerance value.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}});return}try{if(s){const r={...s.config,tolerance:l.tolerance,waypoints:a},o=await v.post(route("attendance-types.update",s.id),{config:r});w(y.map(i=>i.id===s.id?o.data.attendanceType:i)),p.success("Waypoints updated successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}})}else p.success("Waypoints saved successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}});_()}catch{p.error("Failed to save waypoints.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}})}};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{title:b}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-7xl w-full",children:[e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full",children:e.jsxs(N,{children:[e.jsx(M,{className:"pb-0",children:e.jsx("h3",{className:"text-xl font-bold",children:"Attendance Settings"})}),e.jsxs("form",{onSubmit:z,children:[e.jsxs(I,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Office Timing"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(h,{label:"Office Start Time",type:"time",value:d.office_start_time,onChange:a=>x("office_start_time",a.target.value),isInvalid:!!n.office_start_time,errorMessage:n.office_start_time}),e.jsx(h,{label:"Office End Time",type:"time",value:d.office_end_time,onChange:a=>x("office_end_time",a.target.value),fullWidth:!0,InputLabelProps:{shrink:!0},error:!!n.office_end_time,helperText:n.office_end_time})]}),e.jsx("div",{children:e.jsx(h,{label:"Break Time Duration (minutes)",type:"number",value:d.break_time_duration,onChange:a=>x("break_time_duration",parseInt(a.target.value)),isInvalid:!!n.break_time_duration,errorMessage:n.break_time_duration})}),e.jsx("div",{children:e.jsx(h,{label:"Late Mark After (minutes)",type:"number",value:d.late_mark_after,onChange:a=>x("late_mark_after",parseInt(a.target.value)),isInvalid:!!n.late_mark_after,errorMessage:n.late_mark_after})})]}),e.jsx(Typography,{variant:"h6",gutterBottom:!0,sx:{marginTop:2},children:"Attendance Rules"}),e.jsxs(Grid,{container:!0,spacing:3,children:[e.jsx(Grid,{item:!0,xs:12,sm:6,children:e.jsx(TextField,{label:"Early Leave Before (minutes)",type:"number",value:d.early_leave_before,onChange:a=>x("early_leave_before",parseInt(a.target.value)),fullWidth:!0,error:!!n.early_leave_before,helperText:n.early_leave_before})}),e.jsx(Grid,{item:!0,xs:12,sm:6,children:e.jsx(TextField,{label:"Overtime After (minutes)",type:"number",value:d.overtime_after,onChange:a=>x("overtime_after",parseInt(a.target.value)),fullWidth:!0,error:!!n.overtime_after,helperText:n.overtime_after})})]}),e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Weekend Settings"}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx("div",{children:e.jsxs(FormControl,{fullWidth:!0,children:[e.jsx(InputLabel,{id:"weekend-days",children:"Weekend Days"}),e.jsx(ae,{labelId:"weekend-days",multiple:!0,value:d.weekend_days,onChange:a=>x("weekend_days",a.target.value),input:e.jsx(OutlinedInput,{label:"Weekend Days"}),error:!!n.weekend_days,renderValue:a=>e.jsx(Box,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:a.map(r=>e.jsx(te,{label:r.charAt(0).toUpperCase()+r.slice(1)},r))}),MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:ie.map(a=>e.jsx(MenuItem,{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))}),n.weekend_days&&e.jsx("p",{className:"text-xs text-danger mt-1",children:n.weekend_days})]})})})]}),e.jsx("div",{className:"flex justify-center px-6 pb-6",children:e.jsx(g,{isLoading:$,color:"primary",variant:"solid",type:"submit",className:"rounded-full px-8 py-3",children:"Save"})})]})]})}),e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full",children:e.jsxs(N,{children:[e.jsx(M,{title:"Attendance Types"}),e.jsx(I,{children:e.jsx("div",{className:"space-y-4",children:y.map(a=>e.jsx("div",{children:e.jsxs(Box,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderRadius:3,background:"rgba(255,255,255,0.12)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.18)",backdropFilter:"blur(12px) saturate(180%)",transition:"box-shadow 0.2s","&:hover":{boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.18)"}},children:[e.jsxs(Box,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(Box,{sx:{mr:1},children:a.icon}),e.jsxs(Box,{children:[e.jsx(Typography,{variant:"subtitle1",sx:{fontWeight:600},children:a.name}),e.jsx(Typography,{variant:"body2",color:"text.secondary",children:a.description}),e.jsxs(Typography,{variant:"caption",color:"text.secondary",children:["Slug: ",a.slug]}),e.jsxs(Typography,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5},children:["Config: ",JSON.stringify(a.config)]})]})]}),e.jsx(Box,{children:e.jsx(IconButton,{onClick:()=>H(a),children:e.jsx(oe,{style:{width:20,height:20,color:theme.palette.primary.main}})})})]})},a.id))})})]})})]})}),e.jsxs(Dialog,{open:typeDialogOpen,onClose:k,maxWidth:"sm",fullWidth:!0,children:[e.jsx(DialogTitle,{children:"Edit Attendance Type Config"}),e.jsx(DialogContent,{children:s&&e.jsxs(e.Fragment,{children:[e.jsxs(Typography,{variant:"subtitle1",sx:{mb:2},children:[s.name," (",s.slug,")"]}),Object.keys(j.config).length===0&&e.jsx(Typography,{variant:"body2",color:"text.secondary",children:"No config fields available for this type."}),Object.entries(j.config).map(([a,r])=>e.jsx(TextField,{label:a,value:r,onChange:o=>U(a,o.target.value),fullWidth:!0,margin:"normal"},a))]})}),e.jsxs(DialogActions,{children:[e.jsx(g,{onClick:k,children:"Cancel"}),e.jsx(g,{onClick:q,variant:"contained",children:"Save"})]})]}),e.jsxs(Dialog,{open:waypointDialogOpen,onClose:_,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,borderRadius:3,boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37)"}},children:[e.jsxs(DialogTitle,{sx:{display:"flex",alignItems:"center",gap:2,borderBottom:"1px solid rgba(255,255,255,0.1)",pb:2},children:[e.jsx(L,{style:{width:24,height:24,color:theme.palette.primary.main}}),e.jsx(Typography,{variant:"h6",component:"span",children:s?`Manage Waypoints - ${s.name}`:"Manage Waypoints"})]}),e.jsxs(DialogContent,{sx:{pt:3},children:[e.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Define location waypoints for attendance tracking. Each waypoint requires latitude and longitude coordinates."}),e.jsx(Box,{sx:{mb:4},children:e.jsxs(Box,{sx:{p:2.5,borderRadius:3,background:"rgba(255,255,255,0.08)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.12)",backdropFilter:"blur(12px) saturate(180%)"},children:[e.jsxs(Typography,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",gap:1,color:theme.palette.primary.main,fontWeight:600,mb:2},children:[e.jsxs("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Location Tolerance Settings"]}),e.jsx(TextField,{label:"Tolerance (meters)",placeholder:"e.g., 100",type:"number",value:l.tolerance,onChange:a=>K(parseInt(a.target.value)||0),fullWidth:!0,inputProps:{min:1,max:1e4,step:1},helperText:"Distance in meters within which attendance can be marked from each waypoint",sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})]})}),e.jsx(D,{sx:{my:3,opacity:.3}}),e.jsx(Grid,{container:!0,spacing:3,children:l.waypoints.map((a,r)=>e.jsxs(Grid,{item:!0,xs:12,children:[e.jsxs(Box,{sx:{p:2.5,borderRadius:3,background:"rgba(255,255,255,0.08)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.12)",backdropFilter:"blur(12px) saturate(180%)"},children:[e.jsxs(Box,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(Typography,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",gap:1,color:theme.palette.primary.main,fontWeight:600},children:[e.jsx(L,{style:{width:16,height:16}}),"Waypoint ",r+1]}),l.waypoints.length>2&&e.jsx(IconButton,{onClick:()=>V(r),size:"small",sx:{color:theme.palette.error.main,"&:hover":{background:"rgba(255,0,0,0.08)"}},children:e.jsx(ne,{style:{width:16,height:16}})})]}),e.jsxs(Grid,{container:!0,spacing:2,children:[e.jsx(Grid,{item:!0,xs:12,sm:6,children:e.jsx(TextField,{label:"Latitude",placeholder:"e.g., 40.7128",type:"number",value:a.lat,onChange:o=>B(r,"lat",o.target.value),fullWidth:!0,inputProps:{step:"any",min:-90,max:90},sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})}),e.jsx(Grid,{item:!0,xs:12,sm:6,children:e.jsx(TextField,{label:"Longitude",placeholder:"e.g., -74.0060",type:"number",value:a.lng,onChange:o=>B(r,"lng",o.target.value),fullWidth:!0,inputProps:{step:"any",min:-180,max:180},sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})})]})]}),r<l.waypoints.length-1&&e.jsx(D,{sx:{my:2,opacity:.3}})]},r))}),e.jsx(Box,{sx:{mt:3,display:"flex",justifyContent:"center"},children:e.jsx(g,{startIcon:e.jsx(se,{style:{width:20,height:20}}),onClick:Q,variant:"outlined",sx:{borderRadius:3,background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.2)",color:theme.palette.primary.main,"&:hover":{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.3)"}},children:"Add Another Waypoint"})})]}),e.jsxs(DialogActions,{sx:{p:3,borderTop:"1px solid rgba(255,255,255,0.1)",gap:2},children:[e.jsx(g,{onClick:_,sx:{borderRadius:3,color:theme.palette.text.secondary,"&:hover":{background:"rgba(255,255,255,0.05)"}},children:"Cancel"}),e.jsx(LoadingButton,{onClick:X,variant:"contained",sx:{borderRadius:3,background:`linear-gradient(135deg, ${theme.palette.primary.main}, ${theme.palette.primary.dark})`,boxShadow:"0 4px 20px rgba(0,0,0,0.15)","&:hover":{boxShadow:"0 6px 25px rgba(0,0,0,0.2)"}},children:"Save Waypoints"})]})]})]})};le.layout=b=>e.jsx(re,{children:b});export{le as default};
