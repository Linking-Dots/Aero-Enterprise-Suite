import{r as l,j as e,c as T,b as B,s as ie,d as P,J as X,f as z,a as Z,Q as oe}from"./app-DZPKM75F.js";import{i as L,m as U,j as ee,k as se,n as te,s as ne,l as le,F as Y,o as ae,c as K,h as de,u as Q,a as ce,A as me}from"./Dashboard-DUzDf0gW.js";import{T as ue}from"./TimeSheetTable-BOdkSqPH.js";import{F as $,B as S,c as V}from"./react-toastify.esm-cQRz5_Bg.js";import{d as M}from"./dayjs.min-BG2bZEI9.js";import{M as pe,T as he,a as xe,L as re}from"./leaflet-1tHvY6AJ.js";import{F as q}from"./GlobeAltIcon-kIxrC6G7.js";import{F as fe}from"./ExclamationTriangleIcon-DBubR7yw.js";import{M as ye}from"./Marker-D4wzZiGH.js";import{i as E}from"./chunk-SSA7SXE4-fxYfSghp.js";import{F as O}from"./UserPlusIcon-WUObTyZT.js";import{F as W}from"./InformationCircleIcon-xdhpJAz8.js";import{u as G}from"./chunk-S574QCAN-ChpOSbsO.js";import{c as J}from"./chunk-XJ2YRSUP-DrowePxv.js";import{t as ve}from"./chunk-QESP63UR-K0K1dIxQ.js";import{F as ge}from"./CheckCircleIcon-Cjrqfs4R.js";import{F as be}from"./ChartBarIcon-BbCOnBef.js";import"./EnvelopeIcon-70JLjCGt.js";import"./UserIcon-est37Lcw.js";import"./ShieldCheckIcon-DAsYnJiY.js";import"./KeyIcon-Bl-Ju-OA.js";import"./logo-Pwvcz7fP.js";import"./proxy-DMsSV-JP.js";import"./create-visual-element-rUHlUq0c.js";import"./features-animation-CmRTTB-L.js";import"./PageHeader-DSPxexNF.js";import"./XCircleIcon-OnqWt3-G.js";import"./DocumentArrowDownIcon-CWfQ_PkU.js";import"./chunk-JOT4BT4P-Bjrmn3Kq.js";import"./chunk-TLYTI3QM-Cp-xmZaH.js";import"./chunk-F3UDT23P-vR3480AL.js";import"./chunk-YRZGWF2W-DagVMW8F.js";import"./chunk-EAPQ7RWQ-Dx_po_ZQ.js";import"./chunk-D5XJWRAV-BWddd6iu.js";import"./useToggleState-Oh7MZvHa.js";delete re.Icon.Default.prototype._getIconUrl;re.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const N={CHECKING:"checking",ACTIVE:"active",DENIED:"denied",INACTIVE:"inactive"},je=({onLocationSelect:y})=>(xe({click(v){const{lat:_,lng:g}=v.latlng;y({latitude:_,longitude:g,accuracy:10,source:"manual"})}}),null),_e=({onLocationChange:y,initialLocation:v=null,className:_="",style:g={}})=>{const R=()=>{var x;if(typeof window>"u")return"lg";const m=((x=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:x.trim())||"12px",f=parseInt(m);return f===0?"none":f<=4?"sm":f<=8?"md":f<=16?"lg":"full"},[n,p]=l.useState({status:N.CHECKING,coordinates:v||{latitude:23.8103,longitude:90.4125},error:null,accuracy:null}),[t,i]=l.useState({latitude:"",longitude:""}),h=l.useCallback(()=>new Promise((r,m)=>{if(!navigator.geolocation){m(new Error("Geolocation is not supported by this browser"));return}const f={enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4};navigator.geolocation.getCurrentPosition(x=>{const u={latitude:x.coords.latitude,longitude:x.coords.longitude,accuracy:x.coords.accuracy,source:"gps"};r(u)},x=>{let u="Location unavailable";switch(x.code){case 1:u="Location access denied. Please allow location permission.";break;case 2:u="Location unavailable. Please ensure GPS is enabled.";break;case 3:u="Location request timed out.";break;default:u="Unable to retrieve location."}m(new Error(u))},f)}),[]);l.useEffect(()=>{if(v){p(r=>({...r,status:N.ACTIVE,coordinates:v,accuracy:v.accuracy||null}));return}p(r=>({...r,status:N.CHECKING})),h().then(r=>{p({status:N.ACTIVE,coordinates:r,error:null,accuracy:r.accuracy}),y==null||y(r)}).catch(r=>{const m=r.message.includes("denied");p({status:m?N.DENIED:N.INACTIVE,coordinates:{latitude:23.8103,longitude:90.4125},error:r.message,accuracy:null})})},[v]);const b=l.useCallback(r=>{p(m=>({...m,coordinates:r,status:N.ACTIVE,accuracy:r.accuracy||10})),y==null||y(r)},[]),w=l.useCallback(()=>{const r=parseFloat(t.latitude),m=parseFloat(t.longitude);if(isNaN(r)||isNaN(m)||r<-90||r>90||m<-180||m>180){p(x=>({...x,error:"Invalid coordinates. Latitude must be between -90 and 90, longitude between -180 and 180."}));return}b({latitude:r,longitude:m,accuracy:50,source:"manual"}),i({latitude:"",longitude:""})},[t,b]),F=l.useCallback(()=>{p(r=>({...r,status:N.CHECKING,error:null})),h().then(r=>{p({status:N.ACTIVE,coordinates:r,error:null,accuracy:r.accuracy}),y==null||y(r)}).catch(r=>{const m=r.message.includes("denied");p(f=>({...f,status:m?N.DENIED:N.INACTIVE,error:r.message}))})},[h]);return e.jsxs("div",{className:`space-y-4 ${_}`,style:g,children:[e.jsx(T,{style:{background:"color-mix(in srgb, var(--theme-content1) 80%, transparent)",borderColor:"color-mix(in srgb, var(--theme-divider) 50%, transparent)",borderWidth:"var(--borderWidth, 1px)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsxs(B,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4",style:{color:"var(--theme-primary)"}}),e.jsx("span",{className:"text-sm font-medium",style:{color:"var(--theme-foreground)"},children:"Location Selection"})]}),n.status===N.CHECKING&&e.jsx(ie,{size:"sm"}),(n.status===N.DENIED||n.status===N.INACTIVE)&&e.jsx(P,{size:"sm",color:"primary",variant:"flat",onPress:F,startContent:e.jsx(q,{className:"w-3 h-3"}),children:"Get GPS"})]}),n.coordinates&&e.jsxs("div",{className:"text-xs space-y-1",style:{color:"var(--theme-foreground-600)"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Lat:"})," ",n.coordinates.latitude.toFixed(6),",",e.jsx("strong",{children:" Lng:"})," ",n.coordinates.longitude.toFixed(6)]}),n.accuracy&&e.jsxs("div",{children:[e.jsx("strong",{children:"Accuracy:"})," ±",Math.round(n.accuracy),"m"]})]}),n.error&&e.jsxs("div",{className:"flex items-start gap-2 mt-2 p-2 rounded",style:{background:"color-mix(in srgb, var(--theme-danger) 10%, transparent)",color:"var(--theme-danger)"},children:[e.jsx(fe,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-xs",children:n.error})]})]})}),e.jsx(T,{style:{borderRadius:"var(--borderRadius, 8px)",overflow:"hidden"},children:e.jsx("div",{style:{height:"300px",width:"100%"},children:n.coordinates&&e.jsxs(pe,{center:[n.coordinates.latitude,n.coordinates.longitude],zoom:16,style:{height:"100%",width:"100%"},children:[e.jsx(he,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),e.jsx(ye,{position:[n.coordinates.latitude,n.coordinates.longitude]}),e.jsx(je,{onLocationSelect:b})]})})}),e.jsx(T,{style:{background:"color-mix(in srgb, var(--theme-content2) 60%, transparent)",borderColor:"color-mix(in srgb, var(--theme-divider) 50%, transparent)",borderWidth:"var(--borderWidth, 1px)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsxs(B,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(q,{className:"w-4 h-4",style:{color:"var(--theme-secondary)"}}),e.jsx("span",{className:"text-sm font-medium",style:{color:"var(--theme-foreground)"},children:"Manual Coordinates"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsx(E,{size:"sm",label:"Latitude",placeholder:"23.8103",value:t.latitude,onValueChange:r=>i(m=>({...m,latitude:r})),variant:"bordered",radius:R()}),e.jsx(E,{size:"sm",label:"Longitude",placeholder:"90.4125",value:t.longitude,onValueChange:r=>i(m=>({...m,longitude:r})),variant:"bordered",radius:R()}),e.jsx(P,{size:"sm",color:"secondary",variant:"flat",onPress:w,isDisabled:!t.latitude||!t.longitude,className:"h-10",children:"Set Location"})]}),e.jsx("p",{className:"text-xs mt-2",style:{color:"var(--theme-foreground-600)"},children:"Click on the map or enter coordinates manually to set the punch location."})]})})]})},Ne=({open:y,closeModal:v,selectedDate:_,allUsers:g,refreshTimeSheet:R,currentUser:n=null})=>{const{props:{auth:p}}=X(),t=()=>{var s;if(typeof window>"u")return"lg";const o=((s=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:s.trim())||"12px",a=parseInt(o);return a===0?"none":a<=4?"sm":a<=8?"md":a<=16?"lg":"full"},[i,h]=l.useState({user_id:"",date:_,punch_in_time:"09:00",punch_out_time:"",reason:"",location:"Office - Manually marked present by admin",coordinates:null}),[b,w]=l.useState({}),[F,r]=l.useState(!1);l.useEffect(()=>{h(n?c=>({...c,user_id:n.id,date:_}):c=>({...c,user_id:"",date:_,punch_in_time:"09:00",punch_out_time:""}))},[n,_]);const m=l.useCallback(c=>{h(o=>({...o,coordinates:c,location:c.source==="manual"?`Manual: ${c.latitude.toFixed(6)}, ${c.longitude.toFixed(6)}`:`GPS: ${c.latitude.toFixed(6)}, ${c.longitude.toFixed(6)} (±${Math.round(c.accuracy)}m)`}))},[]),f=l.useMemo(()=>(g==null?void 0:g.filter(c=>{var o;return(o=c.roles)==null?void 0:o.some(a=>a.name==="Employee")}))||[],[g]),x=(c,o)=>{h(a=>({...a,[c]:o})),b[c]&&w(a=>({...a,[c]:void 0}))},u=l.useMemo(()=>{if(i.punch_in_time&&i.punch_out_time){const c=M(`${i.date} ${i.punch_in_time}`),o=M(`${i.date} ${i.punch_out_time}`);if(o.isAfter(c)){const a=o.diff(c,"minute"),s=Math.floor(a/60),d=a%60;return`${s}h ${d}m`}}return null},[i.punch_in_time,i.punch_out_time,i.date]),I=async c=>{var o,a,s,d;c.preventDefault(),r(!0),w({});try{if(!i.coordinates){S.error("Please select a location on the map before submitting."),r(!1);return}const j={user_id:parseInt(i.user_id),date:i.date,punch_in_time:i.punch_in_time,punch_out_time:i.punch_out_time||null,lat:i.coordinates.latitude,lng:i.coordinates.longitude,address:i.location||`Manually marked present by ${((o=p.user)==null?void 0:o.name)||"Administrator"}`},k=await Z.post(route("attendance.mark-as-present"),j);k.status===200&&(S.success(k.data.message||"User marked as present successfully!"),R(),v())}catch(j){((a=j.response)==null?void 0:a.status)===422?(w(j.response.data.errors||{}),S.error(j.response.data.message||"Please check the form for errors")):S.error(((d=(s=j.response)==null?void 0:s.data)==null?void 0:d.message)||"Failed to mark user as present")}finally{r(!1)}},C=n||f.find(c=>c.id==i.user_id);return e.jsx(U,{isOpen:y,onClose:v,size:"2xl",radius:t(),scrollBehavior:"inside",classNames:{base:"backdrop-blur-md mx-2 my-2 sm:mx-4 sm:my-4 max-h-[90vh]",backdrop:"bg-black/50 backdrop-blur-sm",header:"border-b border-divider flex-shrink-0",body:"overflow-y-auto max-h-[calc(90vh-8rem)]",footer:"border-t border-divider flex-shrink-0",closeButton:"hover:bg-white/5 active:bg-white/10"},style:{border:"var(--borderWidth, 2px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))"},children:e.jsx(ee,{children:c=>e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"flex flex-col gap-1",style:{borderColor:"var(--theme-divider, #E4E4E7)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}}),e.jsx("span",{className:"text-lg font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Mark Employee as Present"})]})}),e.jsxs("form",{onSubmit:I,children:[e.jsx(te,{className:"py-4 px-4 sm:py-6 sm:px-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}}),e.jsx("h3",{className:"text-base font-semibold",style:{color:"var(--theme-foreground)"},children:"Employee Selection"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[n?e.jsx("div",{className:"p-3 rounded-lg border",style:{backgroundColor:"var(--theme-content2)",borderColor:"var(--theme-divider)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(G,{avatarProps:{size:"sm",src:n.profile_image_url,showFallback:!0,name:n.name},description:`Employee ID: ${n.employee_id}`,name:n.name})}):e.jsx(ne,{label:"Select Employee",placeholder:"Choose an employee to mark as present",selectedKeys:i.user_id?new Set([i.user_id.toString()]):new Set,onSelectionChange:o=>{const a=Array.from(o)[0];x("user_id",a||"")},isInvalid:!!b.user_id,errorMessage:b.user_id,variant:"bordered",size:"sm",radius:t(),classNames:{trigger:"min-h-unit-12",value:"text-small"},style:{fontFamily:'var(--fontFamily, "Inter")'},renderValue:o=>o.map(a=>{const s=f.find(d=>d.id.toString()===a.key);return s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s.name}),e.jsxs("span",{className:"text-xs text-default-500",children:["(",s.employee_id,")"]})]},a.key):null}),children:f.map(o=>e.jsx(le,{value:o.id.toString(),textValue:`${o.name} (${o.employee_id})`,children:e.jsx(G,{avatarProps:{size:"sm",src:o.profile_image_url,showFallback:!0,name:o.name},description:`ID: ${o.employee_id}`,name:o.name})},o.id.toString()))}),e.jsx(E,{label:"Date",type:"date",value:i.date,onValueChange:o=>x("date",o),isInvalid:!!b.date,errorMessage:b.date,variant:"bordered",size:"sm",radius:t(),startContent:e.jsx(Y,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})]})]}),e.jsx(z,{style:{background:"var(--theme-divider)"}}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}}),e.jsx("h3",{className:"text-base font-semibold",style:{color:"var(--theme-foreground)"},children:"Working Hours"})]}),u&&e.jsxs("span",{className:"text-sm px-2 py-1 rounded-md bg-success/10 text-success",children:["Duration: ",u]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(E,{label:"Punch In Time",type:"time",value:i.punch_in_time,onValueChange:o=>x("punch_in_time",o),isInvalid:!!b.punch_in_time,errorMessage:b.punch_in_time,variant:"bordered",size:"sm",radius:t(),startContent:e.jsx($,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(E,{label:"Punch Out Time (Optional)",type:"time",value:i.punch_out_time,onValueChange:o=>x("punch_out_time",o),isInvalid:!!b.punch_out_time,errorMessage:b.punch_out_time,variant:"bordered",size:"sm",radius:t(),startContent:e.jsx($,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'},description:"Leave empty if employee is still working"})]})]}),e.jsx(z,{style:{background:"var(--theme-divider)"}}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}}),e.jsx("h3",{className:"text-base font-semibold",style:{color:"var(--theme-foreground)"},children:"Location & Security Information"})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsx(_e,{onLocationChange:m,initialLocation:i.coordinates})})]}),C&&e.jsx("div",{className:"p-4 rounded-lg border",style:{backgroundColor:"var(--theme-content2)",borderColor:"var(--theme-divider)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm",style:{color:"var(--theme-foreground)"},children:"Preview"}),e.jsxs("p",{className:"text-xs",style:{color:"var(--theme-foreground-600)"},children:[C.name," will be marked present for"," ",M(i.date).format("MMM D, YYYY")," from"," ",i.punch_in_time," ",i.punch_out_time&&`to ${i.punch_out_time}`,u&&` (${u})`]})]})]})})]})}),e.jsxs(ae,{className:"flex flex-col sm:flex-row justify-center gap-2 px-4 sm:px-6 py-3 sm:py-4",style:{borderColor:"var(--theme-divider, #E4E4E7)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(P,{color:"default",variant:"bordered",onPress:c,radius:t(),size:"sm",isDisabled:F,style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(P,{type:"submit",color:"primary",variant:"solid",isLoading:F,isDisabled:F||!i.user_id,radius:t(),size:"sm",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:F?"Marking Present...":"Mark as Present"})]})]})]})})})},we=({open:y,closeModal:v,selectedDate:_,allUsers:g,refreshTimeSheet:R,selectedUsers:n=[]})=>{const p=()=>{var j;if(typeof window>"u")return"lg";const s=((j=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:j.trim())||"12px",d=parseInt(s);return d===0?"none":d<=4?"sm":d<=8?"md":d<=16?"lg":"full"},[t,i]=l.useState({user_ids:[],date:_,punch_in_time:"09:00",punch_out_time:"",reason:"",location:"Office - Bulk marked present by admin"}),[h,b]=l.useState({}),[w,F]=l.useState(!1),[r,m]=l.useState(!1),f=l.useMemo(()=>(g==null?void 0:g.filter(a=>{var s;return(s=a.roles)==null?void 0:s.some(d=>d.name==="Employee")}))||[],[g]);l.useEffect(()=>{const a=n.map(s=>s.id.toString());i(s=>({...s,user_ids:a,date:_})),m(a.length===f.length),b({})},[n,_,y,f.length]);const x=(a,s)=>{i(d=>({...d,[a]:s})),h[a]&&b(d=>({...d,[a]:void 0}))},u=(a,s)=>{const d=a.toString();i(j=>({...j,user_ids:s?[...j.user_ids,d]:j.user_ids.filter(k=>k!==d)}))},I=a=>{m(a),i(s=>({...s,user_ids:a?f.map(d=>d.id.toString()):[]}))},C=l.useMemo(()=>{if(t.punch_in_time&&t.punch_out_time){const a=M(`${t.date} ${t.punch_in_time}`),s=M(`${t.date} ${t.punch_out_time}`);if(s.isAfter(a)){const d=s.diff(a,"minute"),j=Math.floor(d/60),k=d%60;return`${j}h ${k}m`}}return null},[t.punch_in_time,t.punch_out_time,t.date]),c=async a=>{var s,d,j;a.preventDefault(),F(!0),b({});try{const k={user_ids:t.user_ids.map(H=>parseInt(H)),date:t.date,punch_in_time:t.punch_in_time,punch_out_time:t.punch_out_time||null,reason:t.reason||"Bulk marked present by administrator",location:t.location},A=await Z.post(route("attendance.bulk-mark-as-present"),k);if(A.status===200){const{data:H}=A.data,{summary:D}=A.data;D.successful>0&&S.success(`Successfully marked ${D.successful} employees as present!`),D.failed>0&&S.warning(`${D.failed} employees failed to be marked present.`),D.skipped>0&&S.info(`${D.skipped} employees were skipped (already have attendance).`),R(),v()}}catch(k){((s=k.response)==null?void 0:s.status)===422?(b(k.response.data.errors||{}),S.error(k.response.data.message||"Please check the form for errors")):S.error(((j=(d=k.response)==null?void 0:d.data)==null?void 0:j.message)||"Failed to bulk mark users as present")}finally{F(!1)}},o=f.filter(a=>t.user_ids.includes(a.id.toString()));return e.jsx(U,{isOpen:y,onClose:v,size:"4xl",radius:p(),scrollBehavior:"inside",classNames:{base:"backdrop-blur-md mx-2 my-2 sm:mx-4 sm:my-8 max-h-[95vh]",backdrop:"bg-black/50 backdrop-blur-sm",header:"border-b border-divider",body:"overflow-y-auto",footer:"border-t border-divider",closeButton:"hover:bg-white/5 active:bg-white/10"},style:{border:"var(--borderWidth, 2px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))"},children:e.jsx(ee,{children:a=>e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"flex flex-col gap-1",style:{borderColor:"var(--theme-divider, #E4E4E7)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}}),e.jsx("span",{className:"text-lg font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Bulk Mark as Present"})]}),e.jsxs(V,{variant:"bordered",size:"sm",style:{borderColor:"var(--theme-primary)",color:"var(--theme-primary)"},children:[t.user_ids.length," selected"]})]})}),e.jsxs("form",{onSubmit:c,children:[e.jsx(te,{className:"py-4 px-4 sm:py-6 sm:px-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}}),e.jsx("h3",{className:"text-base font-semibold",style:{color:"var(--theme-foreground)"},children:"Date & Time Configuration"})]}),C&&e.jsxs("span",{className:"text-sm px-2 py-1 rounded-md bg-success/10 text-success",children:["Duration: ",C]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(E,{label:"Date",type:"date",value:t.date,onValueChange:s=>x("date",s),isInvalid:!!h.date,errorMessage:h.date,variant:"bordered",size:"sm",radius:p(),startContent:e.jsx(Y,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(E,{label:"Punch In Time",type:"time",value:t.punch_in_time,onValueChange:s=>x("punch_in_time",s),isInvalid:!!h.punch_in_time,errorMessage:h.punch_in_time,variant:"bordered",size:"sm",radius:p(),startContent:e.jsx($,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(E,{label:"Punch Out Time (Optional)",type:"time",value:t.punch_out_time,onValueChange:s=>x("punch_out_time",s),isInvalid:!!h.punch_out_time,errorMessage:h.punch_out_time,variant:"bordered",size:"sm",radius:p(),startContent:e.jsx($,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'},description:"Leave empty if employees are still working"})]})]}),e.jsx(z,{style:{background:"var(--theme-divider)"}}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}}),e.jsxs("h3",{className:"text-base font-semibold",style:{color:"var(--theme-foreground)"},children:["Select Employees (",t.user_ids.length," of ",f.length,")"]})]}),e.jsx(J,{isSelected:r,onValueChange:I,color:"primary",size:"sm",children:"Select All"})]}),e.jsx(T,{children:e.jsx(B,{className:"p-4",children:e.jsx(de,{className:"max-h-64",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:f.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-default-50",children:[e.jsx(J,{isSelected:t.user_ids.includes(s.id.toString()),onValueChange:d=>u(s.id,d),color:"primary",size:"sm"}),e.jsx(G,{avatarProps:{size:"sm",src:s.profile_image_url,showFallback:!0,name:s.name},description:`ID: ${s.employee_id}`,name:s.name,classNames:{name:"text-sm",description:"text-xs"}})]},s.id))})})})}),h.user_ids&&e.jsx("p",{className:"text-danger text-sm",children:h.user_ids})]}),e.jsx(z,{style:{background:"var(--theme-divider)"}}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}}),e.jsx("h3",{className:"text-base font-semibold",style:{color:"var(--theme-foreground)"},children:"Additional Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(E,{label:"Location",value:t.location,onValueChange:s=>x("location",s),isInvalid:!!h.location,errorMessage:h.location,variant:"bordered",size:"sm",radius:p(),startContent:e.jsx(L,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(ve,{label:"Reason (Optional)",placeholder:"Reason for bulk marking employees as present...",value:t.reason,onValueChange:s=>x("reason",s),isInvalid:!!h.reason,errorMessage:h.reason,variant:"bordered",size:"sm",radius:p(),minRows:3,maxRows:5,classNames:{input:"text-small"},style:{fontFamily:'var(--fontFamily, "Inter")'}})]})]}),o.length>0&&e.jsx("div",{className:"p-4 rounded-lg border",style:{backgroundColor:"var(--theme-content2)",borderColor:"var(--theme-divider)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(W,{className:"w-5 h-5 mt-0.5",style:{color:"var(--theme-primary)"}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"font-medium text-sm mb-2",style:{color:"var(--theme-foreground)"},children:["Preview - ",o.length," employee",o.length!==1?"s":""," will be marked present"]}),e.jsxs("p",{className:"text-xs mb-3",style:{color:"var(--theme-foreground-600)"},children:["Date: ",M(t.date).format("MMM D, YYYY")," | Time: ",t.punch_in_time,t.punch_out_time&&` to ${t.punch_out_time}`,C&&` (${C})`]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[o.slice(0,10).map(s=>e.jsx(V,{size:"sm",variant:"flat",color:"primary",children:s.name},s.id)),o.length>10&&e.jsxs(V,{size:"sm",variant:"flat",color:"default",children:["+",o.length-10," more"]})]})]})]})})]})}),e.jsxs(ae,{className:"flex flex-col sm:flex-row justify-center gap-2 px-4 sm:px-6 py-3 sm:py-4",style:{borderColor:"var(--theme-divider, #E4E4E7)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(P,{color:"default",variant:"bordered",onPress:a,radius:p(),size:"sm",isDisabled:w,style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(P,{type:"submit",color:"primary",variant:"solid",isLoading:w,isDisabled:w||t.user_ids.length===0,radius:p(),size:"sm",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:w?"Processing...":`Mark ${t.user_ids.length} Employee${t.user_ids.length!==1?"s":""} as Present`})]})]})]})})})},ke=({title:y,allUsers:v})=>{var x;const{auth:_}=X().props;Q("(max-width: 768px)"),Q("(max-width: 640px)");const[g,R]=l.useState(M().format("YYYY-MM-DD")),[n,p]=l.useState({type:null,selectedUsers:[],currentUser:null}),[t,i]=l.useState(0),[h,b]=l.useState({currentMonth:M().format("YYYY-MM")});l.useCallback((u,I=[],C=null)=>{p({type:u,selectedUsers:I,currentUser:C})},[]);const w=l.useCallback(()=>{p({type:null,selectedUsers:[],currentUser:null})},[]),F=l.useCallback(u=>{const I=u.target.value;R(I)},[]),r=l.useCallback(()=>{i(u=>u+1)},[]),m=l.useCallback((u,I)=>{p({type:"mark_as_present",selectedUsers:[],currentUser:u,selectedDate:I})},[]);l.useMemo(()=>{const u=M(g);return[{title:"Present Today",value:0,icon:e.jsx(ge,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Employees present"},{title:"Absent Today",value:0,icon:e.jsx(O,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Employees absent"},{title:"Total Employees",value:(v==null?void 0:v.length)||0,icon:e.jsx(be,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"Active employees"},{title:"Date",value:u.format("MMM D"),icon:e.jsx(ce,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:u.format("dddd")}]},[g,v]);const f=l.useMemo(()=>({open:!!n.type,closeModal:w,selectedDate:n.selectedDate||g,allUsers:v,refreshTimeSheet:r,selectedUsers:n.selectedUsers,currentUser:n.currentUser}),[n.type,w,n.selectedDate,g,v,r,n.selectedUsers,n.currentUser]);return(x=_.permissions)!=null&&x.includes("attendance.view"),e.jsxs(e.Fragment,{children:[e.jsx(oe,{title:y}),n.type==="mark_as_present"&&e.jsx(Ne,{...f}),n.type==="bulk_mark_as_present"&&e.jsx(we,{...f}),e.jsx(ue,{handleDateChange:F,selectedDate:g,updateTimeSheet:t,externalFilterData:h,externalEmployee:"",onMarkAsPresent:m})]})};ke.layout=y=>e.jsx(me,{children:y});export{ke as default};
