import{u as le,r as n,j as e,M as De,e as R,a as A,H as Ce}from"./app-B8QYX9Px.js";import{u as ie,T as I,B as H,G as Ne}from"./logo-BoX8pchB.js";import{P as Pe}from"./PageHeader-XJFWVm9P.js";import{S as Se}from"./StatsCards-DEVVTSBN.js";import{r as V,t as Ie,v as Fe,w as Te,x as W,c as Me,y as Ae,u as U,I as ce,z as de,m as M,D as Ee,S as ke,B as D,e as Re,A as Be,g as $e}from"./App-DkF9RL3Y.js";import"./dayjs.min-BHuFkWn-.js";import{N as Le}from"./NoDataMessage-b2As3E0n.js";import{F as te}from"./EyeIcon-CDre6n7j.js";import{F as se}from"./PencilIcon-q28LArt-.js";import{F as ae}from"./TrashIcon-DFtGfjbZ.js";import{F as ze}from"./EllipsisVerticalIcon-B1J6VG1L.js";import{F as me}from"./CheckCircleIcon-B90VRiLI.js";import{F as ue}from"./XCircleIcon-tcb-l3UC.js";import{t as Oe,a as We,b as Ge,c as He,d as Ve,e as Ue}from"./chunk-F3UDT23P-Hrzl6yhk.js";import{p as Ye}from"./chunk-EAPQ7RWQ-OKuZgSIq.js";import{t as G}from"./chunk-BOOVDPB6-CftkAAhs.js";import{G as qe}from"./GlassDialog-w1fMVGB6.js";import{D as he}from"./DialogTitle-B_yNWDSa.js";import{D as B}from"./Divider-DfNajlN5.js";import{D as pe,a as xe}from"./DialogContent-DYCSoO7D.js";import{T as fe,F as re}from"./TextField-BAa6JqDO.js";import{F as Qe,C as ge,G as Je}from"./Grow-DP1KP2ex.js";import{I as Xe}from"./InputLabel-CehJzubO.js";import{S as Ze}from"./Select-8HD_0XQO.js";import{M as oe}from"./MenuItem-BN00sQGI.js";import{B as $}from"./Button-CpKhJqSS.js";import{D as Ke}from"./Dialog-Bo_XotCr.js";import{F as et}from"./ExclamationTriangleIcon-BW32ASrn.js";import{A as ne}from"./Alert-D_AVVXbH.js";import{F as tt}from"./PlusIcon-BzbZnk-Z.js";import{I as st}from"./InputAdornment-Cc_eLtv_.js";import"./create-visual-element-4S4I33NB.js";import"./chunk-D5XJWRAV-zQzkTunB.js";import"./EnvelopeIcon-B1M8vjD_.js";import"./UserIcon-D9_80nkG.js";import"./ShieldCheckIcon-RZqgNGJW.js";import"./useHasTabbableChild-CrUAHYqA.js";import"./index-Dxlg9OmP.js";import"./index-CokAva9Y.js";import"./listItemTextClasses-DfTDYmaW.js";const at=({designations:l,onEdit:o,onDelete:C,onView:r,loading:c,isMobile:y,isTablet:d,pagination:a,onPageChange:v,onRowsPerPageChange:m,canEditDesignation:j=!1,canDeleteDesignation:x=!1})=>{var w,g;const{auth:p}=le().props,u=j||((w=p.permissions)==null?void 0:w.includes("designations.update"))||!1,i=x||((g=p.permissions)==null?void 0:g.includes("designations.delete"))||!1,S=n.useMemo(()=>[{name:"TITLE",uid:"title"},{name:"DEPARTMENT",uid:"department_name"},{name:"EMPLOYEES",uid:"employee_count"},{name:"STATUS",uid:"status"},{name:"ACTIONS",uid:"actions"}],[]),b=(s,P)=>{switch(P){case"title":return e.jsx("span",{className:"font-semibold text-foreground",children:s.title});case"department_name":return e.jsx("span",{className:"text-default-500",children:s.department_name||"-"});case"employee_count":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:s.employee_count||0})]});case"status":return e.jsx(Me,{size:"sm",variant:s.is_active?"solid":"bordered",color:s.is_active?"success":"danger",startContent:s.is_active?e.jsx(me,{className:"w-3 h-3"}):e.jsx(ue,{className:"w-3 h-3"}),children:s.is_active?"Active":"Inactive"});case"actions":return e.jsx("div",{className:"flex justify-end items-center",children:y?e.jsxs(Ie,{children:[e.jsx(Fe,{children:e.jsx(R,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(ze,{className:"w-4 h-4"})})}),e.jsxs(Te,{"aria-label":"Designation actions",children:[e.jsx(W,{startContent:e.jsx(te,{className:"w-4 h-4"}),onPress:()=>r(s),children:"View Details"},"view"),u&&e.jsx(W,{startContent:e.jsx(se,{className:"w-4 h-4"}),onPress:()=>o(s),children:"Edit Designation"},"edit"),i&&e.jsx(W,{className:"text-danger",color:"danger",startContent:e.jsx(ae,{className:"w-4 h-4"}),isDisabled:s.employee_count>0,onPress:()=>C(s),children:"Delete Designation"},"delete")]})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{content:"View Designation",children:e.jsx(R,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>r(s),children:e.jsx(te,{className:"w-4 h-4"})})}),u&&e.jsx(G,{content:"Edit Designation",children:e.jsx(R,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-blue-500",onPress:()=>o(s),children:e.jsx(se,{className:"w-4 h-4"})})}),i&&e.jsx(G,{content:s.employee_count>0?"Cannot delete designation with employees":"Delete Designation",children:e.jsx(R,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-danger",isDisabled:s.employee_count>0,onPress:()=>C(s),children:e.jsx(ae,{className:"w-4 h-4"})})})]})});default:return e.jsx("span",{children:s[P]})}},f=()=>!l||!l.data||c?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(a.currentPage-1)*a.perPage+1," to ",Math.min(a.currentPage*a.perPage,l.total)," of ",l.total," designations"]}),e.jsx(Ye,{total:Math.ceil(l.total/a.perPage),initialPage:a.currentPage,page:a.currentPage,onChange:v,size:y?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]});return!c&&(!l||!l.data||l.data.length===0)?e.jsx("div",{className:"w-full",children:e.jsx(Le,{message:"No designations found",icon:e.jsx(V,{className:"w-12 h-12 text-default-300"}),description:"Try adjusting your search or filters"})}):e.jsx("div",{className:"w-full",children:e.jsxs(Oe,{"aria-label":"Designations table",removeWrapper:!0,classNames:{base:"bg-transparent",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs",td:"border-b border-white/5 py-3"},bottomContent:f(),children:[e.jsx(We,{columns:S,children:s=>e.jsx(Ge,{children:s.name},s.uid)}),e.jsx(He,{items:l.data||[],emptyContent:!c&&"No designations found",loadingContent:e.jsx(De,{}),isLoading:c,children:s=>e.jsx(Ve,{children:P=>e.jsx(Ue,{children:b(s,P)})},s.id)})]})})},rt=({open:l,onClose:o,onSuccess:C,designation:r=null,departments:c=[]})=>{var b;const y=ie(),d=U(y.breakpoints.down("md")),[a,v]=n.useState(!1),[m,j]=n.useState({}),x={title:"",department_id:"",is_active:!0},[p,u]=n.useState(x);n.useEffect(()=>{u(r?{title:r.title||"",department_id:r.department_id||"",is_active:r.is_active??!0}:x),j({})},[r,l]);const i=f=>{const{name:w,value:g,type:s,checked:P}=f.target;u(N=>({...N,[w]:s==="checkbox"?P:g})),m[w]&&j(N=>({...N,[w]:null}))},S=async()=>{var f,w;v(!0),j({});try{const g={...p};let s;r!=null&&r.id?(s=await A.put(`/designations/${r.id}`,g),D.success("Designation updated successfully")):(s=await A.post("/designations",g),D.success("Designation created successfully")),C(s.data.designation),o()}catch(g){if((w=(f=g.response)==null?void 0:f.data)!=null&&w.errors){j(g.response.data.errors);const s=Object.values(g.response.data.errors)[0];s&&D.error(s[0])}else D.error("An error occurred while saving the designation")}finally{v(!1)}};return e.jsxs(qe,{open:l,onClose:a?void 0:o,maxWidth:"sm",fullWidth:!0,fullScreen:d,"aria-labelledby":"designation-form-dialog",children:[e.jsxs(he,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(I,{variant:"h6",component:"div",children:r?"Edit Designation":"Create New Designation"}),e.jsx(ce,{edge:"end",color:"inherit",onClick:o,disabled:a,"aria-label":"close",children:e.jsx(de,{className:"w-5 h-5"})})]}),e.jsx(B,{}),e.jsx(pe,{sx:{pt:2},children:e.jsxs(M,{container:!0,spacing:3,children:[e.jsx(M,{item:!0,xs:12,children:e.jsx(I,{variant:"subtitle1",color:"primary",gutterBottom:!0,children:"Designation Information"})}),e.jsx(M,{item:!0,xs:12,md:6,children:e.jsx(fe,{name:"title",label:"Designation Title",fullWidth:!0,required:!0,value:p.title,onChange:i,error:!!m.title,helperText:((b=m.title)==null?void 0:b[0])||"",disabled:a})}),e.jsx(M,{item:!0,xs:12,md:6,children:e.jsxs(Qe,{fullWidth:!0,error:!!m.department_id,children:[e.jsx(Xe,{id:"department-label",children:"Department"}),e.jsxs(Ze,{labelId:"department-label",name:"department_id",value:p.department_id,onChange:i,label:"Department",disabled:a,children:[e.jsx(oe,{value:"",children:e.jsx("em",{children:"Select Department"})}),c.map(f=>e.jsx(oe,{value:f.id,children:f.name},f.id))]}),m.department_id&&e.jsx(re,{children:m.department_id[0]})]})}),e.jsxs(M,{item:!0,xs:12,children:[e.jsx(Ee,{control:e.jsx(ke,{checked:p.is_active,onChange:i,name:"is_active",color:"success",disabled:a}),label:"Designation is active"}),m.is_active&&e.jsx(re,{error:!0,children:m.is_active[0]})]})]})}),e.jsx(B,{}),e.jsxs(xe,{sx:{px:3,py:2},children:[e.jsx($,{onClick:o,disabled:a,color:"inherit",children:"Cancel"}),e.jsx($,{onClick:S,variant:"contained",color:"primary",disabled:a,children:a?"Saving...":r?"Update Designation":"Create Designation"})]})]})},ot=({open:l,onClose:o,onSuccess:C,designation:r})=>{const[c,y]=n.useState(!1),[d,a]=n.useState(null),v=async()=>{var m,j,x,p;if(r){y(!0),a(null);try{await A.delete(`/hr/designations/${r.id}`),D.success("Designation deleted successfully"),C(),o()}catch(u){if((j=(m=u.response)==null?void 0:m.data)!=null&&j.message)a(u.response.data.message),D.error(u.response.data.message);else if((p=(x=u.response)==null?void 0:x.data)!=null&&p.errors){const i=Object.values(u.response.data.errors)[0];a(i),D.error(i)}else a("An error occurred while deleting the designation"),D.error("An error occurred while deleting the designation")}finally{y(!1)}}};return r?e.jsxs(Ke,{open:l,onClose:c?void 0:o,maxWidth:"sm",fullWidth:!0,"aria-labelledby":"delete-designation-dialog",children:[e.jsxs(he,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(I,{variant:"h6",children:"Delete Designation"}),e.jsx(ce,{edge:"end",color:"inherit",onClick:o,disabled:c,"aria-label":"close",children:e.jsx(de,{className:"w-5 h-5"})})]}),e.jsx(B,{}),e.jsx(pe,{children:e.jsxs(H,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(H,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(et,{className:"w-8 h-8 text-yellow-500"}),e.jsxs(I,{variant:"body1",children:["Are you sure you want to delete the designation ",e.jsx("strong",{children:r.title}),"?"]})]}),r.employee_count>0&&e.jsxs(ne,{severity:"warning",sx:{mt:2},children:["This designation has ",r.employee_count," employees assigned to it. You cannot delete a designation with active employees. Please reassign these employees to other designations first."]}),d&&e.jsx(ne,{severity:"error",sx:{mt:2},children:d}),e.jsx(I,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"This action cannot be undone. All associated data will be permanently removed."})]})}),e.jsx(B,{}),e.jsxs(xe,{sx:{px:3,py:2},children:[e.jsx($,{onClick:o,disabled:c,color:"inherit",children:"Cancel"}),e.jsx($,{onClick:v,variant:"contained",color:"error",disabled:c||r.employee_count>0,startIcon:c&&e.jsx(ge,{size:20,color:"inherit"}),children:c?"Deleting...":"Delete Designation"})]})]}):null},Ut=({title:l,initialDesignations:o,departments:C,managers:r,parentDesignations:c,stats:y,filters:d})=>{var Z,K,ee;const{auth:a}=le().props,v=ie(),m=U(v.breakpoints.down("sm"));U(v.breakpoints.down("md"));const[j,x]=n.useState(o||{data:[]}),[p,u]=n.useState(!1),[i,S]=n.useState({type:null,designation:null}),[b,f]=n.useState({search:(d==null?void 0:d.search)||"",status:(d==null?void 0:d.status)||"all",parentDesignation:(d==null?void 0:d.parentDesignation)||"all"}),[w,g]=n.useState(!1),[s,P]=n.useState("table"),[N,L]=n.useState({currentPage:(o==null?void 0:o.current_page)||1,perPage:(o==null?void 0:o.per_page)||10}),[F,je]=n.useState(y||{total:0,active:0,inactive:0,parent_designations:0}),Y=((Z=a.permissions)==null?void 0:Z.includes("designations.create"))||!1,q=((K=a.permissions)==null?void 0:K.includes("designations.update"))||!1,Q=((ee=a.permissions)==null?void 0:ee.includes("designations.delete"))||!1,z=n.useCallback(async()=>{u(!0);try{const t=await A.get(route("designations.json"),{params:{page:N.currentPage,per_page:N.perPage,search:b.search,status:b.status,parent_designation:b.parentDesignation}});x(t.data.designations||t.data)}catch(t){console.error("Error fetching designations:",t),D.error("Failed to load designations data")}finally{u(!1)}},[N,b]),O=n.useCallback(async()=>{try{const t=await A.get(route("designations.stats"));t.status===200&&je(t.data.stats)}catch(t){console.error("Error fetching designation stats:",t)}},[]);n.useEffect(()=>{z(),O()},[z,O]);const be=(t,_)=>{f(h=>({...h,[t]:_})),L(h=>({...h,currentPage:1}))},we=t=>{L(_=>({..._,currentPage:t})),window.scrollTo({top:0,behavior:"smooth"})},ye=t=>{L({currentPage:1,perPage:t})},E=(t,_=null)=>{S({type:t,designation:_})},J=()=>{S({type:null,designation:null})},X=(t=null,_=null)=>{_==="add"&&t?x(h=>{const T=[t,...h.data];return{...h,data:T,total:(h.total||0)+1}}):_==="edit"&&t?x(h=>{const T=h.data.map(k=>k.id===t.id?t:k);return{...h,data:T}}):_==="delete"&&t?x(h=>{const T=h.data.filter(k=>k.id!==t.id);return{...h,data:T,total:(h.total||1)-1}}):(z(),O())},ve=n.useMemo(()=>[{title:"Total Designations",value:F.total,icon:e.jsx(V,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All designations"},{title:"Active",value:F.active,icon:e.jsx(me,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Active designations"},{title:"Inactive",value:F.inactive,icon:e.jsx(ue,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Inactive designations"},{title:"Parent Designations",value:F.parent_designations,icon:e.jsx(Re,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Top-level designations"}],[F]),_e=n.useMemo(()=>{const t=[];return Y&&t.push({label:m?"Add":"Add Designation",icon:e.jsx(tt,{className:"w-4 h-4"}),onPress:()=>E("add_designation"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),t},[Y,m]);return e.jsxs(Be,{children:[e.jsx(Ce,{title:l}),e.jsx(H,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(Je,{in:!0,timeout:800,children:e.jsx(Ne,{children:e.jsx(Pe,{title:"Designation Management",subtitle:"Manage company designations and hierarchy",icon:e.jsx(V,{className:"w-8 h-8"}),variant:"default",actionButtons:_e,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(Se,{stats:ve,className:"mb-6"}),e.jsx("div",{className:"mb-6",children:e.jsx(fe,{label:"Search",placeholder:"Search designations...",value:b.search,onChange:t=>be("search",t.target.value),InputProps:{startAdornment:e.jsx(st,{position:"start",children:e.jsx($e,{className:"w-4 h-4"})})},fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{backgroundColor:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"12px",color:"white","& fieldset":{borderColor:"rgba(255, 255, 255, 0.2)"},"&:hover fieldset":{borderColor:"rgba(255, 255, 255, 0.3)"},"&.Mui-focused fieldset":{borderColor:"var(--primary-color)"},"& input::placeholder":{color:"rgba(255, 255, 255, 0.5)",opacity:1}},"& .MuiInputLabel-root":{color:"rgba(255, 255, 255, 0.7)","&.Mui-focused":{color:"var(--primary-color)"}}}})}),e.jsx("div",{children:p?e.jsxs("div",{className:"text-center py-6",children:[e.jsx(ge,{size:40}),e.jsx(I,{className:"mt-4",children:"Loading..."})]}):e.jsx(at,{designations:j,loading:p,onEdit:q?t=>E("edit_designation",t):void 0,onDelete:Q?t=>E("delete_designation",t):void 0,onView:t=>E("view_designation",t),pagination:N,onPageChange:we,onRowsPerPageChange:ye,canEditDesignation:q,canDeleteDesignation:Q})})]})})})})}),(i.type==="add_designation"||i.type==="edit_designation")&&e.jsx(rt,{open:!0,departments:C,onClose:J,onSuccess:t=>X(t,i.type==="add_designation"?"add":"edit"),designation:i.designation,managers:r,parentDesignations:c}),i.type==="delete_designation"&&e.jsx(ot,{open:!0,onClose:J,onSuccess:t=>X(t,"delete"),designation:i.designation})]})};export{Ut as default};
