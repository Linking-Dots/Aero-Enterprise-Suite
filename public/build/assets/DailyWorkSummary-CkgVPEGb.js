import{u as ve,R as ge,j as e,b as L,F as ee,a as T,d as B,f as ae,r as b,W as je,e as Ne,Q as Fe,A as we}from"./app-2c7u7EvZ.js";import{T as ke}from"./index-CtBsO7PD.js";import{p as U,F as q,n as re,j as ie,c as Se,e as De,f as Re,g as Ce,A as _e}from"./Dashboard-ut-uTYa1.js";import{F as O}from"./DocumentIcon-DYLWCqDw.js";import{F as X}from"./ClockIcon-DAT7Xd7d.js";import{F as le}from"./CheckCircleIcon-CPFV9knS.js";import{F as ne,r as oe,a as de,D as Ie,b as We,c as $e,u as Y,w as Ee}from"./xlsx-DufbwYGP.js";import{F as P}from"./ChartBarIcon-nyCBQz4Y.js";import{a as se}from"./MapPinIcon-BxpL7FKX.js";import{F as te}from"./CheckCircleIcon-BK5yRv8r.js";import{F as pe}from"./ClockIcon-DrPRI1xR.js";import{F as Me}from"./ExclamationTriangleIcon-0OwFYDN5.js";import{c as R,t as Ye,a as Pe,b as Ae}from"./chunk-F3UDT23P-dWfslj-A.js";import{p as G}from"./chunk-XVMALT6H-9Ui-7K8v.js";import{c as Z}from"./chunk-IHOGUXIG-C9esasSB.js";import{a as K,s as ce,l as me}from"./chunk-Y2AYO5NJ-BOC3jhcU.js";import{t as ze,a as Le}from"./chunk-YRZGWF2W-CVnTuOqD.js";import{s as Q}from"./chunk-TLYTI3QM-BbQtNAl7.js";import{S as Te}from"./StatsCards-GckFiXHe.js";import{s as J}from"./toastUtils-9mT78FF5.js";import{c as Be}from"./chunk-ITDNPVX3-QEO6jZQh.js";import{c as Ve}from"./chunk-XJ2YRSUP-DLGgeZNc.js";import{F as Oe}from"./InformationCircleIcon-Ba2N0bKg.js";import{m as Ge}from"./chunk-O5MCAK4F-ok9r27sp.js";import{d as D}from"./dayjs.min-CL0Q_Aa-.js";import{i as Qe}from"./isBetween-DFFWhDxe.js";import{F as Ue}from"./DocumentArrowDownIcon-CnZZy8O5.js";import{m as xe}from"./proxy--RyoqgPN.js";import{F as qe}from"./FunnelIcon-DAtwNSKO.js";import{F as He}from"./AdjustmentsHorizontalIcon-Dd2sWTOK.js";import{F as Je}from"./UserIcon-DpR6Yxvw.js";import{c as Xe}from"./chunk-D5XJWRAV-CqAxdy3X.js";import{b as Ze}from"./chunk-57V4RE7B-CVFD1uUx.js";import{i as ue}from"./chunk-SSA7SXE4-CYs09r68.js";import"./EnvelopeIcon-CFXOPER_.js";import"./UserGroupIcon-DKyx_-H9.js";import"./ShieldCheckIcon-Bn1mNc_N.js";import"./XMarkIcon-Cv9cS_ra.js";import"./KeyIcon-CXuJ5V_o.js";import"./index-BzR0Ydkt.js";import"./logo-Pwvcz7fP.js";import"./MagnifyingGlassIcon-B0trLquL.js";import"./features-animation-CjaMVz5S.js";import"./create-visual-element-DqSzzSQU.js";import"./createLucideIcon-Dekl8mjq.js";import"./useProgressBar-BMyTNH9j.js";import"./NumberFormatter-DNR9MAW-.js";import"./useToggleState-BrFcryJF.js";const Ke=({filteredData:f,onRefresh:C,loading:_=!1})=>{const{theme:I}=ve(),p=U("(max-width: 1024px)"),x=()=>{var r;if(typeof window>"u")return"lg";const s=parseInt(((r=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:r.trim())||"12");return s===0?"none":s<=4?"sm":s<=8?"md":s<=16?"lg":"full"},g=()=>e.jsxs("div",{className:"max-h-[84vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx(Q,{className:"w-32 h-6 rounded"}),e.jsx(Q,{className:"w-20 h-8 rounded"})]}),e.jsx(K,{className:"max-h-[70vh]",children:e.jsxs("div",{className:"border border-divider rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-default-100/80 backdrop-blur-md border-b border-divider",children:e.jsx("div",{className:"flex",children:$.map((s,r)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(Q,{className:"w-20 h-4 rounded"})},r))})}),e.jsx("div",{className:"divide-y divide-divider",children:Array.from({length:8}).map((s,r)=>e.jsx("div",{className:"flex hover:bg-default-50/50 transition-colors",children:$.map((d,t)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(Q,{className:"w-full h-4 rounded"})},t))},r))})]})})]}),o=s=>new Date(s).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}),m=s=>s>=100?"success":s>=75?"warning":s>=50?"primary":"danger",j=s=>s>=100?e.jsx(le,{className:"w-3 h-3"}):s>=50?e.jsx(X,{className:"w-3 h-3"}):e.jsx(Me,{className:"w-3 h-3"}),N=(s,r)=>{const d="w-3 h-3",t=r>0?"":"text-gray-400";switch(s==null?void 0:s.toLowerCase()){case"embankment":return e.jsx(ie,{className:`${d} text-amber-500 ${t}`});case"structure":return e.jsx(O,{className:`${d} text-blue-500 ${t}`});case"pavement":return e.jsx(se,{className:`${d} text-gray-500 ${t}`});default:return e.jsx(q,{className:`${d} text-primary ${t}`})}},V=({summary:s})=>{const r=s.totalDailyWorks>0?(s.completed/s.totalDailyWorks*100).toFixed(1):0,d=s.rfiSubmissions>0&&s.completed>0?(s.rfiSubmissions/s.completed*100).toFixed(1):0,t=s.totalDailyWorks-s.completed;return e.jsx(T,{className:"mb-2",shadow:"sm",radius:x(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(B,{className:"p-3",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-3 flex-1",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-primary",style:{fontFamily:'var(--fontFamily, "Inter")'},children:o(s.date)}),e.jsxs("span",{className:"text-xs text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.totalDailyWorks," total works"]})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Z,{size:"sm",variant:"flat",color:m(parseFloat(r)),startContent:j(parseFloat(r)),radius:x(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:[r,"%"]})})]}),e.jsx(ae,{className:"my-3"}),e.jsxs("div",{className:"space-y-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Completion Progress"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.completed,"/",s.totalDailyWorks]})]}),e.jsx(G,{value:parseFloat(r),color:m(parseFloat(r)),size:"sm",radius:x(),className:"w-full","aria-label":`Completion progress: ${r}%`})]}),s.rfiSubmissions>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"RFI Submission"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.rfiSubmissions,"/",s.completed]})]}),e.jsx(G,{value:parseFloat(d),color:m(parseFloat(d)),size:"sm",radius:x(),className:"w-full","aria-label":`RFI submission progress: ${d}%`})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[N("embankment",s.embankment),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Embankment"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.embankment})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[N("structure",s.structure),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Structure"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.structure})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[N("pavement",s.pavement),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Pavement"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.pavement})]})]}),e.jsx(ae,{className:"my-3"}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3 text-warning"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Resubmissions: ",s.resubmissions]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3 text-danger"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Pending: ",t]})]})]})]})})},M=ge.useCallback((s,r)=>{const d=s.totalDailyWorks>0?(s.completed/s.totalDailyWorks*100).toFixed(1):0,t=s.rfiSubmissions>0&&s.completed>0?(s.rfiSubmissions/s.completed*100).toFixed(1):0,l=s.totalDailyWorks-s.completed;switch(r){case"date":return e.jsx(R,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(re,{className:"w-3 h-3 text-default-500"}),e.jsx("span",{className:"text-sm font-medium",children:o(s.date)})]})});case"totalDailyWorks":return e.jsx(R,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-3 h-3 text-primary"}),e.jsx("span",{className:"text-sm font-bold",children:s.totalDailyWorks})]})});case"resubmissions":return e.jsx(R,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3 text-warning"}),e.jsx("span",{className:"text-sm",children:s.resubmissions})]})});case"embankment":case"structure":case"pavement":return e.jsx(R,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[N(r,s[r]),e.jsx("span",{className:"text-sm",children:s[r]})]})});case"completed":return e.jsx(R,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"w-3 h-3 text-success"}),e.jsx("span",{className:"text-sm font-medium text-success",children:s.completed})]})});case"pending":return e.jsx(R,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3 text-danger"}),e.jsx("span",{className:"text-sm font-medium text-danger",children:l})]})});case"completionPercentage":return e.jsx(R,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{value:parseFloat(d),color:m(parseFloat(d)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`Daily work completion: ${d}%`}),e.jsxs(Z,{size:"sm",variant:"flat",color:m(parseFloat(d)),startContent:j(parseFloat(d)),children:[d,"%"]})]})});case"rfiSubmissions":return e.jsx(R,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"w-3 h-3 text-info"}),e.jsx("span",{className:"text-sm",children:s.rfiSubmissions})]})});case"rfiSubmissionPercentage":return e.jsx(R,{children:e.jsx("div",{className:"flex items-center gap-2",children:s.rfiSubmissions>0?e.jsxs(e.Fragment,{children:[e.jsx(G,{value:parseFloat(t),color:m(parseFloat(t)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`RFI submission percentage: ${t}%`}),e.jsxs(Z,{size:"sm",variant:"flat",color:m(parseFloat(t)),startContent:j(parseFloat(t)),children:[t,"%"]})]}):e.jsx("span",{className:"text-sm text-default-400",children:"-"})})});default:return e.jsx(R,{children:s[r]})}},[]),$=[{name:"Date",uid:"date",icon:re},{name:"Total Daily Works",uid:"totalDailyWorks",icon:q},{name:"Resubmissions",uid:"resubmissions",icon:ee},{name:"Embankment",uid:"embankment",icon:ie},{name:"Structure",uid:"structure",icon:O},{name:"Pavement",uid:"pavement",icon:se},{name:"Completed",uid:"completed",icon:te},{name:"Pending",uid:"pending",icon:pe},{name:"Completion %",uid:"completionPercentage",icon:P},{name:"RFI Submissions",uid:"rfiSubmissions",icon:O},{name:"RFI Submission %",uid:"rfiSubmissionPercentage",icon:P}];return p?e.jsxs("div",{className:"space-y-4",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[C&&e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(L,{size:"sm",variant:"bordered",color:"primary",radius:x(),startContent:e.jsx(ee,{className:"w-4 h-4"}),onPress:C,"aria-label":"Refresh daily work summary table",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Refresh Summary"})}),e.jsx(K,{className:"max-h-[70vh]",children:(f==null?void 0:f.length)>0?f.map((s,r)=>e.jsx(V,{summary:s},r)):e.jsx(T,{className:"text-center py-8",radius:x(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(B,{children:[e.jsx(P,{className:"w-12 h-12 text-default-300 mb-4 mx-auto"}),e.jsx("h6",{className:"text-lg font-semibold text-default-600 mb-2",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No summary data found"}),e.jsx("p",{className:"text-sm text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No work summary available for the selected period"})]})})})]}):_?e.jsx(g,{}):e.jsx("div",{className:"max-h-[84vh] overflow-y-auto",children:e.jsx(K,{className:"max-h-[70vh]",children:e.jsxs(Ye,{selectionMode:"none",isCompact:!0,removeWrapper:!0,isStriped:!0,"aria-label":"Daily Work Summary Table",isHeaderSticky:!0,radius:x(),classNames:{base:"max-h-[520px] overflow-auto",table:"min-h-[200px] w-full",thead:"z-10",tbody:"overflow-y-auto",th:"bg-default-100 text-default-700 font-semibold",td:"text-default-600"},style:{borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(ze,{columns:$,children:s=>e.jsx(Le,{align:s.uid==="date"?"start":"center",className:`bg-default-100/80 backdrop-blur-md ${s.width||""}`,style:{minWidth:s.uid==="date"?"128px":s.uid==="incharge"?"192px":"auto"},children:e.jsxs("div",{className:`flex items-center gap-1 ${s.uid==="date"?"justify-start":"justify-center"}`,children:[s.icon&&e.jsx(s.icon,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-semibold",children:s.name})]})},s.uid)}),e.jsx(Pe,{items:f||[],emptyContent:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(P,{className:"w-12 h-12 text-default-300 mb-4"}),e.jsx("h6",{className:"text-lg font-medium text-default-600",children:"No summary data found"}),e.jsx("span",{className:"text-sm text-default-500",children:"No work summary available for the selected period"})]}),children:s=>e.jsx(Ae,{children:r=>M(s,r)},s.date)})]})})})},es=({open:f,closeModal:C,filteredData:_=[],inCharges:I=[]})=>{var r,d;const[p,x]=b.useState({format:"excel",columns:["date","totalDailyWorks","completed","pending","completionPercentage","rfiSubmissions","embankment","structure","pavement","resubmissions"],includeCharts:!1,groupBy:"date"}),[g,o]=b.useState(!1),m=[{key:"excel",label:"Excel (.xlsx)",description:"Comprehensive spreadsheet with summary data",icon:e.jsx(We,{size:20,className:"text-green-600"})},{key:"csv",label:"CSV (.csv)",description:"Simple comma-separated values",icon:e.jsx($e,{size:20,className:"text-blue-600"})}],j=[{key:"date",label:"Date",description:"Summary date"},{key:"totalDailyWorks",label:"Total Works",description:"Total number of daily works"},{key:"completed",label:"Completed",description:"Number of completed works"},{key:"pending",label:"Pending",description:"Number of pending works"},{key:"completionPercentage",label:"Completion %",description:"Completion percentage"},{key:"rfiSubmissions",label:"RFI Submissions",description:"Number of RFI submissions"},{key:"rfiSubmissionPercentage",label:"RFI Submission %",description:"RFI submission percentage"},{key:"embankment",label:"Embankment Works",description:"Number of embankment works"},{key:"structure",label:"Structure Works",description:"Number of structure works"},{key:"pavement",label:"Pavement Works",description:"Number of pavement works"},{key:"resubmissions",label:"Resubmissions",description:"Number of resubmissions"}],N=[{key:"date",label:"By Date",description:"Group summary by date"},{key:"type",label:"By Type",description:"Group summary by work type"},{key:"overall",label:"Overall Summary",description:"Single overall summary"}],V=async()=>{o(!0);try{let t=M();const l=`daily_work_summary_${new Date().toISOString().split("T")[0]}`;switch(p.format){case"excel":$(t,l);break;case"csv":s(t,l);break}J.success(`Successfully exported ${t.length} summary records`,{icon:e.jsx(te,{className:"w-5 h-5"})}),C()}catch(t){J.error("Export failed: "+t.message)}finally{o(!1)}},M=()=>{let t=[..._];if(p.groupBy==="overall"){const l=t.reduce((v,k)=>v+k.totalDailyWorks,0),n=t.reduce((v,k)=>v+k.completed,0),i=t.reduce((v,k)=>v+k.rfiSubmissions,0),h=t.reduce((v,k)=>v+k.embankment,0),y=t.reduce((v,k)=>v+k.structure,0),c=t.reduce((v,k)=>v+k.pavement,0),E=t.reduce((v,k)=>v+k.resubmissions,0);t=[{date:"Overall Summary",totalDailyWorks:l,completed:n,pending:l-n,completionPercentage:l>0?(n/l*100).toFixed(1)+"%":"0%",rfiSubmissions:i,rfiSubmissionPercentage:l>0?(i/l*100).toFixed(1)+"%":"0%",embankment:h,structure:y,pavement:c,resubmissions:E}]}else if(p.groupBy==="type"){const l=t.reduce((n,i)=>(["embankment","structure","pavement"].forEach(h=>{i[h]>0&&(n[h]||(n[h]={type:h.charAt(0).toUpperCase()+h.slice(1),totalWorks:0,dates:[]}),n[h].totalWorks+=i[h],n[h].dates.push(i.date))}),n),{});t=Object.values(l).map(n=>({type:n.type,totalWorks:n.totalWorks,dateRange:`${Math.min(...n.dates)} to ${Math.max(...n.dates)}`,dateCount:n.dates.length}))}return t.map(l=>{const n={};return p.columns.forEach(i=>{var h;if(l.hasOwnProperty(i)){const y=((h=j.find(c=>c.key===i))==null?void 0:h.label)||i;n[y]=l[i]}}),n})},$=(t,l)=>{const n=Y.json_to_sheet(t),i=Y.book_new();Y.book_append_sheet(i,n,"Summary");const h=Object.keys(t[0]||{}).map(()=>({wch:20}));n["!cols"]=h;const y=Y.decode_range(n["!ref"]);for(let c=y.s.c;c<=y.e.c;c++){const E=Y.encode_cell({r:0,c});n[E]&&(n[E].s={font:{bold:!0},fill:{fgColor:{rgb:"CCCCCC"}}})}Ee(i,`${l}.xlsx`)},s=(t,l)=>{const n=Y.json_to_sheet(t),i=Y.sheet_to_csv(n),h=new Blob([i],{type:"text/csv;charset=utf-8;"}),y=document.createElement("a"),c=URL.createObjectURL(h);y.setAttribute("href",c),y.setAttribute("download",`${l}.csv`),y.style.visibility="hidden",document.body.appendChild(y),y.click(),document.body.removeChild(y)};return e.jsx(Se,{isOpen:f,onClose:C,size:"3xl",scrollBehavior:"inside",classNames:{base:"backdrop-blur-md",backdrop:"bg-black/50 backdrop-blur-sm"},children:e.jsxs(De,{children:[e.jsxs(Re,{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-6 h-6 text-primary"}),e.jsx("span",{children:"Export Daily Work Summary"})]}),e.jsx("p",{className:"text-sm text-default-500 font-normal",children:"Export summary data with customizable grouping and format options"})]}),e.jsx(Ce,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(T,{className:"bg-default-50",children:e.jsxs(B,{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Export Format"}),e.jsx(oe,{value:p.format,onValueChange:t=>x(l=>({...l,format:t})),orientation:"horizontal",children:m.map(t=>e.jsx(de,{value:t.key,children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.icon,e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsx("div",{className:"text-xs text-default-500",children:t.description})]})]})},t.key))})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Grouping & Summary"}),e.jsx(oe,{value:p.groupBy,onValueChange:t=>x(l=>({...l,groupBy:t})),children:N.map(t=>e.jsx(de,{value:t.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsx("div",{className:"text-xs text-default-500",children:t.description})]})},t.key))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Columns to Export"}),e.jsx(Be,{value:p.columns,onValueChange:t=>x(l=>({...l,columns:t})),children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:j.map(t=>e.jsx(Ve,{value:t.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsx("div",{className:"text-xs text-default-500",children:t.description})]})},t.key))})})]}),e.jsx(T,{className:"bg-primary-50 border-primary-200",children:e.jsx(B,{children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Oe,{className:"w-5 h-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-primary-900",children:"Export Summary"}),e.jsxs("div",{className:"text-sm text-primary-700 space-y-1",children:[e.jsxs("p",{children:["• Format: ",(r=m.find(t=>t.key===p.format))==null?void 0:r.label]}),e.jsxs("p",{children:["• Grouping: ",(d=N.find(t=>t.key===p.groupBy))==null?void 0:d.label]}),e.jsxs("p",{children:["• Columns: ",p.columns.length," selected"]}),e.jsxs("p",{children:["• Records: ",_.length," summary entries"]})]})]})]})})})]})}),e.jsxs(Ge,{children:[e.jsx(L,{variant:"light",onPress:C,isDisabled:g,children:"Cancel"}),e.jsx(L,{color:"primary",onPress:V,isLoading:g,startContent:!g&&e.jsx(Ie,{size:16}),isDisabled:p.columns.length===0,children:g?"Exporting...":"Export Summary"})]})]})})};var H={exports:{}},ss=H.exports,fe;function ts(){return fe||(fe=1,function(f,C){(function(_,I){f.exports=I()})(ss,function(){return function(_,I,p){var x=function(g,o){if(!o||!o.length||o.length===1&&!o[0]||o.length===1&&Array.isArray(o[0])&&!o[0].length)return null;var m;o.length===1&&o[0].length>0&&(o=o[0]),m=(o=o.filter(function(N){return N}))[0];for(var j=1;j<o.length;j+=1)o[j].isValid()&&!o[j][g](m)||(m=o[j]);return m};p.max=function(){var g=[].slice.call(arguments,0);return x("isAfter",g)},p.min=function(){var g=[].slice.call(arguments,0);return x("isBefore",g)}}})}(H)),H.exports}var as=ts();const rs=je(as);D.extend(rs);D.extend(Qe);const is=({auth:f,title:C,summary:_,jurisdictions:I,inCharges:p})=>{const x=U("(min-width: 1025px)"),g=U("(min-width: 641px) and (max-width: 1024px)"),o=U("(max-width: 640px)"),m=()=>{var W;if(typeof window>"u")return"lg";const u=((W=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:W.trim())||"12px",S=parseInt(u);return S===0?"none":S<=4?"sm":S<=8?"md":S<=16?"lg":"full"},[j]=b.useState(_),[N,V]=b.useState(_),[M,$]=b.useState(!1),[s,r]=b.useState(null),[d,t]=b.useState(!1),l=b.useCallback(a=>{r(a)},[]),n=b.useCallback(()=>{r(null)},[]),i=b.useMemo(()=>!j||j.length===0?[]:j.map(a=>D(a.date)).filter(a=>a.isValid()),[j]),h=b.useCallback((a,u,S,W="name")=>{if(!a||a.length===0)return e.jsx("span",{className:"text-default-400 text-xs",children:S});const z=a.map(String),F=(u==null?void 0:u.filter(w=>z.includes(String(w.id))).map(w=>w[W]))??[];return F.length===0?e.jsx("span",{className:"text-default-400 text-xs",children:S}):e.jsx("div",{className:"flex flex-wrap gap-1",children:F.map(w=>e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-primary/10 text-primary",children:w},w))})},[]),y=b.useMemo(()=>(I==null?void 0:I.map(a=>({...a,displayLabel:`${a.start_chainage} - ${a.end_chainage}`})))??[],[I]),[c,E]=b.useState({startDate:i.length>0?D.min(...i).format("YYYY-MM-DD"):D().subtract(30,"days").format("YYYY-MM-DD"),endDate:i.length>0?D.max(...i).format("YYYY-MM-DD"):D().format("YYYY-MM-DD"),status:"all",incharge:[],jurisdiction:[]}),v=b.useCallback(async()=>{var a,u,S,W,z;$(!0);try{const F={startDate:c.startDate,endDate:c.endDate};(a=c.incharge)!=null&&a.length&&(F.incharge=c.incharge),(u=c.jurisdiction)!=null&&u.length&&(F.jurisdiction=c.jurisdiction);const ye=((S=(await Ne.post(ke("daily-works-summary.filter"),F)).data)==null?void 0:S.summaries)??[];return V(ye),!0}catch(F){console.error("Failed to load filtered summary:",F);const w=((z=(W=F.response)==null?void 0:W.data)==null?void 0:z.error)||"Failed to load summary data";return J.error(w),!1}finally{$(!1)}},[c]),k=b.useCallback(async()=>{await v()&&J.success("Summary data refreshed successfully")},[v]),A=b.useCallback((a,u)=>{E(S=>({...S,[a]:u}))},[]),he=b.useMemo(()=>{const a=N.reduce((F,w)=>F+w.totalDailyWorks,0),u=N.reduce((F,w)=>F+w.completed,0),S=N.reduce((F,w)=>F+w.pending,0),W=N.reduce((F,w)=>F+w.rfiSubmissions,0),z=a>0?(u/a*100).toFixed(1):0;return[{title:"Total Works",value:a,icon:e.jsx(P,{className:"w-5 h-5"}),color:"text-blue-600",description:"All logged works"},{title:"Completed",value:u,icon:e.jsx(te,{className:"w-5 h-5"}),color:"text-green-600",description:`${z}% completion rate`},{title:"Pending",value:S,icon:e.jsx(pe,{className:"w-5 h-5"}),color:"text-orange-600",description:"In progress"},{title:"RFI Submissions",value:W,icon:e.jsx(q,{className:"w-5 h-5"}),color:"text-purple-600",description:"Ready for inspection"}]},[N]),be=[{label:"Refresh",icon:e.jsx(ee,{className:"w-4 h-4"}),variant:"flat",color:"primary",onPress:k,isLoading:M,className:"bg-linear-to-r from-blue-500/20 to-cyan-500/20 hover:from-blue-500/30 hover:to-cyan-500/30",ariaLabel:"Refresh daily work summary data"},...f.roles.includes("Administrator")||f.designation==="Supervision Engineer"?[{label:"Export",icon:e.jsx(Ue,{className:"w-4 h-4"}),variant:"flat",color:"success",onPress:()=>l("exportDailyWorkSummary"),className:"bg-linear-to-r from-green-500/20 to-emerald-500/20 hover:from-green-500/30 hover:to-emerald-500/30",ariaLabel:"Export daily work summary data"}]:[]];return b.useEffect(()=>{i.length>0&&(!c.startDate||!c.endDate)&&E(a=>({...a,startDate:D.min(...i).format("YYYY-MM-DD"),endDate:D.max(...i).format("YYYY-MM-DD")}))},[i]),b.useEffect(()=>{v()},[v]),e.jsxs(e.Fragment,{children:[e.jsx(Fe,{title:C}),s==="exportDailyWorkSummary"&&e.jsx(es,{open:s==="exportDailyWorkSummary",closeModal:n,filteredData:N,inCharges:p}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full max-w-[2000px]",children:e.jsxs(T,{className:"transition-all duration-200",radius:m(),style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                var(--theme-content1, #FAFAFA) 20%, 
                                var(--theme-content2, #F4F4F5) 10%, 
                                var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(Xe,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                    color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                    color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${x?"p-6":g?"p-4":"p-3"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                    ${x?"p-3":g?"p-2.5":"p-2"} 
                                                    rounded-xl flex items-center justify-center
                                                `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(P,{className:`
                                                        ${x?"w-8 h-8":g?"w-6 h-6":"w-5 h-5"}
                                                    `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                        ${x?"text-2xl":g?"text-xl":"text-lg"}
                                                        font-bold text-foreground
                                                        ${x?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Daily Work Summary"}),e.jsx("p",{className:`
                                                        ${x?"text-sm":"text-xs"} 
                                                        text-default-500
                                                        ${x?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Overview of daily work statistics and progress"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex items-center gap-2",children:be.map((a,u)=>e.jsx(L,{size:x?"md":"sm",variant:a.variant||"flat",color:a.color||"primary",startContent:a.icon,onPress:a.onPress,isLoading:a.isLoading,className:`${a.className||""} font-medium`,radius:m(),"aria-label":a.ariaLabel||a.label,style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)"},children:a.label},u))})})]})})})}),e.jsxs(B,{className:"pt-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Te,{stats:he,isLoading:M}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-5 h-5 text-default-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Quick Filters:"})]}),e.jsx("div",{className:"flex gap-2 items-end",children:e.jsx(Ze,{variant:"bordered",radius:m(),className:"bg-white/5",children:e.jsxs(L,{isIconOnly:o,color:d?"primary":"default",onPress:()=>t(!d),className:d?"bg-primary/20":"bg-white/5","aria-label":d?"Hide advanced filters":"Show advanced filters",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(He,{className:"w-4 h-4"}),!o&&e.jsx("span",{className:"ml-1",children:"Advanced Filters"})]})})})]}),e.jsx(we,{children:d&&e.jsx(xe.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx("div",{className:"p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ue,{type:"date",label:"Start Date",value:c.startDate,onChange:a=>A("startDate",a.target.value),size:"sm",variant:"bordered",radius:m(),"aria-label":"Select start date",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                             focus-within:bg-content2/90 border-divider/50 
                                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(ue,{type:"date",label:"End Date",value:c.endDate,onChange:a=>A("endDate",a.target.value),size:"sm",variant:"bordered",radius:m(),"aria-label":"Select end date",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                             focus-within:bg-content2/90 border-divider/50 
                                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}}),(f.roles.includes("Administrator")||f.roles.includes("Super Administrator")||f.designation==="Supervision Engineer")&&e.jsx(ce,{label:"In Charge",placeholder:"Select in charge...",selectionMode:"multiple",selectedKeys:new Set(c.incharge||[]),onSelectionChange:a=>{const u=Array.from(a);A("incharge",u),u.length>0&&A("jurisdiction",[])},variant:"bordered",size:"sm",radius:m(),startContent:e.jsx(Je,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground",listboxWrapper:"bg-content1",popoverContent:"bg-content1"},renderValue:()=>h(c.incharge,p,"Select in charge..."),style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by in charge",children:p.map(a=>e.jsx(me,{value:String(a.id),children:a.name},String(a.id)))}),(f.roles.includes("Administrator")||f.roles.includes("Super Administrator")||f.designation==="Supervision Engineer")&&e.jsx(ce,{label:"Jurisdiction",placeholder:"Select jurisdiction...",selectionMode:"multiple",selectedKeys:new Set(c.jurisdiction||[]),onSelectionChange:a=>{const u=Array.from(a);A("jurisdiction",u),u.length>0&&A("incharge",[])},variant:"bordered",size:"sm",radius:m(),startContent:e.jsx(se,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground",listboxWrapper:"bg-content1",popoverContent:"bg-content1"},renderValue:()=>h(c.jurisdiction,y,"Select jurisdiction...","displayLabel"),style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by jurisdiction",children:y==null?void 0:y.map(a=>e.jsx(me,{value:String(a.id),children:a.displayLabel},String(a.id)))}),e.jsx("div",{className:"flex items-end",children:e.jsx(L,{size:"sm",variant:"flat",color:"danger",onPress:()=>{E({startDate:i.length>0?D.min(...i).format("YYYY-MM-DD"):D().subtract(30,"days").format("YYYY-MM-DD"),endDate:i.length>0?D.max(...i).format("YYYY-MM-DD"):D().format("YYYY-MM-DD"),status:"all",incharge:[],jurisdiction:[]})},style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Clear Filters"})})]})})})})]})}),e.jsx(T,{radius:m(),className:"bg-content1/80 backdrop-blur-md border border-divider/20",style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)",border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                        color-mix(in srgb, var(--theme-content1) 90%, transparent) 20%, 
                                        color-mix(in srgb, var(--theme-content2) 60%, transparent) 10%)`},children:e.jsx(B,{className:"p-0",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsx(Ke,{filteredData:N,onRefresh:k,loading:M})})})]})]})})})]})};is.layout=f=>e.jsx(_e,{children:f});export{is as default};
