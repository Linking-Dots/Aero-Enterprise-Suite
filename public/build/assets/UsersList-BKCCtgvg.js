import{r as n,j as e,H as Ze,b as q,t as Ke,F as Y,a as se,Q as _s,c as V,d as H,S as oe}from"./app-CFOXYWdD.js";import{u as ds,g as cs,G as Cs}from"./logo-AMLCgbkx.js";import{g as ks,a as es}from"./glassyStyles-SXTxBm_S.js";import{v as ss,w as ts,x as as,y as X,d as O,t as Fs,g as ms,j as re,z as xs,B as N,C as Ps,o as Rs,s as Z,b as de,c as Is,D as Ts,A as Ss}from"./App-D44H3aE5.js";import{P as Us}from"./PageHeader-DIUdhN7v.js";import{S as Ds}from"./StatsCards-GNCJc6Af.js";import{F as hs}from"./EllipsisVerticalIcon-C5p9jyC7.js";import{F as ce}from"./UserIcon-B8KaJTnW.js";import{F as ps}from"./PencilIcon-BxC4n9WJ.js";import{F as me,a as $s,b as rs}from"./SignalIcon-q6OB8yEM.js";import{F as xe}from"./LockClosedIcon-sxTsvOMn.js";import{F as he}from"./DevicePhoneMobileIcon-DStYPa2-.js";import{a as ie}from"./ShieldCheckIcon-DfAiaKpT.js";import{F as As}from"./EnvelopeIcon-DJsx2AYc.js";import{t as Ls,a as zs,b as Es,c as Ms}from"./chunk-F3UDT23P-DfyL8aGa.js";import{t as Gs}from"./chunk-YRZGWF2W-CVS3z9wo.js";import{t as Os}from"./chunk-TSPNSPCL-CDimUInN.js";import{p as us}from"./chunk-EAPQ7RWQ-CTPnoxCw.js";import{u as gs}from"./chunk-S574QCAN-C6iBC3Hs.js";import{G as Ws}from"./GlassDialog-CB1Z5Bs0.js";import{F as is}from"./CheckCircleIcon-WfVI_0Z3.js";import{F as ls}from"./XCircleIcon-CXS-JZ21.js";import{F as Bs}from"./TrophyIcon-6L7vcMoJ.js";import{F as Vs}from"./UserPlusIcon-DEOIqm7-.js";import{F as ns}from"./ChartBarIcon-COx860cq.js";import{F as Hs}from"./ChartPieIcon-Jd3OEt6Y.js";import{F as qs}from"./ExclamationTriangleIcon-Kx82ewut.js";import{F as Js}from"./TableCellsIcon-KaLKNQw_.js";import{F as Qs}from"./AdjustmentsHorizontalIcon-CN9Y28v6.js";import{b as Xs}from"./chunk-57V4RE7B-L7qqUn1Q.js";import"./create-visual-element-DL7V4SzU.js";import"./chunk-SSA7SXE4-B38lyIff.js";import"./chunk-D5XJWRAV-Bs0mRdwq.js";import"./index-CaGcrq76.js";import"./useHasTabbableChild-Bti5CcwH.js";import"./index-CokAva9Y.js";const Ys=({allUsers:i,roles:A,isMobile:R,isTablet:p,setUsers:L,pagination:g,onPageChange:z,onRowsPerPageChange:C,totalUsers:u=0,onEdit:W,loading:x=!1,updateUserOptimized:K,deleteUserOptimized:o,toggleUserStatusOptimized:E,updateUserRolesOptimized:M,toggleSingleDeviceLogin:I,resetUserDevice:U,deviceActions:T={}})=>{const[J,B]=n.useState({}),D=(t,r="w-5 h-5")=>{const a=(t==null?void 0:t.toLowerCase())||"";return a.includes("mobile")||a.includes("android")||a.includes("iphone")?e.jsx(he,{className:`${r} text-primary`}):a.includes("tablet")||a.includes("ipad")?e.jsx($s,{className:`${r} text-secondary`}):e.jsx(Ps,{className:`${r} text-default-500`})},h=t=>{const r=(t==null?void 0:t.toLowerCase())||"";return r.includes("mobile")||r.includes("android")||r.includes("iphone")?"Mobile Device":r.includes("tablet")||r.includes("ipad")?"Tablet":"Desktop"},k=(t,r,a)=>{B(d=>({...d,[`${t}-${r}`]:a}))},v=(t,r)=>J[`${t}-${r}`]||!1;async function te(t,r){k(t,"role",!0);const a=new Promise(async(d,c)=>{var w;try{const y=await axios.post(route("user.updateRole",{id:t}),{roles:r});y.status===200&&(M&&M(t,r),d([y.data.message||"Role updated successfully"]))}catch(y){((w=y.response)==null?void 0:w.status)===422?c(y.response.data.errors||["Failed to update user role."]):c(["An unexpected error occurred. Please try again later."])}finally{k(t,"role",!1)}});return N.promise(a,{pending:"Updating employee role...",success:{render({data:d}){return d.join(", ")}},error:{render({data:d}){return Array.isArray(d)?d.join(", "):d}}}),a}const F=n.useMemo(()=>{const t=[{name:"#",uid:"sl"},{name:"USER",uid:"user"},{name:"EMAIL",uid:"email"},{name:"DEPARTMENT",uid:"department"},{name:"DEVICE STATUS",uid:"device_status"},{name:"STATUS",uid:"status"},{name:"ROLES",uid:"roles"},{name:"ACTIONS",uid:"actions"}];if(!R&&!p)t.splice(3,0,{name:"PHONE",uid:"phone"});else if(R)t.splice(t.findIndex(r=>r.uid==="department"),1),t.splice(t.findIndex(r=>r.uid==="device_status"),1);else if(p){const r=t.findIndex(a=>a.uid==="device_status");if(r>-1){const a=t.splice(r,1)[0];t.splice(2,0,a)}}return t},[R,p]),Q=async(t,r)=>{if(!v(t,"status")){k(t,"status",!0);try{E?(E(t,!r),N.success(`User status ${r?"deactivated":"activated"} successfully`)):L&&(L(a=>a.map(d=>d.id===t?{...d,active:!r}:d)),N.success(`User status ${r?"deactivated":"activated"} successfully`))}catch(a){console.error("Error toggling user status:",a),N.error("Failed to update user status")}finally{k(t,"status",!1)}}},_=(t,r,a)=>{var c;const d=t[r];switch(r){case"sl":const S=(g!=null&&g.currentPage&&(g!=null&&g.perPage)?Number((g.currentPage-1)*g.perPage):0)+(typeof a=="number"?a:0)+1;return e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-content1/20 backdrop-blur-md rounded-lg border border-divider",children:e.jsx("span",{className:"text-sm font-semibold text-foreground",children:S})})});case"user":return e.jsx(gs,{className:"w-fit max-w-full",avatarProps:{radius:"lg",size:"sm",src:(t==null?void 0:t.profile_image_url)||(t==null?void 0:t.profile_image),showFallback:!0,name:(t==null?void 0:t.name)||"Unnamed User",isBordered:!0},name:e.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:(t==null?void 0:t.name)||"Unnamed User"})});case"email":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(As,{className:"w-4 h-4 text-default-400 mr-2"}),e.jsx("span",{className:"text-sm",children:t.email})]});case"phone":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(xs,{className:"w-4 h-4 text-default-400 mr-2"}),e.jsx("span",{className:"text-sm",children:t.phone||"N/A"})]});case"department":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"w-4 h-4 text-default-400 mr-2"}),e.jsx("span",{className:"text-sm",children:(t==null?void 0:t.department)||"N/A"})]});case"device_status":const P=v(t.id,"deviceToggle");return e.jsx("div",{className:"flex items-center space-x-2",children:t.single_device_login?e.jsxs(e.Fragment,{children:[e.jsx(O,{size:"sm",variant:"flat",color:t.active_device?"warning":"success",startContent:P?e.jsx("div",{className:"animate-spin",children:e.jsx(Y,{className:"w-3 h-3"})}):t.active_device?e.jsx(xe,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"}),children:P?"Loading...":t.active_device?"Locked":"Free"}),t.active_device&&!P&&e.jsx(Fs,{content:e.jsxs("div",{className:"bg-content1/20 backdrop-blur-md border border-divider rounded-lg p-4 shadow-2xl max-w-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[D(t.active_device.user_agent,"w-5 h-5"),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-foreground text-sm",children:t.active_device.device_name||"Unknown Device"}),e.jsx("div",{className:"text-xs text-default-500",children:h(t.active_device.user_agent)})]})]}),e.jsx("div",{className:"space-y-2 text-xs",children:e.jsx("div",{className:"pt-2 mt-2 border-t border-white/20",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ms,{className:"w-3 h-3 text-success"}),e.jsx("span",{className:"text-success text-xs font-medium",children:t.active_device.is_active?"Currently Active":"Inactive"})]})})})]}),placement:"top",classNames:{content:"p-0 bg-transparent shadow-none border-none"},children:e.jsx("div",{className:"flex items-center p-1 rounded-sm hover:bg-content1/10 transition-colors cursor-default",children:D(t.active_device.user_agent,"w-4 h-4")})})]}):e.jsx(O,{size:"sm",variant:"flat",color:"default",startContent:P?e.jsx("div",{className:"animate-spin",children:e.jsx(Y,{className:"w-3 h-3"})}):e.jsx(ie,{className:"w-3 h-3"}),children:P?"Loading...":"Disabled"})});case"status":return e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:t.active,onChange:()=>Q(t.id,t.active),disabled:v(t.id,"status")}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-hidden peer-focus:ring-4 peer-focus:ring-opacity-30 rounded-full peer transition-all duration-300 ${t.active?"bg-green-500 peer-focus:ring-green-300":"bg-red-500 peer-focus:ring-red-300"} peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all`}),v(t.id,"status")&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),e.jsx("span",{className:"ml-2 text-xs",children:t.active?"Active":"Inactive"})]});case"roles":const G=((c=t.roles)==null?void 0:c.map(j=>typeof j=="object"&&j!==null?j.name:j))||[],ee=new Set(G),le=Array.from(ee).join(", ")||"No Roles";return e.jsx("div",{className:"flex items-center",children:e.jsxs(ss,{isDisabled:v(t.id,"role"),className:"max-w-[220px]",children:[e.jsx(ts,{children:e.jsx(q,{className:"capitalize",variant:"bordered",size:"sm",startContent:v(t.id,"role")?e.jsx(Ze,{size:"sm"}):null,children:le})}),e.jsx(as,{disallowEmptySelection:!1,"aria-label":"Multiple selection example",closeOnSelect:!1,selectedKeys:ee,selectionMode:"multiple",variant:"flat",onSelectionChange:j=>{const ae=Array.from(j);te(t.id,ae)},children:(A||[]).map(j=>e.jsx(X,{children:typeof j=="object"&&j!==null?j.name:j},typeof j=="object"&&j!==null?j.name:j))})]})});case"actions":return e.jsx("div",{className:"flex justify-center items-center",children:e.jsxs(ss,{children:[e.jsx(ts,{children:e.jsx(q,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",children:e.jsx(hs,{className:"w-4 h-4"})})}),e.jsxs(as,{"aria-label":"User Actions",children:[e.jsx(X,{textValue:"View Profile",href:route("profile",{user:t.id}),as:Ke,className:"text-blue-500",startContent:e.jsx(ce,{className:"w-4 h-4"}),children:"View Profile"}),e.jsx(X,{textValue:"Edit User",onPress:()=>{W&&W(t)},className:"text-amber-500",startContent:e.jsx(ps,{className:"w-4 h-4"}),children:"Edit"}),e.jsx(X,{textValue:"Device Toggle",onPress:()=>{I&&!v(t.id,"deviceToggle")&&(k(t.id,"deviceToggle",!0),I(t.id,!t.single_device_login).finally(()=>{k(t.id,"deviceToggle",!1)}))},isDisabled:T[t.id]||v(t.id,"deviceToggle"),startContent:v(t.id,"deviceToggle")?e.jsx("div",{className:"animate-spin",children:e.jsx(Y,{className:"w-4 h-4"})}):t.single_device_login?e.jsx(me,{className:"w-4 h-4"}):e.jsx(xe,{className:"w-4 h-4"}),className:t.single_device_login?"text-orange-500":"text-green-500",children:v(t.id,"deviceToggle")?"Processing...":t.single_device_login?"Disable Device Lock":"Enable Device Lock"}),t.single_device_login&&t.active_device&&e.jsx(X,{textValue:"Reset Device",onPress:()=>{U&&!v(t.id,"deviceReset")&&(k(t.id,"deviceReset",!0),U(t.id).finally(()=>{k(t.id,"deviceReset",!1)}))},isDisabled:T[t.id]||v(t.id,"deviceReset"),startContent:v(t.id,"deviceReset")?e.jsx("div",{className:"animate-spin",children:e.jsx(Y,{className:"w-4 h-4"})}):e.jsx(Y,{className:"w-4 h-4"}),className:"text-red-500",children:v(t.id,"deviceReset")?"Resetting...":"Reset Device"}),e.jsx(X,{textValue:"View Devices",href:route("users.device.show",{user:t.id}),as:Ke,startContent:e.jsx(he,{className:"w-4 h-4"}),className:"text-blue-500",children:"View Device History"})]})]})});default:return d}},b=()=>!i||!u||x?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-divider bg-content1/50 backdrop-blur-md",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(g.currentPage-1)*g.perPage+1," to ",Math.min(g.currentPage*g.perPage,u)," of ",u," users"]}),e.jsx(us,{total:Math.ceil(u/g.perPage),initialPage:g.currentPage,page:g.currentPage,onChange:z,size:R?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-content1/20 backdrop-blur-md border-divider hover:bg-content1/30",cursor:"bg-content1/40 backdrop-blur-md border-divider"}})]});return e.jsxs("div",{className:"w-full overflow-hidden flex flex-col border border-divider rounded-lg bg-content1/10 backdrop-blur-md",style:{maxHeight:"calc(100vh - 200px)"},children:[e.jsx("div",{className:"overflow-auto grow relative table-scroll-container frozen-column-container",children:e.jsxs(Ls,{"aria-label":"Users table",removeWrapper:!0,selectionMode:"none",isCompact:R,classNames:{base:"bg-transparent min-w-[800px]",wrapper:"p-0 bg-transparent shadow-none",th:"backdrop-blur-md text-default-500 border-b border-divider font-medium text-xs sticky top-0 z-30 shadow-xs bg-content1/20",td:"border-b border-divider/50 py-3 group-aria-[selected=false]:group-data-[hover=true]:before:bg-default-100",table:"border-collapse",thead:"sticky top-0 z-30",tbody:"divide-y divide-divider/50",tr:"group outline-none tap-highlight-transparent data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 data-[selected=true]:bg-default-100",emptyWrapper:"text-center h-32",loadingWrapper:"h-32"},children:[e.jsx(Gs,{columns:F,children:t=>e.jsx(Os,{align:t.uid==="actions"||t.uid==="sl"?"center":"start",width:t.uid==="sl"?60:t.uid==="user"?240:void 0,className:t.uid==="sl"?"sticky-header-sl backdrop-blur-md":t.uid==="user"?"sticky-header-user backdrop-blur-md":"backdrop-blur-md sticky top-0 z-30",children:t.name},t.uid)}),e.jsx(zs,{items:i||[],emptyContent:"No users found",loadingContent:e.jsx(Ze,{}),isLoading:x,children:(t,r)=>{const a=i?i.findIndex(d=>d.id===t.id):r;return e.jsx(Es,{className:"table-row-hover",children:d=>e.jsx(Ms,{className:d==="sl"?"frozen-column sticky left-0 z-20 backdrop-blur-md border-r border-divider/30":d==="user"?"frozen-column-user sticky z-20 backdrop-blur-md border-r border-divider/30":"",style:d==="user"?{left:"60px"}:{},children:_(t,d,a)})},t.id)}})]})}),b()]})},os=({user:i,allUsers:A,departments:R,designations:p,setUsers:L,open:g,closeModal:z,editMode:C=!1})=>{const[u,W]=n.useState(!1),[x,K]=n.useState({id:(i==null?void 0:i.id)||"",name:(i==null?void 0:i.name)||"",user_name:(i==null?void 0:i.user_name)||"",gender:(i==null?void 0:i.gender)||"",birthday:(i==null?void 0:i.birthday)||"",date_of_joining:(i==null?void 0:i.date_of_joining)||"",address:(i==null?void 0:i.address)||"",employee_id:(i==null?void 0:i.employee_id)||"",phone:(i==null?void 0:i.phone)||"",email:(i==null?void 0:i.email)||"",department_id:(i==null?void 0:i.department_id)||"",designation_id:(i==null?void 0:i.designation_id)||"",report_to:(i==null?void 0:i.report_to)||"",password:"",confirmPassword:"",roles:(i==null?void 0:i.roles)||[]}),[o,E]=n.useState({}),[M,I]=n.useState(!1),[U,T]=n.useState(!1),[J,B]=n.useState((i==null?void 0:i.profile_image_url)||(i==null?void 0:i.profile_image)||null),[D,h]=n.useState(null),[k,v]=n.useState(A),{isDark:te}=ds();cs(),n.useEffect(()=>{(i!=null&&i.profile_image_url||i!=null&&i.profile_image)&&B(i.profile_image_url||i.profile_image)},[i]);const F=async r=>{var d;r.preventDefault(),I(!0);const a=new FormData;if(Object.keys(x).forEach(c=>{c==="roles"&&Array.isArray(x[c])?x[c].forEach((w,y)=>{a.append(`roles[${y}]`,w)}):x[c]!==null&&x[c]!==void 0&&a.append(c,x[c])}),D){const c=D.type;if(["image/jpeg","image/jpg","image/png"].includes(c))a.append("profile_image",D);else{N.error("Invalid file type. Only JPEG and PNG are allowed.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}),I(!1);return}}try{const c=C?route("updateUser",{id:i.id}):route("addUser"),w=C?"put":"post",y=await axios[w](c,a);y.status===200&&(L&&L(C?S=>S.map(P=>P.id===y.data.user.id?y.data.user:P):S=>[...S,y.data.user]),N.success(((d=y.data.messages)==null?void 0:d.length)>0?y.data.messages.join(" "):`User ${C?"updated":"added"} successfully`,{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}),z())}catch(c){I(!1),Q(c)}finally{I(!1)}},Q=r=>{r.response?r.response.status===422?(E(r.response.data.errors||{}),N.error(r.response.data.error||`Failed to ${C?"update":"add"} user.`,{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}})):N.error("An unexpected error occurred. Please try again later.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}):r.request?N.error("No response received from the server. Please check your internet connection.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}}):N.error("An error occurred while setting up the request.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:theme.glassCard.background,border:theme.glassCard.border,color:theme.palette.text.primary}})},_=r=>{const a=r.target.files[0];if(a){const d=URL.createObjectURL(a);B(d),h(a)}},b=(r,a)=>{K(d=>({...d,[r]:a})),o[r]&&E(d=>{const c={...d};return delete c[r],c})},t=()=>{W(!u)};return e.jsxs(Ws,{open:g,onClose:z,fullWidth:!0,maxWidth:"md",sx:{"& .MuiPaper-root":{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:theme.glassCard.background,border:theme.glassCard.border,borderRadius:"16px",color:theme.palette.text.primary,boxShadow:theme.glassCard.boxShadow}},children:[e.jsx(DialogTitle,{sx:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",pb:2},children:e.jsxs(Box,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(Typography,{variant:"h6",component:"div",sx:{fontWeight:600},children:C?"Edit User":"Add New User"}),e.jsx(IconButton,{"aria-label":"close",onClick:z,sx:{color:theme.palette.grey[500],"&:hover":{color:theme.palette.primary.main}},children:e.jsx(ClearIcon,{})})]})}),e.jsx(DialogContent,{sx:{pt:3},children:e.jsx("form",{onSubmit:F,children:e.jsxs(Grid,{container:!0,spacing:3,children:[e.jsx(Grid,{item:!0,xs:12,sx:{display:"flex",justifyContent:"center",mb:2},children:e.jsxs(Box,{onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),sx:{position:"relative"},children:[e.jsx(Rs,{src:J,alt:"Profile",sx:{width:120,height:120,border:"4px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",filter:U?"brightness(70%)":"brightness(100%)",transition:"all 0.3s ease"}}),e.jsxs(Box,{component:"label",htmlFor:"icon-button-file",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",opacity:U?1:0,transition:"opacity 0.3s ease",cursor:"pointer"},children:[e.jsx("input",{accept:"image/*",id:"icon-button-file",type:"file",style:{display:"none"},onChange:_}),e.jsx(PhotoCamera,{sx:{color:"white",fontSize:32}})]})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Full Name",value:x.name,onChange:r=>b("name",r.target.value),error:!!o.name,helperText:o.name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}},required:!0})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Username",value:x.user_name,onChange:r=>b("user_name",r.target.value),error:!!o.user_name,helperText:o.user_name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}},required:!0})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Email",type:"email",value:x.email,onChange:r=>b("email",r.target.value),error:!!o.email,helperText:o.email,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}},required:!0})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Phone",value:x.phone,onChange:r=>b("phone",r.target.value),error:!!o.phone,helperText:o.phone,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"department-label",sx:{color:theme.palette.text.secondary},children:"Department"}),e.jsxs(Z,{labelId:"department-label",value:x.department_id,onChange:r=>b("department_id",r.target.value),label:"Department",error:!!o.department_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"None"})}),R==null?void 0:R.map(r=>e.jsx(MenuItem,{value:r.id,children:r.name},r.id))]}),o.department_id&&e.jsx(FormHelperText,{error:!0,children:o.department_id})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"designation-label",sx:{color:theme.palette.text.secondary},children:"Designation"}),e.jsxs(Z,{labelId:"designation-label",value:x.designation_id,onChange:r=>b("designation_id",r.target.value),label:"Designation",error:!!o.designation_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"None"})}),p==null?void 0:p.map(r=>e.jsx(MenuItem,{value:r.id,children:r.name},r.id))]}),o.designation_id&&e.jsx(FormHelperText,{error:!0,children:o.designation_id})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"gender-label",sx:{color:theme.palette.text.secondary},children:"Gender"}),e.jsxs(Z,{labelId:"gender-label",value:x.gender,onChange:r=>b("gender",r.target.value),label:"Gender",error:!!o.gender,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"Select Gender"})}),e.jsx(MenuItem,{value:"male",children:"Male"}),e.jsx(MenuItem,{value:"female",children:"Female"}),e.jsx(MenuItem,{value:"other",children:"Other"})]}),o.gender&&e.jsx(FormHelperText,{error:!0,children:o.gender})]})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Employee ID",value:x.employee_id,onChange:r=>b("employee_id",r.target.value),error:!!o.employee_id,helperText:o.employee_id,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Date of Birth",type:"date",value:x.birthday,onChange:r=>b("birthday",r.target.value),error:!!o.birthday,helperText:o.birthday,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Date of Joining",type:"date",value:x.date_of_joining,onChange:r=>b("date_of_joining",r.target.value),error:!!o.date_of_joining,helperText:o.date_of_joining,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsxs(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(InputLabel,{id:"report-to-label",sx:{color:theme.palette.text.secondary},children:"Reports To"}),e.jsxs(Z,{labelId:"report-to-label",value:x.report_to,onChange:r=>b("report_to",r.target.value),label:"Reports To",error:!!o.report_to,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e.jsx(MenuItem,{value:"",children:e.jsx("em",{children:"None"})}),k==null?void 0:k.filter(r=>r.id!==x.id).map(r=>e.jsx(MenuItem,{value:r.id,children:r.name},r.id))]}),o.report_to&&e.jsx(FormHelperText,{error:!0,children:o.report_to})]})}),e.jsx(Grid,{item:!0,xs:12,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Address",multiline:!0,rows:3,value:x.address,onChange:r=>b("address",r.target.value),error:!!o.address,helperText:o.address,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),!C&&e.jsxs(e.Fragment,{children:[e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Password",type:u?"text":"password",value:x.password,onChange:r=>b("password",r.target.value),error:!!o.password,helperText:o.password,required:!C,InputProps:{endAdornment:e.jsx(IconButton,{"aria-label":"toggle password visibility",onClick:t,edge:"end",children:u?e.jsx(VisibilityOff,{}):e.jsx(Visibility,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})}),e.jsx(Grid,{item:!0,xs:12,md:6,children:e.jsx(FormControl,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e.jsx(TextField,{label:"Confirm Password",type:u?"text":"password",value:x.confirmPassword,onChange:r=>b("confirmPassword",r.target.value),error:!!o.confirmPassword,helperText:o.confirmPassword||(x.password!==x.confirmPassword&&x.confirmPassword?"Passwords do not match":""),required:!C,InputProps:{endAdornment:e.jsx(IconButton,{"aria-label":"toggle password visibility",onClick:t,edge:"end",children:u?e.jsx(VisibilityOff,{}):e.jsx(Visibility,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:theme.palette.text.secondary}}})})})]})]})})}),e.jsxs(DialogActions,{sx:{justifyContent:"space-between",p:3,borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(q,{onClick:z,variant:"bordered",color:"default",size:"lg",className:"bg-white/5 hover:bg-white/10 border border-white/10",children:"Cancel"}),e.jsx(LoadingButton,{onClick:F,loading:M,loadingPosition:"start",startIcon:e.jsx(PasswordIcon,{}),variant:"contained",sx:{background:"linear-gradient(45deg, #3a7bd5 0%, #2456bd 100%)",boxShadow:"0 4px 20px 0 rgba(58, 123, 213, 0.4)","&:hover":{background:"linear-gradient(45deg, #2456bd 0%, #1a3c8a 100%)"}},children:C?"Update User":"Add User"})]})]})},Zs=({title:i,roles:A})=>{var ge,be,fe,ve,je,we,ye,Ne,_e,Ce,ke,Fe,Pe,Re,Ie,Te,Se,Ue,De,$e,Ae,Le,ze,Ee,Me,Ge,Oe;const{isDark:R}=ds();cs();const[p,L]=n.useState(!1),[g,z]=n.useState(!1);n.useEffect(()=>{const s=()=>{L(window.innerWidth<640),z(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const[C,u]=n.useState([]),[W,x]=n.useState(!0),[K,o]=n.useState(null),[E,M]=n.useState(0),[I,U]=n.useState(1),[T,J]=n.useState(null),[B,D]=n.useState({}),[h,k]=n.useState({search:"",role:"all",status:"all",department:"all"}),[v,te]=n.useState(!1),[F,Q]=n.useState("table"),[_,b]=n.useState({currentPage:1,perPage:10,total:C.length}),[t,r]=n.useState({}),[a,d]=n.useState({overview:{total_users:0,active_users:0,inactive_users:0,deleted_users:0,total_roles:0,total_departments:0},distribution:{by_role:[],by_department:[],by_status:[]},activity:{recent_registrations:{new_users_30_days:0,new_users_90_days:0,new_users_year:0,recently_active:0},user_growth_rate:0,current_month_registrations:0},security:{access_metrics:{users_with_roles:0,users_without_roles:0,admin_users:0,regular_users:0},role_distribution:[]},health:{status_ratio:{active_percentage:0,inactive_percentage:0,deleted_percentage:0},system_metrics:{user_activation_rate:0,role_coverage:0,department_coverage:0}},quick_metrics:{total_users:0,active_ratio:0,role_diversity:0,department_diversity:0,recent_activity:0,system_health_score:0}}),c=n.useMemo(()=>({data:C,total:E,current_page:_.currentPage,per_page:_.perPage,last_page:I}),[C,E,_.currentPage,_.perPage,I]),w=n.useCallback(async()=>{try{const{data:s}=await se.get(route("users.stats"));s.stats&&d(s.stats)}catch(s){console.error("Error fetching user stats:",s)}},[]),y=n.useCallback((s,l)=>{D(m=>({...m,[l]:s.currentTarget}))},[]),S=n.useCallback(s=>{D(l=>({...l,[s]:null}))},[]),P=n.useCallback(async()=>{x(!0);try{const s=await se.get(route("users.paginate"),{params:{page:_.currentPage,perPage:_.perPage,search:h.search||void 0,role:h.role!=="all"?h.role:void 0,status:h.status!=="all"?h.status:void 0,department:h.department!=="all"?h.department:void 0}});if(s.status===200){const{users:l}=s.data;l.data&&Array.isArray(l.data)?(u(l.data),M(l.total||l.data.length),U(l.last_page||1)):Array.isArray(l)?(u(l),M(l.length),U(1)):(console.error("Unexpected users data format:",l),u([]),M(0),U(1))}}catch(s){console.error("Error fetching users:",s),N.error("Failed to load users data"),u([])}finally{x(!1)}},[h,_.currentPage,_.perPage]);n.useEffect(()=>{P()},[P]),n.useEffect(()=>{w();const s=setInterval(w,6e4);return()=>clearInterval(s)},[w]);const G=(s,l)=>{k(m=>({...m,[s]:l})),b(m=>({...m,currentPage:1}))},ee=s=>{b(l=>({...l,currentPage:s})),window.scrollTo({top:0,behavior:"smooth"})},le=s=>{b(l=>({...l,currentPage:1,perPage:s}))},j=n.useCallback((s,l=null)=>{J(s),o(l)},[]),ae=n.useCallback(()=>{J(null),o(null)},[]),ne=n.useCallback(s=>{u(s)},[]),bs=n.useCallback(s=>{u(l=>l.map(m=>m.id===s.id?{...m,...s}:m))},[]),fs=n.useCallback(s=>{u(l=>l.filter(m=>m.id!==s)),w()},[w]),vs=n.useCallback((s,l)=>{u(m=>m.map(f=>f.id===s?{...f,active:l}:f)),w()},[w]),js=n.useCallback((s,l)=>{u(m=>m.map(f=>f.id===s?{...f,roles:l}:f)),w()},[w]),pe=n.useCallback(async(s,l)=>{r(m=>({...m,[s]:!0}));try{(await se.post(route("users.device.toggle"),{user_id:s,enabled:l})).status===200&&(u(f=>f.map($=>$.id===s?{...$,single_device_login:l,active_device:l?$.active_device:null}:$)),N.success(l?"Single device login enabled for user":"Single device login disabled for user"))}catch(m){console.error("Error toggling single device login:",m),N.error("Failed to update device settings")}finally{r(m=>({...m,[s]:!1}))}},[]),ue=n.useCallback(async s=>{r(l=>({...l,[s]:!0}));try{(await se.post(route("users.device.reset"),{user_id:s})).status===200&&(u(m=>m.map(f=>f.id===s?{...f,active_device:null}:f)),N.success("User device has been reset"))}catch(l){console.error("Error resetting user device:",l),N.error("Failed to reset user device")}finally{r(l=>({...l,[s]:!1}))}},[]);n.useCallback(async s=>{try{const l=await se.get(route("users.device.list",{user:s}));if(l.status===200){const m=l.data.devices;N.info(`User has ${m.length} device record(s)`)}}catch(l){console.error("Error fetching user devices:",l),N.error("Failed to fetch device information")}},[]);const ws=({user:s,index:l})=>{var m;return e.jsx(V,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 transition-all duration-200 cursor-pointer h-full",onPress:()=>oe.visit(route("profile",{user:s.id})),children:e.jsxs(H,{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3 pb-3 border-b border-white/10",children:[e.jsx(gs,{avatarProps:{radius:"lg",src:(s==null?void 0:s.profile_image_url)||(s==null?void 0:s.profile_image),size:"md",fallback:e.jsx(ce,{className:"w-5 h-5"})},classNames:{name:"font-semibold text-foreground text-sm",description:"text-default-500 text-xs"}}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground text-sm line-clamp-1",children:s.name}),e.jsx("p",{className:"text-default-500 text-xs",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>{oe.visit(route("profile",{user:s.id}))},children:e.jsx(ps,{className:"w-4 h-4"})}),e.jsx(IconButton,{size:"small",onClick:f=>y(f,`device-menu-${s.id}`),sx:{color:"rgba(255, 255, 255, 0.6)","&:hover":{color:"rgba(255, 255, 255, 0.9)",backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:e.jsx(hs,{className:"w-4 h-4"})}),e.jsxs(Menu,{anchorEl:B[`device-menu-${s.id}`],open:!!B[`device-menu-${s.id}`],onClose:()=>S(`device-menu-${s.id}`),sx:{"& .MuiPaper-root":{backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(16px)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px",minWidth:"200px"},"& .MuiMenuItem-root":{color:"rgba(255, 255, 255, 0.9)",padding:"8px 16px","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.15)"},"&.Mui-disabled":{color:"rgba(255, 255, 255, 0.3)"}}},children:[e.jsxs(MenuItem,{onClick:()=>{S(`device-menu-${s.id}`),pe(s.id,!s.single_device_login)},disabled:t[s.id],sx:{gap:1},children:[s.single_device_login?e.jsx(me,{className:"w-4 h-4"}):e.jsx(xe,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{children:s.single_device_login?"Disable Device Lock":"Enable Device Lock"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)"},children:s.single_device_login?"Disable device restriction":"Enable device restriction"})]})]}),s.single_device_login&&s.active_device&&e.jsxs(MenuItem,{onClick:()=>{S(`device-menu-${s.id}`),ue(s.id)},disabled:t[s.id],sx:{gap:1},children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{children:"Reset Device"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)"},children:"Allow login from new device"})]})]}),e.jsxs(MenuItem,{onClick:()=>{S(`device-menu-${s.id}`),oe.visit(route("users.device.show",{user:s.id}))},sx:{gap:1},children:[e.jsx(he,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{children:"View Devices"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)"},children:"View device history"})]})]})]})]})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[s.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(xs,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs line-clamp-1",children:s.phone})]}),(s.department||s.department_id)&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(re,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs",children:typeof s.department=="string"?s.department:"N/A"})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10 flex flex-wrap gap-2",children:[e.jsx(O,{size:"sm",variant:s.active?"solid":"bordered",color:s.active?"success":"danger",className:"text-xs",startContent:s.active?e.jsx(is,{className:"w-3 h-3"}):e.jsx(ls,{className:"w-3 h-3"}),children:s.active?"Active":"Inactive"}),(m=s.roles)==null?void 0:m.map((f,$)=>e.jsx(O,{size:"sm",variant:"flat",color:"secondary",className:"text-xs",startContent:e.jsx(ce,{className:"w-3 h-3"}),children:f},$)),s.single_device_login&&e.jsx(O,{size:"sm",variant:"flat",color:s.active_device?"warning":"default",className:"text-xs",startContent:e.jsx(ie,{className:"w-3 h-3"}),children:s.active_device?"Device Locked":"Device Free"})]})]})})},ys=n.useMemo(()=>{var s,l,m,f,$,We,Be,Ve,He,qe,Je,Qe,Xe,Ye;return[{title:"Total Users",value:((s=a==null?void 0:a.overview)==null?void 0:s.total_users)||0,icon:e.jsx(de,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All users"},{title:"Active Users",value:((l=a==null?void 0:a.overview)==null?void 0:l.active_users)||0,icon:e.jsx(is,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:`${((f=(m=a==null?void 0:a.health)==null?void 0:m.status_ratio)==null?void 0:f.active_percentage)||0}% Active`},{title:"Inactive Users",value:(($=a==null?void 0:a.overview)==null?void 0:$.inactive_users)||0,icon:e.jsx(ls,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:`${((Be=(We=a==null?void 0:a.health)==null?void 0:We.status_ratio)==null?void 0:Be.inactive_percentage)||0}% Inactive`},{title:"Total Roles",value:((Ve=a==null?void 0:a.overview)==null?void 0:Ve.total_roles)||0,icon:e.jsx(ie,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Role diversity"},{title:"Role Coverage",value:`${((qe=(He=a==null?void 0:a.health)==null?void 0:He.system_metrics)==null?void 0:qe.role_coverage)||0}%`,icon:e.jsx(Bs,{className:"w-5 h-5"}),color:"text-emerald-400",iconBg:"bg-emerald-500/20",description:"Users with roles"},{title:"Recent Activity",value:((Qe=(Je=a==null?void 0:a.activity)==null?void 0:Je.recent_registrations)==null?void 0:Qe.recently_active)||0,icon:e.jsx(ms,{className:"w-5 h-5"}),color:"text-cyan-400",iconBg:"bg-cyan-500/20",description:"Active last 7 days"},{title:"System Health",value:`${((Xe=a==null?void 0:a.quick_metrics)==null?void 0:Xe.system_health_score)||0}%`,icon:e.jsx(rs,{className:"w-5 h-5"}),color:"text-pink-400",iconBg:"bg-pink-500/20",description:"Overall health"},{title:"Departments",value:((Ye=a==null?void 0:a.overview)==null?void 0:Ye.total_departments)||0,icon:e.jsx(re,{className:"w-5 h-5"}),color:"text-indigo-400",iconBg:"bg-indigo-500/20",description:"Department diversity"}]},[a]),Ns=n.useMemo(()=>{const s=[];return s.push({label:p?"Add":"Add User",icon:e.jsx(Vs,{className:"w-4 h-4"}),onPress:()=>j("add"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),s.push({label:p?"":"Export",isIconOnly:p,icon:e.jsx(ns,{className:"w-4 h-4"}),variant:"bordered",className:"border-[rgba(var(--theme-primary-rgb),0.3)] bg-[rgba(var(--theme-primary-rgb),0.05)] hover:bg-[rgba(var(--theme-primary-rgb),0.1)]"}),s},[p,j]);return e.jsxs(e.Fragment,{children:[e.jsx(_s,{title:i}),T==="add"&&e.jsx(os,{user:null,open:T==="add",setUsers:ne,closeModal:ae,editMode:!1}),T==="edit"&&K&&e.jsx(os,{user:K,open:T==="edit",setUsers:ne,closeModal:ae,editMode:!0}),e.jsx(Box,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(Grow,{in:!0,children:e.jsx(Cs,{children:e.jsx(Us,{title:"Users Management",subtitle:"Manage users accounts and roles",icon:e.jsx(de,{className:"w-8 h-8"}),actionButtons:Ns,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(Ds,{stats:ys,className:"mb-6"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mb-6",children:[e.jsx(V,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(H,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(Hs,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"Role Distribution"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"User roles breakdown"})]})]}),e.jsx("div",{className:"space-y-3",children:(be=(ge=a==null?void 0:a.distribution)==null?void 0:ge.by_role)==null?void 0:be.slice(0,5).map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-linear-to-r from-purple-400 to-pink-400"}),e.jsx("span",{className:"text-sm text-foreground truncate",children:s.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:s.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",children:["(",s.percentage,"%)"]})]})]},l))})]})}),e.jsx(V,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(H,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(re,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"Department Distribution"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"Users by department"})]})]}),e.jsx("div",{className:"space-y-3",children:(ve=(fe=a==null?void 0:a.distribution)==null?void 0:fe.by_department)==null?void 0:ve.slice(0,5).map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-linear-to-r from-blue-400 to-cyan-400"}),e.jsx("span",{className:"text-sm text-foreground truncate",children:s.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:s.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",children:["(",s.percentage,"%)"]})]})]},l))})]})}),e.jsx(V,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(H,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e.jsx(ie,{className:"w-5 h-5 text-red-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"Security Metrics"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"Access control overview"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Users with Roles"}),e.jsx("span",{className:"text-sm font-medium text-green-400",children:((we=(je=a==null?void 0:a.security)==null?void 0:je.access_metrics)==null?void 0:we.users_with_roles)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Users without Roles"}),e.jsx("span",{className:"text-sm font-medium text-red-400",children:((Ne=(ye=a==null?void 0:a.security)==null?void 0:ye.access_metrics)==null?void 0:Ne.users_without_roles)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Admin Users"}),e.jsx("span",{className:"text-sm font-medium text-orange-400",children:((Ce=(_e=a==null?void 0:a.security)==null?void 0:_e.access_metrics)==null?void 0:Ce.admin_users)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Role Coverage"}),e.jsxs("span",{className:"text-sm font-medium text-blue-400",children:[((Fe=(ke=a==null?void 0:a.health)==null?void 0:ke.system_metrics)==null?void 0:Fe.role_coverage)||0,"%"]})]})]})]})}),e.jsx(V,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(H,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(ns,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"Activity Trends"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"Recent user activity"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Recently Active"}),e.jsx("span",{className:"text-sm font-medium text-green-400",children:((Re=(Pe=a==null?void 0:a.activity)==null?void 0:Pe.recent_registrations)==null?void 0:Re.recently_active)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"New (30 days)"}),e.jsx("span",{className:"text-sm font-medium text-blue-400",children:((Te=(Ie=a==null?void 0:a.activity)==null?void 0:Ie.recent_registrations)==null?void 0:Te.new_users_30_days)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"New (90 days)"}),e.jsx("span",{className:"text-sm font-medium text-cyan-400",children:((Ue=(Se=a==null?void 0:a.activity)==null?void 0:Se.recent_registrations)==null?void 0:Ue.new_users_90_days)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Growth Rate"}),e.jsxs("span",{className:"text-sm font-medium text-purple-400",children:[((De=a==null?void 0:a.activity)==null?void 0:De.user_growth_rate)||0,"%"]})]})]})]})}),e.jsx(V,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(H,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-teal-500/20 rounded-lg",children:e.jsx(rs,{className:"w-5 h-5 text-teal-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"System Health"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"Overall system metrics"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Health Score"}),e.jsxs("span",{className:"text-sm font-medium text-teal-400",children:[(($e=a==null?void 0:a.quick_metrics)==null?void 0:$e.system_health_score)||0,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Activation Rate"}),e.jsxs("span",{className:"text-sm font-medium text-green-400",children:[((Le=(Ae=a==null?void 0:a.health)==null?void 0:Ae.system_metrics)==null?void 0:Le.user_activation_rate)||0,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Dept. Coverage"}),e.jsxs("span",{className:"text-sm font-medium text-blue-400",children:[((Ee=(ze=a==null?void 0:a.health)==null?void 0:ze.system_metrics)==null?void 0:Ee.department_coverage)||0,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:"Total Departments"}),e.jsx("span",{className:"text-sm font-medium text-purple-400",children:((Me=a==null?void 0:a.overview)==null?void 0:Me.total_departments)||0})]})]})]})}),e.jsx(V,{className:"bg-white/5 backdrop-blur-md border-white/10",children:e.jsxs(H,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(qs,{className:"w-5 h-5 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx(Typography,{variant:"h6",className:"font-semibold text-foreground",children:"Status Breakdown"}),e.jsx(Typography,{variant:"caption",className:"text-default-500",children:"User status distribution"})]})]}),e.jsx("div",{className:"space-y-3",children:(Oe=(Ge=a==null?void 0:a.distribution)==null?void 0:Ge.by_status)==null?void 0:Oe.map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s.name==="Active"?"bg-green-400":s.name==="Inactive"?"bg-red-400":"bg-gray-400"}`}),e.jsx("span",{className:"text-sm text-foreground",children:s.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:s.count}),e.jsxs("span",{className:"text-xs text-default-500 ml-1",children:["(",s.percentage,"%)"]})]})]},l))})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(TextField,{placeholder:"Search by name, email or phone...",value:h.search,onChange:s=>G("search",s.target.value),InputProps:{startAdornment:e.jsx(InputAdornment,{position:"start",children:e.jsx(Is,{className:"w-4 h-4"})})},fullWidth:!0,size:p?"small":"medium",sx:ks("search")})}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs(Xs,{variant:"bordered",className:"bg-white/5",children:[e.jsxs(q,{isIconOnly:p,color:F==="table"?"primary":"default",onPress:()=>Q("table"),className:F==="table"?"bg-blue-500/20":"",children:[e.jsx(Js,{className:"w-4 h-4"}),!p&&e.jsx("span",{className:"ml-1",children:"Table"})]}),e.jsxs(q,{isIconOnly:p,color:F==="grid"?"primary":"default",onPress:()=>Q("grid"),className:F==="grid"?"bg-blue-500/20":"",children:[e.jsx(Ts,{className:"w-4 h-4"}),!p&&e.jsx("span",{className:"ml-1",children:"Grid"})]})]}),e.jsxs(q,{isIconOnly:p,variant:"bordered",onPress:()=>te(!v),className:v?"bg-purple-500/20":"bg-white/5",children:[e.jsx(Qs,{className:"w-4 h-4"}),!p&&e.jsx("span",{className:"ml-1",children:"Filters"})]})]})]}),v&&e.jsx(Fade,{in:!0,timeout:300,children:e.jsxs("div",{className:"mb-6 p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(FormControl,{fullWidth:!0,size:"small",sx:es(),children:[e.jsx(InputLabel,{children:"Status"}),e.jsxs(Z,{value:h.status,onChange:s=>G("status",s.target.value),children:[e.jsx(MenuItem,{value:"all",children:"All Statuses"}),e.jsx(MenuItem,{value:"active",children:"Active Only"}),e.jsx(MenuItem,{value:"inactive",children:"Inactive Only"})]})]}),e.jsxs(FormControl,{fullWidth:!0,size:"small",sx:es(),children:[e.jsx(InputLabel,{children:"Role"}),e.jsxs(Z,{value:h.role,onChange:s=>G("role",s.target.value),children:[e.jsx(MenuItem,{value:"all",children:"All Roles"}),A==null?void 0:A.map(s=>e.jsx(MenuItem,{value:s.toLowerCase(),children:s},s.toLowerCase()))]})]})]}),(h.search||h.status!=="all"||h.role!=="all")&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-white/10",children:[h.search&&e.jsxs(O,{variant:"flat",color:"primary",size:"sm",onClose:()=>G("search",""),children:["Search: ",h.search]}),h.status!=="all"&&e.jsxs(O,{variant:"flat",color:"secondary",size:"sm",onClose:()=>G("status","all"),children:["Status: ",h.status==="active"?"Active":"Inactive"]}),h.role!=="all"&&e.jsxs(O,{variant:"flat",color:"warning",size:"sm",onClose:()=>G("role","all"),children:["Role: ",h.role]})]})]})}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsxs(Typography,{variant:"h6",className:"font-semibold text-foreground",children:[F==="table"?"User Table":"User Grid",e.jsxs("span",{className:"text-sm text-default-500 ml-2",children:["(",c.total||0," ",c.total===1?"user":"users",")"]})]})}),W?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(CircularProgress,{size:40}),e.jsx(Typography,{className:"mt-4",color:"textSecondary",children:"Loading users data..."})]}):F==="table"?e.jsx(Ys,{allUsers:c.data,roles:A,setUsers:ne,isMobile:p,isTablet:g,pagination:_,onPageChange:ee,onRowsPerPageChange:le,totalUsers:c.total,loading:W,onEdit:s=>j("edit",s),updateUserOptimized:bs,deleteUserOptimized:fs,toggleUserStatusOptimized:vs,updateUserRolesOptimized:js,toggleSingleDeviceLogin:pe,resetUserDevice:ue,deviceActions:t}):e.jsxs("div",{className:"p-4",children:[c.data&&c.data.length>0?e.jsx("div",{className:`grid gap-4 ${p?"grid-cols-1":g?"grid-cols-2":"grid-cols-3 xl:grid-cols-4"}`,children:c.data.map((s,l)=>e.jsx(ws,{user:s,index:l},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(de,{className:"w-12 h-12 mx-auto text-default-300 mb-2"}),e.jsx(Typography,{variant:"body1",color:"textSecondary",children:"No users found"}),e.jsx(Typography,{variant:"caption",color:"textSecondary",children:"Try adjusting your search or filters"})]}),c.data&&c.data.length>0&&e.jsx("div",{className:"flex justify-center mt-6 border-t border-white/10 pt-4",children:e.jsx(us,{total:Math.ceil(c.total/_.perPage),initialPage:_.currentPage,page:_.currentPage,onChange:ee,size:p?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})})]})]})]})})})})})]})};Zs.layout=i=>e.jsx(Ss,{children:i});export{Zs as default};
