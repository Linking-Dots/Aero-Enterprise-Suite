import{j as a,a as l,Q as ye,b as ge}from"./app-B7AtoKun.js";import{r as o}from"./react-core-DDvupgOx.js";import{e as B,d as be,h as we,c as _e,B as w,A as xe}from"./App-CvPkoLA_.js";import{G as ve}from"./logo-Ije2rsrp.js";import{P as Ne}from"./PageHeader-BJJ9eJCg.js";import{S as Ce}from"./StatsCards-D_QYSQG6.js";import{a as k}from"./utilities-DT6SRl8s.js";import{u as Fe,a as E,G as Se,F as De,T as He,B as ke}from"./mui-libraries-DeLqYkpc.js";import{u as O,t as L,f as p,i as U,s as j,l as A,b as h,k as Oe,m as Ae,n as Ye,o as Re,q as ze,v as Te,w as q,x as G,y as Q,z as W,A as $e,B as V,C as I}from"./ui-libraries-CxFzkmxb.js";import{F as K}from"./GlobeAltIcon-bD-UMzKg.js";import{F as Me}from"./PencilIcon-Dhfhztfv.js";import{F as Pe}from"./TrashIcon-D8Us3Tf_.js";import{F as Be}from"./CheckCircleIcon-CJUGb5Jf.js";import{F as Ee}from"./ExclamationTriangleIcon-C_gcLnRy.js";import{F as Le}from"./FunnelIcon-BLg7eNfe.js";import{F as Ue}from"./PlusIcon-AKF5lePL.js";import"./EnvelopeIcon-D6nUSkik.js";import"./UserIcon-D16nn9o_.js";import"./ShieldCheckIcon-C7bFKizx.js";const je=({title:_,holidays:J,stats:n})=>{const Y=Fe(),f=E(Y.breakpoints.down("sm"));E(Y.breakpoints.down("md"));const[y,x]=o.useState(J),[m,R]=o.useState(""),[s,z]=o.useState(new Date().getFullYear().toString()),[T,X]=o.useState(!1),{isOpen:Z,onOpen:ee,onClose:ae}=O(),{isOpen:te,onOpen:le,onClose:re}=O(),{isOpen:oe,onOpen:se,onClose:v}=O(),[r,g]=o.useState(null),[d,c]=o.useState({title:"",from_date:"",to_date:"",description:"",type:"public",is_recurring:!1}),[$,b]=o.useState(!1),ie=o.useMemo(()=>[{title:"Total Holidays",value:n.total_holidays,icon:a(K,{}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All company holidays",trend:`${n.this_year_holidays} this year`},{title:"Upcoming",value:n.upcoming_holidays,icon:a(B,{}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Next holidays",trend:"Next 90 days"},{title:"This Month",value:n.this_month_holidays,icon:a(be,{}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Current month",trend:"Ongoing & upcoming"},{title:"Working Days",value:365-n.total_holidays,icon:a(we,{}),color:"text-orange-400",iconBg:"bg-orange-500/20",description:"Business days",trend:`${Math.round((365-n.total_holidays)/365*100)}% of year`}],[n]),N=o.useMemo(()=>y.filter(e=>{const t=e.title.toLowerCase().includes(m.toLowerCase()),i=s==="all"||new Date(e.from_date).getFullYear().toString()===s;return t&&i}),[y,m,s]),ne=o.useMemo(()=>[...new Set(y.map(t=>new Date(t.from_date).getFullYear()))].sort((t,i)=>i-t),[y]),C=[{key:"public",label:"Public Holiday",color:"primary"},{key:"religious",label:"Religious Holiday",color:"secondary"},{key:"national",label:"National Holiday",color:"success"},{key:"company",label:"Company Holiday",color:"warning"},{key:"optional",label:"Optional Holiday",color:"default"}],de=async()=>{b(!0);try{const e=r?await k.put(route("holiday.update",r.id),d):await k.post(route("holiday.store"),d);e.data.success&&(x(r?t=>t.map(i=>i.id===r.id?e.data.holiday:i):t=>[...t,e.data.holiday]),w.success(r?"Holiday updated successfully!":"Holiday created successfully!"),F())}catch{w.error("Failed to save holiday. Please try again.")}finally{b(!1)}},ce=async()=>{if(r){b(!0);try{await k.delete(route("holiday.destroy",r.id)),x(e=>e.filter(t=>t.id!==r.id)),w.success("Holiday deleted successfully!"),v(),g(null)}catch{w.error("Failed to delete holiday. Please try again.")}finally{b(!1)}}},F=()=>{ae(),re(),g(null),c({title:"",from_date:"",to_date:"",description:"",type:"public",is_recurring:!1})},me=e=>{g(e),c({title:e.title,from_date:e.from_date,to_date:e.to_date,description:e.description||"",type:e.type||"public",is_recurring:e.is_recurring||!1}),le()},ue=e=>{g(e),se()},pe=[{name:"Holiday",uid:"title"},{name:"Date",uid:"dates"},{name:"Duration",uid:"duration"},{name:"Type",uid:"type"},{name:"Status",uid:"status"},{name:"Actions",uid:"actions"}],he=o.useCallback((e,t)=>{const i=e[t],u=new Date(e.from_date),S=new Date(e.to_date),M=Math.ceil((S-u)/(1e3*60*60*24))+1,D=u>new Date,H=u<=new Date&&S>=new Date;switch(t){case"title":return l("div",{className:"flex flex-col",children:[a("p",{className:"text-bold text-small capitalize",children:e.title}),e.description&&a("p",{className:"text-bold text-tiny capitalize text-default-400",children:e.description})]});case"dates":return l("div",{className:"flex flex-col",children:[a("span",{className:"text-small",children:u.toLocaleDateString("en-US",{month:"short",day:"numeric",year:u.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}),e.from_date!==e.to_date&&l("span",{className:"text-tiny text-default-400",children:["to ",S.toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]});case"duration":return l(p,{size:"sm",variant:"flat",children:[M," ",M===1?"day":"days"]});case"type":const P=C.find(fe=>fe.key===e.type)||C[0];return a(p,{size:"sm",color:P.color,variant:"flat",children:P.label});case"status":return a(p,{size:"sm",color:H?"success":D?"warning":"default",variant:"flat",startContent:H?a(Be,{className:"w-3 h-3"}):D?a(B,{className:"w-3 h-3"}):a(Ee,{className:"w-3 h-3"}),children:H?"Ongoing":D?"Upcoming":"Past"});case"actions":return l("div",{className:"relative flex items-center gap-2",children:[a(L,{content:"Edit holiday",children:a("span",{className:"text-lg text-default-400 cursor-pointer active:opacity-50",onClick:()=>me(e),children:a(Me,{className:"w-4 h-4"})})}),a(L,{color:"danger",content:"Delete holiday",children:a("span",{className:"text-lg text-danger cursor-pointer active:opacity-50",onClick:()=>ue(e),children:a(Pe,{className:"w-4 h-4"})})})]});default:return i}},[]);return l(ge,{children:[a(ye,{title:_}),a(ke,{sx:{display:"flex",justifyContent:"center",p:2},children:a(Se,{in:!0,timeout:800,children:a(ve,{children:a(Ne,{title:"Company Holidays",subtitle:"Manage company-wide holidays and special occasions",icon:a(K,{className:"w-8 h-8"}),variant:"default",actionButtons:[{label:f?"Add":"Add Holiday",icon:a(Ue,{className:"w-4 h-4"}),onClick:ee,className:"bg-gradient-to-r from-[var(--theme-primary)] to-[var(--theme-secondary)] text-white font-medium hover:opacity-90"}],children:l("div",{className:"p-4 sm:p-6",children:[a(Ce,{stats:ie,className:"mb-6"}),l("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[a("div",{className:"flex-1",children:a(U,{label:"Search Holidays",variant:"bordered",placeholder:"Search by holiday name...",value:m,onValueChange:R,startContent:a(_e,{className:"w-4 h-4"}),classNames:{input:"bg-transparent",inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},size:f?"sm":"md"})}),l("div",{className:"flex gap-2 items-end",children:[l(j,{label:"Year",variant:"bordered",selectedKeys:[s],onSelectionChange:e=>z(Array.from(e)[0]),className:"w-32",classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[a(A,{value:"all",children:"All Years"},"all"),ne.map(e=>a(A,{value:e.toString(),children:e},e.toString()))]}),l(h,{isIconOnly:f,variant:"bordered",onPress:()=>X(!T),className:T?"bg-purple-500/20":"bg-white/5",children:[a(Le,{className:"w-4 h-4"}),!f&&a("span",{className:"ml-1",children:"Filters"})]})]})]}),(m||s!==new Date().getFullYear().toString())&&a(De,{in:!0,timeout:300,children:l("div",{className:"mb-4 flex flex-wrap gap-2",children:[m&&l(p,{variant:"flat",color:"primary",size:"sm",onClose:()=>R(""),children:["Search: ",m]}),s!==new Date().getFullYear().toString()&&l(p,{variant:"flat",color:"secondary",size:"sm",onClose:()=>z(new Date().getFullYear().toString()),children:["Year: ",s==="all"?"All Years":s]})]})}),l("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[a("div",{className:"p-4 border-b border-white/10",children:l(He,{variant:"h6",className:"font-semibold text-foreground",children:["Company Holidays",l("span",{className:"text-sm text-default-500 ml-2",children:["(",N.length," ",N.length===1?"holiday":"holidays",")"]})]})}),l(Oe,{isStriped:!0,removeWrapper:!0,"aria-label":"Holidays table",classNames:{th:"bg-white/5 text-default-600 border-b border-white/10",td:"border-b border-white/5"},children:[a(Ae,{columns:pe,children:e=>a(Ye,{align:e.uid==="actions"?"center":"start",children:e.name},e.uid)}),a(Re,{items:N,children:e=>a(ze,{children:t=>a(Te,{children:he(e,t)})},e.id)})]})]})]})})})})}),a(I,{isOpen:Z||te,onClose:F,size:"2xl",backdrop:"blur",classNames:{backdrop:"bg-gradient-to-t from-zinc-900 to-zinc-900/10 backdrop-opacity-20",base:"border-[#292f46] bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-md",header:"border-b-[1px] border-[#292f46]",footer:"border-t-[1px] border-[#292f46]"},children:l(q,{children:[a(G,{className:"flex flex-col gap-1",children:r?"Edit Holiday":"Add New Holiday"}),l(Q,{children:[l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a(U,{label:"Holiday Title",placeholder:"Enter holiday name",value:d.title,onChange:e=>c(t=>({...t,title:e.target.value})),isRequired:!0}),a(j,{label:"Holiday Type",selectedKeys:[d.type],onSelectionChange:e=>c(t=>({...t,type:Array.from(e)[0]})),children:C.map(e=>a(A,{value:e.key,children:e.label},e.key))}),a(W,{label:"From Date",value:d.from_date,onChange:e=>c(t=>({...t,from_date:e})),isRequired:!0}),a(W,{label:"To Date",value:d.to_date,onChange:e=>c(t=>({...t,to_date:e})),isRequired:!0})]}),a($e,{label:"Description (Optional)",placeholder:"Enter holiday description or additional notes",value:d.description,onChange:e=>c(t=>({...t,description:e.target.value})),rows:3})]}),l(V,{children:[a(h,{color:"danger",variant:"light",onPress:F,children:"Cancel"}),a(h,{color:"primary",onPress:de,isLoading:$,children:r?"Update Holiday":"Add Holiday"})]})]})}),a(I,{isOpen:oe,onClose:v,size:"md",backdrop:"blur",children:l(q,{children:[a(G,{className:"flex flex-col gap-1",children:"Confirm Delete"}),l(Q,{children:[l("p",{children:['Are you sure you want to delete the holiday "',r?.title,'"?']}),a("p",{className:"text-small text-danger",children:"This action cannot be undone."})]}),l(V,{children:[a(h,{color:"default",variant:"light",onPress:v,children:"Cancel"}),a(h,{color:"danger",onPress:ce,isLoading:$,children:"Delete Holiday"})]})]})})]})};je.layout=_=>a(xe,{children:_});export{je as default};
