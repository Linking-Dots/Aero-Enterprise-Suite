import{j as e,v as C,K as G,h as X,b as T,P as Z,a as B,e as O,m as ge,n as je,o as Ne,q as Fe,r as we,F as te,J as Q,A as ke,B as Se,C as De,D as Re,X as re,Y as ie,N as Ce,O as _e,E as Ie,d as We,g as $e,i as le,s as ne,l as oe}from"./vendor-heroui-CinxWHhv.js";import{R as Ee,r as b,Q as Me}from"./vendor-inertia-sUfCHI_5.js";import{T as Ye}from"./index-CtBsO7PD.js";import{u as q,a as H,f as de,d as ce,A as Pe}from"./Dashboard-isX2XDqi.js";import{u as Ae,b as ee}from"./app-Catfk_Bc.js";import{g as Y}from"./useThemeRadius-AM-qADuZ.js";import{F as U}from"./DocumentIcon-08C5TBVc.js";import{F as K}from"./ClockIcon-Auj34PFH.js";import{F as me}from"./CheckCircleIcon-CykloG3X.js";import{F as xe,D as ze,a as Le,b as Te,u as P,w as Be}from"./xlsx-5XwjyFIQ.js";import{F as A}from"./ChartBarIcon-BGC3fra6.js";import{a as se}from"./MapPinIcon-DDwLGyCW.js";import{F as pe}from"./CheckCircleIcon-BAvoXTNq.js";import{F as he}from"./ClockIcon-BKLni_N9.js";import{F as Oe}from"./ExclamationTriangleIcon-BarRaUA8.js";import{S as Ve}from"./StatsCards-CMSN0reW.js";import{s as ae}from"./toastUtils-BVg-E_WQ.js";import{F as Ge}from"./InformationCircleIcon-Hd0GuQtg.js";import{d as R}from"./dayjs.min-BJ9zlrPD.js";import{g as Qe}from"./vendor-react-FouZbkAE.js";import{i as Ue}from"./isBetween-BmZnC1k9.js";import{a as qe}from"./vendor-utils-CrJAVL9K.js";import{F as He}from"./DocumentArrowDownIcon-DCm9Iy1y.js";import{e as ue,A as Je}from"./vendor-framer-B7qqn1b6.js";import{F as Xe}from"./FunnelIcon-DZ8SUaNX.js";import{F as Ze}from"./AdjustmentsHorizontalIcon-lemo7t2o.js";import{F as Ke}from"./UserIcon-CgrjQ1A2.js";import"./EnvelopeIcon-CFKoTD3N.js";import"./UserGroupIcon-CSQScwVa.js";import"./ShieldCheckIcon-Ck-ae4AP.js";import"./XMarkIcon-twQGc8di.js";import"./KeyIcon-BIi5nz4o.js";import"./logo-DFaNDj_M.js";import"./MagnifyingGlassIcon-BJyUDYwI.js";import"./createLucideIcon-DJAbkOCz.js";const es=({filteredData:f,onRefresh:_,loading:I=!1})=>{const{theme:W}=Ae(),p=q("(max-width: 1024px)"),N=()=>e.jsxs("div",{className:"max-h-[84vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx(Q,{className:"w-32 h-6 rounded"}),e.jsx(Q,{className:"w-20 h-8 rounded"})]}),e.jsx(Z,{className:"max-h-[70vh]",children:e.jsxs("div",{className:"border border-divider rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-default-100/80 backdrop-blur-md border-b border-divider",children:e.jsx("div",{className:"flex",children:$.map((s,o)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(Q,{className:"w-20 h-4 rounded"})},o))})}),e.jsx("div",{className:"divide-y divide-divider",children:Array.from({length:8}).map((s,o)=>e.jsx("div",{className:"flex hover:bg-default-50/50 transition-colors",children:$.map((x,c)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(Q,{className:"w-full h-4 rounded"})},c))},o))})]})})]}),y=s=>new Date(s).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}),i=s=>s>=100?"success":s>=75?"warning":s>=50?"primary":"danger",h=s=>s>=100?e.jsx(me,{className:"w-3 h-3"}):s>=50?e.jsx(K,{className:"w-3 h-3"}):e.jsx(Oe,{className:"w-3 h-3"}),v=(s,o)=>{const x="w-3 h-3",c=o>0?"":"text-gray-400";switch(s==null?void 0:s.toLowerCase()){case"embankment":return e.jsx(ce,{className:`${x} text-amber-500 ${c}`});case"structure":return e.jsx(U,{className:`${x} text-blue-500 ${c}`});case"pavement":return e.jsx(se,{className:`${x} text-gray-500 ${c}`});default:return e.jsx(H,{className:`${x} text-primary ${c}`})}},S=({summary:s})=>{const o=s.totalDailyWorks>0?(s.completed/s.totalDailyWorks*100).toFixed(1):0,x=s.rfiSubmissions>0&&s.completed>0?(s.rfiSubmissions/s.completed*100).toFixed(1):0,c=s.totalDailyWorks-s.completed;return e.jsx(B,{className:"mb-2",shadow:"sm",radius:Y(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(O,{className:"p-3",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-3 flex-1",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-primary",style:{fontFamily:'var(--fontFamily, "Inter")'},children:y(s.date)}),e.jsxs("span",{className:"text-xs text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.totalDailyWorks," total works"]})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(X,{size:"sm",variant:"flat",color:i(parseFloat(o)),startContent:h(parseFloat(o)),radius:Y(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:[o,"%"]})})]}),e.jsx(te,{className:"my-3"}),e.jsxs("div",{className:"space-y-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Completion Progress"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.completed,"/",s.totalDailyWorks]})]}),e.jsx(G,{value:parseFloat(o),color:i(parseFloat(o)),size:"sm",radius:Y(),className:"w-full","aria-label":`Completion progress: ${o}%`})]}),s.rfiSubmissions>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"RFI Submission"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.rfiSubmissions,"/",s.completed]})]}),e.jsx(G,{value:parseFloat(x),color:i(parseFloat(x)),size:"sm",radius:Y(),className:"w-full","aria-label":`RFI submission progress: ${x}%`})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[v("embankment",s.embankment),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Embankment"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.embankment})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[v("structure",s.structure),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Structure"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.structure})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[v("pavement",s.pavement),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Pavement"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.pavement})]})]}),e.jsx(te,{className:"my-3"}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"w-3 h-3 text-warning"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Resubmissions: ",s.resubmissions]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3 text-danger"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Pending: ",c]})]})]})]})})},V=Ee.useCallback((s,o)=>{const x=s.totalDailyWorks>0?(s.completed/s.totalDailyWorks*100).toFixed(1):0,c=s.rfiSubmissions>0&&s.completed>0?(s.rfiSubmissions/s.completed*100).toFixed(1):0,t=s.totalDailyWorks-s.completed;switch(o){case"date":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(de,{className:"w-3 h-3 text-default-500"}),e.jsx("span",{className:"text-sm font-medium",children:y(s.date)})]})});case"totalDailyWorks":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"w-3 h-3 text-primary"}),e.jsx("span",{className:"text-sm font-bold",children:s.totalDailyWorks})]})});case"resubmissions":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"w-3 h-3 text-warning"}),e.jsx("span",{className:"text-sm",children:s.resubmissions})]})});case"embankment":case"structure":case"pavement":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[v(o,s[o]),e.jsx("span",{className:"text-sm",children:s[o]})]})});case"completed":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(me,{className:"w-3 h-3 text-success"}),e.jsx("span",{className:"text-sm font-medium text-success",children:s.completed})]})});case"pending":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3 text-danger"}),e.jsx("span",{className:"text-sm font-medium text-danger",children:t})]})});case"completionPercentage":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{value:parseFloat(x),color:i(parseFloat(x)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`Daily work completion: ${x}%`}),e.jsxs(X,{size:"sm",variant:"flat",color:i(parseFloat(x)),startContent:h(parseFloat(x)),children:[x,"%"]})]})});case"rfiSubmissions":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"w-3 h-3 text-info"}),e.jsx("span",{className:"text-sm",children:s.rfiSubmissions})]})});case"rfiSubmissionPercentage":return e.jsx(C,{children:e.jsx("div",{className:"flex items-center gap-2",children:s.rfiSubmissions>0?e.jsxs(e.Fragment,{children:[e.jsx(G,{value:parseFloat(c),color:i(parseFloat(c)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`RFI submission percentage: ${c}%`}),e.jsxs(X,{size:"sm",variant:"flat",color:i(parseFloat(c)),startContent:h(parseFloat(c)),children:[c,"%"]})]}):e.jsx("span",{className:"text-sm text-default-400",children:"-"})})});default:return e.jsx(C,{children:s[o]})}},[]),$=[{name:"Date",uid:"date",icon:de},{name:"Total Daily Works",uid:"totalDailyWorks",icon:H},{name:"Resubmissions",uid:"resubmissions",icon:ee},{name:"Embankment",uid:"embankment",icon:ce},{name:"Structure",uid:"structure",icon:U},{name:"Pavement",uid:"pavement",icon:se},{name:"Completed",uid:"completed",icon:pe},{name:"Pending",uid:"pending",icon:he},{name:"Completion %",uid:"completionPercentage",icon:A},{name:"RFI Submissions",uid:"rfiSubmissions",icon:U},{name:"RFI Submission %",uid:"rfiSubmissionPercentage",icon:A}];return p?e.jsxs("div",{className:"space-y-4",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[_&&e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(T,{size:"sm",variant:"bordered",color:"primary",radius:Y(),startContent:e.jsx(ee,{className:"w-4 h-4"}),onPress:_,"aria-label":"Refresh daily work summary table",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Refresh Summary"})}),e.jsx(Z,{className:"max-h-[70vh]",children:(f==null?void 0:f.length)>0?f.map((s,o)=>e.jsx(S,{summary:s},o)):e.jsx(B,{className:"text-center py-8",radius:Y(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(O,{children:[e.jsx(A,{className:"w-12 h-12 text-default-300 mb-4 mx-auto"}),e.jsx("h6",{className:"text-lg font-semibold text-default-600 mb-2",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No summary data found"}),e.jsx("p",{className:"text-sm text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No work summary available for the selected period"})]})})})]}):I?e.jsx(N,{}):e.jsx("div",{className:"max-h-[84vh] overflow-y-auto",children:e.jsx(Z,{className:"max-h-[70vh]",children:e.jsxs(ge,{selectionMode:"none",isCompact:!0,removeWrapper:!0,isStriped:!0,"aria-label":"Daily Work Summary Table",isHeaderSticky:!0,radius:Y(),classNames:{base:"max-h-[520px] overflow-auto",table:"min-h-[200px] w-full",thead:"z-10",tbody:"overflow-y-auto",th:"bg-default-100 text-default-700 font-semibold",td:"text-default-600"},style:{borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(je,{columns:$,children:s=>e.jsx(Ne,{align:s.uid==="date"?"start":"center",className:`bg-default-100/80 backdrop-blur-md ${s.width||""}`,style:{minWidth:s.uid==="date"?"128px":s.uid==="incharge"?"192px":"auto"},children:e.jsxs("div",{className:`flex items-center gap-1 ${s.uid==="date"?"justify-start":"justify-center"}`,children:[s.icon&&e.jsx(s.icon,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-semibold",children:s.name})]})},s.uid)}),e.jsx(Fe,{items:f||[],emptyContent:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(A,{className:"w-12 h-12 text-default-300 mb-4"}),e.jsx("h6",{className:"text-lg font-medium text-default-600",children:"No summary data found"}),e.jsx("span",{className:"text-sm text-default-500",children:"No work summary available for the selected period"})]}),children:s=>e.jsx(we,{children:o=>V(s,o)},s.date)})]})})})},ss=({open:f,closeModal:_,filteredData:I=[],inCharges:W=[]})=>{var x,c;const[p,N]=b.useState({format:"excel",columns:["date","totalDailyWorks","completed","pending","completionPercentage","rfiSubmissions","embankment","structure","pavement","resubmissions"],includeCharts:!1,groupBy:"date"}),[y,i]=b.useState(!1),h=[{key:"excel",label:"Excel (.xlsx)",description:"Comprehensive spreadsheet with summary data",icon:e.jsx(Le,{size:20,className:"text-green-600"})},{key:"csv",label:"CSV (.csv)",description:"Simple comma-separated values",icon:e.jsx(Te,{size:20,className:"text-blue-600"})}],v=[{key:"date",label:"Date",description:"Summary date"},{key:"totalDailyWorks",label:"Total Works",description:"Total number of daily works"},{key:"completed",label:"Completed",description:"Number of completed works"},{key:"pending",label:"Pending",description:"Number of pending works"},{key:"completionPercentage",label:"Completion %",description:"Completion percentage"},{key:"rfiSubmissions",label:"RFI Submissions",description:"Number of RFI submissions"},{key:"rfiSubmissionPercentage",label:"RFI Submission %",description:"RFI submission percentage"},{key:"embankment",label:"Embankment Works",description:"Number of embankment works"},{key:"structure",label:"Structure Works",description:"Number of structure works"},{key:"pavement",label:"Pavement Works",description:"Number of pavement works"},{key:"resubmissions",label:"Resubmissions",description:"Number of resubmissions"}],S=[{key:"date",label:"By Date",description:"Group summary by date"},{key:"type",label:"By Type",description:"Group summary by work type"},{key:"overall",label:"Overall Summary",description:"Single overall summary"}],V=async()=>{i(!0);const t=new Promise(async(n,l)=>{try{let r=$();const m=`daily_work_summary_${new Date().toISOString().split("T")[0]}`;switch(p.format){case"excel":s(r,m);break;case"csv":o(r,m);break}_(),n(`Successfully exported ${r.length} summary records`)}catch(r){l("Export failed: "+r.message)}finally{i(!1)}});ae.promise(t,{loading:"Exporting summary...",success:n=>n,error:n=>n})},$=()=>{let t=[...I];if(p.groupBy==="overall"){const n=t.reduce((j,k)=>j+k.totalDailyWorks,0),l=t.reduce((j,k)=>j+k.completed,0),r=t.reduce((j,k)=>j+k.rfiSubmissions,0),m=t.reduce((j,k)=>j+k.embankment,0),g=t.reduce((j,k)=>j+k.structure,0),d=t.reduce((j,k)=>j+k.pavement,0),M=t.reduce((j,k)=>j+k.resubmissions,0);t=[{date:"Overall Summary",totalDailyWorks:n,completed:l,pending:n-l,completionPercentage:n>0?(l/n*100).toFixed(1)+"%":"0%",rfiSubmissions:r,rfiSubmissionPercentage:n>0?(r/n*100).toFixed(1)+"%":"0%",embankment:m,structure:g,pavement:d,resubmissions:M}]}else if(p.groupBy==="type"){const n=t.reduce((l,r)=>(["embankment","structure","pavement"].forEach(m=>{r[m]>0&&(l[m]||(l[m]={type:m.charAt(0).toUpperCase()+m.slice(1),totalWorks:0,dates:[]}),l[m].totalWorks+=r[m],l[m].dates.push(r.date))}),l),{});t=Object.values(n).map(l=>({type:l.type,totalWorks:l.totalWorks,dateRange:`${Math.min(...l.dates)} to ${Math.max(...l.dates)}`,dateCount:l.dates.length}))}return t.map(n=>{const l={};return p.columns.forEach(r=>{var m;if(n.hasOwnProperty(r)){const g=((m=v.find(d=>d.key===r))==null?void 0:m.label)||r;l[g]=n[r]}}),l})},s=(t,n)=>{const l=P.json_to_sheet(t),r=P.book_new();P.book_append_sheet(r,l,"Summary");const m=Object.keys(t[0]||{}).map(()=>({wch:20}));l["!cols"]=m;const g=P.decode_range(l["!ref"]);for(let d=g.s.c;d<=g.e.c;d++){const M=P.encode_cell({r:0,c:d});l[M]&&(l[M].s={font:{bold:!0},fill:{fgColor:{rgb:"CCCCCC"}}})}Be(r,`${n}.xlsx`)},o=(t,n)=>{const l=P.json_to_sheet(t),r=P.sheet_to_csv(l),m=new Blob([r],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a"),d=URL.createObjectURL(m);g.setAttribute("href",d),g.setAttribute("download",`${n}.csv`),g.style.visibility="hidden",document.body.appendChild(g),g.click(),document.body.removeChild(g)};return e.jsx(ke,{isOpen:f,onClose:_,size:"3xl",scrollBehavior:"inside",classNames:{base:"backdrop-blur-md",backdrop:"bg-black/50 backdrop-blur-sm"},children:e.jsxs(Se,{children:[e.jsxs(De,{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-6 h-6 text-primary"}),e.jsx("span",{children:"Export Daily Work Summary"})]}),e.jsx("p",{className:"text-sm text-default-500 font-normal",children:"Export summary data with customizable grouping and format options"})]}),e.jsx(Re,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(B,{className:"bg-default-50",children:e.jsxs(O,{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Export Format"}),e.jsx(re,{value:p.format,onValueChange:t=>N(n=>({...n,format:t})),orientation:"horizontal",children:h.map(t=>e.jsx(ie,{value:t.key,children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.icon,e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsx("div",{className:"text-xs text-default-500",children:t.description})]})]})},t.key))})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Grouping & Summary"}),e.jsx(re,{value:p.groupBy,onValueChange:t=>N(n=>({...n,groupBy:t})),children:S.map(t=>e.jsx(ie,{value:t.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsx("div",{className:"text-xs text-default-500",children:t.description})]})},t.key))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Columns to Export"}),e.jsx(Ce,{value:p.columns,onValueChange:t=>N(n=>({...n,columns:t})),children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:v.map(t=>e.jsx(_e,{value:t.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsx("div",{className:"text-xs text-default-500",children:t.description})]})},t.key))})})]}),e.jsx(B,{className:"bg-primary-50 border-primary-200",children:e.jsx(O,{children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ge,{className:"w-5 h-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-primary-900",children:"Export Summary"}),e.jsxs("div",{className:"text-sm text-primary-700 space-y-1",children:[e.jsxs("p",{children:["• Format: ",(x=h.find(t=>t.key===p.format))==null?void 0:x.label]}),e.jsxs("p",{children:["• Grouping: ",(c=S.find(t=>t.key===p.groupBy))==null?void 0:c.label]}),e.jsxs("p",{children:["• Columns: ",p.columns.length," selected"]}),e.jsxs("p",{children:["• Records: ",I.length," summary entries"]})]})]})]})})})]})}),e.jsxs(Ie,{children:[e.jsx(T,{variant:"light",onPress:_,isDisabled:y,children:"Cancel"}),e.jsx(T,{color:"primary",onPress:V,isLoading:y,startContent:!y&&e.jsx(ze,{size:16}),isDisabled:p.columns.length===0,children:y?"Exporting...":"Export Summary"})]})]})})};var J={exports:{}},as=J.exports,fe;function ts(){return fe||(fe=1,function(f,_){(function(I,W){f.exports=W()})(as,function(){return function(I,W,p){var N=function(y,i){if(!i||!i.length||i.length===1&&!i[0]||i.length===1&&Array.isArray(i[0])&&!i[0].length)return null;var h;i.length===1&&i[0].length>0&&(i=i[0]),h=(i=i.filter(function(S){return S}))[0];for(var v=1;v<i.length;v+=1)i[v].isValid()&&!i[v][y](h)||(h=i[v]);return h};p.max=function(){var y=[].slice.call(arguments,0);return N("isAfter",y)},p.min=function(){var y=[].slice.call(arguments,0);return N("isBefore",y)}}})}(J)),J.exports}var rs=ts();const is=Qe(rs);R.extend(is);R.extend(Ue);const ls=({auth:f,title:_,summary:I,jurisdictions:W,inCharges:p})=>{const N=q("(min-width: 1025px)"),y=q("(min-width: 641px) and (max-width: 1024px)"),i=q("(max-width: 640px)"),h=()=>{var E;if(typeof window>"u")return"lg";const u=((E=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:E.trim())||"12px",D=parseInt(u);return D===0?"none":D<=4?"sm":D<=8?"md":D<=16?"lg":"full"},[v]=b.useState(I),[S,V]=b.useState(I),[$,s]=b.useState(!1),[o,x]=b.useState(null),[c,t]=b.useState(!1),n=b.useCallback(a=>{x(a)},[]),l=b.useCallback(()=>{x(null)},[]),r=b.useMemo(()=>!v||v.length===0?[]:v.map(a=>R(a.date)).filter(a=>a.isValid()),[v]),m=b.useCallback((a,u,D,E="name")=>{if(!a||a.length===0)return e.jsx("span",{className:"text-default-400 text-xs",children:D});const L=a.map(String),F=(u==null?void 0:u.filter(w=>L.includes(String(w.id))).map(w=>w[E]))??[];return F.length===0?e.jsx("span",{className:"text-default-400 text-xs",children:D}):e.jsx("div",{className:"flex flex-wrap gap-1",children:F.map(w=>e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-primary/10 text-primary",children:w},w))})},[]),g=b.useMemo(()=>(W==null?void 0:W.map(a=>({...a,displayLabel:`${a.start_chainage} - ${a.end_chainage}`})))??[],[W]),[d,M]=b.useState({startDate:r.length>0?R.min(...r).format("YYYY-MM-DD"):R().subtract(30,"days").format("YYYY-MM-DD"),endDate:r.length>0?R.max(...r).format("YYYY-MM-DD"):R().format("YYYY-MM-DD"),status:"all",incharge:[],jurisdiction:[]}),j=b.useCallback(async()=>{var a,u,D,E,L;s(!0);try{const F={startDate:d.startDate,endDate:d.endDate};(a=d.incharge)!=null&&a.length&&(F.incharge=d.incharge),(u=d.jurisdiction)!=null&&u.length&&(F.jurisdiction=d.jurisdiction);const ve=((D=(await qe.post(Ye("daily-works-summary.filter"),F)).data)==null?void 0:D.summaries)??[];return V(ve),!0}catch(F){console.error("Failed to load filtered summary:",F);const w=((L=(E=F.response)==null?void 0:E.data)==null?void 0:L.error)||"Failed to load summary data";return ae.error(w),!1}finally{s(!1)}},[d]),k=b.useCallback(async()=>{await j()&&ae.success("Summary data refreshed successfully")},[j]),z=b.useCallback((a,u)=>{M(D=>({...D,[a]:u}))},[]),be=b.useMemo(()=>{const a=S.reduce((F,w)=>F+w.totalDailyWorks,0),u=S.reduce((F,w)=>F+w.completed,0),D=S.reduce((F,w)=>F+w.pending,0),E=S.reduce((F,w)=>F+w.rfiSubmissions,0),L=a>0?(u/a*100).toFixed(1):0;return[{title:"Total Works",value:a,icon:e.jsx(A,{className:"w-5 h-5"}),color:"text-blue-600",description:"All logged works"},{title:"Completed",value:u,icon:e.jsx(pe,{className:"w-5 h-5"}),color:"text-green-600",description:`${L}% completion rate`},{title:"Pending",value:D,icon:e.jsx(he,{className:"w-5 h-5"}),color:"text-orange-600",description:"In progress"},{title:"RFI Submissions",value:E,icon:e.jsx(H,{className:"w-5 h-5"}),color:"text-purple-600",description:"Ready for inspection"}]},[S]),ye=[{label:"Refresh",icon:e.jsx(ee,{className:"w-4 h-4"}),variant:"flat",color:"primary",onPress:k,isLoading:$,className:"bg-linear-to-r from-blue-500/20 to-cyan-500/20 hover:from-blue-500/30 hover:to-cyan-500/30",ariaLabel:"Refresh daily work summary data"},...f.roles.includes("Administrator")||f.designation==="Supervision Engineer"?[{label:"Export",icon:e.jsx(He,{className:"w-4 h-4"}),variant:"flat",color:"success",onPress:()=>n("exportDailyWorkSummary"),className:"bg-linear-to-r from-green-500/20 to-emerald-500/20 hover:from-green-500/30 hover:to-emerald-500/30",ariaLabel:"Export daily work summary data"}]:[]];return b.useEffect(()=>{r.length>0&&(!d.startDate||!d.endDate)&&M(a=>({...a,startDate:R.min(...r).format("YYYY-MM-DD"),endDate:R.max(...r).format("YYYY-MM-DD")}))},[r]),b.useEffect(()=>{j()},[j]),e.jsxs(e.Fragment,{children:[e.jsx(Me,{title:_}),o==="exportDailyWorkSummary"&&e.jsx(ss,{open:o==="exportDailyWorkSummary",closeModal:l,filteredData:S,inCharges:p}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full max-w-[2000px]",children:e.jsxs(B,{className:"transition-all duration-200",radius:h(),style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                var(--theme-content1, #FAFAFA) 20%, 
                                var(--theme-content2, #F4F4F5) 10%, 
                                var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(We,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                    color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                    color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${N?"p-6":y?"p-4":"p-3"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                    ${N?"p-3":y?"p-2.5":"p-2"} 
                                                    rounded-xl flex items-center justify-center
                                                `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(A,{className:`
                                                        ${N?"w-8 h-8":y?"w-6 h-6":"w-5 h-5"}
                                                    `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                        ${N?"text-2xl":y?"text-xl":"text-lg"}
                                                        font-bold text-foreground
                                                        ${N?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Daily Work Summary"}),e.jsx("p",{className:`
                                                        ${N?"text-sm":"text-xs"} 
                                                        text-default-500
                                                        ${N?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Overview of daily work statistics and progress"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex items-center gap-2",children:ye.map((a,u)=>e.jsx(T,{size:N?"md":"sm",variant:a.variant||"flat",color:a.color||"primary",startContent:a.icon,onPress:a.onPress,isLoading:a.isLoading,className:`${a.className||""} font-medium`,radius:h(),"aria-label":a.ariaLabel||a.label,style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)"},children:a.label},u))})})]})})})}),e.jsxs(O,{className:"pt-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Ve,{stats:be,isLoading:$}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-5 h-5 text-default-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Quick Filters:"})]}),e.jsx("div",{className:"flex gap-2 items-end",children:e.jsx($e,{variant:"bordered",radius:h(),className:"bg-white/5",children:e.jsxs(T,{isIconOnly:i,color:c?"primary":"default",onPress:()=>t(!c),className:c?"bg-primary/20":"bg-white/5","aria-label":c?"Hide advanced filters":"Show advanced filters",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Ze,{className:"w-4 h-4"}),!i&&e.jsx("span",{className:"ml-1",children:"Advanced Filters"})]})})})]}),e.jsx(Je,{children:c&&e.jsx(ue.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx("div",{className:"p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(le,{type:"date",label:"Start Date",value:d.startDate,onChange:a=>z("startDate",a.target.value),size:"sm",variant:"bordered",radius:h(),"aria-label":"Select start date",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                             focus-within:bg-content2/90 border-divider/50 
                                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(le,{type:"date",label:"End Date",value:d.endDate,onChange:a=>z("endDate",a.target.value),size:"sm",variant:"bordered",radius:h(),"aria-label":"Select end date",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                             focus-within:bg-content2/90 border-divider/50 
                                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}}),(f.roles.includes("Administrator")||f.roles.includes("Super Administrator")||f.designation==="Supervision Engineer")&&e.jsx(ne,{label:"In Charge",placeholder:"Select in charge...",selectionMode:"multiple",selectedKeys:new Set(d.incharge||[]),onSelectionChange:a=>{const u=Array.from(a);z("incharge",u),u.length>0&&z("jurisdiction",[])},variant:"bordered",size:"sm",radius:h(),startContent:e.jsx(Ke,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground",listboxWrapper:"bg-content1",popoverContent:"bg-content1"},renderValue:()=>m(d.incharge,p,"Select in charge..."),style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by in charge",children:p.map(a=>e.jsx(oe,{value:String(a.id),children:a.name},String(a.id)))}),(f.roles.includes("Administrator")||f.roles.includes("Super Administrator")||f.designation==="Supervision Engineer")&&e.jsx(ne,{label:"Jurisdiction",placeholder:"Select jurisdiction...",selectionMode:"multiple",selectedKeys:new Set(d.jurisdiction||[]),onSelectionChange:a=>{const u=Array.from(a);z("jurisdiction",u),u.length>0&&z("incharge",[])},variant:"bordered",size:"sm",radius:h(),startContent:e.jsx(se,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground",listboxWrapper:"bg-content1",popoverContent:"bg-content1"},renderValue:()=>m(d.jurisdiction,g,"Select jurisdiction...","displayLabel"),style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by jurisdiction",children:g==null?void 0:g.map(a=>e.jsx(oe,{value:String(a.id),children:a.displayLabel},String(a.id)))}),e.jsx("div",{className:"flex items-end",children:e.jsx(T,{size:"sm",variant:"flat",color:"danger",onPress:()=>{M({startDate:r.length>0?R.min(...r).format("YYYY-MM-DD"):R().subtract(30,"days").format("YYYY-MM-DD"),endDate:r.length>0?R.max(...r).format("YYYY-MM-DD"):R().format("YYYY-MM-DD"),status:"all",incharge:[],jurisdiction:[]})},style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Clear Filters"})})]})})})})]})}),e.jsx(B,{radius:h(),className:"bg-content1/80 backdrop-blur-md border border-divider/20",style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)",border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                        color-mix(in srgb, var(--theme-content1) 90%, transparent) 20%, 
                                        color-mix(in srgb, var(--theme-content2) 60%, transparent) 10%)`},children:e.jsx(O,{className:"p-0",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsx(es,{filteredData:S,onRefresh:k,loading:$})})})]})]})})})]})};ls.layout=f=>e.jsx(Pe,{children:f});export{ls as default};
