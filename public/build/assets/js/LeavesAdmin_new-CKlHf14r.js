import{j as e,a as S,e as _,d as B,b as j,i as P,g as de,s as T,l as d,k as ce}from"./vendor-heroui-CinxWHhv.js";import{J as me,r as t,Q as W}from"./vendor-inertia-sUfCHI_5.js";import{a as Y,f as pe,A as ve}from"./Dashboard-B0BKoUtD.js";import{S as ue}from"./StatsCards-EhVNQOnO.js";import{L as q,D as xe,B as fe,a as he,b as be}from"./BulkDeleteModal-Cizura3b.js";import{d as ye}from"./dayjs.min-BJ9zlrPD.js";import{a as je}from"./vendor-utils-CrJAVL9K.js";import"./toastUtils-BVg-E_WQ.js";import{F as ge}from"./ClockIcon-BKLni_N9.js";import{F as Fe}from"./CheckCircleIcon-BAvoXTNq.js";import{F as we}from"./XCircleIcon-BzKw4V53.js";import{F as R}from"./MapPinIcon-DDwLGyCW.js";import{F as Ne}from"./ExclamationTriangleIcon-BarRaUA8.js";import{e as O}from"./vendor-framer-B7qqn1b6.js";import{F as ke}from"./PresentationChartLineIcon-BVDAJ73-.js";import{F as Le}from"./PlusIcon-BO1LbXgZ.js";import{F as Se}from"./DocumentArrowDownIcon-DCm9Iy1y.js";import{F as _e}from"./MagnifyingGlassIcon-BjGR0KXJ.js";import{F as Re}from"./AdjustmentsHorizontalIcon-lemo7t2o.js";import"./vendor-react-FouZbkAE.js";import"./app-D0ZNdme8.js";import"./EnvelopeIcon-CFKoTD3N.js";import"./UserGroupIcon-CSQScwVa.js";import"./UserIcon-CgrjQ1A2.js";import"./ShieldCheckIcon-Ck-ae4AP.js";import"./XMarkIcon-twQGc8di.js";import"./KeyIcon-BIi5nz4o.js";import"./logo-DFaNDj_M.js";import"./MagnifyingGlassIcon-BJyUDYwI.js";import"./index-CtBsO7PD.js";import"./TrashIcon-Dnjv_I7q.js";import"./PencilIcon-BsmkHcSS.js";import"./EllipsisVerticalIcon-CqOfKM9J.js";import"./XCircleIcon-Cv262LQg.js";import"./CheckCircleIcon-CykloG3X.js";import"./ClockIcon-Auj34PFH.js";import"./ExclamationTriangleIcon-D3y6aOMr.js";import"./createLucideIcon-DJAbkOCz.js";import"./HeartIcon-DRLfg0vS.js";import"./SunIcon-QPa9r1ID.js";import"./calendar-CNUH36JA.js";import"./user-CD9nOF0M.js";import"./clock-Cy0rHGp7.js";import"./InformationCircleIcon-Hd0GuQtg.js";const Me=({title:x,allUsers:f})=>{var D,E,I,$,z;const{auth:m}=me().props,[r,Q]=t.useState(!1),[Ce,J]=t.useState(!1);t.useEffect(()=>{const a=()=>{Q(window.innerWidth<640),J(window.innerWidth<768)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);const[K,Ae]=t.useState(!1),[g,p]=t.useState([]),[De,F]=t.useState(),[Ee,v]=t.useState(0),[Ie,w]=t.useState(0),[h,M]=t.useState(),[G,C]=t.useState([]),[$e,ze]=t.useState(""),[N,Be]=t.useState([]),[Pe,H]=t.useState({perPage:30,currentPage:1}),[Te,We]=t.useState(!1),[k,X]=t.useState(!1),[i,Z]=t.useState({employee:"",selectedMonth:ye().format("YYYY-MM"),status:[],leaveType:[],department:[]}),b=t.useCallback((a,s)=>{if(a==="year"){const o=Number(s);if(o<1900||o>new Date().getFullYear()){console.warn("Invalid year selected. Must be between 1900 and current year.");return}}Z(o=>({...o,[a]:s})),H(o=>({...o,currentPage:1}))},[]),[c,V]=t.useState({pending:0,approved:0,rejected:0,total:0,thisMonth:0,thisWeek:0,totalDaysUsed:0,totalDaysRemaining:0}),U=t.useMemo(()=>[{title:"Total Leaves",value:c.total,icon:e.jsx(Y,{}),color:"text-primary",iconBg:"bg-primary/20",description:"All leave requests"},{title:"Pending",value:c.pending,icon:e.jsx(ge,{}),color:"text-warning",iconBg:"bg-warning/20",description:"Awaiting approval"},{title:"Approved",value:c.approved,icon:e.jsx(Fe,{}),color:"text-success",iconBg:"bg-success/20",description:"Approved requests"},{title:"Rejected",value:c.rejected,icon:e.jsx(we,{}),color:"text-danger",iconBg:"bg-danger/20",description:"Rejected requests"},{title:"This Month",value:c.thisMonth,icon:e.jsx(pe,{}),color:"text-secondary",iconBg:"bg-secondary/20",description:"Current month"},{title:"This Week",value:c.thisWeek,icon:e.jsx(R,{}),color:"text-primary",iconBg:"bg-primary/20",description:"Current week"}],[c]),ee=((D=m.permissions)==null?void 0:D.includes("leaves.view"))||!1,ae=((E=m.permissions)==null?void 0:E.includes("leaves.approve"))||!1,A=((I=m.permissions)==null?void 0:I.includes("leaves.create"))||!1,te=(($=m.permissions)==null?void 0:$.includes("leaves.update"))||!1,se=((z=m.permissions)==null?void 0:z.includes("leaves.delete"))||!1,[n,L]=t.useState({add_leave:!1,edit_leave:!1,delete_leave:!1,bulk_leave:!1,bulk_delete:!1}),re=t.useRef(null),y=t.useCallback(a=>{L(s=>({...s,[a]:!0}))},[]),u=t.useCallback(a=>{L(s=>({...s,[a]:!1})),a==="bulk_delete"&&C([])},[]),le=t.useCallback(a=>{C(a),L(s=>({...s,bulk_delete:!0}))},[]),l=t.useCallback(async()=>{try{const a=await je.get(route("leaves.stats"));a.data.success&&V(a.data.data)}catch(a){console.error("Failed to fetch leave stats:",a)}},[]),oe=t.useCallback(a=>{p(s=>[a,...s]),v(s=>s+1),l()},[l]),ne=t.useCallback(a=>{p(s=>s.map(o=>o.id===a.id?a:o)),l()},[l]),ie=t.useCallback(a=>{p(s=>s.filter(o=>o.id!==a)),v(s=>s-1),l()},[l]);return t.useEffect(()=>{l()},[l]),ee?e.jsxs(e.Fragment,{children:[e.jsx(W,{title:x}),n.add_leave&&e.jsx(q,{open:n.add_leave,closeModal:()=>u("add_leave"),leavesData:g,setLeavesData:p,currentLeave:null,allUsers:f,departments:N,setTotalRows:v,setLastPage:w,setLeaves:F,employee:i.employee,selectedMonth:i.selectedMonth,addLeaveOptimized:oe,fetchLeavesStats:l}),n.edit_leave&&e.jsx(q,{open:n.edit_leave,closeModal:()=>u("edit_leave"),leavesData:g,setLeavesData:p,currentLeave:h,allUsers:f,departments:N,setTotalRows:v,setLastPage:w,setLeaves:F,employee:i.employee,selectedMonth:i.selectedMonth,updateLeaveOptimized:ne,fetchLeavesStats:l}),n.delete_leave&&e.jsx(xe,{open:n.delete_leave,closeModal:()=>u("delete_leave"),leaveId:h==null?void 0:h.id,setLeaves:F,setTotalRows:v,setLastPage:w,deleteLeaveOptimized:ie,fetchLeavesStats:l}),n.bulk_leave&&e.jsx(fe,{open:n.bulk_leave,onClose:()=>u("bulk_leave"),onSuccess:a=>{l()},allUsers:f,departments:N,leavesData:g,isAdmin:!0}),n.bulk_delete&&e.jsx(he,{open:n.bulk_delete,onClose:()=>u("bulk_delete"),onSuccess:a=>{l()},selectedLeaves:G,allUsers:f}),e.jsx("div",{className:"flex flex-col w-full h-full p-4",role:"main","aria-label":"Leave Management",children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"w-full",children:e.jsx(O.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:e.jsxs(S,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                        var(--theme-content1, #FAFAFA) 20%, 
                                        var(--theme-content2, #F4F4F5) 10%, 
                                        var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(B,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                            color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                            color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${r?"p-4":"p-6"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                            ${r?"p-2":"p-3"} 
                                                            rounded-xl flex items-center justify-center
                                                        `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(ke,{className:`
                                                                ${r?"w-6 h-6":"w-8 h-8"}
                                                            `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                                ${r?"text-xl":"text-2xl"}
                                                                font-bold text-foreground
                                                                ${r?"truncate":""}
                                                            `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Leave Management"}),e.jsx("p",{className:`
                                                                ${r?"text-xs":"text-sm"} 
                                                                text-default-500
                                                                ${r?"truncate":""}
                                                            `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Manage employee leave requests and approvals"})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[A&&e.jsx(j,{color:"primary",variant:"shadow",startContent:e.jsx(Le,{className:"w-4 h-4"}),onPress:()=>y("add_leave"),size:r?"sm":"md",className:"font-semibold",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Add Leave"}),A&&e.jsx(j,{color:"secondary",variant:"flat",startContent:e.jsx(R,{className:"w-4 h-4"}),onPress:()=>y("bulk_leave"),size:r?"sm":"md",className:"font-semibold",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Bulk Add"}),e.jsx(j,{color:"default",variant:"bordered",startContent:e.jsx(Se,{className:"w-4 h-4"}),size:r?"sm":"md",className:"font-semibold",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Export"})]})]})})})}),e.jsxs(_,{className:"p-6",children:[e.jsx(ue,{stats:U,className:"mb-6"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(P,{label:"Search Employee",placeholder:"Search by name or ID...",value:i.employee,onChange:a=>b("employee",a.target.value),startContent:e.jsx(_e,{className:"w-4 h-4 text-default-400"}),variant:"bordered",size:r?"sm":"md",className:"w-full",style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"flex gap-2 items-end",children:e.jsx(de,{variant:"bordered",children:e.jsxs(j,{isIconOnly:r,color:k?"primary":"default",onPress:()=>X(!k),style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Re,{className:"w-4 h-4"}),!r&&e.jsx("span",{className:"ml-1",children:"Filters"})]})})})]}),k&&e.jsx(O.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx("div",{className:"mb-6 p-4 rounded-lg border border-divider",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(T,{label:"Leave Status",placeholder:"Select status...",selectionMode:"multiple",selectedKeys:new Set(i.status),onSelectionChange:a=>b("status",Array.from(a)),variant:"bordered",size:r?"sm":"md",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(d,{value:"pending",children:"Pending"},"pending"),e.jsx(d,{value:"approved",children:"Approved"},"approved"),e.jsx(d,{value:"rejected",children:"Rejected"},"rejected"),e.jsx(d,{value:"new",children:"New"},"new")]}),e.jsxs(T,{label:"Leave Type",placeholder:"Select type...",selectionMode:"multiple",selectedKeys:new Set(i.leaveType),onSelectionChange:a=>b("leaveType",Array.from(a)),variant:"bordered",size:r?"sm":"md",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(d,{value:"sick",children:"Sick Leave"},"sick"),e.jsx(d,{value:"annual",children:"Annual Leave"},"annual"),e.jsx(d,{value:"personal",children:"Personal Leave"},"personal"),e.jsx(d,{value:"maternity",children:"Maternity Leave"},"maternity")]}),e.jsx(P,{label:"Month/Year",type:"month",value:i.selectedMonth,onChange:a=>b("selectedMonth",a.target.value),startContent:e.jsx(R,{className:"w-4 h-4 text-default-400"}),variant:"bordered",size:r?"sm":"md",style:{fontFamily:'var(--fontFamily, "Inter")'}})]})})}),e.jsxs(S,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',background:`linear-gradient(135deg, 
                                                var(--theme-content1, #FAFAFA) 20%, 
                                                var(--theme-content2, #F4F4F5) 10%, 
                                                var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(B,{className:"border-b pb-2",style:{borderColor:"var(--theme-divider, #E4E4E7)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg flex items-center justify-center",style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)"},children:e.jsx(Y,{className:"w-6 h-6",style:{color:"var(--theme-primary)"}})}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-semibold text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Leave Records"})]})}),e.jsx(_,{children:K?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx(ce,{size:"lg"})}):e.jsx("div",{className:"max-h-[84vh] overflow-y-auto",children:e.jsx(be,{ref:re,filterData:i,onEditLeave:a=>{M(a),y("edit_leave")},onDeleteLeave:a=>{M(a),y("delete_leave")},onBulkDelete:le,isAdmin:!0,canEdit:te,canDelete:se,canApprove:ae})})})]})]})]})})})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{title:x}),e.jsx("div",{className:"flex flex-col w-full h-full p-4",children:e.jsx(S,{className:"max-w-md mx-auto mt-8",children:e.jsxs(_,{className:"p-8 text-center",children:[e.jsx(Ne,{className:"w-16 h-16 text-warning mx-auto mb-4"}),e.jsx("h6",{className:"text-lg font-semibold mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-sm text-default-500",children:"You don't have permission to view leave management."})]})})})]})};Me.layout=x=>e.jsx(ve,{children:x});export{Me as default};
