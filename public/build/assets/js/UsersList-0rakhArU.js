import{a,j as e,L as Le,F as ee,b as Fe,H as st,r as fe}from"./app-4xO7QMbQ.js";import{r as n,n as Se,g as je}from"./react-core-ZDN6GY9H.js";import{k as it,h as he,q as Je,B as P,r as Ie,b as ve,e as lt,c as nt,o as ot,A as dt}from"./App-CcunCrEp.js";import{G as ct}from"./logo-CW2fW_lL.js";import{P as mt}from"./PageHeader-DL0cxjrC.js";import{S as ut}from"./StatsCards-67JEhJ1x.js";import{u as Ae,Z as De,B as pe,T as y,o as xe,p as ht,h as k,a6 as pt,j as A,i as L,I as me,M as $,m as ue,q as gt,r as bt,a as $e,G as ft,F as vt,f as xt}from"./mui-libraries-BtmIKYJi.js";import{F as Ze}from"./EllipsisVerticalIcon-B3UU8oqU.js";import{F as Ne}from"./UserIcon-Vw3xDLqJ.js";import{F as Qe}from"./PencilIcon-apaSougW.js";import{F as _e,a as ye}from"./LockOpenIcon-BgjATH9x.js";import{F as Pe}from"./LockClosedIcon-D4pFY55q.js";import{a as ge}from"./ShieldCheckIcon-DfDaQsK0.js";import{F as wt}from"./EnvelopeIcon-B_JLNrsu.js";import{k as Nt,m as _t,n as yt,o as Pt,q as Ct,v as kt,N as we,G as Ke,O as Ce,b as X,P as ke,Q as O,S as Re,h as Rt,f as G,t as Ft,L as Xe,s as te,g as Q,e as K,i as St,D as jt,l as ie}from"./ui-libraries-CP3AhJpb.js";import{C as It}from"./Clear-BOqHom54.js";import{G as At}from"./GlassDialog-BMfAfG2u.js";import{P as Dt}from"./PhotoCamera-DwPsJH0N.js";import{L as Ut}from"./LoadingButton-_ogDhfaH.js";import{a as le}from"./utilities-DyZVG5is.js";import{F as Ee}from"./CheckCircleIcon-B49SGIg1.js";import{F as ze}from"./XCircleIcon-XneVflro.js";import{F as Tt}from"./TrophyIcon-CrXXw2R_.js";import{F as Lt}from"./UserPlusIcon-C7p_-edL.js";import{F as Oe}from"./ChartBarIcon-RXU87FdU.js";import{F as $t}from"./ChartPieIcon-CQIzlcBr.js";import{F as Et}from"./ExclamationTriangleIcon-BAHPm542.js";import{F as zt}from"./TableCellsIcon-D1LE4M8f.js";import{F as Ot}from"./AdjustmentsHorizontalIcon-C4FnR9vQ.js";function Vt({title:o,titleId:R,...x},f){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:f,"aria-labelledby":R},x),o?n.createElement("title",{id:R},o):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.348 14.652a3.75 3.75 0 0 1 0-5.304m5.304 0a3.75 3.75 0 0 1 0 5.304m-7.425 2.121a6.75 6.75 0 0 1 0-9.546m9.546 0a6.75 6.75 0 0 1 0 9.546M5.106 18.894c-3.808-3.807-3.808-9.98 0-13.788m13.788 0c3.808 3.807 3.808 9.98 0 13.788M12 12h.008v.008H12V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const Ve=n.forwardRef(Vt),Mt=({allUsers:o,roles:R,isMobile:x,isTablet:f,setUsers:E,pagination:w,onPageChange:v,onRowsPerPageChange:j,totalUsers:D=0,onEdit:J,loading:h=!1,updateUserOptimized:ae,deleteUserOptimized:c,toggleUserStatusOptimized:V,updateUserRolesOptimized:M,toggleSingleDeviceLogin:U,resetUserDevice:q,deviceActions:p={}})=>{const[re,B]=n.useState({});Ae();const I=(t,d,u)=>{B(s=>({...s,[`${t}-${d}`]:u}))},b=(t,d)=>re[`${t}-${d}`]||!1;async function Y(t,d){I(t,"role",!0);const u=new Promise(async(s,N)=>{try{const m=await axios.post(route("user.updateRole",{id:t}),{roles:d});m.status===200&&(M&&M(t,d),s([m.data.message||"Role updated successfully"]))}catch(m){m.response?.status===422?N(m.response.data.errors||["Failed to update user role."]):N(["An unexpected error occurred. Please try again later."])}finally{I(t,"role",!1)}});return P.promise(u,{pending:"Updating employee role...",success:{render({data:s}){return s.join(", ")}},error:{render({data:s}){return Array.isArray(s)?s.join(", "):s}}}),u}const F=n.useMemo(()=>{const t=[{name:"#",uid:"sl"},{name:"USER",uid:"user"},{name:"EMAIL",uid:"email"},{name:"DEPARTMENT",uid:"department"},{name:"DEVICE STATUS",uid:"device_status"},{name:"STATUS",uid:"status"},{name:"ROLES",uid:"roles"},{name:"ACTIONS",uid:"actions"}];if(!x&&!f)t.splice(3,0,{name:"PHONE",uid:"phone"});else if(x)t.splice(t.findIndex(d=>d.uid==="department"),1),t.splice(t.findIndex(d=>d.uid==="device_status"),1);else if(f){const d=t.findIndex(u=>u.uid==="device_status");if(d>-1){const u=t.splice(d,1)[0];t.splice(2,0,u)}}return t},[x,f]),l=async(t,d)=>{if(!b(t,"status")){I(t,"status",!0);try{V?(V(t,!d),P.success(`User status ${d?"deactivated":"activated"} successfully`)):E&&(E(u=>u.map(s=>s.id===t?{...s,active:!d}:s)),P.success(`User status ${d?"deactivated":"activated"} successfully`))}catch(u){console.error("Error toggling user status:",u),P.error("Failed to update user status")}finally{I(t,"status",!1)}}},H=(t,d,u)=>{const s=t[d];switch(d){case"sl":const T=(w?.currentPage&&w?.perPage?Number((w.currentPage-1)*w.perPage):0)+(typeof u=="number"?u:0)+1;return e("div",{className:"flex items-center justify-center",children:e("div",{className:"flex items-center justify-center w-8 h-8 bg-white/10 backdrop-blur-md rounded-lg border border-white/20",children:e("span",{className:"text-sm font-semibold text-foreground",children:T})})});case"user":return e(Xe,{className:"w-fit max-w-full",avatarProps:{radius:"lg",size:"sm",src:t?.profile_image_url||t?.profile_image,showFallback:!0,name:t?.name||"Unnamed User",isBordered:!0},name:e("span",{className:"text-sm font-medium whitespace-nowrap",children:t?.name||"Unnamed User"})});case"email":return a("div",{className:"flex items-center",children:[e(wt,{className:"w-4 h-4 text-default-400 mr-2"}),e("span",{className:"text-sm",children:t.email})]});case"phone":return a("div",{className:"flex items-center",children:[e(Je,{className:"w-4 h-4 text-default-400 mr-2"}),e("span",{className:"text-sm",children:t.phone||"N/A"})]});case"department":return a("div",{className:"flex items-center",children:[e(he,{className:"w-4 h-4 text-default-400 mr-2"}),e("span",{className:"text-sm",children:t?.department||"N/A"})]});case"device_status":const C=b(t.id,"deviceToggle");return e("div",{className:"flex items-center space-x-2",children:t.single_device_login?a(Fe,{children:[e(G,{size:"sm",variant:"flat",color:t.active_device?"warning":"success",startContent:C?e("div",{className:"animate-spin",children:e(ee,{className:"w-3 h-3"})}):t.active_device?e(Pe,{className:"w-3 h-3"}):e(_e,{className:"w-3 h-3"}),children:C?"Loading...":t.active_device?"Locked":"Free"}),t.active_device&&!C&&e(Ft,{content:`Device: ${t.active_device.device_name||"Unknown"}`,children:e("div",{className:"flex items-center",children:t.active_device.device_type==="mobile"?e(ye,{className:"w-4 h-4 text-default-400"}):e(it,{className:"w-4 h-4 text-default-400"})})})]}):e(G,{size:"sm",variant:"flat",color:"default",startContent:C?e("div",{className:"animate-spin",children:e(ee,{className:"w-3 h-3"})}):e(ge,{className:"w-3 h-3"}),children:C?"Loading...":"Disabled"})});case"status":return a("div",{className:"flex items-center justify-center",children:[e(Rt,{size:"sm",color:t.active?"success":"danger",isSelected:t.active,isDisabled:b(t.id,"status"),startContent:b(t.id,"status")?e(we,{size:"sm"}):null,onChange:()=>l(t.id,t.active),classNames:{wrapper:"group-data-[selected=true]:bg-success-500 group-data-[selected=false]:bg-danger-500"}}),e("span",{className:"ml-2 text-xs",children:t.active?"Active":"Inactive"})]});case"roles":const z=t.roles?.map(_=>typeof _=="object"&&_!==null?_.name:_)||[],W=new Set(z),se=Array.from(W).join(", ")||"No Roles";return e("div",{className:"flex items-center",children:a(Re,{isDisabled:b(t.id,"role"),className:"max-w-[220px]",children:[e(Ce,{children:e(X,{className:"capitalize",variant:"bordered",size:"sm",startContent:b(t.id,"role")?e(we,{size:"sm"}):null,children:se})}),e(ke,{disallowEmptySelection:!1,"aria-label":"Multiple selection example",closeOnSelect:!1,selectedKeys:W,selectionMode:"multiple",variant:"flat",onSelectionChange:_=>{const be=Array.from(_);Y(t.id,be)},children:(R||[]).map(_=>e(O,{children:typeof _=="object"&&_!==null?_.name:_},typeof _=="object"&&_!==null?_.name:_))})]})});case"actions":return e("div",{className:"flex justify-center items-center",children:a(Re,{children:[e(Ce,{children:e(X,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",children:e(Ze,{className:"w-4 h-4"})})}),a(ke,{"aria-label":"User Actions",children:[e(O,{textValue:"View Profile",href:route("profile",{user:t.id}),as:Le,className:"text-blue-500",startContent:e(Ne,{className:"w-4 h-4"}),children:"View Profile"}),e(O,{textValue:"Edit User",onPress:()=>{J&&J(t)},className:"text-amber-500",startContent:e(Qe,{className:"w-4 h-4"}),children:"Edit"}),e(O,{textValue:"Device Toggle",onPress:()=>{U&&!b(t.id,"deviceToggle")&&(I(t.id,"deviceToggle",!0),U(t.id,!t.single_device_login).finally(()=>{I(t.id,"deviceToggle",!1)}))},isDisabled:p[t.id]||b(t.id,"deviceToggle"),startContent:b(t.id,"deviceToggle")?e("div",{className:"animate-spin",children:e(ee,{className:"w-4 h-4"})}):t.single_device_login?e(_e,{className:"w-4 h-4"}):e(Pe,{className:"w-4 h-4"}),className:t.single_device_login?"text-orange-500":"text-green-500",children:b(t.id,"deviceToggle")?"Processing...":t.single_device_login?"Disable Device Lock":"Enable Device Lock"}),t.single_device_login&&t.active_device&&e(O,{textValue:"Reset Device",onPress:()=>{q&&!b(t.id,"deviceReset")&&(I(t.id,"deviceReset",!0),q(t.id).finally(()=>{I(t.id,"deviceReset",!1)}))},isDisabled:p[t.id]||b(t.id,"deviceReset"),startContent:b(t.id,"deviceReset")?e("div",{className:"animate-spin",children:e(ee,{className:"w-4 h-4"})}):e(ee,{className:"w-4 h-4"}),className:"text-red-500",children:b(t.id,"deviceReset")?"Resetting...":"Reset Device"}),e(O,{textValue:"View Devices",href:route("users.device.show",{user:t.id}),as:Le,startContent:e(ye,{className:"w-4 h-4"}),className:"text-blue-500",children:"View Device History"})]})]})});default:return s}};return a("div",{className:"w-full overflow-hidden flex flex-col border border-white/10 rounded-lg",style:{maxHeight:"calc(100vh - 200px)"},children:[e("div",{className:"overflow-auto flex-grow relative table-scroll-container frozen-column-container",children:a(Nt,{"aria-label":"Users table",removeWrapper:!0,classNames:{base:"bg-transparent min-w-[800px]",th:"bg-white/10 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs sticky top-0 z-30 shadow-sm",td:"border-b border-white/5 py-3",table:"border-collapse",thead:"bg-white/10",tr:"hover:bg-white/5"},children:[e(_t,{columns:F,children:t=>e(yt,{align:t.uid==="actions"||t.uid==="sl"?"center":"start",width:t.uid==="sl"?60:t.uid==="user"?200:void 0,className:t.uid==="sl"?"sticky-header-sl":t.uid==="user"?"sticky-header-user":"bg-white/10 backdrop-blur-md",children:t.name},t.uid)}),e(Pt,{items:o||[],emptyContent:"No users found",loadingContent:e(we,{}),isLoading:h,children:(t,d)=>{const u=o?o.findIndex(s=>s.id===t.id):d;return e(Ct,{className:"table-row-hover",children:s=>e(kt,{className:s==="sl"?"frozen-column":s==="user"?"frozen-column-user":"",children:H(t,s,u)})},t.id)}})]})}),!o||!D||h?null:a("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10 bg-white/5 backdrop-blur-md",children:[a("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(w.currentPage-1)*w.perPage+1," to ",Math.min(w.currentPage*w.perPage,D)," of ",D," users"]}),e(Ke,{total:Math.ceil(D/w.perPage),initialPage:w.currentPage,page:w.currentPage,onChange:v,size:x?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]})]})};var ne={},Me;function qt(){if(Me)return ne;Me=1;var o=De();Object.defineProperty(ne,"__esModule",{value:!0}),ne.default=void 0;var R=o(Ie()),x=Se();return ne.default=(0,R.default)((0,x.jsx)("path",{d:"M2 17h20v2H2zm1.15-4.05L4 11.47l.85 1.48 1.3-.75-.85-1.48H7v-1.5H5.3l.85-1.47L4.85 7 4 8.47 3.15 7l-1.3.75.85 1.47H1v1.5h1.7l-.85 1.48zm6.7-.75 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H15v-1.5h-1.7l.85-1.47-1.3-.75L12 8.47 11.15 7l-1.3.75.85 1.47H9v1.5h1.7zM23 9.22h-1.7l.85-1.47-1.3-.75L20 8.47 19.15 7l-1.3.75.85 1.47H17v1.5h1.7l-.85 1.48 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H23z"}),"Password"),ne}var Bt=qt();const Ht=je(Bt);var oe={},qe;function Wt(){if(qe)return oe;qe=1;var o=De();Object.defineProperty(oe,"__esModule",{value:!0}),oe.default=void 0;var R=o(Ie()),x=Se();return oe.default=(0,R.default)((0,x.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),oe}var Gt=Wt();const Be=je(Gt);var de={},He;function Jt(){if(He)return de;He=1;var o=De();Object.defineProperty(de,"__esModule",{value:!0}),de.default=void 0;var R=o(Ie()),x=Se();return de.default=(0,R.default)((0,x.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),de}var Zt=Jt();const We=je(Zt),Ge=({user:o,allUsers:R,departments:x,designations:f,setUsers:E,open:w,closeModal:v,editMode:j=!1})=>{const[D,J]=n.useState(!1),[h,ae]=n.useState({id:o?.id||"",name:o?.name||"",user_name:o?.user_name||"",gender:o?.gender||"",birthday:o?.birthday||"",date_of_joining:o?.date_of_joining||"",address:o?.address||"",employee_id:o?.employee_id||"",phone:o?.phone||"",email:o?.email||"",department_id:o?.department_id||"",designation_id:o?.designation_id||"",report_to:o?.report_to||"",password:"",confirmPassword:"",roles:o?.roles||[]}),[c,V]=n.useState({}),[M,U]=n.useState(!1),[q,p]=n.useState(!1),[re,B]=n.useState(o?.profile_image_url||o?.profile_image||null),[I,b]=n.useState(null),[Y,F]=n.useState(R),l=Ae();n.useEffect(()=>{(o?.profile_image_url||o?.profile_image)&&B(o.profile_image_url||o.profile_image)},[o]);const H=async s=>{s.preventDefault(),U(!0);const N=new FormData;if(Object.keys(h).forEach(m=>{m==="roles"&&Array.isArray(h[m])?h[m].forEach((T,C)=>{N.append(`roles[${C}]`,T)}):h[m]!==null&&h[m]!==void 0&&N.append(m,h[m])}),I){const m=I.type;if(["image/jpeg","image/jpg","image/png"].includes(m))N.append("profile_image",I);else{P.error("Invalid file type. Only JPEG and PNG are allowed.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:l.glassCard.background,border:l.glassCard.border,color:l.palette.text.primary}}),U(!1);return}}try{const m=j?route("updateUser",{id:o.id}):route("addUser"),T=j?"put":"post",C=await axios[T](m,N);C.status===200&&(E&&E(j?z=>z.map(W=>W.id===C.data.user.id?C.data.user:W):z=>[...z,C.data.user]),P.success(C.data.messages?.length>0?C.data.messages.join(" "):`User ${j?"updated":"added"} successfully`,{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:l.glassCard.background,border:l.glassCard.border,color:l.palette.text.primary}}),v())}catch(m){U(!1),Z(m)}finally{U(!1)}},Z=s=>{s.response?s.response.status===422?(V(s.response.data.errors||{}),P.error(s.response.data.error||`Failed to ${j?"update":"add"} user.`,{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:l.glassCard.background,border:l.glassCard.border,color:l.palette.text.primary}})):P.error("An unexpected error occurred. Please try again later.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:l.glassCard.background,border:l.glassCard.border,color:l.palette.text.primary}}):s.request?P.error("No response received from the server. Please check your internet connection.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:l.glassCard.background,border:l.glassCard.border,color:l.palette.text.primary}}):P.error("An error occurred while setting up the request.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:l.glassCard.background,border:l.glassCard.border,color:l.palette.text.primary}})},t=s=>{const N=s.target.files[0];if(N){const m=URL.createObjectURL(N);B(m),b(N)}},d=(s,N)=>{ae(m=>({...m,[s]:N})),c[s]&&V(m=>{const T={...m};return delete T[s],T})},u=()=>{J(!D)};return a(At,{open:w,onClose:v,fullWidth:!0,maxWidth:"md",sx:{"& .MuiPaper-root":{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:l.glassCard.background,border:l.glassCard.border,borderRadius:"16px",color:l.palette.text.primary,boxShadow:l.glassCard.boxShadow}},children:[e(ht,{sx:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",pb:2},children:a(pe,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e(y,{variant:"h6",component:"div",sx:{fontWeight:600},children:j?"Edit User":"Add New User"}),e(xe,{"aria-label":"close",onClick:v,sx:{color:l.palette.grey[500],"&:hover":{color:l.palette.primary.main}},children:e(It,{})})]})}),e(gt,{sx:{pt:3},children:e("form",{onSubmit:H,children:a(k,{container:!0,spacing:3,children:[e(k,{item:!0,xs:12,sx:{display:"flex",justifyContent:"center",mb:2},children:a(pe,{onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),sx:{position:"relative"},children:[e(pt,{src:re,alt:"Profile",sx:{width:120,height:120,border:"4px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",filter:q?"brightness(70%)":"brightness(100%)",transition:"all 0.3s ease"}}),a(pe,{component:"label",htmlFor:"icon-button-file",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",opacity:q?1:0,transition:"opacity 0.3s ease",cursor:"pointer"},children:[e("input",{accept:"image/*",id:"icon-button-file",type:"file",style:{display:"none"},onChange:t}),e(Dt,{sx:{color:"white",fontSize:32}})]})]})}),e(k,{item:!0,xs:12,md:6,children:e(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Full Name",value:h.name,onChange:s=>d("name",s.target.value),error:!!c.name,helperText:c.name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:l.palette.text.secondary}},required:!0})})}),e(k,{item:!0,xs:12,md:6,children:e(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Username",value:h.user_name,onChange:s=>d("user_name",s.target.value),error:!!c.user_name,helperText:c.user_name,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:l.palette.text.secondary}},required:!0})})}),e(k,{item:!0,xs:12,md:6,children:e(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Email",type:"email",value:h.email,onChange:s=>d("email",s.target.value),error:!!c.email,helperText:c.email,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:l.palette.text.secondary}},required:!0})})}),e(k,{item:!0,xs:12,md:6,children:e(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Phone",value:h.phone,onChange:s=>d("phone",s.target.value),error:!!c.phone,helperText:c.phone,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:l.palette.text.secondary}}})})}),e(k,{item:!0,xs:12,md:6,children:a(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e(me,{id:"department-label",sx:{color:l.palette.text.secondary},children:"Department"}),a(te,{labelId:"department-label",value:h.department_id,onChange:s=>d("department_id",s.target.value),label:"Department",error:!!c.department_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e($,{value:"",children:e("em",{children:"None"})}),x?.map(s=>e($,{value:s.id,children:s.name},s.id))]}),c.department_id&&e(ue,{error:!0,children:c.department_id})]})}),e(k,{item:!0,xs:12,md:6,children:a(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e(me,{id:"designation-label",sx:{color:l.palette.text.secondary},children:"Designation"}),a(te,{labelId:"designation-label",value:h.designation_id,onChange:s=>d("designation_id",s.target.value),label:"Designation",error:!!c.designation_id,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e($,{value:"",children:e("em",{children:"None"})}),f?.map(s=>e($,{value:s.id,children:s.name},s.id))]}),c.designation_id&&e(ue,{error:!0,children:c.designation_id})]})}),e(k,{item:!0,xs:12,md:6,children:a(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e(me,{id:"gender-label",sx:{color:l.palette.text.secondary},children:"Gender"}),a(te,{labelId:"gender-label",value:h.gender,onChange:s=>d("gender",s.target.value),label:"Gender",error:!!c.gender,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e($,{value:"",children:e("em",{children:"Select Gender"})}),e($,{value:"male",children:"Male"}),e($,{value:"female",children:"Female"}),e($,{value:"other",children:"Other"})]}),c.gender&&e(ue,{error:!0,children:c.gender})]})}),e(k,{item:!0,xs:12,md:6,children:e(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Employee ID",value:h.employee_id,onChange:s=>d("employee_id",s.target.value),error:!!c.employee_id,helperText:c.employee_id,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:l.palette.text.secondary}}})})}),e(k,{item:!0,xs:12,md:6,children:e(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Date of Birth",type:"date",value:h.birthday,onChange:s=>d("birthday",s.target.value),error:!!c.birthday,helperText:c.birthday,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:l.palette.text.secondary}}})})}),e(k,{item:!0,xs:12,md:6,children:e(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Date of Joining",type:"date",value:h.date_of_joining,onChange:s=>d("date_of_joining",s.target.value),error:!!c.date_of_joining,helperText:c.date_of_joining,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{shrink:!0,sx:{color:l.palette.text.secondary}}})})}),e(k,{item:!0,xs:12,md:6,children:a(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e(me,{id:"report-to-label",sx:{color:l.palette.text.secondary},children:"Reports To"}),a(te,{labelId:"report-to-label",value:h.report_to,onChange:s=>d("report_to",s.target.value),label:"Reports To",error:!!c.report_to,sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:[e($,{value:"",children:e("em",{children:"None"})}),Y?.filter(s=>s.id!==h.id).map(s=>e($,{value:s.id,children:s.name},s.id))]}),c.report_to&&e(ue,{error:!0,children:c.report_to})]})}),e(k,{item:!0,xs:12,children:e(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Address",multiline:!0,rows:3,value:h.address,onChange:s=>d("address",s.target.value),error:!!c.address,helperText:c.address,InputProps:{sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:l.palette.text.secondary}}})})}),!j&&a(Fe,{children:[e(k,{item:!0,xs:12,md:6,children:e(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Password",type:D?"text":"password",value:h.password,onChange:s=>d("password",s.target.value),error:!!c.password,helperText:c.password,required:!j,InputProps:{endAdornment:e(xe,{"aria-label":"toggle password visibility",onClick:u,edge:"end",children:D?e(Be,{}):e(We,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:l.palette.text.secondary}}})})}),e(k,{item:!0,xs:12,md:6,children:e(A,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:e(L,{label:"Confirm Password",type:D?"text":"password",value:h.confirmPassword,onChange:s=>d("confirmPassword",s.target.value),error:!!c.confirmPassword,helperText:c.confirmPassword||(h.password!==h.confirmPassword&&h.confirmPassword?"Passwords do not match":""),required:!j,InputProps:{endAdornment:e(xe,{"aria-label":"toggle password visibility",onClick:u,edge:"end",children:D?e(Be,{}):e(We,{})}),sx:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"}},InputLabelProps:{sx:{color:l.palette.text.secondary}}})})})]})]})})}),a(bt,{sx:{justifyContent:"space-between",p:3,borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:[e(Button,{onClick:v,variant:"bordered",color:"default",size:"lg",className:"bg-white/5 hover:bg-white/10 border border-white/10",children:"Cancel"}),e(Ut,{onClick:H,loading:M,loadingPosition:"start",startIcon:e(Ht,{}),variant:"contained",sx:{background:"linear-gradient(45deg, #3a7bd5 0%, #2456bd 100%)",boxShadow:"0 4px 20px 0 rgba(58, 123, 213, 0.4)","&:hover":{background:"linear-gradient(45deg, #2456bd 0%, #1a3c8a 100%)"}},children:j?"Update User":"Add User"})]})]})},Qt=({title:o,roles:R})=>{const x=Ae(),f=$e(x.breakpoints.down("sm")),E=$e(x.breakpoints.down("md")),[w,v]=n.useState([]),[j,D]=n.useState(!0),[J,h]=n.useState(null),[ae,c]=n.useState(0),[V,M]=n.useState(1),[U,q]=n.useState(null),[p,re]=n.useState({search:"",role:"all",status:"all",department:"all"}),[B,I]=n.useState(!1),[b,Y]=n.useState("table"),[F,l]=n.useState({currentPage:1,perPage:10,total:w.length}),[H,Z]=n.useState({}),[t,d]=n.useState({overview:{total_users:0,active_users:0,inactive_users:0,deleted_users:0,total_roles:0,total_departments:0},distribution:{by_role:[],by_department:[],by_status:[]},activity:{recent_registrations:{new_users_30_days:0,new_users_90_days:0,new_users_year:0,recently_active:0},user_growth_rate:0,current_month_registrations:0},security:{access_metrics:{users_with_roles:0,users_without_roles:0,admin_users:0,regular_users:0},role_distribution:[]},health:{status_ratio:{active_percentage:0,inactive_percentage:0,deleted_percentage:0},system_metrics:{user_activation_rate:0,role_coverage:0,department_coverage:0}},quick_metrics:{total_users:0,active_ratio:0,role_diversity:0,department_diversity:0,recent_activity:0,system_health_score:0}}),u=n.useMemo(()=>({data:w,total:ae,current_page:F.currentPage,per_page:F.perPage,last_page:V}),[w,ae,F.currentPage,F.perPage,V]),s=n.useCallback(async()=>{try{const{data:r}=await le.get(route("users.stats"));r.stats&&d(r.stats)}catch(r){console.error("Error fetching user stats:",r)}},[]),N=n.useCallback(async()=>{D(!0);try{const r=await le.get(route("users.paginate"),{params:{page:F.currentPage,perPage:F.perPage,search:p.search||void 0,role:p.role!=="all"?p.role:void 0,status:p.status!=="all"?p.status:void 0,department:p.department!=="all"?p.department:void 0}});if(r.status===200){const{users:i}=r.data;i.data&&Array.isArray(i.data)?(v(i.data),c(i.total||i.data.length),M(i.last_page||1)):Array.isArray(i)?(v(i),c(i.length),M(1)):(console.error("Unexpected users data format:",i),v([]),c(0),M(1))}}catch(r){console.error("Error fetching users:",r),P.error("Failed to load users data"),v([])}finally{D(!1)}},[p,F.currentPage,F.perPage]);n.useEffect(()=>{N()},[N]),n.useEffect(()=>{s();const r=setInterval(s,6e4);return()=>clearInterval(r)},[s]);const m=(r,i)=>{re(g=>({...g,[r]:i})),l(g=>({...g,currentPage:1}))},T=r=>{l(i=>({...i,currentPage:r})),window.scrollTo({top:0,behavior:"smooth"})},C=r=>{l(i=>({...i,currentPage:1,perPage:r}))},z=n.useCallback((r,i=null)=>{q(r),h(i)},[]),W=n.useCallback(()=>{q(null),h(null)},[]),se=n.useCallback(r=>{v(r)},[]),_=n.useCallback(r=>{v(i=>i.map(g=>g.id===r.id?{...g,...r}:g))},[]),be=n.useCallback(r=>{v(i=>i.filter(g=>g.id!==r)),s()},[s]),Ye=n.useCallback((r,i)=>{v(g=>g.map(S=>S.id===r?{...S,active:i}:S)),s()},[s]),et=n.useCallback((r,i)=>{v(g=>g.map(S=>S.id===r?{...S,roles:i}:S)),s()},[s]),Ue=n.useCallback(async(r,i)=>{Z(g=>({...g,[r]:!0}));try{(await le.post(route("users.device.toggle"),{user_id:r,enabled:i})).status===200&&(v(S=>S.map(ce=>ce.id===r?{...ce,single_device_login:i,active_device:i?ce.active_device:null}:ce)),P.success(i?"Single device login enabled for user":"Single device login disabled for user"))}catch(g){console.error("Error toggling single device login:",g),P.error("Failed to update device settings")}finally{Z(g=>({...g,[r]:!1}))}},[]),Te=n.useCallback(async r=>{Z(i=>({...i,[r]:!0}));try{(await le.post(route("users.device.reset"),{user_id:r})).status===200&&(v(g=>g.map(S=>S.id===r?{...S,active_device:null}:S)),P.success("User device has been reset"))}catch(i){console.error("Error resetting user device:",i),P.error("Failed to reset user device")}finally{Z(i=>({...i,[r]:!1}))}},[]);n.useCallback(async r=>{try{const i=await le.get(route("users.device.list",{user:r}));if(i.status===200){const g=i.data.devices;P.info(`User has ${g.length} device record(s)`)}}catch(i){console.error("Error fetching user devices:",i),P.error("Failed to fetch device information")}},[]);const tt=({user:r,index:i})=>e(Q,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 transition-all duration-200 cursor-pointer h-full",onPress:()=>fe.visit(route("profile",{user:r.id})),children:a(K,{className:"p-4 flex flex-col h-full",children:[a("div",{className:"flex items-start gap-3 mb-3 pb-3 border-b border-white/10",children:[e(Xe,{avatarProps:{radius:"lg",src:r?.profile_image_url||r?.profile_image,size:"md",fallback:e(Ne,{className:"w-5 h-5"})},classNames:{name:"font-semibold text-foreground text-sm",description:"text-default-500 text-xs"}}),e("div",{className:"flex-1 min-w-0",children:a("div",{className:"flex items-start justify-between",children:[a("div",{children:[e("h3",{className:"font-semibold text-foreground text-sm line-clamp-1",children:r.name}),e("p",{className:"text-default-500 text-xs",children:r.email})]}),a("div",{className:"flex items-center gap-1",children:[e(X,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>{fe.visit(route("profile",{user:r.id}))},children:e(Qe,{className:"w-4 h-4"})}),a(Re,{children:[e(Ce,{children:e(X,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",children:e(Ze,{className:"w-4 h-4"})})}),a(ke,{"aria-label":"Device Actions",children:[e(O,{description:r.single_device_login?"Disable device restriction":"Enable device restriction",startContent:r.single_device_login?e(_e,{className:"w-4 h-4"}):e(Pe,{className:"w-4 h-4"}),onPress:()=>{Ue(r.id,!r.single_device_login)},isDisabled:H[r.id],children:r.single_device_login?"Disable Device Lock":"Enable Device Lock"},"toggle-device"),r.single_device_login&&r.active_device&&e(O,{description:"Allow login from new device",startContent:e(ee,{className:"w-4 h-4"}),color:"warning",onPress:()=>{Te(r.id)},isDisabled:H[r.id],children:"Reset Device"},"reset-device"),e(O,{description:"View device history",startContent:e(ye,{className:"w-4 h-4"}),onPress:()=>{fe.visit(route("users.device.show",{user:r.id}))},children:"View Devices"},"view-devices")]})]})]})]})})]}),a("div",{className:"flex-1 flex flex-col gap-3",children:[r.phone&&a("div",{className:"flex items-center gap-2 text-sm",children:[e(Je,{className:"w-4 h-4 text-default-400 flex-shrink-0"}),e("span",{className:"text-default-600 text-xs line-clamp-1",children:r.phone})]}),(r.department||r.department_id)&&a("div",{className:"flex items-center gap-2 text-sm",children:[e(he,{className:"w-4 h-4 text-default-400 flex-shrink-0"}),e("span",{className:"text-default-600 text-xs",children:typeof r.department=="string"?r.department:"N/A"})]})]}),a("div",{className:"mt-3 pt-3 border-t border-white/10 flex flex-wrap gap-2",children:[e(G,{size:"sm",variant:r.active?"solid":"bordered",color:r.active?"success":"danger",className:"text-xs",startContent:r.active?e(Ee,{className:"w-3 h-3"}):e(ze,{className:"w-3 h-3"}),children:r.active?"Active":"Inactive"}),r.roles?.map((g,S)=>e(G,{size:"sm",variant:"flat",color:"secondary",className:"text-xs",startContent:e(Ne,{className:"w-3 h-3"}),children:g},S)),r.single_device_login&&e(G,{size:"sm",variant:"flat",color:r.active_device?"warning":"default",className:"text-xs",startContent:e(ge,{className:"w-3 h-3"}),children:r.active_device?"Device Locked":"Device Free"})]})]})}),at=n.useMemo(()=>[{title:"Total Users",value:t?.overview?.total_users||0,icon:e(ve,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All users"},{title:"Active Users",value:t?.overview?.active_users||0,icon:e(Ee,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:`${t?.health?.status_ratio?.active_percentage||0}% Active`},{title:"Inactive Users",value:t?.overview?.inactive_users||0,icon:e(ze,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:`${t?.health?.status_ratio?.inactive_percentage||0}% Inactive`},{title:"Total Roles",value:t?.overview?.total_roles||0,icon:e(ge,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Role diversity"},{title:"Role Coverage",value:`${t?.health?.system_metrics?.role_coverage||0}%`,icon:e(Tt,{className:"w-5 h-5"}),color:"text-emerald-400",iconBg:"bg-emerald-500/20",description:"Users with roles"},{title:"Recent Activity",value:t?.activity?.recent_registrations?.recently_active||0,icon:e(lt,{className:"w-5 h-5"}),color:"text-cyan-400",iconBg:"bg-cyan-500/20",description:"Active last 7 days"},{title:"System Health",value:`${t?.quick_metrics?.system_health_score||0}%`,icon:e(Ve,{className:"w-5 h-5"}),color:"text-pink-400",iconBg:"bg-pink-500/20",description:"Overall health"},{title:"Departments",value:t?.overview?.total_departments||0,icon:e(he,{className:"w-5 h-5"}),color:"text-indigo-400",iconBg:"bg-indigo-500/20",description:"Department diversity"}],[t]),rt=n.useMemo(()=>{const r=[];return r.push({label:f?"Add":"Add User",icon:e(Lt,{className:"w-4 h-4"}),onPress:()=>z("add"),className:"bg-gradient-to-r from-[var(--theme-primary)] to-[var(--theme-secondary)] text-white font-medium hover:opacity-90"}),r.push({label:f?"":"Export",isIconOnly:f,icon:e(Oe,{className:"w-4 h-4"}),variant:"bordered",className:"border-[rgba(var(--theme-primary-rgb),0.3)] bg-[rgba(var(--theme-primary-rgb),0.05)] hover:bg-[rgba(var(--theme-primary-rgb),0.1)]"}),r},[f,z]);return a(Fe,{children:[e(st,{title:o}),U==="add"&&e(Ge,{user:null,open:U==="add",setUsers:se,closeModal:W,editMode:!1}),U==="edit"&&J&&e(Ge,{user:J,open:U==="edit",setUsers:se,closeModal:W,editMode:!0}),e(pe,{sx:{display:"flex",justifyContent:"center",p:2},children:e(ft,{in:!0,children:e(ct,{children:e(mt,{title:"Users Management",subtitle:"Manage users accounts and roles",icon:e(ve,{className:"w-8 h-8"}),actionButtons:rt,children:a("div",{className:"p-4 sm:p-6",children:[e(ut,{stats:at,className:"mb-6"}),a("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mb-6",children:[e(Q,{className:"bg-white/5 backdrop-blur-md border-white/10",children:a(K,{className:"p-4",children:[a("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e($t,{className:"w-5 h-5 text-purple-400"})}),a("div",{children:[e(y,{variant:"h6",className:"font-semibold text-foreground",children:"Role Distribution"}),e(y,{variant:"caption",className:"text-default-500",children:"User roles breakdown"})]})]}),e("div",{className:"space-y-3",children:t?.distribution?.by_role?.slice(0,5).map((r,i)=>a("div",{className:"flex items-center justify-between",children:[a("div",{className:"flex items-center gap-2",children:[e("div",{className:"w-3 h-3 rounded-full bg-gradient-to-r from-purple-400 to-pink-400"}),e("span",{className:"text-sm text-foreground truncate",children:r.name})]}),a("div",{className:"text-right",children:[e("span",{className:"text-sm font-medium text-foreground",children:r.count}),a("span",{className:"text-xs text-default-500 ml-1",children:["(",r.percentage,"%)"]})]})]},i))})]})}),e(Q,{className:"bg-white/5 backdrop-blur-md border-white/10",children:a(K,{className:"p-4",children:[a("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e(he,{className:"w-5 h-5 text-blue-400"})}),a("div",{children:[e(y,{variant:"h6",className:"font-semibold text-foreground",children:"Department Distribution"}),e(y,{variant:"caption",className:"text-default-500",children:"Users by department"})]})]}),e("div",{className:"space-y-3",children:t?.distribution?.by_department?.slice(0,5).map((r,i)=>a("div",{className:"flex items-center justify-between",children:[a("div",{className:"flex items-center gap-2",children:[e("div",{className:"w-3 h-3 rounded-full bg-gradient-to-r from-blue-400 to-cyan-400"}),e("span",{className:"text-sm text-foreground truncate",children:r.name})]}),a("div",{className:"text-right",children:[e("span",{className:"text-sm font-medium text-foreground",children:r.count}),a("span",{className:"text-xs text-default-500 ml-1",children:["(",r.percentage,"%)"]})]})]},i))})]})}),e(Q,{className:"bg-white/5 backdrop-blur-md border-white/10",children:a(K,{className:"p-4",children:[a("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e(ge,{className:"w-5 h-5 text-red-400"})}),a("div",{children:[e(y,{variant:"h6",className:"font-semibold text-foreground",children:"Security Metrics"}),e(y,{variant:"caption",className:"text-default-500",children:"Access control overview"})]})]}),a("div",{className:"space-y-3",children:[a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Users with Roles"}),e("span",{className:"text-sm font-medium text-green-400",children:t?.security?.access_metrics?.users_with_roles||0})]}),a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Users without Roles"}),e("span",{className:"text-sm font-medium text-red-400",children:t?.security?.access_metrics?.users_without_roles||0})]}),a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Admin Users"}),e("span",{className:"text-sm font-medium text-orange-400",children:t?.security?.access_metrics?.admin_users||0})]}),a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Role Coverage"}),a("span",{className:"text-sm font-medium text-blue-400",children:[t?.health?.system_metrics?.role_coverage||0,"%"]})]})]})]})}),e(Q,{className:"bg-white/5 backdrop-blur-md border-white/10",children:a(K,{className:"p-4",children:[a("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e(Oe,{className:"w-5 h-5 text-green-400"})}),a("div",{children:[e(y,{variant:"h6",className:"font-semibold text-foreground",children:"Activity Trends"}),e(y,{variant:"caption",className:"text-default-500",children:"Recent user activity"})]})]}),a("div",{className:"space-y-3",children:[a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Recently Active"}),e("span",{className:"text-sm font-medium text-green-400",children:t?.activity?.recent_registrations?.recently_active||0})]}),a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"New (30 days)"}),e("span",{className:"text-sm font-medium text-blue-400",children:t?.activity?.recent_registrations?.new_users_30_days||0})]}),a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"New (90 days)"}),e("span",{className:"text-sm font-medium text-cyan-400",children:t?.activity?.recent_registrations?.new_users_90_days||0})]}),a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Growth Rate"}),a("span",{className:"text-sm font-medium text-purple-400",children:[t?.activity?.user_growth_rate||0,"%"]})]})]})]})}),e(Q,{className:"bg-white/5 backdrop-blur-md border-white/10",children:a(K,{className:"p-4",children:[a("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-teal-500/20 rounded-lg",children:e(Ve,{className:"w-5 h-5 text-teal-400"})}),a("div",{children:[e(y,{variant:"h6",className:"font-semibold text-foreground",children:"System Health"}),e(y,{variant:"caption",className:"text-default-500",children:"Overall system metrics"})]})]}),a("div",{className:"space-y-3",children:[a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Health Score"}),a("span",{className:"text-sm font-medium text-teal-400",children:[t?.quick_metrics?.system_health_score||0,"%"]})]}),a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Activation Rate"}),a("span",{className:"text-sm font-medium text-green-400",children:[t?.health?.system_metrics?.user_activation_rate||0,"%"]})]}),a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Dept. Coverage"}),a("span",{className:"text-sm font-medium text-blue-400",children:[t?.health?.system_metrics?.department_coverage||0,"%"]})]}),a("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-foreground",children:"Total Departments"}),e("span",{className:"text-sm font-medium text-purple-400",children:t?.overview?.total_departments||0})]})]})]})}),e(Q,{className:"bg-white/5 backdrop-blur-md border-white/10",children:a(K,{className:"p-4",children:[a("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e(Et,{className:"w-5 h-5 text-yellow-400"})}),a("div",{children:[e(y,{variant:"h6",className:"font-semibold text-foreground",children:"Status Breakdown"}),e(y,{variant:"caption",className:"text-default-500",children:"User status distribution"})]})]}),e("div",{className:"space-y-3",children:t?.distribution?.by_status?.map((r,i)=>a("div",{className:"flex items-center justify-between",children:[a("div",{className:"flex items-center gap-2",children:[e("div",{className:`w-3 h-3 rounded-full ${r.name==="Active"?"bg-green-400":r.name==="Inactive"?"bg-red-400":"bg-gray-400"}`}),e("span",{className:"text-sm text-foreground",children:r.name})]}),a("div",{className:"text-right",children:[e("span",{className:"text-sm font-medium text-foreground",children:r.count}),a("span",{className:"text-xs text-default-500 ml-1",children:["(",r.percentage,"%)"]})]})]},i))})]})})]}),a("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e("div",{className:"flex-1",children:e(St,{label:"Search Users",variant:"bordered",placeholder:"Search by name, email or phone...",value:p.search,onValueChange:r=>m("search",r),startContent:e(nt,{className:"w-4 h-4"}),classNames:{input:"bg-transparent",inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},size:f?"sm":"md"})}),a("div",{className:"flex gap-2 items-end",children:[a(jt,{variant:"bordered",className:"bg-white/5",children:[a(X,{isIconOnly:f,color:b==="table"?"primary":"default",onPress:()=>Y("table"),className:b==="table"?"bg-blue-500/20":"",children:[e(zt,{className:"w-4 h-4"}),!f&&e("span",{className:"ml-1",children:"Table"})]}),a(X,{isIconOnly:f,color:b==="grid"?"primary":"default",onPress:()=>Y("grid"),className:b==="grid"?"bg-blue-500/20":"",children:[e(ot,{className:"w-4 h-4"}),!f&&e("span",{className:"ml-1",children:"Grid"})]})]}),a(X,{isIconOnly:f,variant:"bordered",onPress:()=>I(!B),className:B?"bg-purple-500/20":"bg-white/5",children:[e(Ot,{className:"w-4 h-4"}),!f&&e("span",{className:"ml-1",children:"Filters"})]})]})]}),B&&e(vt,{in:!0,timeout:300,children:a("div",{className:"mb-6 p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:[a("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a(te,{label:"Status",variant:"bordered",selectedKeys:p.status!=="all"?[p.status]:[],onSelectionChange:r=>{const i=Array.from(r)[0]||"all";m("status",i)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e(ie,{value:"all",children:"All Statuses"},"all"),e(ie,{value:"active",children:"Active Only"},"active"),e(ie,{value:"inactive",children:"Inactive Only"},"inactive")]}),a(te,{label:"Role",variant:"bordered",selectedKeys:p.role!=="all"?[p.role]:[],onSelectionChange:r=>{const i=Array.from(r)[0]||"all";m("role",i)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e(ie,{value:"all",children:"All Roles"},"all"),R?.map(r=>e(ie,{value:r.toLowerCase(),children:r},r.toLowerCase()))]})]}),(p.search||p.status!=="all"||p.role!=="all")&&a("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-white/10",children:[p.search&&a(G,{variant:"flat",color:"primary",size:"sm",onClose:()=>m("search",""),children:["Search: ",p.search]}),p.status!=="all"&&a(G,{variant:"flat",color:"secondary",size:"sm",onClose:()=>m("status","all"),children:["Status: ",p.status==="active"?"Active":"Inactive"]}),p.role!=="all"&&a(G,{variant:"flat",color:"warning",size:"sm",onClose:()=>m("role","all"),children:["Role: ",p.role]})]})]})}),a("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[e("div",{className:"p-4 border-b border-white/10",children:a(y,{variant:"h6",className:"font-semibold text-foreground",children:[b==="table"?"User Table":"User Grid",a("span",{className:"text-sm text-default-500 ml-2",children:["(",u.total||0," ",u.total===1?"user":"users",")"]})]})}),j?a("div",{className:"text-center py-8",children:[e(xt,{size:40}),e(y,{className:"mt-4",color:"textSecondary",children:"Loading users data..."})]}):b==="table"?e(Mt,{allUsers:u.data,roles:R,setUsers:se,isMobile:f,isTablet:E,pagination:F,onPageChange:T,onRowsPerPageChange:C,totalUsers:u.total,loading:j,onEdit:r=>z("edit",r),updateUserOptimized:_,deleteUserOptimized:be,toggleUserStatusOptimized:Ye,updateUserRolesOptimized:et,toggleSingleDeviceLogin:Ue,resetUserDevice:Te,deviceActions:H}):a("div",{className:"p-4",children:[u.data&&u.data.length>0?e("div",{className:`grid gap-4 ${f?"grid-cols-1":E?"grid-cols-2":"grid-cols-3 xl:grid-cols-4"}`,children:u.data.map((r,i)=>e(tt,{user:r,index:i},r.id))}):a("div",{className:"text-center py-8",children:[e(ve,{className:"w-12 h-12 mx-auto text-default-300 mb-2"}),e(y,{variant:"body1",color:"textSecondary",children:"No users found"}),e(y,{variant:"caption",color:"textSecondary",children:"Try adjusting your search or filters"})]}),u.data&&u.data.length>0&&e("div",{className:"flex justify-center mt-6 border-t border-white/10 pt-4",children:e(Ke,{total:Math.ceil(u.total/F.perPage),initialPage:F.currentPage,page:F.currentPage,onChange:T,size:f?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})})]})]})]})})})})})]})};Qt.layout=o=>e(dt,{children:o});export{Qt as default};
