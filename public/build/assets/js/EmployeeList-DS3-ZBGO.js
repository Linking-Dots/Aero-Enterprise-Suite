import{a as t,j as e,S as be,Q as Be,b as Ge}from"./app-CDzGJ23-.js";import{r as l}from"./react-core-DDvupgOx.js";import{h as ne,p as le,n as Ce,B,e as xe,q as ye,b as ue,c as We,o as He,A as Ve}from"./App-COhLqSvb.js";import{G as Ye}from"./logo-C4hkafYE.js";import{P as qe}from"./PageHeader-DVunJ7Y_.js";import{S as Qe}from"./StatsCards-bMKFHHsB.js";import{a as V}from"./utilities-DT6SRl8s.js";import{G as je}from"./GlassDialog-DMfdU0Bm.js";import{u as Ne,B as W,T as C,p as Ze,q as Je,a6 as Ke,a8 as Xe,a9 as ke,aa as Pe,ab as Fe,A as et,l as fe,r as tt,f as K,a as De,G as at,F as rt}from"./mui-libraries-BOatgvFC.js";import{F as we}from"./ExclamationTriangleIcon-C_gcLnRy.js";import{F as _e}from"./TrashIcon-D8Us3Tf_.js";import{b as k,I as Ie,f as H,p as st,g as Re,e as Te,M as Se,k as nt,m as lt,n as it,o as ot,q as dt,v as ct,G as $e,N as te,O as ae,P as J,Q as re,L as Le,i as mt,D as pt,s as ge,l as Z}from"./ui-libraries-D1L3zk6d.js";import{F as Me}from"./UserIcon-D16nn9o_.js";import{F as ze}from"./CheckCircleIcon-CJUGb5Jf.js";import{F as se}from"./EllipsisVerticalIcon-BX6PWMxg.js";import{F as Ue}from"./PencilIcon-Dhfhztfv.js";import{F as ve}from"./EnvelopeIcon-D6nUSkik.js";import{F as ht,a as Ae}from"./UserPlusIcon-B6CWJ_n8.js";import{F as ut}from"./ChartBarIcon-Yugn57JF.js";import{F as ft}from"./TableCellsIcon-C2_Qfojp.js";import{F as gt}from"./AdjustmentsHorizontalIcon-DKS_UuIh.js";import"./ShieldCheckIcon-C7bFKizx.js";function bt({title:b,titleId:x,...i},y){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:y,"aria-labelledby":x},i),b?l.createElement("title",{id:x},b):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 8.25h15m-16.5 7.5h15m-1.8-13.5-3.9 19.5m-2.1-19.5-3.9 19.5"}))}const xt=l.forwardRef(bt);function yt({title:b,titleId:x,...i},y){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:y,"aria-labelledby":x},i),b?l.createElement("title",{id:x},b):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const Ee=l.forwardRef(yt),wt=({open:b,onClose:x,employee:i,onConfirm:y,loading:S=!1})=>{const o=Ne();if(!i)return null;const A=i.active_projects_count>0||i.pending_leaves_count>0||i.active_trainings_count>0;return t(je,{open:b,onClose:x,maxWidth:"sm",fullWidth:!0,children:[e(Ze,{sx:{display:"flex",alignItems:"center",gap:2,pb:2},children:t(W,{sx:{display:"flex",alignItems:"center",gap:2,color:o.palette.error.main},children:[e(we,{className:"w-6 h-6"}),e(C,{variant:"h6",component:"h2",children:"Delete Employee"})]})}),t(Je,{sx:{py:0},children:[t(W,{sx:{p:3,borderRadius:2,background:o.palette.background.paper,border:`1px solid ${o.palette.divider}`,mb:3},children:[t(W,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e(Ke,{src:i.profile_image,sx:{width:50,height:50,bgcolor:o.palette.primary.main},children:i.name?.charAt(0)?.toUpperCase()}),t(W,{children:[e(C,{variant:"h6",fontWeight:"600",children:i.name}),e(C,{variant:"body2",color:"text.secondary",children:i.email})]})]}),t(Xe,{dense:!0,sx:{mt:2},children:[t(ke,{sx:{px:0},children:[e(Pe,{children:e(ne,{className:"w-5 h-5 text-gray-500"})}),e(Fe,{primary:"Department",secondary:i.department_name||"Not assigned"})]}),t(ke,{sx:{px:0},children:[e(Pe,{children:e(le,{className:"w-5 h-5 text-gray-500"})}),e(Fe,{primary:"Designation",secondary:i.designation_name||"Not assigned"})]})]})]}),e(et,{severity:"error",sx:{mb:3,"& .MuiAlert-icon":{color:o.palette.error.main}},children:e(C,{variant:"body2",fontWeight:"500",children:"This action will permanently delete the employee record and cannot be undone."})}),A&&t(W,{sx:{p:3,borderRadius:2,background:o.palette.warning.main+"10",border:`1px solid ${o.palette.warning.main}40`,mb:3},children:[t(W,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e(we,{className:"w-5 h-5 text-orange-500"}),e(C,{variant:"subtitle2",color:"warning.main",children:"Employee Has Active Data"})]}),e(C,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"This employee has the following active records that will also be affected:"}),t(W,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[i.active_projects_count>0&&e(fe,{size:"small",label:`${i.active_projects_count} Active Projects`,color:"warning",variant:"outlined"}),i.pending_leaves_count>0&&e(fe,{size:"small",label:`${i.pending_leaves_count} Pending Leaves`,color:"warning",variant:"outlined"}),i.active_trainings_count>0&&e(fe,{size:"small",label:`${i.active_trainings_count} Active Trainings`,color:"warning",variant:"outlined"})]})]}),t(C,{variant:"body1",sx:{mb:1},children:["Are you sure you want to delete ",e("strong",{children:i.name}),"?"]}),e(C,{variant:"body2",color:"text.secondary",children:"Type the employee's name below to confirm this permanent deletion:"})]}),t(tt,{sx:{px:3,py:3,justifyContent:"space-between",borderTop:`1px solid ${o.palette.divider}`},children:[e(k,{variant:"light",onPress:x,disabled:S,children:"Cancel"}),e(k,{color:"danger",variant:"solid",onPress:y,isLoading:S,startContent:!S&&e(_e,{className:"w-4 h-4"}),children:S?"Deleting...":"Delete Employee"})]})]})},vt=({isOpen:b,onClose:x,employee:i,onImageUpdate:y})=>{const S=l.useRef(null),[o,A]=l.useState(null),[f,P]=l.useState(null),[N,U]=l.useState(!1),[E,_]=l.useState(0),[G,s]=l.useState(""),d=2*1024*1024,j=["image/jpeg","image/jpg","image/png","image/webp"],F=100,L=2e3,R=i?.profile_image_url||null,M=R&&R!==null,g=D=>{const m=D.target.files[0];if(!m)return;if(s(""),!j.includes(m.type)){s("Invalid file type. Please select a JPEG, PNG, or WebP image.");return}if(m.size>d){s(`File too large. Maximum size is ${d/1024/1024}MB.`);return}const h=new Image;h.onload=()=>{if(h.width<F||h.height<F){s(`Image dimensions too small. Minimum size is ${F}x${F} pixels.`);return}if(h.width>L||h.height>L){s(`Image dimensions too large. Maximum size is ${L}x${L} pixels.`);return}A(m),P(URL.createObjectURL(m))},h.onerror=()=>{s("Invalid image file.")},h.src=URL.createObjectURL(m)},v=async()=>{if(!o||!i)return;U(!0),_(0),s("");const D=new FormData;D.append("profile_image",o),D.append("id",i.id);try{const m=await V.post(route("profile.update"),D,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:h=>{const Q=Math.round(h.loaded*100/h.total);_(Q)}});if(m.status===200){if(B.success("Profile picture updated successfully!"),y){const h=m.data.profile_image_url||m.data.user?.profile_image_url||null;y(i.id,h)}T()}}catch(m){console.error("Upload error:",m);let h="Failed to upload profile picture";m.response?.status===413?h="File too large. Please choose a smaller image.":m.response?.status===422?h=m.response.data.message||"Validation failed":m.response?.data?.message&&(h=m.response.data.message),s(h),B.error(h)}finally{U(!1),_(0)}},c=async()=>{if(!i)return;U(!0),s("");const D=new FormData;D.append("remove_profile_image","1"),D.append("id",i.id);try{const m=await V.post(route("profile.update"),D,{headers:{"Content-Type":"multipart/form-data"}});if(m.status===200){if(B.success("Profile picture removed successfully!"),y){const h=m.data.profile_image_url||m.data.user?.profile_image_url||null;y(i.id,h)}T()}}catch(m){console.error("Remove error:",m);const h=m.response?.data?.message||"Failed to remove profile picture";s(h),B.error(h)}finally{U(!1)}},T=()=>{N||(A(null),P(null),s(""),_(0),f&&URL.revokeObjectURL(f),x())};return i?e(je,{open:b,closeModal:T,maxWidth:"md",fullWidth:!0,children:t("div",{className:"p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center gap-3",children:[e(Ee,{className:"w-6 h-6 text-blue-500"}),t("div",{children:[e("h3",{className:"text-lg font-semibold text-gray-900",children:"Update Profile Picture"}),e("p",{className:"text-sm text-gray-500",children:i?.name||"Employee"})]})]}),e(k,{isIconOnly:!0,variant:"light",onPress:T,className:"text-gray-400 hover:text-gray-600",children:e(Ce,{className:"w-5 h-5"})})]}),e("div",{className:"flex justify-center mb-6",children:e(Ie,{src:f||R||void 0,name:i?.name||"Employee",size:"lg",className:"w-24 h-24",fallback:e(Me,{className:"w-12 h-12 text-gray-400"})})}),G&&e(H,{color:"danger",variant:"flat",startContent:e(we,{className:"w-4 h-4"}),className:"mb-4 w-full",children:G}),N&&e("div",{className:"mb-4",children:e(st,{value:E,color:"primary",size:"sm",label:"Uploading...",showValueLabel:!0,className:"w-full"})}),e(Re,{className:"mb-4",children:t(Te,{className:"space-y-4",children:[t("div",{className:"text-center",children:[e("input",{ref:S,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:g,className:"hidden",disabled:N}),e(k,{onPress:()=>S.current?.click(),startContent:e(Ee,{className:"w-5 h-5"}),variant:"flat",color:"primary",disabled:N,className:"mb-3",children:"Choose New Picture"}),t("div",{className:"text-xs text-gray-500 space-y-1",children:[e("p",{children:"Supported formats: JPEG, PNG, WebP"}),e("p",{children:"Maximum size: 2MB"}),e("p",{children:"Minimum dimensions: 100x100px"}),e("p",{children:"Maximum dimensions: 2000x2000px"})]})]}),o&&e("div",{className:"bg-gray-50 rounded-lg p-3",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center gap-2",children:[e(ze,{className:"w-5 h-5 text-green-500"}),t("div",{children:[e("p",{className:"text-sm font-medium text-gray-900",children:o.name}),t("p",{className:"text-xs text-gray-500",children:[(o.size/1024/1024).toFixed(2)," MB"]})]})]}),e(k,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>{A(null),P(null),s("")},disabled:N,children:e(Ce,{className:"w-4 h-4"})})]})})]})}),t("div",{className:"flex justify-end gap-3",children:[M&&e(k,{onPress:c,startContent:e(_e,{className:"w-4 h-4"}),color:"danger",variant:"flat",disabled:N,children:"Remove Picture"}),e(k,{onPress:T,variant:"flat",disabled:N,children:"Cancel"}),e(k,{onPress:v,color:"primary",disabled:!o||N,isLoading:N,children:N?"Uploading...":"Update Picture"})]})]})}):null},Nt=({src:b,name:x,size:i="md",className:y="",onClick:S,showFallback:o=!0,fallbackClassName:A="",...f})=>{const[P,N]=l.useState(!1),[U,E]=l.useState(!1),_=M=>{if(!M)return"?";const g=M.trim().split(" ");if(g.length===1)return g[0].charAt(0).toUpperCase();const v=g[0]?.charAt(0)?.toUpperCase()||"",c=g[g.length-1]?.charAt(0)?.toUpperCase()||"";return v+c},G=M=>{if(!M)return{from:"#6B7280",to:"#9CA3AF"};let g=0;for(let c=0;c<M.length;c++)g=M.charCodeAt(c)+((g<<5)-g);const v=[{from:"#EF4444",to:"#DC2626"},{from:"#F97316",to:"#EA580C"},{from:"#EAB308",to:"#CA8A04"},{from:"#22C55E",to:"#16A34A"},{from:"#06B6D4",to:"#0891B2"},{from:"#3B82F6",to:"#2563EB"},{from:"#8B5CF6",to:"#7C3AED"},{from:"#EC4899",to:"#DB2777"},{from:"#14B8A6",to:"#0D9488"},{from:"#F59E0B",to:"#D97706"}];return v[Math.abs(g)%v.length]},s=_(x),d=G(x),j=()=>{N(!0),E(!1)},F=()=>{N(!1),E(!0)},L=b&&!P&&o,R=!b||P||!o;return t(Ie,{size:i,className:`cursor-pointer transition-transform hover:scale-105 ${y}`,onClick:S,classNames:{base:"shrink-0",img:"object-cover",fallback:`bg-gradient-to-br text-white font-semibold ${A}`},style:{background:R?`linear-gradient(135deg, ${d.from}, ${d.to})`:void 0},fallback:R?e("div",{className:"w-full h-full flex items-center justify-center text-white font-semibold",style:{background:`linear-gradient(135deg, ${d.from}, ${d.to})`},children:s}):void 0,src:L?b:void 0,...f,children:[L&&e("img",{src:b,alt:x||"Profile",className:"w-full h-full object-cover",onError:j,onLoad:F,style:{display:P?"none":"block"}}),R&&e("div",{className:"w-full h-full flex items-center justify-center text-white font-semibold",style:{background:`linear-gradient(135deg, ${d.from}, ${d.to})`},children:s})]})},_t=({allUsers:b,departments:x,designations:i,attendanceTypes:y,setUsers:S,isMobile:o,isTablet:A,pagination:f,onPageChange:P,onRowsPerPageChange:N,totalUsers:U=0,loading:E=!1,updateEmployeeOptimized:_,deleteEmployeeOptimized:G})=>{const s=Ne(),[d,j]=l.useState(!1),[F,L]=l.useState(null),[R,M]=l.useState({}),[g,v]=l.useState(!1),[c,T]=l.useState(null),[D,m]=l.useState(!1),[h,Q]=l.useState({isOpen:!1,employee:null}),ie=async(r,u)=>{const w=new Promise(async(p,z)=>{try{if((await V.post(route("user.updateDepartment",{id:r}),{department:u})).status===200){const q=x.find($=>$.id===parseInt(u))||null;_?.(r,{department_id:u,department_name:q?.name||null,designation_id:null,designation_name:null}),p("Department updated successfully")}}catch(O){console.error("Error updating department:",O),z("Failed to update department")}});B.promise(w,{pending:{render(){return t("div",{style:{display:"flex",alignItems:"center"},children:[e(K,{size:16}),e("span",{style:{marginLeft:"8px"},children:"Updating department..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}},success:{render({data:p}){return e("div",{children:p})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}},error:{render({data:p}){return e("div",{children:p})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}}})},oe=async(r,u)=>{const w=new Promise(async(p,z)=>{try{if((await V.post(route("user.updateDesignation",{id:r}),{designation_id:u})).status===200){const q=i.find($=>$.id===parseInt(u))||null;_?.(r,{designation_id:u,designation_name:q?.title||null}),p("Designation updated successfully")}}catch(O){console.error("Error updating designation:",O),z("Failed to update designation")}});B.promise(w,{pending:{render(){return t("div",{style:{display:"flex",alignItems:"center"},children:[e(K,{size:16}),e("span",{style:{marginLeft:"8px"},children:"Updating designation..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}},success:{render({data:p}){return e("div",{children:p})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}},error:{render({data:p}){return e("div",{children:p})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}}})},X=async(r,u)=>{const w=new Promise(async(p,z)=>{try{if((await V.post(route("user.updateAttendanceType",{id:r}),{attendance_type_id:u})).status===200){const q=y.find($=>$.id===parseInt(u))||null;_&&_(r,{attendance_type_id:u,attendance_type_name:q?.name||null}),p("Attendance type updated successfully")}}catch(O){console.error("Error updating attendance type:",O),z("Failed to update attendance type")}});B.promise(w,{pending:{render(){return t("div",{style:{display:"flex",alignItems:"center"},children:[e(K,{size:16}),e("span",{style:{marginLeft:"8px"},children:"Updating attendance type..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}},success:{render({data:p}){return e("div",{children:p})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}},error:{render({data:p}){return e("div",{children:p})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}}})},de=r=>{T(r),v(!0)},ce=async()=>{if(!c)return;m(!0);const r=new Promise(async(u,w)=>{try{(await V.delete(route("user.delete",{id:c.id}))).status===200&&(G&&G(c.id),v(!1),T(null),u("Employee deleted successfully"))}catch(p){console.error("Error deleting employee:",p);let z="Failed to delete employee";p.response?.status===403?z="You do not have permission to delete this employee":p.response?.status===404?z="Employee not found or already deleted":p.response?.data?.error&&(z=p.response.data.error),w(z)}finally{m(!1)}});B.promise(r,{pending:{render(){return t("div",{style:{display:"flex",alignItems:"center"},children:[e(K,{size:16}),e("span",{style:{marginLeft:"8px"},children:"Deleting employee..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}},success:{render({data:u}){return e("div",{children:u})},icon:"âœ…",style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}},error:{render({data:u}){return e("div",{children:u})},icon:"âŒ",style:{backdropFilter:"blur(16px) saturate(200%)",background:s.glassCard?.background||"rgba(15, 20, 25, 0.15)",border:s.glassCard?.border||"1px solid rgba(255, 255, 255, 0.2)",color:s.palette?.text?.primary||"#ffffff"}}})},me=()=>{v(!1),T(null)},ee=r=>{Q({isOpen:!0,employee:r})},pe=()=>{Q({isOpen:!1,employee:null})},he=(r,u)=>{_&&_(r,{profile_image:u})},a=l.useMemo(()=>{const r=[{name:"#",uid:"sl"},{name:"EMPLOYEE",uid:"employee"},{name:"DEPARTMENT",uid:"department"},{name:"DESIGNATION",uid:"designation"},{name:"ACTIONS",uid:"actions"}];return o||r.splice(2,0,{name:"CONTACT",uid:"contact"}),!o&&!A&&r.splice(r.length-1,0,{name:"ATTENDANCE TYPE",uid:"attendance_type"}),r},[o,A]),n=(r,u,w)=>{const p=r[u],q=(f?.currentPage&&f?.perPage?Number((f.currentPage-1)*f.perPage):0)+(typeof w=="number"?w:0)+1;switch(u){case"sl":return e("div",{className:"flex items-center justify-center",children:e("div",{className:"flex items-center justify-center w-8 h-8 bg-white/10 backdrop-blur-md rounded-lg border border-white/20",children:e("span",{className:"text-sm font-semibold text-foreground",children:q})})});case"employee":return t("div",{children:[e(Le,{avatarProps:{radius:"lg",size:o?"sm":"md",className:"cursor-pointer transition-transform hover:scale-105",onClick:()=>ee(r)},avatar:e(Nt,{src:r?.profile_image_url||r?.profile_image,name:r?.name,size:o?"sm":"md",onClick:()=>ee(r)}),name:r?.name,description:o?null:`ID: ${r?.employee_id||"N/A"}`,classNames:{name:"font-semibold text-foreground text-left",description:"text-default-500 text-left text-xs",wrapper:"justify-start"}}),o&&t("div",{className:"flex flex-col gap-1 text-xs text-default-500 ml-10",children:[t("div",{className:"flex items-center gap-1",children:[e(xt,{className:"w-3 h-3"}),r?.employee_id||"N/A"]}),t("div",{className:"flex items-center gap-1",children:[e(ve,{className:"w-3 h-3"}),r?.email]}),r?.phone&&t("div",{className:"flex items-center gap-1",children:[e(ye,{className:"w-3 h-3"}),r?.phone]})]})]});case"contact":return t("div",{className:"flex flex-col gap-2",children:[t("div",{className:"flex items-center gap-2 text-sm",children:[e(ve,{className:"w-4 h-4 text-default-400"}),e("span",{className:"text-foreground",children:r?.email})]}),r?.phone&&t("div",{className:"flex items-center gap-2 text-sm",children:[e(ye,{className:"w-4 h-4 text-default-400"}),e("span",{className:"text-foreground",children:r?.phone})]})]});case"department":return e("div",{className:"flex flex-col gap-2 min-w-[150px]",children:t(re,{children:[e(te,{children:e(k,{variant:"bordered",size:"sm",className:"justify-between backdrop-blur-md border-white/20 min-w-[150px] bg-white/10 hover:bg-white/15 transition-all duration-300",startContent:e(ne,{className:"w-4 h-4"}),endContent:e(se,{className:"w-4 h-4 rotate-90"}),children:e("span",{children:r.department_name||"Select Department"})})}),e(ae,{"aria-label":"Department options",children:x?.map(I=>e(J,{onPress:()=>ie(r.id,I.id),children:I.name},I.id.toString()))})]})});case"designation":const $=r.department_id,Oe=i?.filter(I=>I.department_id===parseInt($))||[];return e("div",{className:"flex flex-col gap-2 min-w-[150px]",children:t(re,{isDisabled:!$,children:[e(te,{children:e(k,{variant:"bordered",size:"sm",className:`justify-between backdrop-blur-md border-white/20 min-w-[150px] transition-all duration-300 ${$?"bg-white/10 hover:bg-white/15":"bg-gray-500/20 border-gray-400/40 opacity-50"}`,isDisabled:!$,startContent:e(le,{className:"w-4 h-4"}),endContent:$&&e(se,{className:"w-4 h-4 rotate-90"}),children:e("span",{children:$?r.designation_name||"Select Designation":"Select Department First"})})}),e(ae,{"aria-label":"Designation options",children:Oe.map(I=>e(J,{onPress:()=>oe(r.id,I.id),children:I.title},I.id.toString()))})]})});case"attendance_type":return e("div",{className:"flex flex-col gap-2 min-w-[150px]",children:t(re,{children:[e(te,{children:e(k,{variant:"bordered",size:"sm",className:"justify-between backdrop-blur-md border-white/20 min-w-[150px] bg-white/10 hover:bg-white/15 transition-all duration-300",startContent:e(xe,{className:"w-4 h-4"}),endContent:e(se,{className:"w-4 h-4 rotate-90"}),children:e("span",{children:r.attendance_type_name||"Select Type"})})}),e(ae,{"aria-label":"Attendance Type options",children:y?.map(I=>e(J,{onPress:()=>X(r.id,I.id),children:I.name},I.id.toString()))})]})});case"actions":return e("div",{className:"relative flex justify-center items-center",children:t(re,{children:[e(te,{children:e(k,{isIconOnly:!0,variant:"light",className:"text-default-400 hover:text-foreground transition-all duration-300",children:e(se,{className:"w-5 h-5"})})}),t(ae,{"aria-label":"Employee Actions",children:[e(J,{startContent:e(Ue,{className:"w-4 h-4"}),onPress:()=>be.visit(route("profile",{user:r.id})),children:"Edit Profile"},"edit"),e(J,{className:"text-danger",color:"danger",startContent:e(_e,{className:"w-4 h-4"}),onPress:()=>de(r),children:"Delete"},"delete")]})]})});default:return p}};return t("div",{className:"w-full overflow-hidden flex flex-col border border-white/10 rounded-lg relative",style:{maxHeight:"calc(100vh - 200px)"},children:[E&&e("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50 rounded-lg",children:t("div",{className:"flex flex-col items-center gap-4 p-6 bg-white/10 backdrop-blur-md rounded-lg border border-white/20",children:[e(Se,{size:"lg",color:"primary"}),e("span",{className:"text-sm text-foreground",children:"Loading employees..."})]})}),e("div",{className:"overflow-auto flex-grow",children:t(nt,{"aria-label":"Employees table",removeWrapper:!0,classNames:{base:"bg-transparent min-w-[800px]",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs sticky top-0 z-10",td:"border-b border-white/5 py-3",table:"border-collapse",thead:"bg-white/5",tr:"hover:bg-white/5"},isHeaderSticky:!0,isCompact:o,children:[e(lt,{columns:a,children:r=>e(it,{align:r.uid==="actions"||r.uid==="sl"?"center":"start",width:r.uid==="sl"?60:void 0,children:r.name},r.uid)}),e(ot,{items:b||[],emptyContent:"No employees found",loadingContent:e(Se,{}),isLoading:E,children:(r,u)=>{const w=b?b.findIndex(p=>p.id===r.id):u;return e(dt,{className:"transition-all duration-300 hover:bg-white/5",children:p=>e(ct,{className:"transition-all duration-300",children:e("div",{className:"transition-all duration-200",children:n(r,p,w)})})},r.id)}})]})}),!f||E?null:t("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10 bg-white/5 backdrop-blur-md",children:[t("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(f.currentPage-1)*f.perPage+1," to ",Math.min(f.currentPage*f.perPage,f.total)," of ",f.total," employees"]}),e($e,{total:Math.ceil(f.total/f.perPage),initialPage:f.currentPage,page:f.currentPage,onChange:P,size:o?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]}),e(wt,{open:g,onClose:me,employee:c,onConfirm:ce,loading:D}),e(vt,{isOpen:h.isOpen,onClose:pe,employee:h.employee,onImageUpdate:he})]})},Ct=({title:b,departments:x,designations:i,attendanceTypes:y})=>{const S=Ne(),o=De(S.breakpoints.down("sm")),A=De(S.breakpoints.down("md")),[f,P]=l.useState([]),[N,U]=l.useState(!0),[E,_]=l.useState(0),[G,s]=l.useState(1),[d,j]=l.useState({search:"",department:"all",designation:"all",attendanceType:"all"}),[F,L]=l.useState("table"),[R,M]=l.useState(!1),[g,v]=l.useState({currentPage:1,perPage:10,total:0}),[c,T]=l.useState({overview:{total_employees:0,active_employees:0,inactive_employees:0,total_departments:0,total_designations:0,total_attendance_types:0},distribution:{by_department:[],by_designation:[],by_attendance_type:[]},hiring_trends:{recent_hires:{last_30_days:0,last_90_days:0,last_year:0},monthly_growth_rate:0,current_month_hires:0},workforce_health:{status_ratio:{active_percentage:0,inactive_percentage:0,retention_rate:0},retention_rate:0,turnover_rate:0},quick_metrics:{headcount:0,active_ratio:0,department_diversity:0,role_diversity:0,recent_activity:0}}),D=l.useCallback(async()=>{U(!0);try{const{data:a}=await V.get(route("employees.paginate"),{params:{page:g.currentPage,perPage:g.perPage,search:d.search,department:d.department,designation:d.designation,attendanceType:d.attendanceType}});console.log(a),P(a.employees.data),_(a.employees.total),s(a.employees.last_page),v(n=>({...n,total:a.employees.total})),a.stats&&T(a.stats)}catch(a){console.error("Error fetching employees:",a),B.error("Failed to load employees data")}finally{U(!1)}},[g.currentPage,g.perPage,d]),m=l.useCallback(async()=>{try{const{data:a}=await V.get(route("employees.stats"));a.stats&&T(a.stats)}catch(a){console.error("Error fetching employee stats:",a)}},[]);l.useEffect(()=>{D(),m()},[D,m]);const h=l.useCallback(a=>{j(n=>({...n,search:a})),v(n=>({...n,currentPage:1}))},[]),Q=l.useCallback(a=>{j(n=>({...n,department:a,designation:a!=="all"?"all":n.designation})),v(n=>({...n,currentPage:1}))},[]),ie=l.useCallback(a=>{j(n=>({...n,designation:a})),v(n=>({...n,currentPage:1}))},[]),oe=l.useCallback(a=>{j(n=>({...n,attendanceType:a})),v(n=>({...n,currentPage:1}))},[]),X=l.useCallback(a=>{v(n=>({...n,currentPage:a}))},[]),de=l.useCallback(a=>{v(n=>({...n,perPage:a,currentPage:1}))},[]),ce=l.useCallback((a,n)=>{P(Y=>Y.map(r=>r.id===a?{...r,...n}:r))},[]),me=l.useCallback(a=>{P(n=>n.filter(Y=>Y.id!==a)),_(n=>n-1),v(n=>({...n,total:n.total-1})),m()},[m]),ee=l.useMemo(()=>d.department==="all"?i:i.filter(a=>a.department_id===parseInt(d.department)),[i,d.department]),pe=l.useMemo(()=>[{title:"Total Employees",value:c.overview?.total_employees||0,icon:e(ue,{}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"Total Headcount"},{title:"Active Employees",value:c.overview?.active_employees||0,icon:e(ze,{}),color:"text-green-400",iconBg:"bg-green-500/20",description:`${c.workforce_health?.status_ratio?.active_percentage||0}% Active`},{title:"Departments",value:c.overview?.total_departments||0,icon:e(ne,{}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Department Diversity"},{title:"Designations",value:c.overview?.total_designations||0,icon:e(le,{}),color:"text-orange-400",iconBg:"bg-orange-500/20",description:"Role Diversity"},{title:"Retention Rate",value:`${c.workforce_health?.retention_rate||0}%`,icon:e(ht,{}),color:"text-emerald-400",iconBg:"bg-emerald-500/20",description:"Employee Retention"},{title:"Recent Hires",value:c.hiring_trends?.recent_hires?.last_30_days||0,icon:e(Ae,{}),color:"text-cyan-400",iconBg:"bg-cyan-500/20",description:"Last 30 Days"},{title:"Growth Rate",value:`${c.hiring_trends?.monthly_growth_rate||0}%`,icon:e(ut,{}),color:"text-pink-400",iconBg:"bg-pink-500/20",description:"Monthly Growth"},{title:"Attendance Types",value:c.overview?.total_attendance_types||0,icon:e(xe,{}),color:"text-indigo-400",iconBg:"bg-indigo-500/20",description:"Available Types"}],[c]),he=({user:a,index:n})=>{const Y=x?.find(w=>w.id===a.department_id),r=i?.find(w=>w.id===a.designation_id),u=y?.find(w=>w.id===a.attendance_type_id);return e(Re,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 transition-all duration-200 cursor-pointer h-full",onPress:()=>be.visit(route("profile",{user:a.id})),children:t(Te,{className:"p-4 flex flex-col h-full",children:[t("div",{className:"flex items-start gap-3 mb-3 pb-3 border-b border-white/10",children:[e("div",{className:"flex-shrink-0",children:e(Le,{avatarProps:{radius:"lg",src:a?.profile_image,size:"md",fallback:e(Me,{className:"w-4 h-4"})},name:a?.name,description:`ID: ${a?.employee_id||"N/A"}`,classNames:{name:"font-semibold text-foreground text-left text-sm",description:"text-default-500 text-left text-xs",wrapper:"justify-start"}})}),e("div",{className:"flex-1 min-w-0 flex justify-end",children:e(k,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:w=>{w.stopPropagation(),be.visit(route("profile",{user:a.id}))},children:e(Ue,{className:"w-4 h-4"})})})]}),e("div",{className:"flex-1 flex flex-col gap-3",children:t("div",{className:"flex flex-col gap-2",children:[t("div",{className:"flex items-center gap-2 text-sm",children:[e(ve,{className:"w-4 h-4 text-default-400 flex-shrink-0"}),e("span",{className:"text-default-600 text-xs truncate",children:a?.email})]}),a?.phone&&t("div",{className:"flex items-center gap-2 text-sm",children:[e(ye,{className:"w-4 h-4 text-default-400 flex-shrink-0"}),e("span",{className:"text-default-600 text-xs",children:a?.phone})]})]})}),t("div",{className:"mt-3 pt-3 border-t border-white/10 flex flex-wrap gap-2",children:[Y&&e(H,{size:"sm",variant:"flat",color:"primary",className:"text-xs",startContent:e(ne,{className:"w-3 h-3"}),children:Y.name}),r&&e(H,{size:"sm",variant:"flat",color:"secondary",className:"text-xs",startContent:e(le,{className:"w-3 h-3"}),children:r.title}),u&&e(H,{size:"sm",variant:"bordered",className:"text-xs",startContent:e(xe,{className:"w-3 h-3"}),children:u.name})]})]})})};return t(Ge,{children:[e(Be,{title:b}),e(W,{sx:{display:"flex",justifyContent:"center",p:2},children:e(at,{in:!0,timeout:800,children:e(Ye,{children:e(qe,{title:"Employee Directory",subtitle:"Manage employee information, departments, and designations",icon:e(ue,{className:"w-8 h-8"}),variant:"default",actionButtons:[{label:o?"Add":"Add Employee",icon:e(Ae,{className:"w-4 h-4"}),className:"bg-gradient-to-r from-[var(--theme-primary)] to-[var(--theme-secondary)] text-white font-medium hover:opacity-90"}],children:t("div",{className:"p-4 sm:p-6",children:[e(Qe,{stats:pe,className:"mb-6"}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[t("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 p-4",children:[e(C,{variant:"h6",className:"font-semibold text-foreground mb-4",children:"Department Distribution"}),e("div",{className:"space-y-3",children:c.distribution?.by_department?.slice(0,5).map((a,n)=>t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-default-600",children:a.name}),t("div",{className:"flex items-center gap-2",children:[e("div",{className:"w-20 h-2 bg-white/10 rounded-full overflow-hidden",children:e("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 rounded-full",style:{width:`${a.percentage}%`}})}),e("span",{className:"text-xs text-default-500 w-8",children:a.count})]})]},n))})]}),t("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 p-4",children:[e(C,{variant:"h6",className:"font-semibold text-foreground mb-4",children:"Hiring Trends"}),t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-default-600",children:"Last 30 Days"}),e("span",{className:"text-sm font-medium text-foreground",children:c.hiring_trends?.recent_hires?.last_30_days||0})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-default-600",children:"Last 90 Days"}),e("span",{className:"text-sm font-medium text-foreground",children:c.hiring_trends?.recent_hires?.last_90_days||0})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-default-600",children:"This Year"}),e("span",{className:"text-sm font-medium text-foreground",children:c.hiring_trends?.recent_hires?.last_year||0})]}),e("div",{className:"pt-2 border-t border-white/10",children:t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-default-600",children:"Monthly Growth"}),t("span",{className:`text-sm font-medium ${(c.hiring_trends?.monthly_growth_rate||0)>=0?"text-green-400":"text-red-400"}`,children:[c.hiring_trends?.monthly_growth_rate||0,"%"]})]})})]})]}),t("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 p-4",children:[e(C,{variant:"h6",className:"font-semibold text-foreground mb-4",children:"Workforce Health"}),t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-default-600",children:"Retention Rate"}),t("span",{className:"text-sm font-medium text-green-400",children:[c.workforce_health?.retention_rate||0,"%"]})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-default-600",children:"Turnover Rate"}),t("span",{className:"text-sm font-medium text-orange-400",children:[c.workforce_health?.turnover_rate||0,"%"]})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-default-600",children:"Active Employees"}),t("span",{className:"text-sm font-medium text-blue-400",children:[c.workforce_health?.status_ratio?.active_percentage||0,"%"]})]})]})]}),t("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 p-4",children:[e(C,{variant:"h6",className:"font-semibold text-foreground mb-4",children:"Attendance Types"}),e("div",{className:"space-y-3",children:c.distribution?.by_attendance_type?.map((a,n)=>t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-default-600",children:a.name}),t("div",{className:"flex items-center gap-2",children:[e("div",{className:"w-16 h-2 bg-white/10 rounded-full overflow-hidden",children:e("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-500 rounded-full",style:{width:`${a.percentage}%`}})}),e("span",{className:"text-xs text-default-500 w-8",children:a.count})]})]},n))})]})]}),t("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e("div",{className:"flex-1",children:e(mt,{label:"Search Employees",variant:"bordered",placeholder:"Search by name, email, or employee ID...",value:d.search,onValueChange:h,startContent:e(We,{className:"w-4 h-4"}),classNames:{input:"bg-transparent",inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},size:o?"sm":"md"})}),t("div",{className:"flex gap-2 items-end",children:[t(pt,{variant:"bordered",className:"bg-white/5",children:[t(k,{isIconOnly:o,color:F==="table"?"primary":"default",onPress:()=>L("table"),className:F==="table"?"bg-blue-500/20":"",children:[e(ft,{className:"w-4 h-4"}),!o&&e("span",{className:"ml-1",children:"Table"})]}),t(k,{isIconOnly:o,color:F==="grid"?"primary":"default",onPress:()=>L("grid"),className:F==="grid"?"bg-blue-500/20":"",children:[e(He,{className:"w-4 h-4"}),!o&&e("span",{className:"ml-1",children:"Grid"})]})]}),t(k,{isIconOnly:o,variant:"bordered",onPress:()=>M(!R),className:R?"bg-purple-500/20":"bg-white/5",children:[e(gt,{className:"w-4 h-4"}),!o&&e("span",{className:"ml-1",children:"Filters"})]})]})]}),R&&e(rt,{in:!0,timeout:300,children:t("div",{className:"mb-6 p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:[t("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[t(ge,{label:"Department",variant:"bordered",selectedKeys:d.department!=="all"?[d.department]:[],onSelectionChange:a=>{const n=Array.from(a)[0]||"all";Q(n)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e(Z,{value:"all",children:"All Departments"},"all"),x?.map(a=>e(Z,{value:a.id.toString(),children:a.name},a.id.toString()))]}),t(ge,{label:"Designation",variant:"bordered",selectedKeys:d.designation!=="all"?[d.designation]:[],onSelectionChange:a=>{const n=Array.from(a)[0]||"all";ie(n)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e(Z,{value:"all",children:"All Designations"},"all"),ee?.map(a=>e(Z,{value:a.id.toString(),children:a.title},a.id.toString()))]}),!o&&t(ge,{label:"Attendance Type",variant:"bordered",selectedKeys:d.attendanceType!=="all"?[d.attendanceType]:[],onSelectionChange:a=>{const n=Array.from(a)[0]||"all";oe(n)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e(Z,{value:"all",children:"All Attendance Types"},"all"),y?.map(a=>e(Z,{value:a.id.toString(),children:a.name},a.id.toString()))]})]}),(d.search||d.department!=="all"||d.designation!=="all"||d.attendanceType!=="all")&&t("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-white/10",children:[d.search&&t(H,{variant:"flat",color:"primary",size:"sm",onClose:()=>j(a=>({...a,search:""})),children:["Search: ",d.search]}),d.department!=="all"&&t(H,{variant:"flat",color:"secondary",size:"sm",onClose:()=>j(a=>({...a,department:"all"})),children:["Department: ",x?.find(a=>a.id===parseInt(d.department))?.name]}),d.designation!=="all"&&t(H,{variant:"flat",color:"warning",size:"sm",onClose:()=>j(a=>({...a,designation:"all"})),children:["Designation: ",i?.find(a=>a.id===parseInt(d.designation))?.title]}),d.attendanceType!=="all"&&t(H,{variant:"flat",color:"success",size:"sm",onClose:()=>j(a=>({...a,attendanceType:"all"})),children:["Attendance: ",y?.find(a=>a.id===parseInt(d.attendanceType))?.name]})]})]})}),t("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[e("div",{className:"p-4 border-b border-white/10",children:t(C,{variant:"h6",className:"font-semibold text-foreground",children:[F==="table"?"Employee Table":"Employee Grid",t("span",{className:"text-sm text-default-500 ml-2",children:["(",E," ",E===1?"employee":"employees",")"]})]})}),N?t("div",{className:"text-center py-8",children:[e(K,{size:40}),e(C,{className:"mt-4",color:"textSecondary",children:"Loading employees data..."})]}):F==="table"?e(_t,{allUsers:f,departments:x,designations:i,attendanceTypes:y,setUsers:P,isMobile:o,isTablet:A,pagination:g,onPageChange:X,onRowsPerPageChange:de,totalUsers:E,loading:N,updateEmployeeOptimized:ce,deleteEmployeeOptimized:me}):t("div",{className:"p-4",children:[f.length>0?e("div",{className:`grid gap-4 ${o?"grid-cols-1":A?"grid-cols-2":"grid-cols-3 xl:grid-cols-4"}`,children:f.map((a,n)=>e(he,{user:a,index:n},a.id))}):t("div",{className:"text-center py-8",children:[e(ue,{className:"w-12 h-12 mx-auto text-default-300 mb-2"}),e(C,{variant:"body1",color:"textSecondary",children:"No employees found"}),e(C,{variant:"caption",color:"textSecondary",children:"Try adjusting your search or filters"})]}),f.length>0&&e("div",{className:"flex justify-center mt-6 border-t border-white/10 pt-4",children:e($e,{total:Math.ceil(E/g.perPage),initialPage:g.currentPage,page:g.currentPage,onChange:X,size:o?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})})]})]})]})})})})})]})};Ct.layout=b=>e(Ve,{children:b});export{Ct as default};
