import{H as f}from"./ui-libraries-CxFzkmxb.js";import{a as l}from"./utilities-DT6SRl8s.js";import"./react-core-DDvupgOx.js";let s=!1;const p=async()=>{if(!s)try{const{onMessageListener:t,requestNotificationPermission:a}=await f(async()=>{const{onMessageListener:e,requestNotificationPermission:o}=await import("./firebase-config-cTDouR3F.js");return{onMessageListener:e,requestNotificationPermission:o}},[]),r=await a();if(r)try{const e=await l.post(route("updateFcmToken"),{fcm_token:r});e.status===200&&console.log("FCM Token Updated:",e.data.fcm_token)}catch(e){console.error("Failed to update FCM token:",e)}else console.warn("Notification permission denied or no token retrieved.");const i=t().then(e=>{console.log("Message received:",e);const{title:o,body:n,icon:c}=e.notification;Notification.permission==="granted"&&new Notification(o,{body:n,icon:c}),alert(`${o}: ${n}`)}).catch(e=>console.error("onMessageListener error:",e));return s=!0,()=>{i&&typeof i=="function"&&i()}}catch(t){console.error("Firebase initialization error:",t)}};export{p as initFirebase};
