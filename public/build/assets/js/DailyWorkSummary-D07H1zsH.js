import{j as e,v as _,K as H,h as re,b as V,P as le,a as G,e as U,m as ke,n as Se,o as Re,q as Ce,r as De,F as me,J,A as _e,B as Ie,C as Ee,D as We,X as xe,Y as ue,N as Pe,O as $e,E as Ae,d as Me,i as ie,g as ze,s as K,l as S}from"./vendor-heroui-CinxWHhv.js";import{R as Te,r as g,Q as Le}from"./vendor-inertia-sUfCHI_5.js";import{T as ve}from"./index-CtBsO7PD.js";import{u as Z,a as ee,f as pe,d as fe,A as Ye}from"./Dashboard-C-UwZ8P5.js";import{u as Be,b as oe}from"./app-bG_kjNHR.js";import{g as M}from"./useThemeRadius-AM-qADuZ.js";import{F as X}from"./DocumentIcon-08C5TBVc.js";import{F as ne}from"./ClockIcon-Auj34PFH.js";import{F as he}from"./CheckCircleIcon-CykloG3X.js";import{F as be,D as Oe,a as Ve,b as Ge}from"./ArrowPathIcon-CtZXGp2T.js";import{F as T}from"./ChartBarIcon-BGC3fra6.js";import{a as de}from"./MapPinIcon-DDwLGyCW.js";import{F as je}from"./CheckCircleIcon-BAvoXTNq.js";import{F as Ne}from"./ClockIcon-BKLni_N9.js";import{F as Ue}from"./ExclamationTriangleIcon-BarRaUA8.js";import{S as qe}from"./StatsCards-BMaN9BXf.js";import{s as ce}from"./toastUtils-BVg-E_WQ.js";import{a as Fe}from"./vendor-utils-CrJAVL9K.js";import{utils as z,writeFile as Qe}from"./xlsx-DkH2s96g.js";import{F as He}from"./InformationCircleIcon-Hd0GuQtg.js";import{d as O}from"./dayjs.min-BJ9zlrPD.js";import{g as Je}from"./vendor-react-FouZbkAE.js";import{i as Ke}from"./isBetween-BmZnC1k9.js";import{F as Xe}from"./DocumentArrowDownIcon-DCm9Iy1y.js";import{e as ye,A as Ze}from"./vendor-framer-B7qqn1b6.js";import{F as es}from"./MagnifyingGlassIcon-BJyUDYwI.js";import{F as ss}from"./AdjustmentsHorizontalIcon-lemo7t2o.js";import{F as ts}from"./UserIcon-CgrjQ1A2.js";import"./EnvelopeIcon-CFKoTD3N.js";import"./UserGroupIcon-CSQScwVa.js";import"./ShieldCheckIcon-Ck-ae4AP.js";import"./XMarkIcon-twQGc8di.js";import"./KeyIcon-BIi5nz4o.js";import"./logo-DFaNDj_M.js";import"./createLucideIcon-DJAbkOCz.js";const as=({filteredData:u,onRefresh:I,loading:E=!1})=>{const{theme:W}=Be(),j=Z("(max-width: 1024px)"),b=()=>e.jsxs("div",{className:"max-h-[84vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx(J,{className:"w-32 h-6 rounded"}),e.jsx(J,{className:"w-20 h-8 rounded"})]}),e.jsx(le,{className:"max-h-[70vh]",children:e.jsxs("div",{className:"border border-divider rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-default-100/80 backdrop-blur-md border-b border-divider",children:e.jsx("div",{className:"flex",children:k.map((s,c)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(J,{className:"w-20 h-4 rounded"})},c))})}),e.jsx("div",{className:"divide-y divide-divider",children:Array.from({length:8}).map((s,c)=>e.jsx("div",{className:"flex hover:bg-default-50/50 transition-colors",children:k.map((x,p)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(J,{className:"w-full h-4 rounded"})},p))},c))})]})})]}),F=s=>new Date(s).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}),l=s=>s>=100?"success":s>=75?"warning":s>=50?"primary":"danger",N=s=>s>=100?e.jsx(he,{className:"w-3 h-3"}):s>=50?e.jsx(ne,{className:"w-3 h-3"}):e.jsx(Ue,{className:"w-3 h-3"}),w=(s,c)=>{const x="w-3 h-3",p=c>0?"":"text-gray-400";switch(s==null?void 0:s.toLowerCase()){case"embankment":return e.jsx(fe,{className:`${x} text-amber-500 ${p}`});case"structure":return e.jsx(X,{className:`${x} text-blue-500 ${p}`});case"pavement":return e.jsx(de,{className:`${x} text-gray-500 ${p}`});default:return e.jsx(ee,{className:`${x} text-primary ${p}`})}},y=({summary:s})=>{const c=s.totalDailyWorks>0?(s.completed/s.totalDailyWorks*100).toFixed(1):0,x=s.rfiSubmissions>0&&s.completed>0?(s.rfiSubmissions/s.completed*100).toFixed(1):0,p=s.totalDailyWorks-s.completed;return e.jsx(G,{className:"mb-2",shadow:"sm",radius:M(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(U,{className:"p-3",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-3 flex-1",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-primary",style:{fontFamily:'var(--fontFamily, "Inter")'},children:F(s.date)}),e.jsxs("span",{className:"text-xs text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.totalDailyWorks," total works"]})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(re,{size:"sm",variant:"flat",color:l(parseFloat(c)),startContent:N(parseFloat(c)),radius:M(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:[c,"%"]})})]}),e.jsx(me,{className:"my-3"}),e.jsxs("div",{className:"space-y-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Completion Progress"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.completed,"/",s.totalDailyWorks]})]}),e.jsx(H,{value:parseFloat(c),color:l(parseFloat(c)),size:"sm",radius:M(),className:"w-full","aria-label":`Completion progress: ${c}%`})]}),s.rfiSubmissions>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"RFI Submission"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.rfiSubmissions,"/",s.completed]})]}),e.jsx(H,{value:parseFloat(x),color:l(parseFloat(x)),size:"sm",radius:M(),className:"w-full","aria-label":`RFI submission progress: ${x}%`})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[w("embankment",s.embankment),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Embankment"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.embankment})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[w("structure",s.structure),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Structure"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.structure})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[w("pavement",s.pavement),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Pavement"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.pavement})]})]}),e.jsx(me,{className:"my-3"}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3 text-warning"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Resubmissions: ",s.resubmissions]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3 text-danger"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Pending: ",p]})]})]})]})})},q=Te.useCallback((s,c)=>{const x=s.totalDailyWorks>0?(s.completed/s.totalDailyWorks*100).toFixed(1):0,p=s.rfiSubmissions>0&&s.completed>0?(s.rfiSubmissions/s.completed*100).toFixed(1):0,L=s.totalDailyWorks-s.completed;switch(c){case"date":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3 text-default-500"}),e.jsx("span",{className:"text-sm font-medium",children:F(s.date)})]})});case"totalDailyWorks":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"w-3 h-3 text-primary"}),e.jsx("span",{className:"text-sm font-bold",children:s.totalDailyWorks})]})});case"resubmissions":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3 text-warning"}),e.jsx("span",{className:"text-sm",children:s.resubmissions})]})});case"embankment":case"structure":case"pavement":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[w(c,s[c]),e.jsx("span",{className:"text-sm",children:s[c]})]})});case"completed":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"w-3 h-3 text-success"}),e.jsx("span",{className:"text-sm font-medium text-success",children:s.completed})]})});case"pending":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3 text-danger"}),e.jsx("span",{className:"text-sm font-medium text-danger",children:L})]})});case"completionPercentage":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{value:parseFloat(x),color:l(parseFloat(x)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`Daily work completion: ${x}%`}),e.jsxs(re,{size:"sm",variant:"flat",color:l(parseFloat(x)),startContent:N(parseFloat(x)),children:[x,"%"]})]})});case"rfiSubmissions":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3 text-info"}),e.jsx("span",{className:"text-sm",children:s.rfiSubmissions})]})});case"rfiSubmissionPercentage":return e.jsx(_,{children:e.jsx("div",{className:"flex items-center gap-2",children:s.rfiSubmissions>0?e.jsxs(e.Fragment,{children:[e.jsx(H,{value:parseFloat(p),color:l(parseFloat(p)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`RFI submission percentage: ${p}%`}),e.jsxs(re,{size:"sm",variant:"flat",color:l(parseFloat(p)),startContent:N(parseFloat(p)),children:[p,"%"]})]}):e.jsx("span",{className:"text-sm text-default-400",children:"-"})})});default:return e.jsx(_,{children:s[c]})}},[]),k=[{name:"Date",uid:"date",icon:pe},{name:"Total Daily Works",uid:"totalDailyWorks",icon:ee},{name:"Resubmissions",uid:"resubmissions",icon:oe},{name:"Embankment",uid:"embankment",icon:fe},{name:"Structure",uid:"structure",icon:X},{name:"Pavement",uid:"pavement",icon:de},{name:"Completed",uid:"completed",icon:je},{name:"Pending",uid:"pending",icon:Ne},{name:"Completion %",uid:"completionPercentage",icon:T},{name:"RFI Submissions",uid:"rfiSubmissions",icon:X},{name:"RFI Submission %",uid:"rfiSubmissionPercentage",icon:T}];return j?e.jsxs("div",{className:"space-y-4",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[I&&e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(V,{size:"sm",variant:"bordered",color:"primary",radius:M(),startContent:e.jsx(oe,{className:"w-4 h-4"}),onPress:I,"aria-label":"Refresh daily work summary table",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Refresh Summary"})}),e.jsx(le,{className:"max-h-[70vh]",children:(u==null?void 0:u.length)>0?u.map((s,c)=>e.jsx(y,{summary:s},c)):e.jsx(G,{className:"text-center py-8",radius:M(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(U,{children:[e.jsx(T,{className:"w-12 h-12 text-default-300 mb-4 mx-auto"}),e.jsx("h6",{className:"text-lg font-semibold text-default-600 mb-2",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No summary data found"}),e.jsx("p",{className:"text-sm text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No work summary available for the selected period"})]})})})]}):E?e.jsx(b,{}):e.jsx("div",{className:"max-h-[84vh] overflow-y-auto",children:e.jsx(le,{className:"max-h-[70vh]",children:e.jsxs(ke,{selectionMode:"none",isCompact:!0,removeWrapper:!0,isStriped:!0,"aria-label":"Daily Work Summary Table",isHeaderSticky:!0,radius:M(),classNames:{base:"max-h-[520px] overflow-auto",table:"min-h-[200px] w-full",thead:"z-10",tbody:"overflow-y-auto",th:"bg-default-100 text-default-700 font-semibold",td:"text-default-600"},style:{borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Se,{columns:k,children:s=>e.jsx(Re,{align:s.uid==="date"?"start":"center",className:`bg-default-100/80 backdrop-blur-md ${s.width||""}`,style:{minWidth:s.uid==="date"?"128px":s.uid==="incharge"?"192px":"auto"},children:e.jsxs("div",{className:`flex items-center gap-1 ${s.uid==="date"?"justify-start":"justify-center"}`,children:[s.icon&&e.jsx(s.icon,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-semibold",children:s.name})]})},s.uid)}),e.jsx(Ce,{items:u||[],emptyContent:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(T,{className:"w-12 h-12 text-default-300 mb-4"}),e.jsx("h6",{className:"text-lg font-medium text-default-600",children:"No summary data found"}),e.jsx("span",{className:"text-sm text-default-500",children:"No work summary available for the selected period"})]}),children:s=>e.jsx(De,{children:c=>q(s,c)},s.date)})]})})})},rs=({open:u,closeModal:I,filteredData:E=[],inCharges:W=[],currentFilters:j={}})=>{var Y,A;const[b,F]=g.useState({format:"excel",columns:["date","totalDailyWorks","completed","pending","inProgress","completionPercentage","rfiSubmissions","embankment","structure","pavement","resubmissions","emergency"],includeCharts:!1,groupBy:"date"}),[l,N]=g.useState(!1),[w,y]=g.useState(!1),q=[{key:"excel",label:"Excel (.xlsx)",description:"Comprehensive spreadsheet with summary data",icon:e.jsx(Ve,{size:20,className:"text-green-600"})},{key:"csv",label:"CSV (.csv)",description:"Simple comma-separated values",icon:e.jsx(Ge,{size:20,className:"text-blue-600"})}],k=[{key:"date",label:"Date",description:"Summary date"},{key:"totalDailyWorks",label:"Total Works",description:"Total number of daily works"},{key:"completed",label:"Completed",description:"Number of completed works"},{key:"pending",label:"Pending",description:"Number of pending works"},{key:"inProgress",label:"In Progress",description:"Number of in-progress works"},{key:"completionPercentage",label:"Completion %",description:"Completion percentage"},{key:"rfiSubmissions",label:"RFI Submissions",description:"Number of RFI submissions"},{key:"rfiSubmissionPercentage",label:"RFI Submission %",description:"RFI submission percentage"},{key:"embankment",label:"Embankment Works",description:"Number of embankment works"},{key:"structure",label:"Structure Works",description:"Number of structure works"},{key:"pavement",label:"Pavement Works",description:"Number of pavement works"},{key:"resubmissions",label:"Resubmissions",description:"Number of resubmissions"},{key:"rejected",label:"Rejected",description:"Number of rejected works"},{key:"emergency",label:"Emergency",description:"Number of emergency works"}],s=[{key:"date",label:"By Date",description:"Group summary by date"},{key:"type",label:"By Type",description:"Group summary by work type"},{key:"overall",label:"Overall Summary",description:"Single overall summary"}],c=async()=>{try{return(await Fe.post(ve("daily-works-summary.export"),{startDate:j.startDate||null,endDate:j.endDate||null,status:j.status||null,type:j.type||null,search:j.search||null,incharge:j.incharge||null,jurisdiction:j.jurisdiction||null})).data.data||[]}catch(i){return console.error("Failed to fetch fresh export data:",i),E}},x=async()=>{N(!0),y(!0);const i=new Promise(async(o,f)=>{try{const d=await c();y(!1);let m=p(d);const t=`daily_work_summary_${new Date().toISOString().split("T")[0]}`;switch(b.format){case"excel":L(m,t);break;case"csv":$(m,t);break}I(),o(`Successfully exported ${m.length} summary records`)}catch(d){f("Export failed: "+d.message)}finally{N(!1),y(!1)}});ce.promise(i,{loading:w?"Fetching latest data...":"Exporting summary...",success:o=>o,error:o=>o})},p=i=>{let o=[...i];if(b.groupBy==="overall"){const f=o.reduce((r,n)=>r+(n.totalDailyWorks||0),0),d=o.reduce((r,n)=>r+(n.completed||0),0),m=o.reduce((r,n)=>r+(n.pending||0),0),t=o.reduce((r,n)=>r+(n.inProgress||0),0),R=o.reduce((r,n)=>r+(n.rfiSubmissions||0),0),C=o.reduce((r,n)=>r+(n.embankment||0),0),Q=o.reduce((r,n)=>r+(n.structure||0),0),D=o.reduce((r,n)=>r+(n.pavement||0),0),te=o.reduce((r,n)=>r+(n.resubmissions||0),0),ae=o.reduce((r,n)=>r+(n.rejected||0),0),a=o.reduce((r,n)=>r+(n.emergency||0),0);o=[{date:"Overall Summary",totalDailyWorks:f,completed:d,pending:m,inProgress:t,completionPercentage:f>0?(d/f*100).toFixed(1)+"%":"0%",rfiSubmissions:R,rfiSubmissionPercentage:d>0?(R/d*100).toFixed(1)+"%":"0%",embankment:C,structure:Q,pavement:D,resubmissions:te,rejected:ae,emergency:a}]}else if(b.groupBy==="type"){const f=o.reduce((d,m)=>(["embankment","structure","pavement"].forEach(t=>{m[t]>0&&(d[t]||(d[t]={type:t.charAt(0).toUpperCase()+t.slice(1),totalWorks:0,dates:[]}),d[t].totalWorks+=m[t],d[t].dates.push(m.date))}),d),{});o=Object.values(f).map(d=>({type:d.type,totalWorks:d.totalWorks,dateRange:`${Math.min(...d.dates)} to ${Math.max(...d.dates)}`,dateCount:d.dates.length}))}return o.map(f=>{const d={};return b.columns.forEach(m=>{var t;if(f.hasOwnProperty(m)){const R=((t=k.find(C=>C.key===m))==null?void 0:t.label)||m;d[R]=f[m]}}),d})},L=(i,o)=>{const f=z.json_to_sheet(i),d=z.book_new();z.book_append_sheet(d,f,"Summary");const m=Object.keys(i[0]||{}).map(()=>({wch:20}));f["!cols"]=m;const t=z.decode_range(f["!ref"]);for(let R=t.s.c;R<=t.e.c;R++){const C=z.encode_cell({r:0,c:R});f[C]&&(f[C].s={font:{bold:!0},fill:{fgColor:{rgb:"CCCCCC"}}})}Qe(d,`${o}.xlsx`)},$=(i,o)=>{const f=z.json_to_sheet(i),d=z.sheet_to_csv(f),m=new Blob([d],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),R=URL.createObjectURL(m);t.setAttribute("href",R),t.setAttribute("download",`${o}.csv`),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)};return e.jsx(_e,{isOpen:u,onClose:I,size:"3xl",scrollBehavior:"inside",classNames:{base:"backdrop-blur-md",backdrop:"bg-black/50 backdrop-blur-sm"},children:e.jsxs(Ie,{children:[e.jsxs(Ee,{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-6 h-6 text-primary"}),e.jsx("span",{children:"Export Daily Work Summary"})]}),e.jsx("p",{className:"text-sm text-default-500 font-normal",children:"Export summary data with customizable grouping and format options"})]}),e.jsx(We,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(G,{className:"bg-default-50",children:e.jsxs(U,{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Export Format"}),e.jsx(xe,{value:b.format,onValueChange:i=>F(o=>({...o,format:i})),orientation:"horizontal",children:q.map(i=>e.jsx(ue,{value:i.key,children:e.jsxs("div",{className:"flex items-center gap-2",children:[i.icon,e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i.label}),e.jsx("div",{className:"text-xs text-default-500",children:i.description})]})]})},i.key))})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Grouping & Summary"}),e.jsx(xe,{value:b.groupBy,onValueChange:i=>F(o=>({...o,groupBy:i})),children:s.map(i=>e.jsx(ue,{value:i.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i.label}),e.jsx("div",{className:"text-xs text-default-500",children:i.description})]})},i.key))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Columns to Export"}),e.jsx(Pe,{value:b.columns,onValueChange:i=>F(o=>({...o,columns:i})),children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:k.map(i=>e.jsx($e,{value:i.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i.label}),e.jsx("div",{className:"text-xs text-default-500",children:i.description})]})},i.key))})})]}),e.jsx(G,{className:"bg-primary-50 border-primary-200",children:e.jsx(U,{children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(He,{className:"w-5 h-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-primary-900",children:"Export Summary"}),e.jsxs("div",{className:"text-sm text-primary-700 space-y-1",children:[e.jsxs("p",{children:["• Format: ",(Y=q.find(i=>i.key===b.format))==null?void 0:Y.label]}),e.jsxs("p",{children:["• Grouping: ",(A=s.find(i=>i.key===b.groupBy))==null?void 0:A.label]}),e.jsxs("p",{children:["• Columns: ",b.columns.length," selected"]}),e.jsxs("p",{children:["• Records: ",E.length," summary entries"]})]})]})]})})})]})}),e.jsxs(Ae,{children:[e.jsx(V,{variant:"light",onPress:I,isDisabled:l,children:"Cancel"}),e.jsx(V,{color:"primary",onPress:x,isLoading:l,startContent:!l&&e.jsx(Oe,{size:16}),isDisabled:b.columns.length===0,children:l?"Exporting...":"Export Summary"})]})]})})};var se={exports:{}},ls=se.exports,ge;function is(){return ge||(ge=1,function(u,I){(function(E,W){u.exports=W()})(ls,function(){return function(E,W,j){var b=function(F,l){if(!l||!l.length||l.length===1&&!l[0]||l.length===1&&Array.isArray(l[0])&&!l[0].length)return null;var N;l.length===1&&l[0].length>0&&(l=l[0]),N=(l=l.filter(function(y){return y}))[0];for(var w=1;w<l.length;w+=1)l[w].isValid()&&!l[w][F](N)||(N=l[w]);return N};j.max=function(){var F=[].slice.call(arguments,0);return b("isAfter",F)},j.min=function(){var F=[].slice.call(arguments,0);return b("isBefore",F)}}})}(se)),se.exports}var ns=is();const os=Je(ns);O.extend(os);O.extend(Ke);const ds=({auth:u,title:I,summary:E,jurisdictions:W,inCharges:j,overallStartDate:b,overallEndDate:F})=>{const l=Z("(min-width: 1025px)"),N=Z("(min-width: 641px) and (max-width: 1024px)"),w=Z("(max-width: 640px)"),y=()=>{var P;if(typeof window>"u")return"lg";const r=((P=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius"))==null?void 0:P.trim())||"12px",n=parseInt(r);return n===0?"none":n<=4?"sm":n<=8?"md":n<=16?"lg":"full"},[q]=g.useState(E),[k,s]=g.useState(E),[c,x]=g.useState(!1),[p,L]=g.useState(null),[$,Y]=g.useState(""),[A,i]=g.useState(!1),o=g.useCallback(a=>{L(a)},[]),f=g.useCallback(()=>{L(null)},[]),d=g.useCallback((a,r,n,P="name")=>{if(!a||a.length===0)return e.jsx("span",{className:"text-default-400 text-xs",children:n});const B=a.map(String),h=(r==null?void 0:r.filter(v=>B.includes(String(v.id))).map(v=>v[P]))??[];return h.length===0?e.jsx("span",{className:"text-default-400 text-xs",children:n}):e.jsx("div",{className:"flex flex-wrap gap-1",children:h.map(v=>e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-primary/10 text-primary",children:v},v))})},[]),m=g.useMemo(()=>(W==null?void 0:W.map(a=>({...a,displayLabel:`${a.start_chainage} - ${a.end_chainage}`})))??[],[W]),[t,R]=g.useState({startDate:b||O().subtract(30,"days").format("YYYY-MM-DD"),endDate:F||O().format("YYYY-MM-DD"),status:"all",type:"all",incharge:[],jurisdiction:[]}),C=g.useCallback(async()=>{var a,r,n,P,B;x(!0);try{const h={startDate:t.startDate,endDate:t.endDate};t.status&&t.status!=="all"&&(h.status=t.status),t.type&&t.type!=="all"&&(h.type=t.type),$&&$.trim()&&(h.search=$.trim()),(a=t.incharge)!=null&&a.length&&(h.incharge=t.incharge),(r=t.jurisdiction)!=null&&r.length&&(h.jurisdiction=t.jurisdiction);const we=((n=(await Fe.post(ve("daily-works-summary.filter"),h)).data)==null?void 0:n.summaries)??[];return s(we),!0}catch(h){console.error("Failed to load filtered summary:",h);const v=((B=(P=h.response)==null?void 0:P.data)==null?void 0:B.error)||"Failed to load summary data";return ce.error(v),!1}finally{x(!1)}},[t,$]),Q=g.useCallback(async()=>{await C()&&ce.success("Summary data refreshed successfully")},[C]),D=g.useCallback((a,r)=>{R(n=>({...n,[a]:r}))},[]),te=g.useMemo(()=>{const a=k.reduce((h,v)=>h+v.totalDailyWorks,0),r=k.reduce((h,v)=>h+v.completed,0),n=k.reduce((h,v)=>h+v.pending,0),P=k.reduce((h,v)=>h+v.rfiSubmissions,0),B=a>0?(r/a*100).toFixed(1):0;return[{title:"Total Works",value:a,icon:e.jsx(T,{className:"w-5 h-5"}),color:"text-blue-600",description:"All logged works"},{title:"Completed",value:r,icon:e.jsx(je,{className:"w-5 h-5"}),color:"text-green-600",description:`${B}% completion rate`},{title:"Pending",value:n,icon:e.jsx(Ne,{className:"w-5 h-5"}),color:"text-orange-600",description:"In progress"},{title:"RFI Submissions",value:P,icon:e.jsx(ee,{className:"w-5 h-5"}),color:"text-purple-600",description:"Ready for inspection"}]},[k]),ae=[{label:"Refresh",icon:e.jsx(oe,{className:"w-4 h-4"}),variant:"flat",color:"primary",onPress:Q,isLoading:c,className:"bg-linear-to-r from-blue-500/20 to-cyan-500/20 hover:from-blue-500/30 hover:to-cyan-500/30",ariaLabel:"Refresh daily work summary data"},...u.roles.includes("Administrator")||u.designation==="Supervision Engineer"?[{label:"Export",icon:e.jsx(Xe,{className:"w-4 h-4"}),variant:"flat",color:"success",onPress:()=>o("exportDailyWorkSummary"),className:"bg-linear-to-r from-green-500/20 to-emerald-500/20 hover:from-green-500/30 hover:to-emerald-500/30",ariaLabel:"Export daily work summary data"}]:[]];return g.useEffect(()=>{C()},[C]),e.jsxs(e.Fragment,{children:[e.jsx(Le,{title:I}),p==="exportDailyWorkSummary"&&e.jsx(rs,{open:p==="exportDailyWorkSummary",closeModal:f,filteredData:k,inCharges:j,currentFilters:{startDate:t.startDate,endDate:t.endDate,status:t.status,type:t.type,search:$,incharge:t.incharge,jurisdiction:t.jurisdiction}}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(ye.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full max-w-[2000px]",children:e.jsxs(G,{className:"transition-all duration-200",radius:y(),style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                var(--theme-content1, #FAFAFA) 20%, 
                                var(--theme-content2, #F4F4F5) 10%, 
                                var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(Me,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                    color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                    color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${l?"p-6":N?"p-4":"p-3"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                    ${l?"p-3":N?"p-2.5":"p-2"} 
                                                    rounded-xl flex items-center justify-center
                                                `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(T,{className:`
                                                        ${l?"w-8 h-8":N?"w-6 h-6":"w-5 h-5"}
                                                    `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                        ${l?"text-2xl":N?"text-xl":"text-lg"}
                                                        font-bold text-foreground
                                                        ${l?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Daily Work Summary"}),e.jsx("p",{className:`
                                                        ${l?"text-sm":"text-xs"} 
                                                        text-default-500
                                                        ${l?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Overview of daily work statistics and progress"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex items-center gap-2",children:ae.map((a,r)=>e.jsx(V,{size:l?"md":"sm",variant:a.variant||"flat",color:a.color||"primary",startContent:a.icon,onPress:a.onPress,isLoading:a.isLoading,className:`${a.className||""} font-medium`,radius:y(),"aria-label":a.ariaLabel||a.label,style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)"},children:a.label},r))})})]})})})}),e.jsxs(U,{className:"pt-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(qe,{stats:te,isLoading:c}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[e.jsx("div",{className:"flex items-center gap-2 flex-1 max-w-md",children:e.jsx(ie,{type:"text",placeholder:"Search by number, location, description...",value:$,onChange:a=>Y(a.target.value),onKeyDown:a=>{a.key==="Enter"&&C()},size:"sm",variant:"bordered",radius:y(),isClearable:!0,onClear:()=>Y(""),startContent:e.jsx(es,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                 focus-within:bg-content2/90 border-divider/50 
                                                                 hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Search daily works"})}),e.jsx("div",{className:"flex gap-2 items-end",children:e.jsx(ze,{variant:"bordered",radius:y(),className:"bg-white/5",children:e.jsxs(V,{isIconOnly:w,color:A?"primary":"default",onPress:()=>i(!A),className:A?"bg-primary/20":"bg-white/5","aria-label":A?"Hide advanced filters":"Show advanced filters",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(ss,{className:"w-4 h-4"}),!w&&e.jsx("span",{className:"ml-1",children:"Advanced Filters"})]})})})]}),e.jsx(Ze,{children:A&&e.jsx(ye.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx("div",{className:"p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ie,{type:"date",label:"Start Date",value:t.startDate,onChange:a=>D("startDate",a.target.value),size:"sm",variant:"bordered",radius:y(),"aria-label":"Select start date",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                             focus-within:bg-content2/90 border-divider/50 
                                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(ie,{type:"date",label:"End Date",value:t.endDate,onChange:a=>D("endDate",a.target.value),size:"sm",variant:"bordered",radius:y(),"aria-label":"Select end date",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                             focus-within:bg-content2/90 border-divider/50 
                                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsxs(K,{label:"Status",placeholder:"All Status",selectedKeys:t.status?[t.status]:["all"],onSelectionChange:a=>{const r=Array.from(a)[0]||"all";D("status",r)},variant:"bordered",size:"sm",radius:y(),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground"},style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by status",children:[e.jsx(S,{value:"all",children:"All Status"},"all"),e.jsx(S,{value:"new",children:"New"},"new"),e.jsx(S,{value:"in-progress",children:"In Progress"},"in-progress"),e.jsx(S,{value:"completed",children:"Completed"},"completed"),e.jsx(S,{value:"rejected",children:"Rejected"},"rejected"),e.jsx(S,{value:"resubmission",children:"Resubmission"},"resubmission"),e.jsx(S,{value:"pending",children:"Pending"},"pending"),e.jsx(S,{value:"emergency",children:"Emergency"},"emergency")]}),e.jsxs(K,{label:"Work Type",placeholder:"All Types",selectedKeys:t.type?[t.type]:["all"],onSelectionChange:a=>{const r=Array.from(a)[0]||"all";D("type",r)},variant:"bordered",size:"sm",radius:y(),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground"},style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by work type",children:[e.jsx(S,{value:"all",children:"All Types"},"all"),e.jsx(S,{value:"Embankment",children:"Embankment"},"Embankment"),e.jsx(S,{value:"Structure",children:"Structure"},"Structure"),e.jsx(S,{value:"Pavement",children:"Pavement"},"Pavement")]}),(u.roles.includes("Administrator")||u.roles.includes("Super Administrator")||u.designation==="Supervision Engineer")&&e.jsx(K,{label:"In Charge",placeholder:"Select in charge...",selectionMode:"multiple",selectedKeys:new Set(t.incharge||[]),onSelectionChange:a=>{const r=Array.from(a);D("incharge",r),r.length>0&&D("jurisdiction",[])},variant:"bordered",size:"sm",radius:y(),startContent:e.jsx(ts,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground",listboxWrapper:"bg-content1",popoverContent:"bg-content1"},renderValue:()=>d(t.incharge,j,"Select in charge..."),style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by in charge",children:j.map(a=>e.jsx(S,{value:String(a.id),children:a.name},String(a.id)))}),(u.roles.includes("Administrator")||u.roles.includes("Super Administrator")||u.designation==="Supervision Engineer")&&e.jsx(K,{label:"Jurisdiction",placeholder:"Select jurisdiction...",selectionMode:"multiple",selectedKeys:new Set(t.jurisdiction||[]),onSelectionChange:a=>{const r=Array.from(a);D("jurisdiction",r),r.length>0&&D("incharge",[])},variant:"bordered",size:"sm",radius:y(),startContent:e.jsx(de,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground",listboxWrapper:"bg-content1",popoverContent:"bg-content1"},renderValue:()=>d(t.jurisdiction,m,"Select jurisdiction...","displayLabel"),style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by jurisdiction",children:m==null?void 0:m.map(a=>e.jsx(S,{value:String(a.id),children:a.displayLabel},String(a.id)))}),e.jsx("div",{className:"flex items-end",children:e.jsx(V,{size:"sm",variant:"flat",color:"danger",onPress:()=>{R({startDate:b||O().subtract(30,"days").format("YYYY-MM-DD"),endDate:F||O().format("YYYY-MM-DD"),status:"all",type:"all",incharge:[],jurisdiction:[]}),Y("")},style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Clear Filters"})})]})})})})]})}),e.jsx(G,{radius:y(),className:"bg-content1/80 backdrop-blur-md border border-divider/20",style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)",border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                        color-mix(in srgb, var(--theme-content1) 90%, transparent) 20%, 
                                        color-mix(in srgb, var(--theme-content2) 60%, transparent) 10%)`},children:e.jsx(U,{className:"p-0",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsx(as,{filteredData:k,onRefresh:Q,loading:c})})})]})]})})})]})};ds.layout=u=>e.jsx(Ye,{children:u});export{ds as default};
