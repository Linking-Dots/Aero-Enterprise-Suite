import{J as ne,j as e,a as r,b as _e,Q as xe}from"./app-iK4ccFYP.js";import{r as o}from"./react-core-DDvupgOx.js";import{G as De}from"./logo-D47JMLDj.js";import{P as Ne}from"./PageHeader-BJuZnBzy.js";import{S as Ce}from"./StatsCards-BveJq6Wu.js";import{m as Q,b as Pe,n as ie,B as D,F as Se,c as Fe,A as Te}from"./App--E8cOTcz.js";import"./dayjs.min-WGrXCzEl.js";import{N as Ee}from"./NoDataMessage-8cQPNRc7.js";import{F as K}from"./EyeIcon-B0n7aNqt.js";import{F as ee}from"./PencilIcon-Dhfhztfv.js";import{F as te}from"./TrashIcon-D8Us3Tf_.js";import{F as ke}from"./EllipsisVerticalIcon-BX6PWMxg.js";import{F as oe}from"./CheckCircleIcon-CJUGb5Jf.js";import{F as le}from"./XCircleIcon-DJR5_Dv7.js";import{m as Ae,n as Ie,o as Me,q as Re,v as $e,N as je,k as Be,G as ze,t as G,b as $,O as Le,P as Oe,Q as W,S as Ge,f as We,i as Qe}from"./ui-libraries-CxFzkmxb.js";import{a as k}from"./utilities-DT6SRl8s.js";import{G as Ve}from"./GlassDialog-CEoz5u2o.js";import{u as ce,a as V,p as de,T as S,o as me,t as j,h as E,i as qe,j as He,I as Ue,k as Ye,M as ae,m as se,a3 as Je,a4 as Xe,q as ue,r as he,s as B,B as q,A as re,f as pe,D as Ze,G as Ke}from"./mui-libraries-CyFs7uQU.js";import{F as et}from"./ExclamationTriangleIcon-C_gcLnRy.js";import{F as tt}from"./PlusIcon-AKF5lePL.js";import"./EnvelopeIcon-D6nUSkik.js";import"./UserIcon-D16nn9o_.js";import"./ShieldCheckIcon-C7bFKizx.js";const at=({designations:c,onEdit:d,onDelete:N,onView:n,loading:m,isMobile:b,isTablet:w,pagination:s,onPageChange:v,onRowsPerPageChange:l,canEditDesignation:g=!1,canDeleteDesignation:y=!1})=>{const{auth:f}=ne().props,_=g||f.permissions?.includes("designations.update")||!1,p=y||f.permissions?.includes("designations.delete")||!1,P=o.useMemo(()=>[{name:"TITLE",uid:"title"},{name:"DEPARTMENT",uid:"department_name"},{name:"EMPLOYEES",uid:"employee_count"},{name:"STATUS",uid:"status"},{name:"ACTIONS",uid:"actions"}],[]),i=(a,C)=>{switch(C){case"title":return e("span",{className:"font-semibold text-foreground",children:a.title});case"department_name":return e("span",{className:"text-default-500",children:a.department_name||"-"});case"employee_count":return r("div",{className:"flex items-center gap-2",children:[e(Pe,{className:"w-4 h-4 text-default-400"}),e("span",{children:a.employee_count||0})]});case"status":return e(We,{size:"sm",variant:a.is_active?"solid":"bordered",color:a.is_active?"success":"danger",startContent:a.is_active?e(oe,{className:"w-3 h-3"}):e(le,{className:"w-3 h-3"}),children:a.is_active?"Active":"Inactive"});case"actions":return e("div",{className:"flex justify-end items-center",children:b?r(Ge,{children:[e(Le,{children:e($,{isIconOnly:!0,size:"sm",variant:"light",children:e(ke,{className:"w-4 h-4"})})}),r(Oe,{"aria-label":"Designation actions",children:[e(W,{startContent:e(K,{className:"w-4 h-4"}),onPress:()=>n(a),children:"View Details"},"view"),_&&e(W,{startContent:e(ee,{className:"w-4 h-4"}),onPress:()=>d(a),children:"Edit Designation"},"edit"),p&&e(W,{className:"text-danger",color:"danger",startContent:e(te,{className:"w-4 h-4"}),isDisabled:a.employee_count>0,onPress:()=>N(a),children:"Delete Designation"},"delete")]})]}):r(_e,{children:[e(G,{content:"View Designation",children:e($,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>n(a),children:e(K,{className:"w-4 h-4"})})}),_&&e(G,{content:"Edit Designation",children:e($,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-blue-500",onPress:()=>d(a),children:e(ee,{className:"w-4 h-4"})})}),p&&e(G,{content:a.employee_count>0?"Cannot delete designation with employees":"Delete Designation",children:e($,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-danger",isDisabled:a.employee_count>0,onPress:()=>N(a),children:e(te,{className:"w-4 h-4"})})})]})});default:return e("span",{children:a[C]})}},u=()=>!c||!c.data||m?null:r("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10",children:[r("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(s.currentPage-1)*s.perPage+1," to ",Math.min(s.currentPage*s.perPage,c.total)," of ",c.total," designations"]}),e(ze,{total:Math.ceil(c.total/s.perPage),initialPage:s.currentPage,page:s.currentPage,onChange:v,size:b?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]});return!m&&(!c||!c.data||c.data.length===0)?e("div",{className:"w-full",children:e(Ee,{message:"No designations found",icon:e(Q,{className:"w-12 h-12 text-default-300"}),description:"Try adjusting your search or filters"})}):e("div",{className:"w-full",children:r(Be,{"aria-label":"Designations table",removeWrapper:!0,classNames:{base:"bg-transparent",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs",td:"border-b border-white/5 py-3"},bottomContent:u(),children:[e(Ae,{columns:P,children:a=>e(Ie,{children:a.name},a.uid)}),e(Me,{items:c.data||[],emptyContent:!m&&"No designations found",loadingContent:e(je,{}),isLoading:m,children:a=>e(Re,{children:C=>e($e,{children:i(a,C)})},a.id)})]})})},st=({open:c,onClose:d,onSuccess:N,designation:n=null,departments:m=[]})=>{const b=ce(),w=V(b.breakpoints.down("md")),[s,v]=o.useState(!1),[l,g]=o.useState({}),y={title:"",department_id:"",is_active:!0},[f,_]=o.useState(y);o.useEffect(()=>{_(n?{title:n.title||"",department_id:n.department_id||"",is_active:n.is_active??!0}:y),g({})},[n,c]);const p=i=>{const{name:u,value:a,type:C,checked:H}=i.target;_(A=>({...A,[u]:C==="checkbox"?H:a})),l[u]&&g(A=>({...A,[u]:null}))},P=async()=>{v(!0),g({});try{const i={...f};let u;n?.id?(u=await k.put(`/designations/${n.id}`,i),D.success("Designation updated successfully")):(u=await k.post("/designations",i),D.success("Designation created successfully")),N(u.data.designation),d()}catch(i){if(i.response?.data?.errors){g(i.response.data.errors);const u=Object.values(i.response.data.errors)[0];u&&D.error(u[0])}else D.error("An error occurred while saving the designation")}finally{v(!1)}};return r(Ve,{open:c,onClose:s?void 0:d,maxWidth:"sm",fullWidth:!0,fullScreen:w,"aria-labelledby":"designation-form-dialog",children:[r(de,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e(S,{variant:"h6",component:"div",children:n?"Edit Designation":"Create New Designation"}),e(me,{edge:"end",color:"inherit",onClick:d,disabled:s,"aria-label":"close",children:e(ie,{className:"w-5 h-5"})})]}),e(j,{}),e(ue,{sx:{pt:2},children:r(E,{container:!0,spacing:3,children:[e(E,{item:!0,xs:12,children:e(S,{variant:"subtitle1",color:"primary",gutterBottom:!0,children:"Designation Information"})}),e(E,{item:!0,xs:12,md:6,children:e(qe,{name:"title",label:"Designation Title",fullWidth:!0,required:!0,value:f.title,onChange:p,error:!!l.title,helperText:l.title?.[0]||"",disabled:s})}),e(E,{item:!0,xs:12,md:6,children:r(He,{fullWidth:!0,error:!!l.department_id,children:[e(Ue,{id:"department-label",children:"Department"}),r(Ye,{labelId:"department-label",name:"department_id",value:f.department_id,onChange:p,label:"Department",disabled:s,children:[e(ae,{value:"",children:e("em",{children:"Select Department"})}),m.map(i=>e(ae,{value:i.id,children:i.name},i.id))]}),l.department_id&&e(se,{children:l.department_id[0]})]})}),r(E,{item:!0,xs:12,children:[e(Je,{control:e(Xe,{checked:f.is_active,onChange:p,name:"is_active",color:"success",disabled:s}),label:"Designation is active"}),l.is_active&&e(se,{error:!0,children:l.is_active[0]})]})]})}),e(j,{}),r(he,{sx:{px:3,py:2},children:[e(B,{onClick:d,disabled:s,color:"inherit",children:"Cancel"}),e(B,{onClick:P,variant:"contained",color:"primary",disabled:s,children:s?"Saving...":n?"Update Designation":"Create Designation"})]})]})},rt=({open:c,onClose:d,onSuccess:N,designation:n})=>{const[m,b]=o.useState(!1),[w,s]=o.useState(null),v=async()=>{if(n){b(!0),s(null);try{await k.delete(`/hr/designations/${n.id}`),D.success("Designation deleted successfully"),N(),d()}catch(l){if(l.response?.data?.message)s(l.response.data.message),D.error(l.response.data.message);else if(l.response?.data?.errors){const g=Object.values(l.response.data.errors)[0];s(g),D.error(g)}else s("An error occurred while deleting the designation"),D.error("An error occurred while deleting the designation")}finally{b(!1)}}};return n?r(Ze,{open:c,onClose:m?void 0:d,maxWidth:"sm",fullWidth:!0,"aria-labelledby":"delete-designation-dialog",children:[r(de,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e(S,{variant:"h6",children:"Delete Designation"}),e(me,{edge:"end",color:"inherit",onClick:d,disabled:m,"aria-label":"close",children:e(ie,{className:"w-5 h-5"})})]}),e(j,{}),e(ue,{children:r(q,{sx:{display:"flex",flexDirection:"column",gap:2},children:[r(q,{sx:{display:"flex",alignItems:"center",gap:2},children:[e(et,{className:"w-8 h-8 text-yellow-500"}),r(S,{variant:"body1",children:["Are you sure you want to delete the designation ",e("strong",{children:n.title}),"?"]})]}),n.employee_count>0&&r(re,{severity:"warning",sx:{mt:2},children:["This designation has ",n.employee_count," employees assigned to it. You cannot delete a designation with active employees. Please reassign these employees to other designations first."]}),w&&e(re,{severity:"error",sx:{mt:2},children:w}),e(S,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"This action cannot be undone. All associated data will be permanently removed."})]})}),e(j,{}),r(he,{sx:{px:3,py:2},children:[e(B,{onClick:d,disabled:m,color:"inherit",children:"Cancel"}),e(B,{onClick:v,variant:"contained",color:"error",disabled:m||n.employee_count>0,startIcon:m&&e(pe,{size:20,color:"inherit"}),children:m?"Deleting...":"Delete Designation"})]})]}):null},Ft=({title:c,initialDesignations:d,departments:N,managers:n,parentDesignations:m,stats:b,filters:w})=>{const{auth:s}=ne().props,v=ce(),l=V(v.breakpoints.down("sm"));V(v.breakpoints.down("md"));const[g,y]=o.useState(d||{data:[]}),[f,_]=o.useState(!1),[p,P]=o.useState({type:null,designation:null}),[i,u]=o.useState({search:w?.search||"",status:w?.status||"all",parentDesignation:w?.parentDesignation||"all"}),[a,C]=o.useState(!1),[H,A]=o.useState("table"),[I,z]=o.useState({currentPage:d?.current_page||1,perPage:d?.per_page||10}),[F,ge]=o.useState(b||{total:0,active:0,inactive:0,parent_designations:0}),U=s.permissions?.includes("designations.create")||!1,Y=s.permissions?.includes("designations.update")||!1,J=s.permissions?.includes("designations.delete")||!1,L=o.useCallback(async()=>{_(!0);try{const t=await k.get(route("designations.json"),{params:{page:I.currentPage,per_page:I.perPage,search:i.search,status:i.status,parent_designation:i.parentDesignation}});y(t.data.designations||t.data)}catch(t){console.error("Error fetching designations:",t),D.error("Failed to load designations data")}finally{_(!1)}},[I,i]),O=o.useCallback(async()=>{try{const t=await k.get(route("designations.stats"));t.status===200&&ge(t.data.stats)}catch(t){console.error("Error fetching designation stats:",t)}},[]);o.useEffect(()=>{L(),O()},[L,O]);const fe=(t,x)=>{u(h=>({...h,[t]:x})),z(h=>({...h,currentPage:1}))},be=t=>{z(x=>({...x,currentPage:t})),window.scrollTo({top:0,behavior:"smooth"})},we=t=>{z({currentPage:1,perPage:t})},M=(t,x=null)=>{P({type:t,designation:x})},X=()=>{P({type:null,designation:null})},Z=(t=null,x=null)=>{x==="add"&&t?y(h=>{const T=[t,...h.data];return{...h,data:T,total:(h.total||0)+1}}):x==="edit"&&t?y(h=>{const T=h.data.map(R=>R.id===t.id?t:R);return{...h,data:T}}):x==="delete"&&t?y(h=>{const T=h.data.filter(R=>R.id!==t.id);return{...h,data:T,total:(h.total||1)-1}}):(L(),O())},ve=o.useMemo(()=>[{title:"Total Designations",value:F.total,icon:e(Q,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All designations"},{title:"Active",value:F.active,icon:e(oe,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Active designations"},{title:"Inactive",value:F.inactive,icon:e(le,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Inactive designations"},{title:"Parent Designations",value:F.parent_designations,icon:e(Se,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Top-level designations"}],[F]),ye=o.useMemo(()=>{const t=[];return U&&t.push({label:l?"Add":"Add Designation",icon:e(tt,{className:"w-4 h-4"}),onPress:()=>M("add_designation"),className:"bg-gradient-to-r from-[var(--theme-primary)] to-[var(--theme-secondary)] text-white font-medium hover:opacity-90"}),t},[U,l]);return r(Te,{children:[e(xe,{title:c}),e(q,{sx:{display:"flex",justifyContent:"center",p:2},children:e(Ke,{in:!0,timeout:800,children:e(De,{children:e(Ne,{title:"Designation Management",subtitle:"Manage company designations and hierarchy",icon:e(Q,{className:"w-8 h-8"}),variant:"default",actionButtons:ye,children:r("div",{className:"p-4 sm:p-6",children:[e(Ce,{stats:ve,className:"mb-6"}),e("div",{className:"mb-6",children:e(Qe,{label:"Search",placeholder:"Search designations...",value:i.search,onValueChange:t=>fe("search",t),startContent:e(Fe,{className:"w-4 h-4"}),size:"md"})}),e("div",{children:f?r("div",{className:"text-center py-6",children:[e(pe,{size:40}),e(S,{className:"mt-4",children:"Loading..."})]}):e(at,{designations:g,loading:f,onEdit:Y?t=>M("edit_designation",t):void 0,onDelete:J?t=>M("delete_designation",t):void 0,onView:t=>M("view_designation",t),pagination:I,onPageChange:be,onRowsPerPageChange:we,canEditDesignation:Y,canDeleteDesignation:J})})]})})})})}),(p.type==="add_designation"||p.type==="edit_designation")&&e(st,{open:!0,departments:N,onClose:X,onSuccess:t=>Z(t,p.type==="add_designation"?"add":"edit"),designation:p.designation,managers:n,parentDesignations:m}),p.type==="delete_designation"&&e(rt,{open:!0,onClose:X,onSuccess:t=>Z(t,"delete"),designation:p.designation})]})};export{Ft as default};
