import{u as he,r as l,j as e,Q as fe,b as u,a as D}from"./app-Bc-vtDbX.js";import{h as P,g as xe,k as ye,f as ge,s as T,l as H,m as E,n as M,o as B,p as L,A as be}from"./App-B7gdTY0y.js";import{G as je}from"./logo-BFkdqDjN.js";import{P as we}from"./PageHeader-CkPypK9M.js";import{S as _e}from"./StatsCards-DhSLFoTT.js";import{t as U,c as p,B as y}from"./react-toastify.esm-BWJPZwaA.js";import{u as k}from"./index-Bpv10qiA.js";import{m as W}from"./chunk-O5MCAK4F-CHDrKDXg.js";import{F as q}from"./GlobeAltIcon-BiEQZ6UD.js";import{F as ve}from"./PencilIcon-D_93JdxL.js";import{F as Ne}from"./TrashIcon-aqZERF0u.js";import{F as Ce}from"./CheckCircleIcon-hqm2mv-H.js";import{F as Se}from"./ExclamationTriangleIcon-HmDIcmhn.js";import{m as G}from"./proxy-xeVcZshG.js";import{F as Fe}from"./FunnelIcon-DCyNbH91.js";import{F as De}from"./PlusIcon-Dwsy93O8.js";import{d as Q}from"./chunk-URM6S66B-DEAi7hSe.js";import{t as He}from"./chunk-QESP63UR-CwWfvXIG.js";import{i as I}from"./chunk-SSA7SXE4-CIJDVDWg.js";import{t as ke,a as Oe,b as Ae,c as Re}from"./chunk-F3UDT23P-CWmCHRKz.js";import{t as Ye}from"./chunk-YRZGWF2W-DWGe8FlR.js";import{t as $e}from"./chunk-TSPNSPCL-fUqxaodg.js";import"./EnvelopeIcon-BRYG4FkO.js";import"./UserIcon-BjkTGiLb.js";import"./ShieldCheckIcon-Cyd1WzjX.js";import"./KeyIcon-Cbg8AdEj.js";import"./features-animation-t7xfZI87.js";import"./create-visual-element-BNxGOuZO.js";import"./index-CPDi6y8D.js";import"./useDateFieldState-Cq1TEdh4.js";import"./NumberFormatter-DNR9MAW-.js";import"./chunk-XJ2YRSUP-B6242VCM.js";import"./useToggleState-D3PLugdr.js";const ze=({title:g,holidays:K,stats:i})=>{const{theme:Pe}=he(),[b]=l.useState(window.innerWidth<640),[Te]=l.useState(window.innerWidth<768),[h,j]=l.useState(K),[c,O]=l.useState(""),[o,A]=l.useState(new Date().getFullYear().toString()),[R,V]=l.useState(!1),{isOpen:J,onOpen:X,onClose:Z}=k(),{isOpen:ee,onOpen:ae,onClose:te}=k(),{isOpen:se,onOpen:le,onClose:w}=k(),[s,f]=l.useState(null),[n,d]=l.useState({title:"",from_date:"",to_date:"",description:"",type:"public",is_recurring:!1}),[Y,x]=l.useState(!1),oe=l.useMemo(()=>[{title:"Total Holidays",value:i.total_holidays,icon:e.jsx(q,{}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All company holidays",trend:`${i.this_year_holidays} this year`},{title:"Upcoming",value:i.upcoming_holidays,icon:e.jsx(P,{}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Next holidays",trend:"Next 90 days"},{title:"This Month",value:i.this_month_holidays,icon:e.jsx(xe,{}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Current month",trend:"Ongoing & upcoming"},{title:"Working Days",value:365-i.total_holidays,icon:e.jsx(ye,{}),color:"text-orange-400",iconBg:"bg-orange-500/20",description:"Business days",trend:`${Math.round((365-i.total_holidays)/365*100)}% of year`}],[i]),_=l.useMemo(()=>h.filter(a=>{const t=a.title.toLowerCase().includes(c.toLowerCase()),r=o==="all"||new Date(a.from_date).getFullYear().toString()===o;return t&&r}),[h,c,o]),re=l.useMemo(()=>[...new Set(h.map(t=>new Date(t.from_date).getFullYear()))].sort((t,r)=>r-t),[h]),v=[{key:"public",label:"Public Holiday",color:"primary"},{key:"religious",label:"Religious Holiday",color:"secondary"},{key:"national",label:"National Holiday",color:"success"},{key:"company",label:"Company Holiday",color:"warning"},{key:"optional",label:"Optional Holiday",color:"default"}],ie=async()=>{x(!0);try{const a=s?await D.put(route("holiday.update",s.id),n):await D.post(route("holiday.store"),n);a.data.success&&(j(s?t=>t.map(r=>r.id===s.id?a.data.holiday:r):t=>[...t,a.data.holiday]),y.success(s?"Holiday updated successfully!":"Holiday created successfully!"),N())}catch{y.error("Failed to save holiday. Please try again.")}finally{x(!1)}},ne=async()=>{if(s){x(!0);try{await D.delete(route("holiday.destroy",s.id)),j(a=>a.filter(t=>t.id!==s.id)),y.success("Holiday deleted successfully!"),w(),f(null)}catch{y.error("Failed to delete holiday. Please try again.")}finally{x(!1)}}},N=()=>{Z(),te(),f(null),d({title:"",from_date:"",to_date:"",description:"",type:"public",is_recurring:!1})},de=a=>{f(a),d({title:a.title,from_date:a.from_date,to_date:a.to_date,description:a.description||"",type:a.type||"public",is_recurring:a.is_recurring||!1}),ae()},ce=a=>{f(a),le()},me=[{name:"Holiday",uid:"title"},{name:"Date",uid:"dates"},{name:"Duration",uid:"duration"},{name:"Type",uid:"type"},{name:"Status",uid:"status"},{name:"Actions",uid:"actions"}],ue=l.useCallback((a,t)=>{const r=a[t],m=new Date(a.from_date),C=new Date(a.to_date),$=Math.ceil((C-m)/(1e3*60*60*24))+1,S=m>new Date,F=m<=new Date&&C>=new Date;switch(t){case"title":return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-bold text-small capitalize",children:a.title}),a.description&&e.jsx("p",{className:"text-bold text-tiny capitalize text-default-400",children:a.description})]});case"dates":return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-small",children:m.toLocaleDateString("en-US",{month:"short",day:"numeric",year:m.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}),a.from_date!==a.to_date&&e.jsxs("span",{className:"text-tiny text-default-400",children:["to ",C.toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]});case"duration":return e.jsxs(p,{size:"sm",variant:"flat",children:[$," ",$===1?"day":"days"]});case"type":const z=v.find(pe=>pe.key===a.type)||v[0];return e.jsx(p,{size:"sm",color:z.color,variant:"flat",children:z.label});case"status":return e.jsx(p,{size:"sm",color:F?"success":S?"warning":"default",variant:"flat",startContent:F?e.jsx(Ce,{className:"w-3 h-3"}):S?e.jsx(P,{className:"w-3 h-3"}):e.jsx(Se,{className:"w-3 h-3"}),children:F?"Ongoing":S?"Upcoming":"Past"});case"actions":return e.jsxs("div",{className:"relative flex items-center gap-2",children:[e.jsx(U,{content:"Edit holiday",children:e.jsx("span",{className:"text-lg text-default-400 cursor-pointer active:opacity-50",onClick:()=>de(a),children:e.jsx(ve,{className:"w-4 h-4"})})}),e.jsx(U,{color:"danger",content:"Delete holiday",children:e.jsx("span",{className:"text-lg text-danger cursor-pointer active:opacity-50",onClick:()=>ce(a),children:e.jsx(Ne,{className:"w-4 h-4"})})})]});default:return r}},[]);return e.jsxs(e.Fragment,{children:[e.jsx(fe,{title:g}),e.jsx("div",{className:"flex justify-center p-2",children:e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:e.jsx(je,{children:e.jsx(we,{title:"Company Holidays",subtitle:"Manage company-wide holidays and special occasions",icon:e.jsx(q,{className:"w-8 h-8"}),variant:"default",actionButtons:[{label:b?"Add":"Add Holiday",icon:e.jsx(De,{className:"w-4 h-4"}),onClick:X,className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}],children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(_e,{stats:oe,className:"mb-6"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(I,{label:"Search Holidays",placeholder:"Search by holiday name...",value:c,onChange:a=>O(a.target.value),startContent:e.jsx(ge,{className:"w-4 h-4 text-default-400"})})}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs(T,{label:"Year",selectedKeys:[o],onSelectionChange:a=>A(Array.from(a)[0]),className:"w-32",children:[e.jsx(H,{value:"all",children:"All Years"},"all"),re.map(a=>e.jsx(H,{value:a.toString(),children:a},a.toString()))]}),e.jsxs(u,{isIconOnly:b,variant:"bordered",onPress:()=>V(!R),className:R?"bg-purple-500/20":"bg-white/5",children:[e.jsx(Fe,{className:"w-4 h-4"}),!b&&e.jsx("span",{className:"ml-1",children:"Filters"})]})]})]}),(c||o!==new Date().getFullYear().toString())&&e.jsxs(G.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"mb-4 flex flex-wrap gap-2",children:[c&&e.jsxs(p,{variant:"flat",color:"primary",size:"sm",onClose:()=>O(""),children:["Search: ",c]}),o!==new Date().getFullYear().toString()&&e.jsxs(p,{variant:"flat",color:"secondary",size:"sm",onClose:()=>A(new Date().getFullYear().toString()),children:["Year: ",o==="all"?"All Years":o]})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:["Company Holidays",e.jsxs("span",{className:"text-sm text-default-500 ml-2",children:["(",_.length," ",_.length===1?"holiday":"holidays",")"]})]})}),e.jsxs(ke,{isStriped:!0,removeWrapper:!0,"aria-label":"Holidays table",classNames:{th:"bg-white/5 text-default-600 border-b border-white/10",td:"border-b border-white/5"},children:[e.jsx(Ye,{columns:me,children:a=>e.jsx($e,{align:a.uid==="actions"?"center":"start",children:a.name},a.uid)}),e.jsx(Oe,{items:_,children:a=>e.jsx(Ae,{children:t=>e.jsx(Re,{children:ue(a,t)})},a.id)})]})]})]})})})})}),e.jsx(E,{isOpen:J||ee,onClose:N,size:"2xl",backdrop:"blur",classNames:{backdrop:"bg-linear-to-t from-zinc-900 to-zinc-900/10 backdrop-opacity-20",base:"border-[#292f46] bg-linear-to-br from-white/10 to-white/5 backdrop-blur-md",header:"border-b border-[#292f46]",footer:"border-t border-[#292f46]"},children:e.jsxs(M,{children:[e.jsx(B,{className:"flex flex-col gap-1",children:s?"Edit Holiday":"Add New Holiday"}),e.jsxs(L,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(I,{label:"Holiday Title",placeholder:"Enter holiday name",value:n.title,onChange:a=>d(t=>({...t,title:a.target.value})),isRequired:!0}),e.jsx(T,{label:"Holiday Type",selectedKeys:[n.type],onSelectionChange:a=>d(t=>({...t,type:Array.from(a)[0]})),children:v.map(a=>e.jsx(H,{value:a.key,children:a.label},a.key))}),e.jsx(Q,{label:"From Date",value:n.from_date,onChange:a=>d(t=>({...t,from_date:a})),isRequired:!0}),e.jsx(Q,{label:"To Date",value:n.to_date,onChange:a=>d(t=>({...t,to_date:a})),isRequired:!0})]}),e.jsx(He,{label:"Description (Optional)",placeholder:"Enter holiday description or additional notes",value:n.description,onChange:a=>d(t=>({...t,description:a.target.value})),rows:3})]}),e.jsxs(W,{children:[e.jsx(u,{color:"danger",variant:"light",onPress:N,children:"Cancel"}),e.jsx(u,{color:"primary",onPress:ie,isLoading:Y,children:s?"Update Holiday":"Add Holiday"})]})]})}),e.jsx(E,{isOpen:se,onClose:w,size:"md",backdrop:"blur",children:e.jsxs(M,{children:[e.jsx(B,{className:"flex flex-col gap-1",children:"Confirm Delete"}),e.jsxs(L,{children:[e.jsxs("p",{children:['Are you sure you want to delete the holiday "',s==null?void 0:s.title,'"?']}),e.jsx("p",{className:"text-small text-danger",children:"This action cannot be undone."})]}),e.jsxs(W,{children:[e.jsx(u,{color:"default",variant:"light",onPress:w,children:"Cancel"}),e.jsx(u,{color:"danger",onPress:ne,isLoading:Y,children:"Delete Holiday"})]})]})})]})};ze.layout=g=>e.jsx(be,{children:g});export{ze as default};
